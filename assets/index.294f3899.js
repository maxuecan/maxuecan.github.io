var UD=Object.defineProperty,zD=Object.defineProperties;var YD=Object.getOwnPropertyDescriptors;var Ud=Object.getOwnPropertySymbols;var PE=Object.prototype.hasOwnProperty,OE=Object.prototype.propertyIsEnumerable;var lw=Math.pow,IE=(t,e,n)=>e in t?UD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Me=(t,e)=>{for(var n in e||(e={}))PE.call(e,n)&&IE(t,n,e[n]);if(Ud)for(var n of Ud(e))OE.call(e,n)&&IE(t,n,e[n]);return t},Cn=(t,e)=>zD(t,YD(e));var $n=(t,e)=>{var n={};for(var i in t)PE.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&Ud)for(var i of Ud(t))e.indexOf(i)<0&&OE.call(t,i)&&(n[i]=t[i]);return n};import{L as zd,d as mS,M as GD,o as oO,b as sO,N as KD,_ as XD,q as qD,O as ZD}from"./platForm.b6da2c16.js";var cc=function(t){return t&&t.Math===Math&&t},hn=cc(typeof globalThis=="object"&&globalThis)||cc(typeof window=="object"&&window)||cc(typeof self=="object"&&self)||cc(typeof zd=="object"&&zd)||cc(typeof zd=="object"&&zd)||function(){return this}()||Function("return this")(),pS={},bn=function(t){try{return!!t()}catch(e){return!0}},QD=bn,Ki=!QD(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),JD=bn,hp=!JD(function(){var t=function(){}.bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),e$=hp,Yd=Function.prototype.call,An=e$?Yd.bind(Yd):function(){return Yd.apply(Yd,arguments)},aO={},lO={}.propertyIsEnumerable,uO=Object.getOwnPropertyDescriptor,t$=uO&&!lO.call({1:2},1);aO.f=t$?function(e){var n=uO(this,e);return!!n&&n.enumerable}:lO;var dp=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},cO=hp,hO=Function.prototype,ny=hO.call,n$=cO&&hO.bind.bind(ny,ny),Kt=cO?n$:function(t){return function(){return ny.apply(t,arguments)}},dO=Kt,i$=dO({}.toString),r$=dO("".slice),ml=function(t){return r$(i$(t),8,-1)},o$=Kt,s$=bn,a$=ml,uw=Object,l$=o$("".split),u$=s$(function(){return!uw("z").propertyIsEnumerable(0)})?function(t){return a$(t)==="String"?l$(t,""):uw(t)}:uw,fp=function(t){return t==null},c$=fp,h$=TypeError,fd=function(t){if(c$(t))throw new h$("Can't call method on "+t);return t},d$=u$,f$=fd,gd=function(t){return d$(f$(t))},cw=typeof document=="object"&&document.all,rn=typeof cw=="undefined"&&cw!==void 0?function(t){return typeof t=="function"||t===cw}:function(t){return typeof t=="function"},g$=rn,Tr=function(t){return typeof t=="object"?t!==null:g$(t)},hw=hn,m$=rn,p$=function(t){return m$(t)?t:void 0},Yu=function(t,e){return arguments.length<2?p$(hw[t]):hw[t]&&hw[t][e]},w$=Kt,md=w$({}.isPrototypeOf),v$=hn,xE=v$.navigator,HE=xE&&xE.userAgent,gp=HE?String(HE):"",fO=hn,dw=gp,AE=fO.process,NE=fO.Deno,DE=AE&&AE.versions||NE&&NE.version,$E=DE&&DE.v8,vr,cm;$E&&(vr=$E.split("."),cm=vr[0]>0&&vr[0]<4?1:+(vr[0]+vr[1]));!cm&&dw&&(vr=dw.match(/Edge\/(\d+)/),(!vr||vr[1]>=74)&&(vr=dw.match(/Chrome\/(\d+)/),vr&&(cm=+vr[1])));var C$=cm,LE=C$,y$=bn,S$=hn,b$=S$.String,wS=!!Object.getOwnPropertySymbols&&!y$(function(){var t=Symbol("symbol detection");return!b$(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&LE&&LE<41}),R$=wS,gO=R$&&!Symbol.sham&&typeof Symbol.iterator=="symbol",E$=Yu,T$=rn,M$=md,_$=gO,I$=Object,vS=_$?function(t){return typeof t=="symbol"}:function(t){var e=E$("Symbol");return T$(e)&&M$(e.prototype,I$(t))},P$=String,mp=function(t){try{return P$(t)}catch(e){return"Object"}},O$=rn,x$=mp,H$=TypeError,hi=function(t){if(O$(t))return t;throw new H$(x$(t)+" is not a function")},A$=hi,N$=fp,pd=function(t,e){var n=t[e];return N$(n)?void 0:A$(n)},fw=An,gw=rn,mw=Tr,D$=TypeError,$$=function(t,e){var n,i;if(e==="string"&&gw(n=t.toString)&&!mw(i=fw(n,t))||gw(n=t.valueOf)&&!mw(i=fw(n,t))||e!=="string"&&gw(n=t.toString)&&!mw(i=fw(n,t)))return i;throw new D$("Can't convert object to primitive value")},pp={exports:{}},CS=!1,kE=hn,L$=Object.defineProperty,yS=function(t,e){try{L$(kE,t,{value:e,configurable:!0,writable:!0})}catch(n){kE[t]=e}return e},k$=hn,F$=yS,FE="__core-js_shared__",VE=pp.exports=k$[FE]||F$(FE,{});(VE.versions||(VE.versions=[])).push({version:"3.41.0",mode:"global",copyright:"\xA9 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"});var WE=pp.exports,mO=function(t,e){return WE[t]||(WE[t]=e||{})},V$=fd,W$=Object,Gu=function(t){return W$(V$(t))},B$=Kt,j$=Gu,U$=B$({}.hasOwnProperty),Xi=Object.hasOwn||function(e,n){return U$(j$(e),n)},z$=Kt,Y$=0,G$=Math.random(),K$=z$(1 .toString),pO=function(t){return"Symbol("+(t===void 0?"":t)+")_"+K$(++Y$+G$,36)},X$=hn,q$=mO,BE=Xi,Z$=pO,Q$=wS,J$=gO,Su=X$.Symbol,pw=q$("wks"),eL=J$?Su.for||Su:Su&&Su.withoutSetter||Z$,Mr=function(t){return BE(pw,t)||(pw[t]=Q$&&BE(Su,t)?Su[t]:eL("Symbol."+t)),pw[t]},tL=An,jE=Tr,UE=vS,nL=pd,iL=$$,rL=Mr,oL=TypeError,sL=rL("toPrimitive"),aL=function(t,e){if(!jE(t)||UE(t))return t;var n=nL(t,sL),i;if(n){if(e===void 0&&(e="default"),i=tL(n,t,e),!jE(i)||UE(i))return i;throw new oL("Can't convert object to primitive value")}return e===void 0&&(e="number"),iL(t,e)},lL=aL,uL=vS,wO=function(t){var e=lL(t,"string");return uL(e)?e:e+""},cL=hn,zE=Tr,iy=cL.document,hL=zE(iy)&&zE(iy.createElement),SS=function(t){return hL?iy.createElement(t):{}},dL=Ki,fL=bn,gL=SS,vO=!dL&&!fL(function(){return Object.defineProperty(gL("div"),"a",{get:function(){return 7}}).a!==7}),mL=Ki,pL=An,wL=aO,vL=dp,CL=gd,yL=wO,SL=Xi,bL=vO,YE=Object.getOwnPropertyDescriptor;pS.f=mL?YE:function(e,n){if(e=CL(e),n=yL(n),bL)try{return YE(e,n)}catch(i){}if(SL(e,n))return vL(!pL(wL.f,e,n),e[n])};var ls={},RL=Ki,EL=bn,CO=RL&&EL(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),TL=Tr,ML=String,_L=TypeError,on=function(t){if(TL(t))return t;throw new _L(ML(t)+" is not an object")},IL=Ki,PL=vO,OL=CO,Gd=on,GE=wO,xL=TypeError,ww=Object.defineProperty,HL=Object.getOwnPropertyDescriptor,vw="enumerable",Cw="configurable",yw="writable";ls.f=IL?OL?function(e,n,i){if(Gd(e),n=GE(n),Gd(i),typeof e=="function"&&n==="prototype"&&"value"in i&&yw in i&&!i[yw]){var r=HL(e,n);r&&r[yw]&&(e[n]=i.value,i={configurable:Cw in i?i[Cw]:r[Cw],enumerable:vw in i?i[vw]:r[vw],writable:!1})}return ww(e,n,i)}:ww:function(e,n,i){if(Gd(e),n=GE(n),Gd(i),PL)try{return ww(e,n,i)}catch(r){}if("get"in i||"set"in i)throw new xL("Accessors not supported");return"value"in i&&(e[n]=i.value),e};var AL=Ki,NL=ls,DL=dp,Ku=AL?function(t,e,n){return NL.f(t,e,DL(1,n))}:function(t,e,n){return t[e]=n,t},bS={exports:{}},ry=Ki,$L=Xi,yO=Function.prototype,LL=ry&&Object.getOwnPropertyDescriptor,RS=$L(yO,"name"),kL=RS&&function(){}.name==="something",FL=RS&&(!ry||ry&&LL(yO,"name").configurable),VL={EXISTS:RS,PROPER:kL,CONFIGURABLE:FL},WL=Kt,BL=rn,oy=pp.exports,jL=WL(Function.toString);BL(oy.inspectSource)||(oy.inspectSource=function(t){return jL(t)});var UL=oy.inspectSource,zL=hn,YL=rn,KE=zL.WeakMap,GL=YL(KE)&&/native code/.test(String(KE)),KL=mO,XL=pO,XE=KL("keys"),ES=function(t){return XE[t]||(XE[t]=XL(t))},TS={},qL=GL,SO=hn,ZL=Tr,QL=Ku,Sw=Xi,bw=pp.exports,JL=ES,ek=TS,qE="Object already initialized",sy=SO.TypeError,tk=SO.WeakMap,hm,Yh,dm,nk=function(t){return dm(t)?Yh(t):hm(t,{})},ik=function(t){return function(e){var n;if(!ZL(e)||(n=Yh(e)).type!==t)throw new sy("Incompatible receiver, "+t+" required");return n}};if(qL||bw.state){var Ar=bw.state||(bw.state=new tk);Ar.get=Ar.get,Ar.has=Ar.has,Ar.set=Ar.set,hm=function(t,e){if(Ar.has(t))throw new sy(qE);return e.facade=t,Ar.set(t,e),e},Yh=function(t){return Ar.get(t)||{}},dm=function(t){return Ar.has(t)}}else{var Ml=JL("state");ek[Ml]=!0,hm=function(t,e){if(Sw(t,Ml))throw new sy(qE);return e.facade=t,QL(t,Ml,e),e},Yh=function(t){return Sw(t,Ml)?t[Ml]:{}},dm=function(t){return Sw(t,Ml)}}var bO={set:hm,get:Yh,has:dm,enforce:nk,getterFor:ik},MS=Kt,rk=bn,ok=rn,Kd=Xi,ay=Ki,sk=VL.CONFIGURABLE,ak=UL,RO=bO,lk=RO.enforce,uk=RO.get,ZE=String,kg=Object.defineProperty,ck=MS("".slice),hk=MS("".replace),dk=MS([].join),fk=ay&&!rk(function(){return kg(function(){},"length",{value:8}).length!==8}),gk=String(String).split("String"),mk=bS.exports=function(t,e,n){ck(ZE(e),0,7)==="Symbol("&&(e="["+hk(ZE(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Kd(t,"name")||sk&&t.name!==e)&&(ay?kg(t,"name",{value:e,configurable:!0}):t.name=e),fk&&n&&Kd(n,"arity")&&t.length!==n.arity&&kg(t,"length",{value:n.arity});try{n&&Kd(n,"constructor")&&n.constructor?ay&&kg(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(r){}var i=lk(t);return Kd(i,"source")||(i.source=dk(gk,typeof e=="string"?e:"")),t};Function.prototype.toString=mk(function(){return ok(this)&&uk(this).source||ak(this)},"toString");var pk=rn,wk=ls,vk=bS.exports,Ck=yS,_S=function(t,e,n,i){i||(i={});var r=i.enumerable,o=i.name!==void 0?i.name:e;if(pk(n)&&vk(n,o,i),i.global)r?t[e]=n:Ck(e,n);else{try{i.unsafe?t[e]&&(r=!0):delete t[e]}catch(s){}r?t[e]=n:wk.f(t,e,{value:n,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return t},EO={},yk=Math.ceil,Sk=Math.floor,bk=Math.trunc||function(e){var n=+e;return(n>0?Sk:yk)(n)},Rk=bk,wd=function(t){var e=+t;return e!==e||e===0?0:Rk(e)},Ek=wd,Tk=Math.max,Mk=Math.min,_k=function(t,e){var n=Ek(t);return n<0?Tk(n+e,0):Mk(n,e)},Ik=wd,Pk=Math.min,Ok=function(t){var e=Ik(t);return e>0?Pk(e,9007199254740991):0},xk=Ok,Xu=function(t){return xk(t.length)},Hk=gd,Ak=_k,Nk=Xu,QE=function(t){return function(e,n,i){var r=Hk(e),o=Nk(r);if(o===0)return!t&&-1;var s=Ak(i,o),a;if(t&&n!==n){for(;o>s;)if(a=r[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in r)&&r[s]===n)return t||s||0;return!t&&-1}},Dk={includes:QE(!0),indexOf:QE(!1)},$k=Kt,Rw=Xi,Lk=gd,kk=Dk.indexOf,Fk=TS,JE=$k([].push),TO=function(t,e){var n=Lk(t),i=0,r=[],o;for(o in n)!Rw(Fk,o)&&Rw(n,o)&&JE(r,o);for(;e.length>i;)Rw(n,o=e[i++])&&(~kk(r,o)||JE(r,o));return r},IS=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Vk=TO,Wk=IS,Bk=Wk.concat("length","prototype");EO.f=Object.getOwnPropertyNames||function(e){return Vk(e,Bk)};var MO={};MO.f=Object.getOwnPropertySymbols;var jk=Yu,Uk=Kt,zk=EO,Yk=MO,Gk=on,Kk=Uk([].concat),Xk=jk("Reflect","ownKeys")||function(e){var n=zk.f(Gk(e)),i=Yk.f;return i?Kk(n,i(e)):n},eT=Xi,qk=Xk,Zk=pS,Qk=ls,_O=function(t,e,n){for(var i=qk(e),r=Qk.f,o=Zk.f,s=0;s<i.length;s++){var a=i[s];!eT(t,a)&&!(n&&eT(n,a))&&r(t,a,o(e,a))}},Jk=bn,eF=rn,tF=/#|\.prototype\./,vd=function(t,e){var n=iF[nF(t)];return n===oF?!0:n===rF?!1:eF(e)?Jk(e):!!e},nF=vd.normalize=function(t){return String(t).replace(tF,".").toLowerCase()},iF=vd.data={},rF=vd.NATIVE="N",oF=vd.POLYFILL="P",sF=vd,Xd=hn,aF=pS.f,lF=Ku,uF=_S,cF=yS,hF=_O,dF=sF,dt=function(t,e){var n=t.target,i=t.global,r=t.stat,o,s,a,l,u,c;if(i?s=Xd:r?s=Xd[n]||cF(n,{}):s=Xd[n]&&Xd[n].prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=aF(s,a),l=c&&c.value):l=s[a],o=dF(i?a:n+(r?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;hF(u,l)}(t.sham||l&&l.sham)&&lF(u,"sham",!0),uF(s,a,u,t)}},fF=hp,IO=Function.prototype,tT=IO.apply,nT=IO.call,wp=typeof Reflect=="object"&&Reflect.apply||(fF?nT.bind(tT):function(){return nT.apply(tT,arguments)}),gF=Kt,mF=hi,PO=function(t,e,n){try{return gF(mF(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(i){}},pF=Tr,wF=function(t){return pF(t)||t===null},vF=wF,CF=String,yF=TypeError,SF=function(t){if(vF(t))return t;throw new yF("Can't set "+CF(t)+" as a prototype")},bF=PO,RF=Tr,EF=fd,TF=SF,OO=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=bF(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch(i){}return function(r,o){return EF(r),TF(o),RF(r)&&(t?n(r,o):r.__proto__=o),r}}():void 0),MF=ls.f,_F=function(t,e,n){n in t||MF(t,n,{configurable:!0,get:function(){return e[n]},set:function(i){e[n]=i}})},IF=rn,PF=Tr,iT=OO,OF=function(t,e,n){var i,r;return iT&&IF(i=e.constructor)&&i!==n&&PF(r=i.prototype)&&r!==n.prototype&&iT(t,r),t},xF=Mr,HF=xF("toStringTag"),xO={};xO[HF]="z";var AF=String(xO)==="[object z]",NF=AF,DF=rn,Fg=ml,$F=Mr,LF=$F("toStringTag"),kF=Object,FF=Fg(function(){return arguments}())==="Arguments",VF=function(t,e){try{return t[e]}catch(n){}},HO=NF?Fg:function(t){var e,n,i;return t===void 0?"Undefined":t===null?"Null":typeof(n=VF(e=kF(t),LF))=="string"?n:FF?Fg(e):(i=Fg(e))==="Object"&&DF(e.callee)?"Arguments":i},WF=HO,BF=String,vp=function(t){if(WF(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return BF(t)},jF=vp,UF=function(t,e){return t===void 0?arguments.length<2?"":e:jF(t)},zF=Tr,YF=Ku,GF=function(t,e){zF(e)&&"cause"in e&&YF(t,"cause",e.cause)},KF=Kt,AO=Error,XF=KF("".replace),qF=function(t){return String(new AO(t).stack)}("zxcasd"),NO=/\n\s*at [^:]*:[^\n]*/,ZF=NO.test(qF),QF=function(t,e){if(ZF&&typeof t=="string"&&!AO.prepareStackTrace)for(;e--;)t=XF(t,NO,"");return t},JF=bn,eV=dp,tV=!JF(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",eV(1,7)),t.stack!==7):!0}),nV=Ku,iV=QF,rV=tV,rT=Error.captureStackTrace,oV=function(t,e,n,i){rV&&(rT?rT(t,e):nV(t,"stack",iV(n,i)))},oT=Yu,sV=Xi,sT=Ku,aV=md,aT=OO,lT=_O,uT=_F,lV=OF,uV=UF,cV=GF,hV=oV,dV=Ki,fV=function(t,e,n,i){var r="stackTraceLimit",o=i?2:1,s=t.split("."),a=s[s.length-1],l=oT.apply(null,s);if(!!l){var u=l.prototype;if(sV(u,"cause")&&delete u.cause,!n)return l;var c=oT("Error"),h=e(function(d,f){var p=uV(i?f:d,void 0),S=i?new l(d):new l;return p!==void 0&&sT(S,"message",p),hV(S,h,S.stack,2),this&&aV(u,this)&&lV(S,this,h),arguments.length>o&&cV(S,arguments[o]),S});h.prototype=u,a!=="Error"?aT?aT(h,c):lT(h,c,{name:!0}):dV&&r in l&&(uT(h,l,r),uT(h,l,"prepareStackTrace")),lT(h,l);try{u.name!==a&&sT(u,"name",a),u.constructor=h}catch(d){}return h}},DO=dt,gV=hn,mo=wp,$O=fV,ly="WebAssembly",cT=gV[ly],fm=new Error("e",{cause:7}).cause!==7,pl=function(t,e){var n={};n[t]=$O(t,e,fm),DO({global:!0,constructor:!0,arity:1,forced:fm},n)},PS=function(t,e){if(cT&&cT[t]){var n={};n[t]=$O(ly+"."+t,e,fm),DO({target:ly,stat:!0,constructor:!0,arity:1,forced:fm},n)}};pl("Error",function(t){return function(n){return mo(t,this,arguments)}});pl("EvalError",function(t){return function(n){return mo(t,this,arguments)}});pl("RangeError",function(t){return function(n){return mo(t,this,arguments)}});pl("ReferenceError",function(t){return function(n){return mo(t,this,arguments)}});pl("SyntaxError",function(t){return function(n){return mo(t,this,arguments)}});pl("TypeError",function(t){return function(n){return mo(t,this,arguments)}});pl("URIError",function(t){return function(n){return mo(t,this,arguments)}});PS("CompileError",function(t){return function(n){return mo(t,this,arguments)}});PS("LinkError",function(t){return function(n){return mo(t,this,arguments)}});PS("RuntimeError",function(t){return function(n){return mo(t,this,arguments)}});var mV=ml,LO=Array.isArray||function(e){return mV(e)==="Array"},pV=Ki,wV=LO,vV=TypeError,CV=Object.getOwnPropertyDescriptor,yV=pV&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),kO=yV?function(t,e){if(wV(t)&&!CV(t,"length").writable)throw new vV("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},SV=TypeError,bV=9007199254740991,FO=function(t){if(t>bV)throw SV("Maximum allowed index exceeded");return t},RV=dt,EV=Gu,TV=Xu,MV=kO,_V=FO,IV=bn,PV=IV(function(){return[].push.call({length:4294967296},1)!==4294967297}),OV=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},xV=PV||!OV();RV({target:"Array",proto:!0,arity:1,forced:xV},{push:function(e){var n=EV(this),i=TV(n),r=arguments.length;_V(i+r);for(var o=0;o<r;o++)n[i]=arguments[o],i++;return MV(n,i),i}});var Ew=Kt,qd=Set.prototype,po={Set,add:Ew(qd.add),has:Ew(qd.has),remove:Ew(qd.delete),proto:qd},HV=po.has,wl=function(t){return HV(t),t},AV=An,vl=function(t,e,n){for(var i=n?t:t.iterator,r=t.next,o,s;!(o=AV(r,i)).done;)if(s=e(o.value),s!==void 0)return s},VO=Kt,NV=vl,WO=po,DV=WO.Set,BO=WO.proto,$V=VO(BO.forEach),jO=VO(BO.keys),LV=jO(new DV).next,Cd=function(t,e,n){return n?NV({iterator:jO(t),next:LV},e):$V(t,e)},UO=po,kV=Cd,FV=UO.Set,VV=UO.add,OS=function(t){var e=new FV;return kV(t,function(n){VV(e,n)}),e},WV=PO,BV=po,yd=WV(BV.proto,"size","get")||function(t){return t.size},wo=function(t){return{iterator:t,next:t.next,done:!1}},hT=hi,zO=on,dT=An,jV=wd,UV=wo,fT="Invalid size",zV=RangeError,YV=TypeError,GV=Math.max,YO=function(t,e){this.set=t,this.size=GV(e,0),this.has=hT(t.has),this.keys=hT(t.keys)};YO.prototype={getIterator:function(){return UV(zO(dT(this.keys,this.set)))},includes:function(t){return dT(this.has,this.set,t)}};var Cl=function(t){zO(t);var e=+t.size;if(e!==e)throw new YV(fT);var n=jV(e);if(n<0)throw new zV(fT);return new YO(t,n)},KV=wl,GO=po,XV=OS,qV=yd,ZV=Cl,QV=Cd,JV=vl,eW=GO.has,gT=GO.remove,tW=function(e){var n=KV(this),i=ZV(e),r=XV(n);return qV(n)<=i.size?QV(n,function(o){i.includes(o)&&gT(r,o)}):JV(i.getIterator(),function(o){eW(n,o)&&gT(r,o)}),r},nW=Yu,mT=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},pT=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}},yl=function(t,e){var n=nW("Set");try{new n()[t](mT(0));try{return new n()[t](mT(-1)),!1}catch(r){if(!e)return!0;try{return new n()[t](pT(-1/0)),!1}catch(o){var i=new n;return i.add(1),i.add(2),e(i[t](pT(1/0)))}}}catch(r){return!1}},iW=dt,rW=tW,oW=yl,sW=!oW("difference",function(t){return t.size===0});iW({target:"Set",proto:!0,real:!0,forced:sW},{difference:rW});var aW=wl,xS=po,lW=yd,uW=Cl,cW=Cd,hW=vl,dW=xS.Set,wT=xS.add,fW=xS.has,gW=function(e){var n=aW(this),i=uW(e),r=new dW;return lW(n)>i.size?hW(i.getIterator(),function(o){fW(n,o)&&wT(r,o)}):cW(n,function(o){i.includes(o)&&wT(r,o)}),r},mW=dt,pW=bn,wW=gW,vW=yl,CW=!vW("intersection",function(t){return t.size===2&&t.has(1)&&t.has(2)})||pW(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});mW({target:"Set",proto:!0,real:!0,forced:CW},{intersection:wW});var yW=An,vT=on,SW=pd,qu=function(t,e,n){var i,r;vT(t);try{if(i=SW(t,"return"),!i){if(e==="throw")throw n;return n}i=yW(i,t)}catch(o){r=!0,i=o}if(e==="throw")throw n;if(r)throw i;return vT(i),n},bW=wl,RW=po.has,EW=yd,TW=Cl,MW=Cd,_W=vl,IW=qu,PW=function(e){var n=bW(this),i=TW(e);if(EW(n)<=i.size)return MW(n,function(o){if(i.includes(o))return!1},!0)!==!1;var r=i.getIterator();return _W(r,function(o){if(RW(n,o))return IW(r,"normal",!1)})!==!1},OW=dt,xW=PW,HW=yl,AW=!HW("isDisjointFrom",function(t){return!t});OW({target:"Set",proto:!0,real:!0,forced:AW},{isDisjointFrom:xW});var NW=wl,DW=yd,$W=Cd,LW=Cl,kW=function(e){var n=NW(this),i=LW(e);return DW(n)>i.size?!1:$W(n,function(r){if(!i.includes(r))return!1},!0)!==!1},FW=dt,VW=kW,WW=yl,BW=!WW("isSubsetOf",function(t){return t});FW({target:"Set",proto:!0,real:!0,forced:BW},{isSubsetOf:VW});var jW=wl,UW=po.has,zW=yd,YW=Cl,GW=vl,KW=qu,XW=function(e){var n=jW(this),i=YW(e);if(zW(n)<i.size)return!1;var r=i.getIterator();return GW(r,function(o){if(!UW(n,o))return KW(r,"normal",!1)})!==!1},qW=dt,ZW=XW,QW=yl,JW=!QW("isSupersetOf",function(t){return!t});qW({target:"Set",proto:!0,real:!0,forced:JW},{isSupersetOf:ZW});var eB=wl,HS=po,tB=OS,nB=Cl,iB=vl,rB=HS.add,oB=HS.has,sB=HS.remove,aB=function(e){var n=eB(this),i=nB(e).getIterator(),r=tB(n);return iB(i,function(o){oB(n,o)?sB(r,o):rB(r,o)}),r},lB=dt,uB=aB,cB=yl;lB({target:"Set",proto:!0,real:!0,forced:!cB("symmetricDifference")},{symmetricDifference:uB});var hB=wl,dB=po.add,fB=OS,gB=Cl,mB=vl,pB=function(e){var n=hB(this),i=gB(e).getIterator(),r=fB(n);return mB(i,function(o){dB(r,o)}),r},wB=dt,vB=pB,CB=yl;wB({target:"Set",proto:!0,real:!0,forced:!CB("union")},{union:vB});var yB=md,SB=TypeError,bB=function(t,e){if(yB(e,t))return t;throw new SB("Incorrect invocation")},RB=bn,EB=!RB(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),TB=Xi,MB=rn,_B=Gu,IB=ES,PB=EB,CT=IB("IE_PROTO"),uy=Object,OB=uy.prototype,KO=PB?uy.getPrototypeOf:function(t){var e=_B(t);if(TB(e,CT))return e[CT];var n=e.constructor;return MB(n)&&e instanceof n?n.prototype:e instanceof uy?OB:null},yT=bS.exports,xB=ls,HB=function(t,e,n){return n.get&&yT(n.get,e,{getter:!0}),n.set&&yT(n.set,e,{setter:!0}),xB.f(t,e,n)},AB=Ki,NB=ls,DB=dp,XO=function(t,e,n){AB?NB.f(t,e,DB(0,n)):t[e]=n},qO={},$B=TO,LB=IS,kB=Object.keys||function(e){return $B(e,LB)},FB=Ki,VB=CO,WB=ls,BB=on,jB=gd,UB=kB;qO.f=FB&&!VB?Object.defineProperties:function(e,n){BB(e);for(var i=jB(n),r=UB(n),o=r.length,s=0,a;o>s;)WB.f(e,a=r[s++],i[a]);return e};var zB=Yu,ZO=zB("document","documentElement"),YB=on,GB=qO,ST=IS,KB=TS,XB=ZO,qB=SS,ZB=ES,bT=">",RT="<",cy="prototype",hy="script",QO=ZB("IE_PROTO"),Tw=function(){},JO=function(t){return RT+hy+bT+t+RT+"/"+hy+bT},ET=function(t){t.write(JO("")),t.close();var e=t.parentWindow.Object;return t=null,e},QB=function(){var t=qB("iframe"),e="java"+hy+":",n;return t.style.display="none",XB.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(JO("document.F=Object")),n.close(),n.F},Zd,Vg=function(){try{Zd=new ActiveXObject("htmlfile")}catch(e){}Vg=typeof document!="undefined"?document.domain&&Zd?ET(Zd):QB():ET(Zd);for(var t=ST.length;t--;)delete Vg[cy][ST[t]];return Vg()};KB[QO]=!0;var ex=Object.create||function(e,n){var i;return e!==null?(Tw[cy]=YB(e),i=new Tw,Tw[cy]=null,i[QO]=e):i=Vg(),n===void 0?i:GB.f(i,n)},JB=bn,ej=rn,tj=Tr,TT=KO,nj=_S,ij=Mr,dy=ij("iterator"),tx=!1,ol,Mw,_w;[].keys&&(_w=[].keys(),"next"in _w?(Mw=TT(TT(_w)),Mw!==Object.prototype&&(ol=Mw)):tx=!0);var rj=!tj(ol)||JB(function(){var t={};return ol[dy].call(t)!==t});rj&&(ol={});ej(ol[dy])||nj(ol,dy,function(){return this});var nx={IteratorPrototype:ol,BUGGY_SAFARI_ITERATORS:tx},oj=dt,sj=hn,aj=bB,lj=on,uj=rn,cj=KO,hj=HB,dj=XO,fj=bn,AS=Xi,gj=Mr,co=nx.IteratorPrototype,mj=Ki,Iw="constructor",ix="Iterator",MT=gj("toStringTag"),rx=TypeError,Pw=sj[ix],ox=!uj(Pw)||Pw.prototype!==co||!fj(function(){Pw({})}),NS=function(){if(aj(this,co),cj(this)===co)throw new rx("Abstract class Iterator not directly constructable")},sx=function(t,e){mj?hj(co,t,{configurable:!0,get:function(){return e},set:function(n){if(lj(this),this===co)throw new rx("You can't redefine this property");AS(this,t)?this[t]=n:dj(this,t,n)}}):co[t]=e};AS(co,MT)||sx(MT,ix);(ox||!AS(co,Iw)||co[Iw]===Object)&&sx(Iw,NS);NS.prototype=co;oj({global:!0,constructor:!0,forced:ox},{Iterator:NS});var pj=_S,wj=function(t,e,n){for(var i in e)pj(t,i,e[i],n);return t},vj=function(t,e){return{value:t,done:e}},Cj=An,yj=ex,Sj=Ku,bj=wj,Rj=Mr,ax=bO,Ej=pd,Tj=nx.IteratorPrototype,Qd=vj,Ow=qu,Mj=Rj("toStringTag"),lx="IteratorHelper",ux="WrapForValidIterator",_j=ax.set,cx=function(t){var e=ax.getterFor(t?ux:lx);return bj(yj(Tj),{next:function(){var i=e(this);if(t)return i.nextHandler();if(i.done)return Qd(void 0,!0);try{var r=i.nextHandler();return i.returnHandlerResult?r:Qd(r,i.done)}catch(o){throw i.done=!0,o}},return:function(){var n=e(this),i=n.iterator;if(n.done=!0,t){var r=Ej(i,"return");return r?Cj(r,i):Qd(void 0,!0)}if(n.inner)try{Ow(n.inner.iterator,"normal")}catch(o){return Ow(i,"throw",o)}return i&&Ow(i,"normal"),Qd(void 0,!0)}})},Ij=cx(!0),hx=cx(!1);Sj(hx,Mj,"Iterator Helper");var DS=function(t,e,n){var i=function(o,s){s?(s.iterator=o.iterator,s.next=o.next):s=o,s.type=e?ux:lx,s.returnHandlerResult=!!n,s.nextHandler=t,s.counter=0,s.done=!1,_j(this,s)};return i.prototype=e?Ij:hx,i},Pj=on,Oj=qu,dx=function(t,e,n,i){try{return i?e(Pj(n)[0],n[1]):e(n)}catch(r){Oj(t,"throw",r)}},xj=dt,Hj=An,Aj=hi,fx=on,Nj=wo,Dj=DS,$j=dx,Lj=CS,kj=Dj(function(){for(var t=this.iterator,e=this.predicate,n=this.next,i,r,o;;){if(i=fx(Hj(n,t)),r=this.done=!!i.done,r)return;if(o=i.value,$j(t,e,[o,this.counter++],!0))return o}});xj({target:"Iterator",proto:!0,real:!0,forced:Lj},{filter:function(e){return fx(this),Aj(e),new kj(Nj(this),{predicate:e})}});var Fj=ml,Vj=Kt,Wj=function(t){if(Fj(t)==="Function")return Vj(t)},_T=Wj,Bj=hi,jj=hp,Uj=_T(_T.bind),gx=function(t,e){return Bj(t),e===void 0?t:jj?Uj(t,e):function(){return t.apply(e,arguments)}},mx={},zj=Mr,Yj=mx,Gj=zj("iterator"),Kj=Array.prototype,Xj=function(t){return t!==void 0&&(Yj.Array===t||Kj[Gj]===t)},qj=HO,IT=pd,Zj=fp,Qj=mx,Jj=Mr,eU=Jj("iterator"),$S=function(t){if(!Zj(t))return IT(t,eU)||IT(t,"@@iterator")||Qj[qj(t)]},tU=An,nU=hi,iU=on,rU=mp,oU=$S,sU=TypeError,aU=function(t,e){var n=arguments.length<2?oU(t):e;if(nU(n))return iU(tU(n,t));throw new sU(rU(t)+" is not iterable")},lU=gx,uU=An,cU=on,hU=mp,dU=Xj,fU=Xu,PT=md,gU=aU,mU=$S,OT=qu,pU=TypeError,Wg=function(t,e){this.stopped=t,this.result=e},xT=Wg.prototype,Zu=function(t,e,n){var i=n&&n.that,r=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=lU(e,i),u,c,h,d,f,p,S,y=function(T){return u&&OT(u,"normal",T),new Wg(!0,T)},R=function(T){return r?(cU(T),a?l(T[0],T[1],y):l(T[0],T[1])):a?l(T,y):l(T)};if(o)u=t.iterator;else if(s)u=t;else{if(c=mU(t),!c)throw new pU(hU(t)+" is not iterable");if(dU(c)){for(h=0,d=fU(t);d>h;h++)if(f=R(t[h]),f&&PT(xT,f))return f;return new Wg(!1)}u=gU(t,c)}for(p=o?t.next:u.next;!(S=uU(p,u)).done;){try{f=R(S.value)}catch(T){OT(u,"throw",T)}if(typeof f=="object"&&f&&PT(xT,f))return f}return new Wg(!1)},wU=dt,vU=Zu,CU=hi,yU=on,SU=wo;wU({target:"Iterator",proto:!0,real:!0},{forEach:function(e){yU(this),CU(e);var n=SU(this),i=0;vU(n,function(r){e(r,i++)},{IS_RECORD:!0})}});var bU=An,RU=hi,px=on,EU=wo,TU=DS,MU=dx,_U=TU(function(){var t=this.iterator,e=px(bU(this.next,t)),n=this.done=!!e.done;if(!n)return MU(t,this.mapper,[e.value,this.counter++],!0)}),IU=function(e){return px(this),RU(e),new _U(EU(this),{mapper:e})},PU=dt,OU=IU,xU=CS;PU({target:"Iterator",proto:!0,real:!0,forced:xU},{map:OU});var HU=Kt,LS=HU([].slice),AU=TypeError,wx=function(t,e){if(t<e)throw new AU("Not enough arguments");return t},NU=gp,DU=/(?:ipad|iphone|ipod).*applewebkit/i.test(NU),hc=hn,$U=gp,LU=ml,Jd=function(t){return $U.slice(0,t.length)===t},vx=function(){return Jd("Bun/")?"BUN":Jd("Cloudflare-Workers")?"CLOUDFLARE":Jd("Deno/")?"DENO":Jd("Node.js/")?"NODE":hc.Bun&&typeof Bun.version=="string"?"BUN":hc.Deno&&typeof Deno.version=="object"?"DENO":LU(hc.process)==="process"?"NODE":hc.window&&hc.document?"BROWSER":"REST"}(),kU=vx,FU=kU==="NODE",Ti=hn,VU=wp,WU=gx,HT=rn,BU=Xi,Cx=bn,AT=ZO,jU=LS,NT=SS,UU=wx,zU=DU,YU=FU,fy=Ti.setImmediate,gy=Ti.clearImmediate,GU=Ti.process,xw=Ti.Dispatch,KU=Ti.Function,DT=Ti.MessageChannel,XU=Ti.String,Hw=0,Rh={},$T="onreadystatechange",Gh,ra,Aw,Nw;Cx(function(){Gh=Ti.location});var kS=function(t){if(BU(Rh,t)){var e=Rh[t];delete Rh[t],e()}},Dw=function(t){return function(){kS(t)}},LT=function(t){kS(t.data)},kT=function(t){Ti.postMessage(XU(t),Gh.protocol+"//"+Gh.host)};(!fy||!gy)&&(fy=function(e){UU(arguments.length,1);var n=HT(e)?e:KU(e),i=jU(arguments,1);return Rh[++Hw]=function(){VU(n,void 0,i)},ra(Hw),Hw},gy=function(e){delete Rh[e]},YU?ra=function(t){GU.nextTick(Dw(t))}:xw&&xw.now?ra=function(t){xw.now(Dw(t))}:DT&&!zU?(Aw=new DT,Nw=Aw.port2,Aw.port1.onmessage=LT,ra=WU(Nw.postMessage,Nw)):Ti.addEventListener&&HT(Ti.postMessage)&&!Ti.importScripts&&Gh&&Gh.protocol!=="file:"&&!Cx(kT)?(ra=kT,Ti.addEventListener("message",LT,!1)):$T in NT("script")?ra=function(t){AT.appendChild(NT("script"))[$T]=function(){AT.removeChild(this),kS(t)}}:ra=function(t){setTimeout(Dw(t),0)});var yx={set:fy,clear:gy},qU=dt,ZU=hn,FT=yx.clear;qU({global:!0,bind:!0,enumerable:!0,forced:ZU.clearImmediate!==FT},{clearImmediate:FT});var Sx=hn,QU=wp,JU=rn,ez=vx,tz=gp,nz=LS,iz=wx,rz=Sx.Function,oz=/MSIE .\./.test(tz)||ez==="BUN"&&function(){var t=Sx.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),sz=function(t,e){var n=e?2:1;return oz?function(i,r){var o=iz(arguments.length,1)>n,s=JU(i)?i:rz(i),a=o?nz(arguments,n):[],l=o?function(){QU(s,this,a)}:s;return e?t(l,r):t(l)}:t},az=dt,bx=hn,VT=yx.set,lz=sz,WT=bx.setImmediate?lz(VT,!1):VT;az({global:!0,bind:!0,enumerable:!0,forced:bx.setImmediate!==WT},{setImmediate:WT});/*! @license DOMPurify 3.2.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.5/LICENSE */const{entries:Rx,setPrototypeOf:BT,isFrozen:uz,getPrototypeOf:cz,getOwnPropertyDescriptor:hz}=Object;let{freeze:Gn,seal:Gi,create:Ex}=Object,{apply:my,construct:py}=typeof Reflect!="undefined"&&Reflect;Gn||(Gn=function(e){return e});Gi||(Gi=function(e){return e});my||(my=function(e,n,i){return e.apply(n,i)});py||(py=function(e,n){return new e(...n)});const ef=Kn(Array.prototype.forEach),dz=Kn(Array.prototype.lastIndexOf),jT=Kn(Array.prototype.pop),dc=Kn(Array.prototype.push),fz=Kn(Array.prototype.splice),Bg=Kn(String.prototype.toLowerCase),$w=Kn(String.prototype.toString),UT=Kn(String.prototype.match),fc=Kn(String.prototype.replace),gz=Kn(String.prototype.indexOf),mz=Kn(String.prototype.trim),cr=Kn(Object.prototype.hasOwnProperty),Ln=Kn(RegExp.prototype.test),gc=pz(TypeError);function Kn(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return my(t,e,i)}}function pz(t){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return py(t,n)}}function ke(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Bg;BT&&BT(t,null);let i=e.length;for(;i--;){let r=e[i];if(typeof r=="string"){const o=n(r);o!==r&&(uz(e)||(e[i]=o),r=o)}t[r]=!0}return t}function wz(t){for(let e=0;e<t.length;e++)cr(t,e)||(t[e]=null);return t}function Ua(t){const e=Ex(null);for(const[n,i]of Rx(t))cr(t,n)&&(Array.isArray(i)?e[n]=wz(i):i&&typeof i=="object"&&i.constructor===Object?e[n]=Ua(i):e[n]=i);return e}function mc(t,e){for(;t!==null;){const i=hz(t,e);if(i){if(i.get)return Kn(i.get);if(typeof i.value=="function")return Kn(i.value)}t=cz(t)}function n(){return null}return n}const zT=Gn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Lw=Gn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),kw=Gn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),vz=Gn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Fw=Gn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Cz=Gn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),YT=Gn(["#text"]),GT=Gn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Vw=Gn(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),KT=Gn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),tf=Gn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),yz=Gi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Sz=Gi(/<%[\w\W]*|[\w\W]*%>/gm),bz=Gi(/\$\{[\w\W]*/gm),Rz=Gi(/^data-[\-\w.\u00B7-\uFFFF]+$/),Ez=Gi(/^aria-[\-\w]+$/),Tx=Gi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Tz=Gi(/^(?:\w+script|data):/i),Mz=Gi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Mx=Gi(/^html$/i),_z=Gi(/^[a-z][.\w]*(-[.\w]+)+$/i);var XT=Object.freeze({__proto__:null,ARIA_ATTR:Ez,ATTR_WHITESPACE:Mz,CUSTOM_ELEMENT:_z,DATA_ATTR:Rz,DOCTYPE_NAME:Mx,ERB_EXPR:Sz,IS_ALLOWED_URI:Tx,IS_SCRIPT_OR_DATA:Tz,MUSTACHE_EXPR:yz,TMPLIT_EXPR:bz});const pc={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},Iz=function(){return typeof window=="undefined"?null:window},Pz=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const r="data-tt-policy-suffix";n&&n.hasAttribute(r)&&(i=n.getAttribute(r));const o="dompurify"+(i?"#"+i:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch(s){return console.warn("TrustedTypes policy "+o+" could not be created."),null}},qT=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function _x(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Iz();const e=me=>_x(me);if(e.version="3.2.5",e.removed=[],!t||!t.document||t.document.nodeType!==pc.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const i=n,r=i.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,p=l.prototype,S=mc(p,"cloneNode"),y=mc(p,"remove"),R=mc(p,"nextSibling"),T=mc(p,"childNodes"),V=mc(p,"parentNode");if(typeof s=="function"){const me=n.createElement("template");me.content&&me.content.ownerDocument&&(n=me.content.ownerDocument)}let B,W="";const{implementation:$,createNodeIterator:L,createDocumentFragment:z,getElementsByTagName:ie}=n,{importNode:K}=i;let te=qT();e.isSupported=typeof Rx=="function"&&typeof V=="function"&&$&&$.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:se,ERB_EXPR:Ce,TMPLIT_EXPR:be,DATA_ATTR:je,ARIA_ATTR:jt,IS_SCRIPT_OR_DATA:Pe,ATTR_WHITESPACE:Ke,CUSTOM_ELEMENT:bt}=XT;let{IS_ALLOWED_URI:qt}=XT,g=null;const m=ke({},[...zT,...Lw,...kw,...Fw,...YT]);let w=null;const b=ke({},[...GT,...Vw,...KT,...tf]);let P=Object.seal(Ex(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),k=null,Y=null,G=!0,ne=!0,v=!1,C=!0,E=!1,x=!0,I=!1,A=!1,F=!1,_=!1,H=!1,N=!1,D=!0,j=!1;const ae="user-content-";let ue=!0,ye=!1,Ne={},Ve=null;const Te=ke({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let $e=null;const Nt=ke({},["audio","video","img","source","image","track"]);let Ji=null;const Or=ke({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),dn="http://www.w3.org/1998/Math/MathML",Zt="http://www.w3.org/2000/svg",Dt="http://www.w3.org/1999/xhtml";let mt=Dt,nt=!1,Le=null;const Wd=ke({},[dn,Zt,Dt],$w);let ia=ke({},["mi","mo","mn","ms","mtext"]),Bd=ke({},["annotation-xml"]);const kD=ke({},["title","style","font","a","script"]);let lc=null;const FD=["application/xhtml+xml","text/html"],VD="text/html";let fn=null,Tl=null;const WD=n.createElement("form"),pE=function(O){return O instanceof RegExp||O instanceof Function},sw=function(){let O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Tl&&Tl===O)){if((!O||typeof O!="object")&&(O={}),O=Ua(O),lc=FD.indexOf(O.PARSER_MEDIA_TYPE)===-1?VD:O.PARSER_MEDIA_TYPE,fn=lc==="application/xhtml+xml"?$w:Bg,g=cr(O,"ALLOWED_TAGS")?ke({},O.ALLOWED_TAGS,fn):m,w=cr(O,"ALLOWED_ATTR")?ke({},O.ALLOWED_ATTR,fn):b,Le=cr(O,"ALLOWED_NAMESPACES")?ke({},O.ALLOWED_NAMESPACES,$w):Wd,Ji=cr(O,"ADD_URI_SAFE_ATTR")?ke(Ua(Or),O.ADD_URI_SAFE_ATTR,fn):Or,$e=cr(O,"ADD_DATA_URI_TAGS")?ke(Ua(Nt),O.ADD_DATA_URI_TAGS,fn):Nt,Ve=cr(O,"FORBID_CONTENTS")?ke({},O.FORBID_CONTENTS,fn):Te,k=cr(O,"FORBID_TAGS")?ke({},O.FORBID_TAGS,fn):{},Y=cr(O,"FORBID_ATTR")?ke({},O.FORBID_ATTR,fn):{},Ne=cr(O,"USE_PROFILES")?O.USE_PROFILES:!1,G=O.ALLOW_ARIA_ATTR!==!1,ne=O.ALLOW_DATA_ATTR!==!1,v=O.ALLOW_UNKNOWN_PROTOCOLS||!1,C=O.ALLOW_SELF_CLOSE_IN_ATTR!==!1,E=O.SAFE_FOR_TEMPLATES||!1,x=O.SAFE_FOR_XML!==!1,I=O.WHOLE_DOCUMENT||!1,_=O.RETURN_DOM||!1,H=O.RETURN_DOM_FRAGMENT||!1,N=O.RETURN_TRUSTED_TYPE||!1,F=O.FORCE_BODY||!1,D=O.SANITIZE_DOM!==!1,j=O.SANITIZE_NAMED_PROPS||!1,ue=O.KEEP_CONTENT!==!1,ye=O.IN_PLACE||!1,qt=O.ALLOWED_URI_REGEXP||Tx,mt=O.NAMESPACE||Dt,ia=O.MATHML_TEXT_INTEGRATION_POINTS||ia,Bd=O.HTML_INTEGRATION_POINTS||Bd,P=O.CUSTOM_ELEMENT_HANDLING||{},O.CUSTOM_ELEMENT_HANDLING&&pE(O.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(P.tagNameCheck=O.CUSTOM_ELEMENT_HANDLING.tagNameCheck),O.CUSTOM_ELEMENT_HANDLING&&pE(O.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(P.attributeNameCheck=O.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),O.CUSTOM_ELEMENT_HANDLING&&typeof O.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(P.allowCustomizedBuiltInElements=O.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),E&&(ne=!1),H&&(_=!0),Ne&&(g=ke({},YT),w=[],Ne.html===!0&&(ke(g,zT),ke(w,GT)),Ne.svg===!0&&(ke(g,Lw),ke(w,Vw),ke(w,tf)),Ne.svgFilters===!0&&(ke(g,kw),ke(w,Vw),ke(w,tf)),Ne.mathMl===!0&&(ke(g,Fw),ke(w,KT),ke(w,tf))),O.ADD_TAGS&&(g===m&&(g=Ua(g)),ke(g,O.ADD_TAGS,fn)),O.ADD_ATTR&&(w===b&&(w=Ua(w)),ke(w,O.ADD_ATTR,fn)),O.ADD_URI_SAFE_ATTR&&ke(Ji,O.ADD_URI_SAFE_ATTR,fn),O.FORBID_CONTENTS&&(Ve===Te&&(Ve=Ua(Ve)),ke(Ve,O.FORBID_CONTENTS,fn)),ue&&(g["#text"]=!0),I&&ke(g,["html","head","body"]),g.table&&(ke(g,["tbody"]),delete k.tbody),O.TRUSTED_TYPES_POLICY){if(typeof O.TRUSTED_TYPES_POLICY.createHTML!="function")throw gc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof O.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw gc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');B=O.TRUSTED_TYPES_POLICY,W=B.createHTML("")}else B===void 0&&(B=Pz(f,r)),B!==null&&typeof W=="string"&&(W=B.createHTML(""));Gn&&Gn(O),Tl=O}},wE=ke({},[...Lw,...kw,...vz]),vE=ke({},[...Fw,...Cz]),BD=function(O){let Z=V(O);(!Z||!Z.tagName)&&(Z={namespaceURI:mt,tagName:"template"});const de=Bg(O.tagName),Rt=Bg(Z.tagName);return Le[O.namespaceURI]?O.namespaceURI===Zt?Z.namespaceURI===Dt?de==="svg":Z.namespaceURI===dn?de==="svg"&&(Rt==="annotation-xml"||ia[Rt]):Boolean(wE[de]):O.namespaceURI===dn?Z.namespaceURI===Dt?de==="math":Z.namespaceURI===Zt?de==="math"&&Bd[Rt]:Boolean(vE[de]):O.namespaceURI===Dt?Z.namespaceURI===Zt&&!Bd[Rt]||Z.namespaceURI===dn&&!ia[Rt]?!1:!vE[de]&&(kD[de]||!wE[de]):!!(lc==="application/xhtml+xml"&&Le[O.namespaceURI]):!1},xr=function(O){dc(e.removed,{element:O});try{V(O).removeChild(O)}catch(Z){y(O)}},jd=function(O,Z){try{dc(e.removed,{attribute:Z.getAttributeNode(O),from:Z})}catch(de){dc(e.removed,{attribute:null,from:Z})}if(Z.removeAttribute(O),O==="is")if(_||H)try{xr(Z)}catch(de){}else try{Z.setAttribute(O,"")}catch(de){}},CE=function(O){let Z=null,de=null;if(F)O="<remove></remove>"+O;else{const vn=UT(O,/^[\r\n\t ]+/);de=vn&&vn[0]}lc==="application/xhtml+xml"&&mt===Dt&&(O='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+O+"</body></html>");const Rt=B?B.createHTML(O):O;if(mt===Dt)try{Z=new d().parseFromString(Rt,lc)}catch(vn){}if(!Z||!Z.documentElement){Z=$.createDocument(mt,"template",null);try{Z.documentElement.innerHTML=nt?W:Rt}catch(vn){}}const Rn=Z.body||Z.documentElement;return O&&de&&Rn.insertBefore(n.createTextNode(de),Rn.childNodes[0]||null),mt===Dt?ie.call(Z,I?"html":"body")[0]:I?Z.documentElement:Rn},yE=function(O){return L.call(O.ownerDocument||O,O,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},aw=function(O){return O instanceof h&&(typeof O.nodeName!="string"||typeof O.textContent!="string"||typeof O.removeChild!="function"||!(O.attributes instanceof c)||typeof O.removeAttribute!="function"||typeof O.setAttribute!="function"||typeof O.namespaceURI!="string"||typeof O.insertBefore!="function"||typeof O.hasChildNodes!="function")},SE=function(O){return typeof a=="function"&&O instanceof a};function So(me,O,Z){ef(me,de=>{de.call(e,O,Z,Tl)})}const bE=function(O){let Z=null;if(So(te.beforeSanitizeElements,O,null),aw(O))return xr(O),!0;const de=fn(O.nodeName);if(So(te.uponSanitizeElement,O,{tagName:de,allowedTags:g}),O.hasChildNodes()&&!SE(O.firstElementChild)&&Ln(/<[/\w!]/g,O.innerHTML)&&Ln(/<[/\w!]/g,O.textContent)||O.nodeType===pc.progressingInstruction||x&&O.nodeType===pc.comment&&Ln(/<[/\w]/g,O.data))return xr(O),!0;if(!g[de]||k[de]){if(!k[de]&&EE(de)&&(P.tagNameCheck instanceof RegExp&&Ln(P.tagNameCheck,de)||P.tagNameCheck instanceof Function&&P.tagNameCheck(de)))return!1;if(ue&&!Ve[de]){const Rt=V(O)||O.parentNode,Rn=T(O)||O.childNodes;if(Rn&&Rt){const vn=Rn.length;for(let Zn=vn-1;Zn>=0;--Zn){const Hr=S(Rn[Zn],!0);Hr.__removalCount=(O.__removalCount||0)+1,Rt.insertBefore(Hr,R(O))}}}return xr(O),!0}return O instanceof l&&!BD(O)||(de==="noscript"||de==="noembed"||de==="noframes")&&Ln(/<\/no(script|embed|frames)/i,O.innerHTML)?(xr(O),!0):(E&&O.nodeType===pc.text&&(Z=O.textContent,ef([se,Ce,be],Rt=>{Z=fc(Z,Rt," ")}),O.textContent!==Z&&(dc(e.removed,{element:O.cloneNode()}),O.textContent=Z)),So(te.afterSanitizeElements,O,null),!1)},RE=function(O,Z,de){if(D&&(Z==="id"||Z==="name")&&(de in n||de in WD))return!1;if(!(ne&&!Y[Z]&&Ln(je,Z))){if(!(G&&Ln(jt,Z))){if(!w[Z]||Y[Z]){if(!(EE(O)&&(P.tagNameCheck instanceof RegExp&&Ln(P.tagNameCheck,O)||P.tagNameCheck instanceof Function&&P.tagNameCheck(O))&&(P.attributeNameCheck instanceof RegExp&&Ln(P.attributeNameCheck,Z)||P.attributeNameCheck instanceof Function&&P.attributeNameCheck(Z))||Z==="is"&&P.allowCustomizedBuiltInElements&&(P.tagNameCheck instanceof RegExp&&Ln(P.tagNameCheck,de)||P.tagNameCheck instanceof Function&&P.tagNameCheck(de))))return!1}else if(!Ji[Z]){if(!Ln(qt,fc(de,Ke,""))){if(!((Z==="src"||Z==="xlink:href"||Z==="href")&&O!=="script"&&gz(de,"data:")===0&&$e[O])){if(!(v&&!Ln(Pe,fc(de,Ke,"")))){if(de)return!1}}}}}}return!0},EE=function(O){return O!=="annotation-xml"&&UT(O,bt)},TE=function(O){So(te.beforeSanitizeAttributes,O,null);const{attributes:Z}=O;if(!Z||aw(O))return;const de={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:w,forceKeepAttr:void 0};let Rt=Z.length;for(;Rt--;){const Rn=Z[Rt],{name:vn,namespaceURI:Zn,value:Hr}=Rn,uc=fn(vn);let Dn=vn==="value"?Hr:mz(Hr);if(de.attrName=uc,de.attrValue=Dn,de.keepAttr=!0,de.forceKeepAttr=void 0,So(te.uponSanitizeAttribute,O,de),Dn=de.attrValue,j&&(uc==="id"||uc==="name")&&(jd(vn,O),Dn=ae+Dn),x&&Ln(/((--!?|])>)|<\/(style|title)/i,Dn)){jd(vn,O);continue}if(de.forceKeepAttr||(jd(vn,O),!de.keepAttr))continue;if(!C&&Ln(/\/>/i,Dn)){jd(vn,O);continue}E&&ef([se,Ce,be],_E=>{Dn=fc(Dn,_E," ")});const ME=fn(O.nodeName);if(!!RE(ME,uc,Dn)){if(B&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!Zn)switch(f.getAttributeType(ME,uc)){case"TrustedHTML":{Dn=B.createHTML(Dn);break}case"TrustedScriptURL":{Dn=B.createScriptURL(Dn);break}}try{Zn?O.setAttributeNS(Zn,vn,Dn):O.setAttribute(vn,Dn),aw(O)?xr(O):jT(e.removed)}catch(_E){}}}So(te.afterSanitizeAttributes,O,null)},jD=function me(O){let Z=null;const de=yE(O);for(So(te.beforeSanitizeShadowDOM,O,null);Z=de.nextNode();)So(te.uponSanitizeShadowNode,Z,null),bE(Z),TE(Z),Z.content instanceof o&&me(Z.content);So(te.afterSanitizeShadowDOM,O,null)};return e.sanitize=function(me){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Z=null,de=null,Rt=null,Rn=null;if(nt=!me,nt&&(me="<!-->"),typeof me!="string"&&!SE(me))if(typeof me.toString=="function"){if(me=me.toString(),typeof me!="string")throw gc("dirty is not a string, aborting")}else throw gc("toString is not a function");if(!e.isSupported)return me;if(A||sw(O),e.removed=[],typeof me=="string"&&(ye=!1),ye){if(me.nodeName){const Hr=fn(me.nodeName);if(!g[Hr]||k[Hr])throw gc("root node is forbidden and cannot be sanitized in-place")}}else if(me instanceof a)Z=CE("<!---->"),de=Z.ownerDocument.importNode(me,!0),de.nodeType===pc.element&&de.nodeName==="BODY"||de.nodeName==="HTML"?Z=de:Z.appendChild(de);else{if(!_&&!E&&!I&&me.indexOf("<")===-1)return B&&N?B.createHTML(me):me;if(Z=CE(me),!Z)return _?null:N?W:""}Z&&F&&xr(Z.firstChild);const vn=yE(ye?me:Z);for(;Rt=vn.nextNode();)bE(Rt),TE(Rt),Rt.content instanceof o&&jD(Rt.content);if(ye)return me;if(_){if(H)for(Rn=z.call(Z.ownerDocument);Z.firstChild;)Rn.appendChild(Z.firstChild);else Rn=Z;return(w.shadowroot||w.shadowrootmode)&&(Rn=K.call(i,Rn,!0)),Rn}let Zn=I?Z.outerHTML:Z.innerHTML;return I&&g["!doctype"]&&Z.ownerDocument&&Z.ownerDocument.doctype&&Z.ownerDocument.doctype.name&&Ln(Mx,Z.ownerDocument.doctype.name)&&(Zn="<!DOCTYPE "+Z.ownerDocument.doctype.name+`>
`+Zn),E&&ef([se,Ce,be],Hr=>{Zn=fc(Zn,Hr," ")}),B&&N?B.createHTML(Zn):Zn},e.setConfig=function(){let me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};sw(me),A=!0},e.clearConfig=function(){Tl=null,A=!1},e.isValidAttribute=function(me,O,Z){Tl||sw({});const de=fn(me),Rt=fn(O);return RE(de,Rt,Z)},e.addHook=function(me,O){typeof O=="function"&&dc(te[me],O)},e.removeHook=function(me,O){if(O!==void 0){const Z=dz(te[me],O);return Z===-1?void 0:fz(te[me],Z,1)[0]}return jT(te[me])},e.removeHooks=function(me){te[me]=[]},e.removeAllHooks=function(){te=qT()},e}var Oz=_x();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Ix;function X(){return Ix.apply(null,arguments)}function xz(t){Ix=t}function Sr(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function il(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function FS(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Ze(t,e))return!1;return!0}function oi(t){return t===void 0}function is(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Sd(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function Px(t,e){var n=[],i,r=t.length;for(i=0;i<r;++i)n.push(e(t[i],i));return n}function Fs(t,e){for(var n in e)Ze(e,n)&&(t[n]=e[n]);return Ze(e,"toString")&&(t.toString=e.toString),Ze(e,"valueOf")&&(t.valueOf=e.valueOf),t}function vo(t,e,n,i){return Qx(t,e,n,i,!0).utc()}function Hz(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ie(t){return t._pf==null&&(t._pf=Hz()),t._pf}var wy;Array.prototype.some?wy=Array.prototype.some:wy=function(t){var e=Object(this),n=e.length>>>0,i;for(i=0;i<n;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function VS(t){var e=null,n=!1,i=t._d&&!isNaN(t._d.getTime());if(i&&(e=Ie(t),n=wy.call(e.parsedDateParts,function(r){return r!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=i;else return i;return t._isValid}function Cp(t){var e=vo(NaN);return t!=null?Fs(Ie(e),t):Ie(e).userInvalidated=!0,e}var ZT=X.momentProperties=[],Ww=!1;function WS(t,e){var n,i,r,o=ZT.length;if(oi(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),oi(e._i)||(t._i=e._i),oi(e._f)||(t._f=e._f),oi(e._l)||(t._l=e._l),oi(e._strict)||(t._strict=e._strict),oi(e._tzm)||(t._tzm=e._tzm),oi(e._isUTC)||(t._isUTC=e._isUTC),oi(e._offset)||(t._offset=e._offset),oi(e._pf)||(t._pf=Ie(e)),oi(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)i=ZT[n],r=e[i],oi(r)||(t[i]=r);return t}function bd(t){WS(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Ww===!1&&(Ww=!0,X.updateOffset(this),Ww=!1)}function br(t){return t instanceof bd||t!=null&&t._isAMomentObject!=null}function Ox(t){X.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn&&console.warn("Deprecation warning: "+t)}function qi(t,e){var n=!0;return Fs(function(){if(X.deprecationHandler!=null&&X.deprecationHandler(null,t),n){var i=[],r,o,s,a=arguments.length;for(o=0;o<a;o++){if(r="",typeof arguments[o]=="object"){r+=`
[`+o+"] ";for(s in arguments[0])Ze(arguments[0],s)&&(r+=s+": "+arguments[0][s]+", ");r=r.slice(0,-2)}else r=arguments[o];i.push(r)}Ox(t+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var QT={};function xx(t,e){X.deprecationHandler!=null&&X.deprecationHandler(t,e),QT[t]||(Ox(e),QT[t]=!0)}X.suppressDeprecationWarnings=!1;X.deprecationHandler=null;function Co(t){return typeof Function!="undefined"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function Az(t){var e,n;for(n in t)Ze(t,n)&&(e=t[n],Co(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function vy(t,e){var n=Fs({},t),i;for(i in e)Ze(e,i)&&(il(t[i])&&il(e[i])?(n[i]={},Fs(n[i],t[i]),Fs(n[i],e[i])):e[i]!=null?n[i]=e[i]:delete n[i]);for(i in t)Ze(t,i)&&!Ze(e,i)&&il(t[i])&&(n[i]=Fs({},n[i]));return n}function BS(t){t!=null&&this.set(t)}var Cy;Object.keys?Cy=Object.keys:Cy=function(t){var e,n=[];for(e in t)Ze(t,e)&&n.push(e);return n};var Nz={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Dz(t,e,n){var i=this._calendar[t]||this._calendar.sameElse;return Co(i)?i.call(e,n):i}function fo(t,e,n){var i=""+Math.abs(t),r=e-i.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var jS=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,nf=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Bw={},Pu={};function we(t,e,n,i){var r=i;typeof i=="string"&&(r=function(){return this[i]()}),t&&(Pu[t]=r),e&&(Pu[e[0]]=function(){return fo(r.apply(this,arguments),e[1],e[2])}),n&&(Pu[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function $z(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function Lz(t){var e=t.match(jS),n,i;for(n=0,i=e.length;n<i;n++)Pu[e[n]]?e[n]=Pu[e[n]]:e[n]=$z(e[n]);return function(r){var o="",s;for(s=0;s<i;s++)o+=Co(e[s])?e[s].call(r,t):e[s];return o}}function jg(t,e){return t.isValid()?(e=Hx(e,t.localeData()),Bw[e]=Bw[e]||Lz(e),Bw[e](t)):t.localeData().invalidDate()}function Hx(t,e){var n=5;function i(r){return e.longDateFormat(r)||r}for(nf.lastIndex=0;n>=0&&nf.test(t);)t=t.replace(nf,i),nf.lastIndex=0,n-=1;return t}var kz={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Fz(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(jS).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[t])}var Vz="Invalid date";function Wz(){return this._invalidDate}var Bz="%d",jz=/\d{1,2}/;function Uz(t){return this._ordinal.replace("%d",t)}var zz={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Yz(t,e,n,i){var r=this._relativeTime[n];return Co(r)?r(t,e,n,i):r.replace(/%d/i,t)}function Gz(t,e){var n=this._relativeTime[t>0?"future":"past"];return Co(n)?n(e):n.replace(/%s/i,e)}var JT={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Zi(t){return typeof t=="string"?JT[t]||JT[t.toLowerCase()]:void 0}function US(t){var e={},n,i;for(i in t)Ze(t,i)&&(n=Zi(i),n&&(e[n]=t[i]));return e}var Kz={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function Xz(t){var e=[],n;for(n in t)Ze(t,n)&&e.push({unit:n,priority:Kz[n]});return e.sort(function(i,r){return i.priority-r.priority}),e}var Ax=/\d/,Pi=/\d\d/,Nx=/\d{3}/,zS=/\d{4}/,yp=/[+-]?\d{6}/,St=/\d\d?/,Dx=/\d\d\d\d?/,$x=/\d\d\d\d\d\d?/,Sp=/\d{1,3}/,YS=/\d{1,4}/,bp=/[+-]?\d{1,6}/,Qu=/\d+/,Rp=/[+-]?\d+/,qz=/Z|[+-]\d\d:?\d\d/gi,Ep=/Z|[+-]\d\d(?::?\d\d)?/gi,Zz=/[+-]?\d+(\.\d{1,3})?/,Rd=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ju=/^[1-9]\d?/,GS=/^([1-9]\d|\d)/,gm;gm={};function oe(t,e,n){gm[t]=Co(e)?e:function(i,r){return i&&n?n:e}}function Qz(t,e){return Ze(gm,t)?gm[t](e._strict,e._locale):new RegExp(Jz(t))}function Jz(t){return ts(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,i,r,o){return n||i||r||o}))}function ts(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ji(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Be(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=ji(e)),n}var yy={};function ct(t,e){var n,i=e,r;for(typeof t=="string"&&(t=[t]),is(e)&&(i=function(o,s){s[e]=Be(o)}),r=t.length,n=0;n<r;n++)yy[t[n]]=i}function Ed(t,e){ct(t,function(n,i,r,o){r._w=r._w||{},e(n,r._w,r,o)})}function eY(t,e,n){e!=null&&Ze(yy,t)&&yy[t](e,n._a,n,t)}function Tp(t){return t%4===0&&t%100!==0||t%400===0}var Hn=0,Ko=1,oo=2,cn=3,Cr=4,Xo=5,qa=6,tY=7,nY=8;we("Y",0,0,function(){var t=this.year();return t<=9999?fo(t,4):"+"+t});we(0,["YY",2],0,function(){return this.year()%100});we(0,["YYYY",4],0,"year");we(0,["YYYYY",5],0,"year");we(0,["YYYYYY",6,!0],0,"year");oe("Y",Rp);oe("YY",St,Pi);oe("YYYY",YS,zS);oe("YYYYY",bp,yp);oe("YYYYYY",bp,yp);ct(["YYYYY","YYYYYY"],Hn);ct("YYYY",function(t,e){e[Hn]=t.length===2?X.parseTwoDigitYear(t):Be(t)});ct("YY",function(t,e){e[Hn]=X.parseTwoDigitYear(t)});ct("Y",function(t,e){e[Hn]=parseInt(t,10)});function Eh(t){return Tp(t)?366:365}X.parseTwoDigitYear=function(t){return Be(t)+(Be(t)>68?1900:2e3)};var Lx=ec("FullYear",!0);function iY(){return Tp(this.year())}function ec(t,e){return function(n){return n!=null?(kx(this,t,n),X.updateOffset(this,e),this):Kh(this,t)}}function Kh(t,e){if(!t.isValid())return NaN;var n=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return i?n.getUTCSeconds():n.getSeconds();case"Minutes":return i?n.getUTCMinutes():n.getMinutes();case"Hours":return i?n.getUTCHours():n.getHours();case"Date":return i?n.getUTCDate():n.getDate();case"Day":return i?n.getUTCDay():n.getDay();case"Month":return i?n.getUTCMonth():n.getMonth();case"FullYear":return i?n.getUTCFullYear():n.getFullYear();default:return NaN}}function kx(t,e,n){var i,r,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(i=t._d,r=t._isUTC,e){case"Milliseconds":return void(r?i.setUTCMilliseconds(n):i.setMilliseconds(n));case"Seconds":return void(r?i.setUTCSeconds(n):i.setSeconds(n));case"Minutes":return void(r?i.setUTCMinutes(n):i.setMinutes(n));case"Hours":return void(r?i.setUTCHours(n):i.setHours(n));case"Date":return void(r?i.setUTCDate(n):i.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!Tp(o)?28:a,r?i.setUTCFullYear(o,s,a):i.setFullYear(o,s,a)}}function rY(t){return t=Zi(t),Co(this[t])?this[t]():this}function oY(t,e){if(typeof t=="object"){t=US(t);var n=Xz(t),i,r=n.length;for(i=0;i<r;i++)this[n[i].unit](t[n[i].unit])}else if(t=Zi(t),Co(this[t]))return this[t](e);return this}function sY(t,e){return(t%e+e)%e}var zt;Array.prototype.indexOf?zt=Array.prototype.indexOf:zt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function KS(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=sY(e,12);return t+=(e-n)/12,n===1?Tp(t)?29:28:31-n%7%2}we("M",["MM",2],"Mo",function(){return this.month()+1});we("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});we("MMMM",0,0,function(t){return this.localeData().months(this,t)});oe("M",St,Ju);oe("MM",St,Pi);oe("MMM",function(t,e){return e.monthsShortRegex(t)});oe("MMMM",function(t,e){return e.monthsRegex(t)});ct(["M","MM"],function(t,e){e[Ko]=Be(t)-1});ct(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);r!=null?e[Ko]=r:Ie(n).invalidMonth=t});var aY="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Fx="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Vx=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,lY=Rd,uY=Rd;function cY(t,e){return t?Sr(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Vx).test(e)?"format":"standalone"][t.month()]:Sr(this._months)?this._months:this._months.standalone}function hY(t,e){return t?Sr(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Vx.test(e)?"format":"standalone"][t.month()]:Sr(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function dY(t,e,n){var i,r,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)o=vo([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(r=zt.call(this._shortMonthsParse,s),r!==-1?r:null):(r=zt.call(this._longMonthsParse,s),r!==-1?r:null):e==="MMM"?(r=zt.call(this._shortMonthsParse,s),r!==-1?r:(r=zt.call(this._longMonthsParse,s),r!==-1?r:null)):(r=zt.call(this._longMonthsParse,s),r!==-1?r:(r=zt.call(this._shortMonthsParse,s),r!==-1?r:null))}function fY(t,e,n){var i,r,o;if(this._monthsParseExact)return dY.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=vo([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),!n&&!this._monthsParse[i]&&(o="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(n&&e==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}}function Wx(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Be(e);else if(e=t.localeData().monthsParse(e),!is(e))return t}var n=e,i=t.date();return i=i<29?i:Math.min(i,KS(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,i):t._d.setMonth(n,i),t}function Bx(t){return t!=null?(Wx(this,t),X.updateOffset(this,!0),this):Kh(this,"Month")}function gY(){return KS(this.year(),this.month())}function mY(t){return this._monthsParseExact?(Ze(this,"_monthsRegex")||jx.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Ze(this,"_monthsShortRegex")||(this._monthsShortRegex=lY),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function pY(t){return this._monthsParseExact?(Ze(this,"_monthsRegex")||jx.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Ze(this,"_monthsRegex")||(this._monthsRegex=uY),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function jx(){function t(l,u){return u.length-l.length}var e=[],n=[],i=[],r,o,s,a;for(r=0;r<12;r++)o=vo([2e3,r]),s=ts(this.monthsShort(o,"")),a=ts(this.months(o,"")),e.push(s),n.push(a),i.push(a),i.push(s);e.sort(t),n.sort(t),i.sort(t),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function wY(t,e,n,i,r,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,i,r,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,i,r,o,s),a}function Xh(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function mm(t,e,n){var i=7+e-n,r=(7+Xh(t,0,i).getUTCDay()-e)%7;return-r+i-1}function Ux(t,e,n,i,r){var o=(7+n-i)%7,s=mm(t,i,r),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Eh(l)+a):a>Eh(t)?(l=t+1,u=a-Eh(t)):(l=t,u=a),{year:l,dayOfYear:u}}function qh(t,e,n){var i=mm(t.year(),e,n),r=Math.floor((t.dayOfYear()-i-1)/7)+1,o,s;return r<1?(s=t.year()-1,o=r+ns(s,e,n)):r>ns(t.year(),e,n)?(o=r-ns(t.year(),e,n),s=t.year()+1):(s=t.year(),o=r),{week:o,year:s}}function ns(t,e,n){var i=mm(t,e,n),r=mm(t+1,e,n);return(Eh(t)-i+r)/7}we("w",["ww",2],"wo","week");we("W",["WW",2],"Wo","isoWeek");oe("w",St,Ju);oe("ww",St,Pi);oe("W",St,Ju);oe("WW",St,Pi);Ed(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=Be(t)});function vY(t){return qh(t,this._week.dow,this._week.doy).week}var CY={dow:0,doy:6};function yY(){return this._week.dow}function SY(){return this._week.doy}function bY(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function RY(t){var e=qh(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}we("d",0,"do","day");we("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});we("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});we("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});we("e",0,0,"weekday");we("E",0,0,"isoWeekday");oe("d",St);oe("e",St);oe("E",St);oe("dd",function(t,e){return e.weekdaysMinRegex(t)});oe("ddd",function(t,e){return e.weekdaysShortRegex(t)});oe("dddd",function(t,e){return e.weekdaysRegex(t)});Ed(["dd","ddd","dddd"],function(t,e,n,i){var r=n._locale.weekdaysParse(t,i,n._strict);r!=null?e.d=r:Ie(n).invalidWeekday=t});Ed(["d","e","E"],function(t,e,n,i){e[i]=Be(t)});function EY(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function TY(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function XS(t,e){return t.slice(e,7).concat(t.slice(0,e))}var MY="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),zx="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),_Y="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),IY=Rd,PY=Rd,OY=Rd;function xY(t,e){var n=Sr(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?XS(n,this._week.dow):t?n[t.day()]:n}function HY(t){return t===!0?XS(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function AY(t){return t===!0?XS(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function NY(t,e,n){var i,r,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)o=vo([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(r=zt.call(this._weekdaysParse,s),r!==-1?r:null):e==="ddd"?(r=zt.call(this._shortWeekdaysParse,s),r!==-1?r:null):(r=zt.call(this._minWeekdaysParse,s),r!==-1?r:null):e==="dddd"?(r=zt.call(this._weekdaysParse,s),r!==-1||(r=zt.call(this._shortWeekdaysParse,s),r!==-1)?r:(r=zt.call(this._minWeekdaysParse,s),r!==-1?r:null)):e==="ddd"?(r=zt.call(this._shortWeekdaysParse,s),r!==-1||(r=zt.call(this._weekdaysParse,s),r!==-1)?r:(r=zt.call(this._minWeekdaysParse,s),r!==-1?r:null)):(r=zt.call(this._minWeekdaysParse,s),r!==-1||(r=zt.call(this._weekdaysParse,s),r!==-1)?r:(r=zt.call(this._shortWeekdaysParse,s),r!==-1?r:null))}function DY(t,e,n){var i,r,o;if(this._weekdaysParseExact)return NY.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=vo([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(o="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[i].test(t))return i;if(n&&e==="ddd"&&this._shortWeekdaysParse[i].test(t))return i;if(n&&e==="dd"&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}}function $Y(t){if(!this.isValid())return t!=null?this:NaN;var e=Kh(this,"Day");return t!=null?(t=EY(t,this.localeData()),this.add(t-e,"d")):e}function LY(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function kY(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=TY(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function FY(t){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||qS.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Ze(this,"_weekdaysRegex")||(this._weekdaysRegex=IY),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function VY(t){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||qS.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ze(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=PY),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function WY(t){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||qS.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ze(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=OY),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function qS(){function t(c,h){return h.length-c.length}var e=[],n=[],i=[],r=[],o,s,a,l,u;for(o=0;o<7;o++)s=vo([2e3,1]).day(o),a=ts(this.weekdaysMin(s,"")),l=ts(this.weekdaysShort(s,"")),u=ts(this.weekdays(s,"")),e.push(a),n.push(l),i.push(u),r.push(a),r.push(l),r.push(u);e.sort(t),n.sort(t),i.sort(t),r.sort(t),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function ZS(){return this.hours()%12||12}function BY(){return this.hours()||24}we("H",["HH",2],0,"hour");we("h",["hh",2],0,ZS);we("k",["kk",2],0,BY);we("hmm",0,0,function(){return""+ZS.apply(this)+fo(this.minutes(),2)});we("hmmss",0,0,function(){return""+ZS.apply(this)+fo(this.minutes(),2)+fo(this.seconds(),2)});we("Hmm",0,0,function(){return""+this.hours()+fo(this.minutes(),2)});we("Hmmss",0,0,function(){return""+this.hours()+fo(this.minutes(),2)+fo(this.seconds(),2)});function Yx(t,e){we(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}Yx("a",!0);Yx("A",!1);function Gx(t,e){return e._meridiemParse}oe("a",Gx);oe("A",Gx);oe("H",St,GS);oe("h",St,Ju);oe("k",St,Ju);oe("HH",St,Pi);oe("hh",St,Pi);oe("kk",St,Pi);oe("hmm",Dx);oe("hmmss",$x);oe("Hmm",Dx);oe("Hmmss",$x);ct(["H","HH"],cn);ct(["k","kk"],function(t,e,n){var i=Be(t);e[cn]=i===24?0:i});ct(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});ct(["h","hh"],function(t,e,n){e[cn]=Be(t),Ie(n).bigHour=!0});ct("hmm",function(t,e,n){var i=t.length-2;e[cn]=Be(t.substr(0,i)),e[Cr]=Be(t.substr(i)),Ie(n).bigHour=!0});ct("hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[cn]=Be(t.substr(0,i)),e[Cr]=Be(t.substr(i,2)),e[Xo]=Be(t.substr(r)),Ie(n).bigHour=!0});ct("Hmm",function(t,e,n){var i=t.length-2;e[cn]=Be(t.substr(0,i)),e[Cr]=Be(t.substr(i))});ct("Hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[cn]=Be(t.substr(0,i)),e[Cr]=Be(t.substr(i,2)),e[Xo]=Be(t.substr(r))});function jY(t){return(t+"").toLowerCase().charAt(0)==="p"}var UY=/[ap]\.?m?\.?/i,zY=ec("Hours",!0);function YY(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var Kx={calendar:Nz,longDateFormat:kz,invalidDate:Vz,ordinal:Bz,dayOfMonthOrdinalParse:jz,relativeTime:zz,months:aY,monthsShort:Fx,week:CY,weekdays:MY,weekdaysMin:_Y,weekdaysShort:zx,meridiemParse:UY},Et={},wc={},Zh;function GY(t,e){var n,i=Math.min(t.length,e.length);for(n=0;n<i;n+=1)if(t[n]!==e[n])return n;return i}function eM(t){return t&&t.toLowerCase().replace("_","-")}function KY(t){for(var e=0,n,i,r,o;e<t.length;){for(o=eM(t[e]).split("-"),n=o.length,i=eM(t[e+1]),i=i?i.split("-"):null;n>0;){if(r=Mp(o.slice(0,n).join("-")),r)return r;if(i&&i.length>=n&&GY(o,i)>=n-1)break;n--}e++}return Zh}function XY(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Mp(t){var e=null,n;if(Et[t]===void 0&&typeof module!="undefined"&&module&&module.exports&&XY(t))try{e=Zh._abbr,n=require,n("./locale/"+t),zs(e)}catch(i){Et[t]=null}return Et[t]}function zs(t,e){var n;return t&&(oi(e)?n=us(t):n=QS(t,e),n?Zh=n:typeof console!="undefined"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Zh._abbr}function QS(t,e){if(e!==null){var n,i=Kx;if(e.abbr=t,Et[t]!=null)xx("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=Et[t]._config;else if(e.parentLocale!=null)if(Et[e.parentLocale]!=null)i=Et[e.parentLocale]._config;else if(n=Mp(e.parentLocale),n!=null)i=n._config;else return wc[e.parentLocale]||(wc[e.parentLocale]=[]),wc[e.parentLocale].push({name:t,config:e}),null;return Et[t]=new BS(vy(i,e)),wc[t]&&wc[t].forEach(function(r){QS(r.name,r.config)}),zs(t),Et[t]}else return delete Et[t],null}function qY(t,e){if(e!=null){var n,i,r=Kx;Et[t]!=null&&Et[t].parentLocale!=null?Et[t].set(vy(Et[t]._config,e)):(i=Mp(t),i!=null&&(r=i._config),e=vy(r,e),i==null&&(e.abbr=t),n=new BS(e),n.parentLocale=Et[t],Et[t]=n),zs(t)}else Et[t]!=null&&(Et[t].parentLocale!=null?(Et[t]=Et[t].parentLocale,t===zs()&&zs(t)):Et[t]!=null&&delete Et[t]);return Et[t]}function us(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Zh;if(!Sr(t)){if(e=Mp(t),e)return e;t=[t]}return KY(t)}function ZY(){return Cy(Et)}function JS(t){var e,n=t._a;return n&&Ie(t).overflow===-2&&(e=n[Ko]<0||n[Ko]>11?Ko:n[oo]<1||n[oo]>KS(n[Hn],n[Ko])?oo:n[cn]<0||n[cn]>24||n[cn]===24&&(n[Cr]!==0||n[Xo]!==0||n[qa]!==0)?cn:n[Cr]<0||n[Cr]>59?Cr:n[Xo]<0||n[Xo]>59?Xo:n[qa]<0||n[qa]>999?qa:-1,Ie(t)._overflowDayOfYear&&(e<Hn||e>oo)&&(e=oo),Ie(t)._overflowWeeks&&e===-1&&(e=tY),Ie(t)._overflowWeekday&&e===-1&&(e=nY),Ie(t).overflow=e),t}var QY=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,JY=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,eG=/Z|[+-]\d\d(?::?\d\d)?/,rf=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],jw=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],tG=/^\/?Date\((-?\d+)/i,nG=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,iG={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Xx(t){var e,n,i=t._i,r=QY.exec(i)||JY.exec(i),o,s,a,l,u=rf.length,c=jw.length;if(r){for(Ie(t).iso=!0,e=0,n=u;e<n;e++)if(rf[e][1].exec(r[1])){s=rf[e][0],o=rf[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(r[3]){for(e=0,n=c;e<n;e++)if(jw[e][1].exec(r[3])){a=(r[2]||" ")+jw[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(r[4])if(eG.exec(r[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),tb(t)}else t._isValid=!1}function rG(t,e,n,i,r,o){var s=[oG(t),Fx.indexOf(e),parseInt(n,10),parseInt(i,10),parseInt(r,10)];return o&&s.push(parseInt(o,10)),s}function oG(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function sG(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function aG(t,e,n){if(t){var i=zx.indexOf(t),r=new Date(e[0],e[1],e[2]).getDay();if(i!==r)return Ie(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function lG(t,e,n){if(t)return iG[t];if(e)return 0;var i=parseInt(n,10),r=i%100,o=(i-r)/100;return o*60+r}function qx(t){var e=nG.exec(sG(t._i)),n;if(e){if(n=rG(e[4],e[3],e[2],e[5],e[6],e[7]),!aG(e[1],n,t))return;t._a=n,t._tzm=lG(e[8],e[9],e[10]),t._d=Xh.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ie(t).rfc2822=!0}else t._isValid=!1}function uG(t){var e=tG.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(Xx(t),t._isValid===!1)delete t._isValid;else return;if(qx(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:X.createFromInputFallback(t)}X.createFromInputFallback=qi("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function du(t,e,n){return t!=null?t:e!=null?e:n}function cG(t){var e=new Date(X.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function eb(t){var e,n,i=[],r,o,s;if(!t._d){for(r=cG(t),t._w&&t._a[oo]==null&&t._a[Ko]==null&&hG(t),t._dayOfYear!=null&&(s=du(t._a[Hn],r[Hn]),(t._dayOfYear>Eh(s)||t._dayOfYear===0)&&(Ie(t)._overflowDayOfYear=!0),n=Xh(s,0,t._dayOfYear),t._a[Ko]=n.getUTCMonth(),t._a[oo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=i[e]=r[e];for(;e<7;e++)t._a[e]=i[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[cn]===24&&t._a[Cr]===0&&t._a[Xo]===0&&t._a[qa]===0&&(t._nextDay=!0,t._a[cn]=0),t._d=(t._useUTC?Xh:wY).apply(null,i),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[cn]=24),t._w&&typeof t._w.d!="undefined"&&t._w.d!==o&&(Ie(t).weekdayMismatch=!0)}}function hG(t){var e,n,i,r,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=du(e.GG,t._a[Hn],qh(yt(),1,4).year),i=du(e.W,1),r=du(e.E,1),(r<1||r>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=qh(yt(),o,s),n=du(e.gg,t._a[Hn],u.year),i=du(e.w,u.week),e.d!=null?(r=e.d,(r<0||r>6)&&(l=!0)):e.e!=null?(r=e.e+o,(e.e<0||e.e>6)&&(l=!0)):r=o),i<1||i>ns(n,o,s)?Ie(t)._overflowWeeks=!0:l!=null?Ie(t)._overflowWeekday=!0:(a=Ux(n,i,r,o,s),t._a[Hn]=a.year,t._dayOfYear=a.dayOfYear)}X.ISO_8601=function(){};X.RFC_2822=function(){};function tb(t){if(t._f===X.ISO_8601){Xx(t);return}if(t._f===X.RFC_2822){qx(t);return}t._a=[],Ie(t).empty=!0;var e=""+t._i,n,i,r,o,s,a=e.length,l=0,u,c;for(r=Hx(t._f,t._locale).match(jS)||[],c=r.length,n=0;n<c;n++)o=r[n],i=(e.match(Qz(o,t))||[])[0],i&&(s=e.substr(0,e.indexOf(i)),s.length>0&&Ie(t).unusedInput.push(s),e=e.slice(e.indexOf(i)+i.length),l+=i.length),Pu[o]?(i?Ie(t).empty=!1:Ie(t).unusedTokens.push(o),eY(o,i,t)):t._strict&&!i&&Ie(t).unusedTokens.push(o);Ie(t).charsLeftOver=a-l,e.length>0&&Ie(t).unusedInput.push(e),t._a[cn]<=12&&Ie(t).bigHour===!0&&t._a[cn]>0&&(Ie(t).bigHour=void 0),Ie(t).parsedDateParts=t._a.slice(0),Ie(t).meridiem=t._meridiem,t._a[cn]=dG(t._locale,t._a[cn],t._meridiem),u=Ie(t).era,u!==null&&(t._a[Hn]=t._locale.erasConvertYear(u,t._a[Hn])),eb(t),JS(t)}function dG(t,e,n){var i;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(i=t.isPM(n),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function fG(t){var e,n,i,r,o,s,a=!1,l=t._f.length;if(l===0){Ie(t).invalidFormat=!0,t._d=new Date(NaN);return}for(r=0;r<l;r++)o=0,s=!1,e=WS({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[r],tb(e),VS(e)&&(s=!0),o+=Ie(e).charsLeftOver,o+=Ie(e).unusedTokens.length*10,Ie(e).score=o,a?o<i&&(i=o,n=e):(i==null||o<i||s)&&(i=o,n=e,s&&(a=!0));Fs(t,n||e)}function gG(t){if(!t._d){var e=US(t._i),n=e.day===void 0?e.date:e.day;t._a=Px([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),eb(t)}}function mG(t){var e=new bd(JS(Zx(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function Zx(t){var e=t._i,n=t._f;return t._locale=t._locale||us(t._l),e===null||n===void 0&&e===""?Cp({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),br(e)?new bd(JS(e)):(Sd(e)?t._d=e:Sr(n)?fG(t):n?tb(t):pG(t),VS(t)||(t._d=null),t))}function pG(t){var e=t._i;oi(e)?t._d=new Date(X.now()):Sd(e)?t._d=new Date(e.valueOf()):typeof e=="string"?uG(t):Sr(e)?(t._a=Px(e.slice(0),function(n){return parseInt(n,10)}),eb(t)):il(e)?gG(t):is(e)?t._d=new Date(e):X.createFromInputFallback(t)}function Qx(t,e,n,i,r){var o={};return(e===!0||e===!1)&&(i=e,e=void 0),(n===!0||n===!1)&&(i=n,n=void 0),(il(t)&&FS(t)||Sr(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=r,o._l=n,o._i=t,o._f=e,o._strict=i,mG(o)}function yt(t,e,n,i){return Qx(t,e,n,i,!1)}var wG=qi("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=yt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Cp()}),vG=qi("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=yt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Cp()});function Jx(t,e){var n,i;if(e.length===1&&Sr(e[0])&&(e=e[0]),!e.length)return yt();for(n=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][t](n))&&(n=e[i]);return n}function CG(){var t=[].slice.call(arguments,0);return Jx("isBefore",t)}function yG(){var t=[].slice.call(arguments,0);return Jx("isAfter",t)}var SG=function(){return Date.now?Date.now():+new Date},vc=["year","quarter","month","week","day","hour","minute","second","millisecond"];function bG(t){var e,n=!1,i,r=vc.length;for(e in t)if(Ze(t,e)&&!(zt.call(vc,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(i=0;i<r;++i)if(t[vc[i]]){if(n)return!1;parseFloat(t[vc[i]])!==Be(t[vc[i]])&&(n=!0)}return!0}function RG(){return this._isValid}function EG(){return _r(NaN)}function _p(t){var e=US(t),n=e.year||0,i=e.quarter||0,r=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=bG(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+r+i*3+n*12,this._data={},this._locale=us(),this._bubble()}function Ug(t){return t instanceof _p}function Sy(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function TG(t,e,n){var i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),o=0,s;for(s=0;s<i;s++)(n&&t[s]!==e[s]||!n&&Be(t[s])!==Be(e[s]))&&o++;return o+r}function e1(t,e){we(t,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+fo(~~(n/60),2)+e+fo(~~n%60,2)})}e1("Z",":");e1("ZZ","");oe("Z",Ep);oe("ZZ",Ep);ct(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=nb(Ep,t)});var MG=/([\+\-]|\d\d)/gi;function nb(t,e){var n=(e||"").match(t),i,r,o;return n===null?null:(i=n[n.length-1]||[],r=(i+"").match(MG)||["-",0,0],o=+(r[1]*60)+Be(r[2]),o===0?0:r[0]==="+"?o:-o)}function ib(t,e){var n,i;return e._isUTC?(n=e.clone(),i=(br(t)||Sd(t)?t.valueOf():yt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),X.updateOffset(n,!1),n):yt(t).local()}function by(t){return-Math.round(t._d.getTimezoneOffset())}X.updateOffset=function(){};function _G(t,e,n){var i=this._offset||0,r;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=nb(Ep,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(r=by(this)),this._offset=t,this._isUTC=!0,r!=null&&this.add(r,"m"),i!==t&&(!e||this._changeInProgress?i1(this,_r(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,X.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:by(this)}function IG(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function PG(t){return this.utcOffset(0,t)}function OG(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(by(this),"m")),this}function xG(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=nb(qz,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function HG(t){return this.isValid()?(t=t?yt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function AG(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function NG(){if(!oi(this._isDSTShifted))return this._isDSTShifted;var t={},e;return WS(t,this),t=Zx(t),t._a?(e=t._isUTC?vo(t._a):yt(t._a),this._isDSTShifted=this.isValid()&&TG(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function DG(){return this.isValid()?!this._isUTC:!1}function $G(){return this.isValid()?this._isUTC:!1}function t1(){return this.isValid()?this._isUTC&&this._offset===0:!1}var LG=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,kG=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function _r(t,e){var n=t,i=null,r,o,s;return Ug(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:is(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(i=LG.exec(t))?(r=i[1]==="-"?-1:1,n={y:0,d:Be(i[oo])*r,h:Be(i[cn])*r,m:Be(i[Cr])*r,s:Be(i[Xo])*r,ms:Be(Sy(i[qa]*1e3))*r}):(i=kG.exec(t))?(r=i[1]==="-"?-1:1,n={y:oa(i[2],r),M:oa(i[3],r),w:oa(i[4],r),d:oa(i[5],r),h:oa(i[6],r),m:oa(i[7],r),s:oa(i[8],r)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=FG(yt(n.from),yt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new _p(n),Ug(t)&&Ze(t,"_locale")&&(o._locale=t._locale),Ug(t)&&Ze(t,"_isValid")&&(o._isValid=t._isValid),o}_r.fn=_p.prototype;_r.invalid=EG;function oa(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function tM(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function FG(t,e){var n;return t.isValid()&&e.isValid()?(e=ib(e,t),t.isBefore(e)?n=tM(t,e):(n=tM(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function n1(t,e){return function(n,i){var r,o;return i!==null&&!isNaN(+i)&&(xx(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=i,i=o),r=_r(n,i),i1(this,r,t),this}}function i1(t,e,n,i){var r=e._milliseconds,o=Sy(e._days),s=Sy(e._months);!t.isValid()||(i=i==null?!0:i,s&&Wx(t,Kh(t,"Month")+s*n),o&&kx(t,"Date",Kh(t,"Date")+o*n),r&&t._d.setTime(t._d.valueOf()+r*n),i&&X.updateOffset(t,o||s))}var VG=n1(1,"add"),WG=n1(-1,"subtract");function r1(t){return typeof t=="string"||t instanceof String}function BG(t){return br(t)||Sd(t)||r1(t)||is(t)||UG(t)||jG(t)||t===null||t===void 0}function jG(t){var e=il(t)&&!FS(t),n=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,o,s=i.length;for(r=0;r<s;r+=1)o=i[r],n=n||Ze(t,o);return e&&n}function UG(t){var e=Sr(t),n=!1;return e&&(n=t.filter(function(i){return!is(i)&&r1(t)}).length===0),e&&n}function zG(t){var e=il(t)&&!FS(t),n=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,o;for(r=0;r<i.length;r+=1)o=i[r],n=n||Ze(t,o);return e&&n}function YG(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function GG(t,e){arguments.length===1&&(arguments[0]?BG(arguments[0])?(t=arguments[0],e=void 0):zG(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||yt(),i=ib(n,this).startOf("day"),r=X.calendarFormat(this,i)||"sameElse",o=e&&(Co(e[r])?e[r].call(this,n):e[r]);return this.format(o||this.localeData().calendar(r,this,yt(n)))}function KG(){return new bd(this)}function XG(t,e){var n=br(t)?t:yt(t);return this.isValid()&&n.isValid()?(e=Zi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function qG(t,e){var n=br(t)?t:yt(t);return this.isValid()&&n.isValid()?(e=Zi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function ZG(t,e,n,i){var r=br(t)?t:yt(t),o=br(e)?e:yt(e);return this.isValid()&&r.isValid()&&o.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(r,n):!this.isBefore(r,n))&&(i[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function QG(t,e){var n=br(t)?t:yt(t),i;return this.isValid()&&n.isValid()?(e=Zi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function JG(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function e2(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function t2(t,e,n){var i,r,o;if(!this.isValid())return NaN;if(i=ib(t,this),!i.isValid())return NaN;switch(r=(i.utcOffset()-this.utcOffset())*6e4,e=Zi(e),e){case"year":o=zg(this,i)/12;break;case"month":o=zg(this,i);break;case"quarter":o=zg(this,i)/3;break;case"second":o=(this-i)/1e3;break;case"minute":o=(this-i)/6e4;break;case"hour":o=(this-i)/36e5;break;case"day":o=(this-i-r)/864e5;break;case"week":o=(this-i-r)/6048e5;break;default:o=this-i}return n?o:ji(o)}function zg(t,e){if(t.date()<e.date())return-zg(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),i=t.clone().add(n,"months"),r,o;return e-i<0?(r=t.clone().add(n-1,"months"),o=(e-i)/(i-r)):(r=t.clone().add(n+1,"months"),o=(e-i)/(r-i)),-(n+o)||0}X.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";X.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function n2(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function i2(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?jg(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Co(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",jg(n,"Z")):jg(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function r2(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,i,r,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+i+r+o)}function o2(t){t||(t=this.isUtc()?X.defaultFormatUtc:X.defaultFormat);var e=jg(this,t);return this.localeData().postformat(e)}function s2(t,e){return this.isValid()&&(br(t)&&t.isValid()||yt(t).isValid())?_r({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function a2(t){return this.from(yt(),t)}function l2(t,e){return this.isValid()&&(br(t)&&t.isValid()||yt(t).isValid())?_r({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function u2(t){return this.to(yt(),t)}function o1(t){var e;return t===void 0?this._locale._abbr:(e=us(t),e!=null&&(this._locale=e),this)}var s1=qi("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function a1(){return this._locale}var pm=1e3,Ou=60*pm,wm=60*Ou,l1=(365*400+97)*24*wm;function xu(t,e){return(t%e+e)%e}function u1(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-l1:new Date(t,e,n).valueOf()}function c1(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-l1:Date.UTC(t,e,n)}function c2(t){var e,n;if(t=Zi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?c1:u1,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=xu(e+(this._isUTC?0:this.utcOffset()*Ou),wm);break;case"minute":e=this._d.valueOf(),e-=xu(e,Ou);break;case"second":e=this._d.valueOf(),e-=xu(e,pm);break}return this._d.setTime(e),X.updateOffset(this,!0),this}function h2(t){var e,n;if(t=Zi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?c1:u1,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=wm-xu(e+(this._isUTC?0:this.utcOffset()*Ou),wm)-1;break;case"minute":e=this._d.valueOf(),e+=Ou-xu(e,Ou)-1;break;case"second":e=this._d.valueOf(),e+=pm-xu(e,pm)-1;break}return this._d.setTime(e),X.updateOffset(this,!0),this}function d2(){return this._d.valueOf()-(this._offset||0)*6e4}function f2(){return Math.floor(this.valueOf()/1e3)}function g2(){return new Date(this.valueOf())}function m2(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function p2(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function w2(){return this.isValid()?this.toISOString():null}function v2(){return VS(this)}function C2(){return Fs({},Ie(this))}function y2(){return Ie(this).overflow}function S2(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}we("N",0,0,"eraAbbr");we("NN",0,0,"eraAbbr");we("NNN",0,0,"eraAbbr");we("NNNN",0,0,"eraName");we("NNNNN",0,0,"eraNarrow");we("y",["y",1],"yo","eraYear");we("y",["yy",2],0,"eraYear");we("y",["yyy",3],0,"eraYear");we("y",["yyyy",4],0,"eraYear");oe("N",rb);oe("NN",rb);oe("NNN",rb);oe("NNNN",H2);oe("NNNNN",A2);ct(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,i){var r=n._locale.erasParse(t,i,n._strict);r?Ie(n).era=r:Ie(n).invalidEra=t});oe("y",Qu);oe("yy",Qu);oe("yyy",Qu);oe("yyyy",Qu);oe("yo",N2);ct(["y","yy","yyy","yyyy"],Hn);ct(["yo"],function(t,e,n,i){var r;n._locale._eraYearOrdinalRegex&&(r=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Hn]=n._locale.eraYearOrdinalParse(t,r):e[Hn]=parseInt(t,10)});function b2(t,e){var n,i,r,o=this._eras||us("en")._eras;for(n=0,i=o.length;n<i;++n){switch(typeof o[n].since){case"string":r=X(o[n].since).startOf("day"),o[n].since=r.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":r=X(o[n].until).startOf("day").valueOf(),o[n].until=r.valueOf();break}}return o}function R2(t,e,n){var i,r,o=this.eras(),s,a,l;for(t=t.toUpperCase(),i=0,r=o.length;i<r;++i)if(s=o[i].name.toUpperCase(),a=o[i].abbr.toUpperCase(),l=o[i].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[i];break;case"NNNN":if(s===t)return o[i];break;case"NNNNN":if(l===t)return o[i];break}else if([s,a,l].indexOf(t)>=0)return o[i]}function E2(t,e){var n=t.since<=t.until?1:-1;return e===void 0?X(t.since).year():X(t.since).year()+(e-t.offset)*n}function T2(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].name;return""}function M2(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].narrow;return""}function _2(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].abbr;return""}function I2(){var t,e,n,i,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=r[t].since<=r[t].until?1:-1,i=this.clone().startOf("day").valueOf(),r[t].since<=i&&i<=r[t].until||r[t].until<=i&&i<=r[t].since)return(this.year()-X(r[t].since).year())*n+r[t].offset;return this.year()}function P2(t){return Ze(this,"_erasNameRegex")||ob.call(this),t?this._erasNameRegex:this._erasRegex}function O2(t){return Ze(this,"_erasAbbrRegex")||ob.call(this),t?this._erasAbbrRegex:this._erasRegex}function x2(t){return Ze(this,"_erasNarrowRegex")||ob.call(this),t?this._erasNarrowRegex:this._erasRegex}function rb(t,e){return e.erasAbbrRegex(t)}function H2(t,e){return e.erasNameRegex(t)}function A2(t,e){return e.erasNarrowRegex(t)}function N2(t,e){return e._eraYearOrdinalRegex||Qu}function ob(){var t=[],e=[],n=[],i=[],r,o,s,a,l,u=this.eras();for(r=0,o=u.length;r<o;++r)s=ts(u[r].name),a=ts(u[r].abbr),l=ts(u[r].narrow),e.push(s),t.push(a),n.push(l),i.push(s),i.push(a),i.push(l);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}we(0,["gg",2],0,function(){return this.weekYear()%100});we(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Ip(t,e){we(0,[t,t.length],0,e)}Ip("gggg","weekYear");Ip("ggggg","weekYear");Ip("GGGG","isoWeekYear");Ip("GGGGG","isoWeekYear");oe("G",Rp);oe("g",Rp);oe("GG",St,Pi);oe("gg",St,Pi);oe("GGGG",YS,zS);oe("gggg",YS,zS);oe("GGGGG",bp,yp);oe("ggggg",bp,yp);Ed(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=Be(t)});Ed(["gg","GG"],function(t,e,n,i){e[i]=X.parseTwoDigitYear(t)});function D2(t){return h1.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function $2(t){return h1.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function L2(){return ns(this.year(),1,4)}function k2(){return ns(this.isoWeekYear(),1,4)}function F2(){var t=this.localeData()._week;return ns(this.year(),t.dow,t.doy)}function V2(){var t=this.localeData()._week;return ns(this.weekYear(),t.dow,t.doy)}function h1(t,e,n,i,r){var o;return t==null?qh(this,i,r).year:(o=ns(t,i,r),e>o&&(e=o),W2.call(this,t,e,n,i,r))}function W2(t,e,n,i,r){var o=Ux(t,e,n,i,r),s=Xh(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}we("Q",0,"Qo","quarter");oe("Q",Ax);ct("Q",function(t,e){e[Ko]=(Be(t)-1)*3});function B2(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}we("D",["DD",2],"Do","date");oe("D",St,Ju);oe("DD",St,Pi);oe("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});ct(["D","DD"],oo);ct("Do",function(t,e){e[oo]=Be(t.match(St)[0])});var d1=ec("Date",!0);we("DDD",["DDDD",3],"DDDo","dayOfYear");oe("DDD",Sp);oe("DDDD",Nx);ct(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Be(t)});function j2(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}we("m",["mm",2],0,"minute");oe("m",St,GS);oe("mm",St,Pi);ct(["m","mm"],Cr);var U2=ec("Minutes",!1);we("s",["ss",2],0,"second");oe("s",St,GS);oe("ss",St,Pi);ct(["s","ss"],Xo);var z2=ec("Seconds",!1);we("S",0,0,function(){return~~(this.millisecond()/100)});we(0,["SS",2],0,function(){return~~(this.millisecond()/10)});we(0,["SSS",3],0,"millisecond");we(0,["SSSS",4],0,function(){return this.millisecond()*10});we(0,["SSSSS",5],0,function(){return this.millisecond()*100});we(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});we(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});we(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});we(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});oe("S",Sp,Ax);oe("SS",Sp,Pi);oe("SSS",Sp,Nx);var Vs,f1;for(Vs="SSSS";Vs.length<=9;Vs+="S")oe(Vs,Qu);function Y2(t,e){e[qa]=Be(("0."+t)*1e3)}for(Vs="S";Vs.length<=9;Vs+="S")ct(Vs,Y2);f1=ec("Milliseconds",!1);we("z",0,0,"zoneAbbr");we("zz",0,0,"zoneName");function G2(){return this._isUTC?"UTC":""}function K2(){return this._isUTC?"Coordinated Universal Time":""}var q=bd.prototype;q.add=VG;q.calendar=GG;q.clone=KG;q.diff=t2;q.endOf=h2;q.format=o2;q.from=s2;q.fromNow=a2;q.to=l2;q.toNow=u2;q.get=rY;q.invalidAt=y2;q.isAfter=XG;q.isBefore=qG;q.isBetween=ZG;q.isSame=QG;q.isSameOrAfter=JG;q.isSameOrBefore=e2;q.isValid=v2;q.lang=s1;q.locale=o1;q.localeData=a1;q.max=vG;q.min=wG;q.parsingFlags=C2;q.set=oY;q.startOf=c2;q.subtract=WG;q.toArray=m2;q.toObject=p2;q.toDate=g2;q.toISOString=i2;q.inspect=r2;typeof Symbol!="undefined"&&Symbol.for!=null&&(q[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});q.toJSON=w2;q.toString=n2;q.unix=f2;q.valueOf=d2;q.creationData=S2;q.eraName=T2;q.eraNarrow=M2;q.eraAbbr=_2;q.eraYear=I2;q.year=Lx;q.isLeapYear=iY;q.weekYear=D2;q.isoWeekYear=$2;q.quarter=q.quarters=B2;q.month=Bx;q.daysInMonth=gY;q.week=q.weeks=bY;q.isoWeek=q.isoWeeks=RY;q.weeksInYear=F2;q.weeksInWeekYear=V2;q.isoWeeksInYear=L2;q.isoWeeksInISOWeekYear=k2;q.date=d1;q.day=q.days=$Y;q.weekday=LY;q.isoWeekday=kY;q.dayOfYear=j2;q.hour=q.hours=zY;q.minute=q.minutes=U2;q.second=q.seconds=z2;q.millisecond=q.milliseconds=f1;q.utcOffset=_G;q.utc=PG;q.local=OG;q.parseZone=xG;q.hasAlignedHourOffset=HG;q.isDST=AG;q.isLocal=DG;q.isUtcOffset=$G;q.isUtc=t1;q.isUTC=t1;q.zoneAbbr=G2;q.zoneName=K2;q.dates=qi("dates accessor is deprecated. Use date instead.",d1);q.months=qi("months accessor is deprecated. Use month instead",Bx);q.years=qi("years accessor is deprecated. Use year instead",Lx);q.zone=qi("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",IG);q.isDSTShifted=qi("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",NG);function X2(t){return yt(t*1e3)}function q2(){return yt.apply(null,arguments).parseZone()}function g1(t){return t}var Qe=BS.prototype;Qe.calendar=Dz;Qe.longDateFormat=Fz;Qe.invalidDate=Wz;Qe.ordinal=Uz;Qe.preparse=g1;Qe.postformat=g1;Qe.relativeTime=Yz;Qe.pastFuture=Gz;Qe.set=Az;Qe.eras=b2;Qe.erasParse=R2;Qe.erasConvertYear=E2;Qe.erasAbbrRegex=O2;Qe.erasNameRegex=P2;Qe.erasNarrowRegex=x2;Qe.months=cY;Qe.monthsShort=hY;Qe.monthsParse=fY;Qe.monthsRegex=pY;Qe.monthsShortRegex=mY;Qe.week=vY;Qe.firstDayOfYear=SY;Qe.firstDayOfWeek=yY;Qe.weekdays=xY;Qe.weekdaysMin=AY;Qe.weekdaysShort=HY;Qe.weekdaysParse=DY;Qe.weekdaysRegex=FY;Qe.weekdaysShortRegex=VY;Qe.weekdaysMinRegex=WY;Qe.isPM=jY;Qe.meridiem=YY;function vm(t,e,n,i){var r=us(),o=vo().set(i,e);return r[n](o,t)}function m1(t,e,n){if(is(t)&&(e=t,t=void 0),t=t||"",e!=null)return vm(t,e,n,"month");var i,r=[];for(i=0;i<12;i++)r[i]=vm(t,i,n,"month");return r}function sb(t,e,n,i){typeof t=="boolean"?(is(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,is(e)&&(n=e,e=void 0),e=e||"");var r=us(),o=t?r._week.dow:0,s,a=[];if(n!=null)return vm(e,(n+o)%7,i,"day");for(s=0;s<7;s++)a[s]=vm(e,(s+o)%7,i,"day");return a}function Z2(t,e){return m1(t,e,"months")}function Q2(t,e){return m1(t,e,"monthsShort")}function J2(t,e,n){return sb(t,e,n,"weekdays")}function eK(t,e,n){return sb(t,e,n,"weekdaysShort")}function tK(t,e,n){return sb(t,e,n,"weekdaysMin")}zs("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Be(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});X.lang=qi("moment.lang is deprecated. Use moment.locale instead.",zs);X.langData=qi("moment.langData is deprecated. Use moment.localeData instead.",us);var bo=Math.abs;function nK(){var t=this._data;return this._milliseconds=bo(this._milliseconds),this._days=bo(this._days),this._months=bo(this._months),t.milliseconds=bo(t.milliseconds),t.seconds=bo(t.seconds),t.minutes=bo(t.minutes),t.hours=bo(t.hours),t.months=bo(t.months),t.years=bo(t.years),this}function p1(t,e,n,i){var r=_r(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function iK(t,e){return p1(this,t,e,1)}function rK(t,e){return p1(this,t,e,-1)}function nM(t){return t<0?Math.floor(t):Math.ceil(t)}function oK(){var t=this._milliseconds,e=this._days,n=this._months,i=this._data,r,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=nM(Ry(n)+e)*864e5,e=0,n=0),i.milliseconds=t%1e3,r=ji(t/1e3),i.seconds=r%60,o=ji(r/60),i.minutes=o%60,s=ji(o/60),i.hours=s%24,e+=ji(s/24),l=ji(w1(e)),n+=l,e-=nM(Ry(l)),a=ji(n/12),n%=12,i.days=e,i.months=n,i.years=a,this}function w1(t){return t*4800/146097}function Ry(t){return t*146097/4800}function sK(t){if(!this.isValid())return NaN;var e,n,i=this._milliseconds;if(t=Zi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+i/864e5,n=this._months+w1(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(Ry(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+t)}}function cs(t){return function(){return this.as(t)}}var v1=cs("ms"),aK=cs("s"),lK=cs("m"),uK=cs("h"),cK=cs("d"),hK=cs("w"),dK=cs("M"),fK=cs("Q"),gK=cs("y"),mK=v1;function pK(){return _r(this)}function wK(t){return t=Zi(t),this.isValid()?this[t+"s"]():NaN}function Sl(t){return function(){return this.isValid()?this._data[t]:NaN}}var vK=Sl("milliseconds"),CK=Sl("seconds"),yK=Sl("minutes"),SK=Sl("hours"),bK=Sl("days"),RK=Sl("months"),EK=Sl("years");function TK(){return ji(this.days()/7)}var Wo=Math.round,bu={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function MK(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function _K(t,e,n,i){var r=_r(t).abs(),o=Wo(r.as("s")),s=Wo(r.as("m")),a=Wo(r.as("h")),l=Wo(r.as("d")),u=Wo(r.as("M")),c=Wo(r.as("w")),h=Wo(r.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=i,MK.apply(null,d)}function IK(t){return t===void 0?Wo:typeof t=="function"?(Wo=t,!0):!1}function PK(t,e){return bu[t]===void 0?!1:e===void 0?bu[t]:(bu[t]=e,t==="s"&&(bu.ss=e-1),!0)}function OK(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,i=bu,r,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(i=Object.assign({},bu,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),r=this.localeData(),o=_K(this,!n,i,r),n&&(o=r.pastFuture(+this,o)),r.postformat(o)}var Uw=Math.abs;function _l(t){return(t>0)-(t<0)||+t}function Pp(){if(!this.isValid())return this.localeData().invalidDate();var t=Uw(this._milliseconds)/1e3,e=Uw(this._days),n=Uw(this._months),i,r,o,s,a=this.asSeconds(),l,u,c,h;return a?(i=ji(t/60),r=ji(i/60),t%=60,i%=60,o=ji(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=_l(this._months)!==_l(a)?"-":"",c=_l(this._days)!==_l(a)?"-":"",h=_l(this._milliseconds)!==_l(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(r||i||t?"T":"")+(r?h+r+"H":"")+(i?h+i+"M":"")+(t?h+s+"S":"")):"P0D"}var Ge=_p.prototype;Ge.isValid=RG;Ge.abs=nK;Ge.add=iK;Ge.subtract=rK;Ge.as=sK;Ge.asMilliseconds=v1;Ge.asSeconds=aK;Ge.asMinutes=lK;Ge.asHours=uK;Ge.asDays=cK;Ge.asWeeks=hK;Ge.asMonths=dK;Ge.asQuarters=fK;Ge.asYears=gK;Ge.valueOf=mK;Ge._bubble=oK;Ge.clone=pK;Ge.get=wK;Ge.milliseconds=vK;Ge.seconds=CK;Ge.minutes=yK;Ge.hours=SK;Ge.days=bK;Ge.weeks=TK;Ge.months=RK;Ge.years=EK;Ge.humanize=OK;Ge.toISOString=Pp;Ge.toString=Pp;Ge.toJSON=Pp;Ge.locale=o1;Ge.localeData=a1;Ge.toIsoString=qi("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Pp);Ge.lang=s1;we("X",0,0,"unix");we("x",0,0,"valueOf");oe("x",Rp);oe("X",Zz);ct("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});ct("x",function(t,e,n){n._d=new Date(Be(t))});//! moment.js
X.version="2.30.1";xz(yt);X.fn=q;X.min=CG;X.max=yG;X.now=SG;X.utc=vo;X.unix=X2;X.months=Z2;X.isDate=Sd;X.locale=zs;X.invalid=Cp;X.duration=_r;X.isMoment=br;X.weekdays=J2;X.parseZone=q2;X.localeData=us;X.isDuration=Ug;X.monthsShort=Q2;X.weekdaysMin=tK;X.defineLocale=QS;X.updateLocale=qY;X.locales=ZY;X.weekdaysShort=eK;X.normalizeUnits=Zi;X.relativeTimeRounding=IK;X.relativeTimeThreshold=PK;X.calendarFormat=YG;X.prototype=q;X.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function xK(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function iM(t,e){const n=e.length;let i=0;for(;i<n;)t.push(e[i]),i+=1}function Yg(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,i=t[0].length;for(let r=0;r<n;r++)for(let o=0;o<i;o++)e[o]||(e[o]=[]),e[o][r]=t[r][o];return e}function di(t,e,n,i){let r=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i&&a&&(r+=1,s=o[r]),r+=1;r<a;)s=e(s,o[r],r,o),r+=1;return s}function sl(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,o=[];let s=-1;for(;n<r;){const a=i[n];e(a,n,i)&&(s+=1,o[s]=a),n+=1}return o}function We(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,o=[];let s=-1;for(;n<r;){const a=i[n];s+=1,o[s]=e(a,n,i),n+=1}return o}function M(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length;for(;n<r&&e(i[n],n,i)!==!1;)n+=1;return t}function HK(t){const e=[];return M(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function rM(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e];let o=i;return M(r,s=>{o=o.filter(a=>!s.includes(a))}),o}function oM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function tt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return di(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Gt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function re(t){return typeof t!="undefined"}function Tt(t){return typeof t=="undefined"}function Wt(t){return t===null||t===""||Tt(t)}function AK(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const ph="length",Th=t=>parseInt(t,16),sM=t=>parseInt(t,10),Cm=(t,e,n)=>t.substr(e,n),Mh=t=>t.codePointAt(0)-65,Ey=t=>`${t}`.replace(/\-/g,""),NK=t=>Th(Cm(Ey(t),Th("12"),Mh("F")))/(Th(Cm(Ey(t),Mh("B"),~~![][ph]))||9),DK=()=>typeof location!="undefined"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let aM=!1;const lM={invalid:()=>tt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return tt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>tt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},uM={invalid:()=>tt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return tt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>tt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function $K(t,e){const n=!Wt(t),i=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",r="15.2.0";let o,s="invalid",a="invalid";t=Ey(t||"");const l=LK(t);if(n||i||l)if(l){const u=X("19/03/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=NK(t);o=X((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else i?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(DK()&&(s="valid",a="valid"),!aM&&s!=="valid"&&(lM[s]({keyValidityDate:o,hotVersion:r})&&console[s==="non_commercial"?"info":"warn"](lM[s]({keyValidityDate:o,hotVersion:r})),aM=!0),a!=="valid"&&e.parentNode&&uM[a]({keyValidityDate:o,hotVersion:r})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=uM[a]({keyValidityDate:o,hotVersion:r}),e.parentNode.insertBefore(c,e.nextSibling)}}function LK(t){let e=[][ph],n=e;if(t[ph]!==Mh("Z"))return!1;for(let i="",r="B<H4P+".split(""),o=Mh(r.shift());o;o=Mh(r.shift()||"A"))--o<""[ph]?n=n|(sM(`${sM(Th(i)+(Th(Cm(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=Cm(t,o,o?r[ph]===1?9:8:6);return n===e}function Rr(t){return t[0].toUpperCase()+t.substr(1)}function C1(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function y1(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function S1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,i)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[i]===void 0?"":e[i])}function cM(t){return ab(`${t}`,{ALLOWED_TAGS:[]})}function ab(t,e){return Oz.sanitize(t,e)}const bl=t=>["tabindex",t],kK=()=>["role","treegrid"],uo=()=>["role","presentation"],FK=()=>["role","gridcell"],VK=()=>["role","rowheader"],b1=()=>["role","rowgroup"],WK=()=>["role","columnheader"],Ty=()=>["role","row"],BK=()=>["role","menu"],jK=()=>["role","menuitem"],UK=()=>["role","menuitemcheckbox"],zK=()=>["role","combobox"],R1=()=>["role","listbox"],YK=()=>["role","option"],GK=()=>["role","checkbox"],KK=()=>["scope","col"],XK=()=>["scope","row"],qK=()=>["type","text"],ym=t=>["aria-label",t],Js=()=>["aria-hidden","true"],ZK=()=>["aria-disabled","true"],QK=()=>["aria-multiselectable","true"],E1=t=>["aria-haspopup",t],T1=t=>["aria-rowcount",t],Op=t=>["aria-colcount",t],M1=t=>["aria-rowindex",t],lb=t=>["aria-colindex",t],Yi=t=>["aria-expanded",t],JK=t=>["aria-sort",t],hM=()=>["aria-readonly","true"],dM=()=>["aria-invalid","true"],_1=t=>["aria-checked",t],ub=()=>["aria-selected","true"],e3=()=>["aria-autocomplete","list"],t3=t=>["aria-controls",t],n3=t=>["aria-activedescendant",t],i3=t=>["aria-live",t],r3=t=>["aria-relevant",t],o3=t=>["aria-setsize",t],s3=t=>["aria-posinset",t];function a3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=null,r=t;for(;r!==null;){if(n===e){i=r;break}r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:(n+=1,r=r.parentNode)}return i}function Gg(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function l3(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Fu(t){return l3(t)&&t.parent}function al(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:r}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===i&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===r?o=l:o=o.parentNode}return null}function of(t,e,n){const i=[];let r=t;for(;r&&(r=al(r,e,n),!(!r||n&&!n.contains(r)));)i.push(r),r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:r=r.parentNode;const o=i.length;return o?i[o-1]:null}function u3(t,e){const n={element:void 0,classNames:[]};let i=t;for(;i!==null&&i!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&i.classList.contains(e))n.element=i,n.classNames.push(e);else if(e instanceof RegExp){const r=Array.from(i.classList).filter(o=>e.test(o));r.length&&(n.element=i,n.classNames.push(...r))}i=i.parentElement}return n}function rl(t,e){let n=t.parentNode,i=[];for(typeof e=="string"?t.defaultView?i=Array.prototype.slice.call(t.querySelectorAll(e),0):i=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):i.push(e);n!==null;){if(i.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function c3(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function sa(t,e,n){const i=n.parentElement.querySelector(`.ht_clone_${t}`);return i?i.contains(e):null}function I1(t){return!t||!t.length?[]:t.filter(e=>!!e)}function P1(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],i=[];return i.push(...t.filter(r=>{const o=r instanceof RegExp;return o&&e&&n.push(r),!o})),e?{regexFree:i,regexes:n}:i}function pe(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function U(t,e){typeof e=="string"&&(e=e.split(" ")),e=I1(e),e.length>0&&t.classList.add(...e)}function ge(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:i}=P1(e,!0);n=I1(n),n.length>0&&t.classList.remove(...n),i.forEach(r=>{t.classList.forEach(o=>{r.test(o)&&t.classList.remove(o)})})}function ve(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(i=>{Array.isArray(i)&&i[0]!==""&&t.setAttribute(...i)})}function tc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:i}=P1(e,!0);n.forEach(r=>{r!==""&&t.removeAttribute(r)}),i.forEach(r=>{t.getAttributeNames().forEach(o=>{r.test(o)&&t.removeAttribute(o)})})}function O1(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)O1(e[n])}}function rs(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const h3=/(<(.*)>|&(.*);)/;function nc(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;h3.test(e)?t.innerHTML=n?ab(e):e:ll(t,e)}function ll(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(rs(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Vu(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let i=t;for(;i!==e;){if(i===null)return!1;if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(i.host){if(i.host.impl)return Vu(i.host.impl);if(i.host)return Vu(i.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(i).display==="none")return!1;i=i.parentNode}return!0}function xn(t){const e=t.ownerDocument,n=e.defaultView,i=e.documentElement;let r=t,o,s,a;for(o=r.offsetLeft,s=r.offsetTop,a=r;(r=r.offsetParent)&&!(r===e.body||!("offsetLeft"in r));)o+=r.offsetLeft,s+=r.offsetTop,a=r;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||i.scrollLeft,s+=n.pageYOffset||i.scrollTop),{left:o,top:s}}function x1(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function cb(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function hb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?x1(e):t.scrollTop}function H1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?cb(e):t.scrollLeft}function Sm(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const i=["auto","scroll"];let r=t.parentNode;for(;r&&r.style&&e.body!==r;){let{overflow:o,overflowX:s,overflowY:a}=r.style;if([o,s,a].includes("scroll"))return r;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(r),i.includes(o)||i.includes(s)||i.includes(a)||r.clientHeight<=r.scrollHeight+1&&(i.includes(a)||i.includes(o))||r.clientWidth<=r.scrollWidth+1&&(i.includes(s)||i.includes(o)))return r;r=r.parentNode}return n}function d3(t){return t.scrollHeight-t.clientHeight}function f3(t){return t.scrollWidth-t.clientWidth}function Qh(t){const e=t.ownerDocument,n=e.defaultView;let i=t.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const r=n.getComputedStyle(i),o=["scroll","hidden","auto"],s=r.getPropertyValue("overflow"),a=r.getPropertyValue("overflow-y"),l=r.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return i;i=i.parentNode}return n}function bm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const i=t.style[e];if(i!==""&&i!==void 0)return i;const r=n.getComputedStyle(t);if(r[e]!==""&&r[e]!==void 0)return r[e]}function Yt(t){return t.offsetWidth}function tn(t){return t.offsetHeight}function _h(t){return t.clientHeight||t.innerHeight}function A1(t){return t.clientWidth||t.innerWidth}function N1(t){return t.selectionStart?t.selectionStart:0}function g3(t){return t.selectionEnd?t.selectionEnd:0}function fM(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function xp(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch(i){const r=t.parentNode,o=r.style.display;r.style.display="block",t.setSelectionRange(e,n),r.style.display=o}}}let zw;function m3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const i=e.offsetWidth;n.style.overflow="scroll";let r=e.offsetWidth;return i===r&&(r=n.clientWidth),(t.body||t.documentElement).removeChild(n),i-r}function wn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return zw===void 0&&(zw=m3(t)),zw}function D1(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function $1(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function db(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function Hp(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Kg(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function L1(t){return Kg(t)&&t.hasAttribute("data-hot-input")===!1}function k1(t){return!t.parentNode}function p3(t,e){new IntersectionObserver((i,r)=>{i.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),r.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function F1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=t.ownerDocument,r=i.createRange(),o=i.defaultView.getSelection();ve(t,"contenteditable",!0),n&&ve(t,...Js()),e&&U(t,"invisibleSelection"),r.selectNodeContents(t),o.removeAllRanges(),o.addRange(r)}function V1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&ge(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function w3(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;F1(t,n),e(),V1(t,n)}function Ys(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}function gt(t){return typeof t=="function"}function fb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,i;function r(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{i=t.apply(this,s)},e),i}return r}function W1(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function v3(t){const e=t.length;function n(i){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=i.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function My(t,e,n,i,r,o,s,a){return re(a)?t.call(e,n,i,r,o,s,a):re(s)?t.call(e,n,i,r,o,s):re(o)?t.call(e,n,i,r,o):re(r)?t.call(e,n,i,r):re(i)?t.call(e,n,i):re(n)?t.call(e,n):t.call(e)}var C3=Kt,gM=LO,y3=rn,mM=ml,S3=vp,pM=C3([].push),b3=function(t){if(y3(t))return t;if(!!gM(t)){for(var e=t.length,n=[],i=0;i<e;i++){var r=t[i];typeof r=="string"?pM(n,r):(typeof r=="number"||mM(r)==="Number"||mM(r)==="String")&&pM(n,S3(r))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(gM(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},R3=dt,B1=Yu,j1=wp,E3=An,Td=Kt,U1=bn,wM=rn,vM=vS,z1=LS,T3=b3,M3=wS,_3=String,Gs=B1("JSON","stringify"),sf=Td(/./.exec),CM=Td("".charAt),I3=Td("".charCodeAt),P3=Td("".replace),O3=Td(1 .toString),x3=/[\uD800-\uDFFF]/g,yM=/^[\uD800-\uDBFF]$/,SM=/^[\uDC00-\uDFFF]$/,bM=!M3||U1(function(){var t=B1("Symbol")("stringify detection");return Gs([t])!=="[null]"||Gs({a:t})!=="{}"||Gs(Object(t))!=="{}"}),RM=U1(function(){return Gs("\uDF06\uD834")!=='"\\udf06\\ud834"'||Gs("\uDEAD")!=='"\\udead"'}),H3=function(t,e){var n=z1(arguments),i=T3(e);if(!(!wM(i)&&(t===void 0||vM(t))))return n[1]=function(r,o){if(wM(i)&&(o=E3(i,this,_3(r),o)),!vM(o))return o},j1(Gs,null,n)},A3=function(t,e,n){var i=CM(n,e-1),r=CM(n,e+1);return sf(yM,t)&&!sf(SM,r)||sf(SM,t)&&!sf(yM,i)?"\\u"+O3(I3(t,0),16):t};Gs&&R3({target:"JSON",stat:!0,arity:3,forced:bM||RM},{stringify:function(e,n,i){var r=z1(arguments),o=j1(bM?H3:Gs,null,r);return RM&&typeof o=="string"?P3(o,x3,A3):o}});function Jh(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ae(t,(n,i)=>{i!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[i]=Jh(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[i]=[Jh(n[0])]:e[i]=[]:e[i]=null)})),e}function N3(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function nn(t,e,n){const i=Array.isArray(n);return Ae(e,(r,o)=>{(i===!1||n.includes(o))&&(t[o]=r)}),t}function Ap(t,e){Ae(e,(n,i)=>{e[i]&&typeof e[i]=="object"?(t[i]||(Array.isArray(e[i])?t[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?t[i]=e[i]:t[i]={}),Ap(t[i],e[i])):t[i]=e[i]})}function Xn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function go(t){const e={};return Ae(t,(n,i)=>{e[i]=n}),e}function lt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return M(n,r=>{t.MIXINS.push(r.MIXIN_NAME),Ae(r,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=p=>{let S=p;return(Array.isArray(S)||He(S))&&(S=Xn(S)),S};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function gb(t,e){return JSON.stringify(t)===JSON.stringify(e)}function He(t){return Object.prototype.toString.call(t)==="[object Object]"}function hs(t,e,n,i){i.value=n,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(t,e,i)}function Ae(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function D3(t,e){const n=e.split(".");let i=t;return Ae(n,r=>{if(i=i[r],i===void 0)return i=void 0,!1}),i}function Yw(t,e,n){const i=e.split(".");let r=t;i.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==i.length-1?(en(r,o)||(r[o]={}),r=r[o]):r[o]=n)})}function mb(t){if(!He(t))return 0;const e=function(n){let i=0;return He(n)?Ae(n,(r,o)=>{o!=="__children"&&(i+=e(r))}):i+=1,i};return e(t)}function Mi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,i={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[n]},set(r){this._touched=!0,this[n]=r},enumerable:!0,configurable:!0}),i}function en(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Rm(t){return window.requestAnimationFrame(t)}function Em(t){window.cancelAnimationFrame(t)}function Y1(){return"ontouchstart"in window}function $3(){return typeof window!="undefined"}let Il;function L3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Il||(typeof Intl=="object"?Il=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Il=(n,i)=>`${n}`.localeCompare(i):Il=(n,i)=>n===i?0:n>i?-1:1,Il)}const ki=t=>{const e={value:!1};return e.test=(n,i)=>{e.value=t(n,i)},e},ea={chrome:ki((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:ki(t=>/CriOS/.test(t)),edge:ki(t=>/Edge/.test(t)),edgeWebKit:ki(t=>/EdgiOS/.test(t)),firefox:ki(t=>/Firefox/.test(t)),firefoxWebKit:ki(t=>/FxiOS/.test(t)),mobile:ki(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:ki((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Md={mac:ki(t=>/^Mac/.test(t)),win:ki(t=>/^Win/.test(t)),linux:ki(t=>/^Linux/.test(t)),ios:ki(t=>/iPhone|iPad|iPod/i.test(t))};function k3(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ae(ea,n=>{let{test:i}=n;return void i(t,e)})}function F3(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ae(Md,e=>{let{test:n}=e;return void n(t)})}$3()&&(k3(),F3());function G1(){return ea.chrome.value}function V3(){return ea.chromeWebKit.value}function Gw(){return ea.firefox.value}function W3(){return ea.firefoxWebKit.value}function K1(){return ea.safari.value}function B3(){return ea.edge.value}function qo(){return ea.mobile.value}function X1(){return Md.ios.value}function q1(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Md.mac.value}function EM(){return Md.win.value}function TM(){return Md.mac.value}const fe={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Gw()?182:174,AUDIO_MUTE:Gw()?181:173,AUDIO_UP:Gw()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},j3=[fe.ALT,fe.ARROW_DOWN,fe.ARROW_LEFT,fe.ARROW_RIGHT,fe.ARROW_UP,fe.AUDIO_DOWN,fe.AUDIO_MUTE,fe.AUDIO_UP,fe.BACKSPACE,fe.CAPS_LOCK,fe.DELETE,fe.END,fe.ENTER,fe.ESCAPE,fe.F1,fe.F2,fe.F3,fe.F4,fe.F5,fe.F6,fe.F7,fe.F8,fe.F9,fe.F10,fe.F11,fe.F12,fe.F13,fe.F14,fe.F15,fe.F16,fe.F17,fe.F18,fe.F19,fe.HOME,fe.INSERT,fe.MEDIA_NEXT,fe.MEDIA_PLAY_PAUSE,fe.MEDIA_PREV,fe.MEDIA_STOP,fe.NULL,fe.NUM_LOCK,fe.PAGE_DOWN,fe.PAGE_UP,fe.PAUSE,fe.SCROLL_LOCK,fe.SHIFT,fe.TAB];function U3(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function Z1(t){return j3.includes(t)}function z3(t){return[fe.CONTROL,fe.COMMAND_LEFT,fe.COMMAND_RIGHT,fe.COMMAND_FIREFOX].includes(t)}function _d(t,e){const n=e.split("|");let i=!1;return M(n,r=>{if(t===fe[r])return i=!0,!1}),i}function Ir(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Ka(t){return t.isImmediatePropagationEnabled===!1}function ul(t){return t.button===2}function pb(t){return t.button===0}function Y3(t){return t instanceof TouchEvent}function G3(t,e){const n={x:t.offsetX,y:t.offsetY};let i=t.target;if(!Ys(e)||i!==e&&i.contains(e))return n;for(;i!==e;)n.x+=i.offsetLeft,n.y+=i.offsetTop,i=i.offsetParent;return n}function qe(){re(console)&&console.warn(...arguments)}function wb(){re(console)&&console.error(...arguments)}const Xa=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Kw=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Xw=new Map([[]]);var K3=Xu,X3=function(t,e,n){for(var i=0,r=arguments.length>2?n:K3(e),o=new t(r);r>i;)o[i]=e[i++];return o},q3=hn,Z3=function(t,e){var n=q3[t],i=n&&n.prototype;return i&&i[e]},Q3=Mr,J3=ex,eX=ls.f,_y=Q3("unscopables"),Iy=Array.prototype;Iy[_y]===void 0&&eX(Iy,_y,{configurable:!0,value:J3(null)});var Np=function(t){Iy[_y][t]=!0},tX=dt,nX=Kt,iX=hi,rX=gd,oX=X3,sX=Z3,aX=Np,lX=Array,uX=nX(sX("Array","sort"));tX({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&iX(e);var n=rX(this),i=oX(lX,n);return uX(i,e)}});aX("toSorted");var cX=dt,hX=Zu,dX=hi,fX=on,gX=wo;cX({target:"Iterator",proto:!0,real:!0},{find:function(e){fX(this),dX(e);var n=gX(this),i=0;return hX(n,function(r,o){if(e(r,i++))return o(r)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function mX(t,e){Q1(t,e),e.add(t)}function qw(t,e,n){Q1(t,e),e.set(t,n)}function Q1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MM(t,e,n){return t.set(Tm(t,e),n),n}function Sn(t,e){return t.get(Tm(t,e))}function Tm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pX=100;var pi=new WeakMap,fu=new WeakMap,Zw=new WeakMap,Qw=new WeakSet;class _M{constructor(){mX(this,Qw),qw(this,pi,new Map),qw(this,fu,new Map),qw(this,Zw,new Set),Xa.forEach(e=>Tm(Qw,this,IM).call(this,e))}getHooks(e){var n;return(n=Sn(pi,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Sn(pi,this).has(e)||(Tm(Qw,this,IM).call(this,e),Xa.push(e));const r=Sn(pi,this).get(e);if(r.find(u=>u.callback===n))return;const o=Number.isInteger(i.orderIndex)?i.orderIndex:0,s=!!i.runOnce,a=!!i.initialHook;let l=!1;if(a){const u=r.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){r.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=Sn(Zw,this).has(e);!u&&o!==0&&(u=!0,Sn(Zw,this).add(e)),u&&r.length>1&&Sn(pi,this).set(e,r.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return Sn(pi,this).has(e)&&Sn(pi,this).get(e).length>0}remove(e,n){if(!Sn(pi,this).has(e))return!1;const i=Sn(pi,this).get(e),r=i.find(o=>o.callback===n);if(r){let o=Sn(fu,this).get(e);return r.skip=!0,o+=1,o>pX&&(Sn(pi,this).set(e,i.filter(s=>!s.skip)),o=0),Sn(fu,this).set(e,o),!0}return!1}destroy(){Sn(pi,this).clear(),Sn(fu,this).clear(),MM(pi,this,null),MM(fu,this,null)}}function IM(t){Sn(pi,this).set(t,[]),Sn(fu,this).set(t,0)}function wX(t,e,n){return(e=vX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vX(t){var e=CX(t,"string");return typeof e=="symbol"?e:e+""}function CX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const yX=tt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ee{constructor(){wX(this,"globalBucket",new _M)}static getSingleton(){return bX()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new _M),e.pluginHookBucket):this.globalBucket}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?M(n,o=>this.add(e,o,i)):(Kw.has(e)&&qe(S1(yX,{hookName:e,removedInVersion:Kw.get(e)})),Xw.has(e)&&qe(Xw.get(e)),this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!1})),this}once(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?M(n,o=>this.once(e,o,i)):this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!0}),this}addAsFixed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?M(n,r=>this.addAsFixed(e,r,i)):this.getBucket(i).add(e,n,{initialHook:!0}),this}remove(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(i).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,i,r,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=My(u[h].callback,e,i,r,o,s,a,l);d!==void 0&&(i=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=My(u[h].callback,e,i,r,o,s,a,l);d!==void 0&&(i=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Xa.push(e)}deregister(e){this.isRegistered(e)&&Xa.splice(Xa.indexOf(e),1)}isDeprecated(e){return Xw.has(e)||Kw.has(e)}isRegistered(e){return Xa.indexOf(e)>=0}getRegistered(){return Xa}}const SX=new ee;function bX(){return SX}const Jw=new Map;function Pr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Jw.has(t)||Jw.set(t,new Map);const e=Jw.get(t);function n(a,l){e.set(a,l)}function i(a){return e.get(a)}function r(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:i,hasItem:r,getNames:o,getValues:s}}const Py=new WeakMap,{register:RX,getItem:J1,hasItem:eH,getNames:ipe,getValues:rpe}=Pr("editors");function EX(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new n(i)),e[i.guid]},ee.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function tH(t,e){let n;if(typeof t=="function")Py.get(t)||vi(null,t),n=Py.get(t);else if(typeof t=="string")n=J1(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function PM(t){if(typeof t=="function")return t;if(!eH(t))throw Error(`No registered editor found under "${t}" name`);return J1(t).getConstructor()}function vi(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new EX(e);typeof t=="string"&&RX(t,n),Py.set(e,n)}function TX(t,e,n){return(e=MX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MX(t){var e=_X(t,"string");return typeof e=="symbol"?e:e+""}function _X(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IX{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;TX(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){i.call(this,PX(s))}return this.context.eventListeners.push({element:e,event:n,callback:i,callbackProxy:o,options:r,eventManager:this}),e.addEventListener(n,o,r),()=>{this.removeEventListener(e,n,i)}}removeEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(i&&i!==s.callback||r&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const i=this.context.eventListeners[n];e&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let i=e.document,r=e;i||(i=e.ownerDocument?e.ownerDocument:e,r=i.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;i.createEvent?(s=i.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,i.body.parentNode)):s=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function PX(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Ir(this)},t}var Er=IX;function OX(t,e){xX(t,e),e.add(t)}function xX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aa(t,e,n){return(e=HX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HX(t){var e=AX(t,"string");return typeof e=="symbol"?e:e+""}function AX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ev=new WeakSet;class Oy{constructor(e,n,i){OX(this,ev),aa(this,"hot",void 0),aa(this,"tableMeta",void 0),aa(this,"selection",void 0),aa(this,"eventManager",void 0),aa(this,"destroyed",!1),aa(this,"activeEditor",void 0),aa(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=i,this.eventManager=new Er(e),this.hot.addHook("afterDocumentKeyDown",r=>OM(ev,this,NX).call(this,r)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",r=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",r)}),this.hot.view._wt.update("onCellDblClick",(r,o,s)=>OM(ev,this,DX).call(this,r,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:i,col:r}=n,o=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");let s=i,a=r;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(i,r,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=tH(u,this.hot),this.activeEditor.prepare(i,r,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const r=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,n,i);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&r.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,i){this.activeEditor?this.activeEditor.finishEditing(e,n,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(i))||s.isHidden(this.hot.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n=Me({},typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves);e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function NX(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Ka(t))return;const{keyCode:n}=t,i=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Z1(n)&&!z3(n)&&!i&&!this.isEditorOpened()&&this.openEditor("",t)}function DX(t,e){e.isCell()&&this.openEditor(null,t,!0)}const xM=new WeakMap;Oy.getInstance=function(t,e,n){let i=xM.get(t);return i||(i=new Oy(t,e,n),xM.set(t,i)),i};var $X=Oy;function LX(t,e){nH(t,e),e.add(t)}function Cc(t,e,n){nH(t,e),e.set(t,n)}function nH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vt(t,e){return t.get(Yo(t,e))}function yc(t,e,n){return t.set(Yo(t,e),n),n}function Yo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Hu=Object.freeze({CELL:"cell",MIXED:"mixed"});var un=new WeakMap,af=new WeakMap,lf=new WeakMap,uf=new WeakMap,cf=new WeakMap,xs=new WeakSet;class kX{constructor(e){var n=this;LX(this,xs),Cc(this,un,void 0),Cc(this,af,void 0),Cc(this,lf,1),Cc(this,uf,null),Cc(this,cf,new Map);const i=e.getSettings();yc(un,this,e),yc(af,this,i.imeFastEdit?Hu.MIXED:Hu.CELL),vt(un,this).addHook("afterUpdateSettings",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Yo(xs,n,VX).call(n,...o)}),vt(un,this).addHook("afterSelection",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Yo(xs,n,HM).call(n,...o)}),vt(un,this).addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Yo(xs,n,HM).call(n,...o)}),vt(un,this).addHook("afterSelectionEnd",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Yo(xs,n,FX).call(n,...o)})}getFocusMode(){return vt(af,this)}setFocusMode(e){Object.values(Hu).includes(e)?yc(af,this,e):qe(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return vt(lf,this)}setRefocusDelay(e){yc(lf,this,e)}setRefocusElementGetter(e){yc(uf,this,e)}getRefocusElement(){var e;return typeof vt(uf,this)=="function"?vt(uf,this).call(this):(e=vt(un,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=i=>{var r,o;const s=(r=vt(un,this).getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;if(!s)return;let a=vt(un,this).runHooks("modifyFocusedElement",s.row,s.col,i);Ys(a)||(a=i),a&&!((o=vt(un,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Yo(xs,this,vb).call(this,i=>n(i))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vt(lf,this);if(vt(un,this).getSettings().imeFastEdit&&!((e=vt(un,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var i,r;(i=vt(un,this).getActiveEditor())===null||i===void 0||(r=i.refreshValue)===null||r===void 0||r.call(i),vt(cf,this).has(n)||vt(cf,this).set(n,fb(()=>{var o;(o=this.getRefocusElement())===null||o===void 0||o.select()},n)),vt(cf,this).get(n)()}}}function vb(t){var e;const n=(e=vt(un,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!vt(un,this).selection.isCellVisible(n)){t(null);return}const i=vt(un,this).getCell(n.row,n.col,!0);i===null?vt(un,this).addHookOnce("afterScroll",()=>{t(vt(un,this).getCell(n.row,n.col,!0))}):t(i)}function HM(){Yo(xs,this,vb).call(this,t=>{const{activeElement:e}=vt(un,this).rootDocument;e&&L1(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function FX(){Yo(xs,this,vb).call(this,t=>{this.getFocusMode()===Hu.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function VX(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Hu.MIXED:Hu.CELL)}var WX=Tr,BX=ml,jX=Mr,UX=jX("match"),zX=function(t){var e;return WX(t)&&((e=t[UX])!==void 0?!!e:BX(t)==="RegExp")},YX=on,GX=function(){var t=YX(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},KX=An,XX=Xi,qX=md,ZX=GX,AM=RegExp.prototype,QX=function(t){var e=t.flags;return e===void 0&&!("flags"in AM)&&!XX(t,"flags")&&qX(AM,t)?KX(ZX,t):e},Cb=Kt,JX=Gu,eq=Math.floor,tv=Cb("".charAt),tq=Cb("".replace),nv=Cb("".slice),nq=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,iq=/\$([$&'`]|\d{1,2})/g,rq=function(t,e,n,i,r,o){var s=n+t.length,a=i.length,l=iq;return r!==void 0&&(r=JX(r),l=nq),tq(o,l,function(u,c){var h;switch(tv(c,0)){case"$":return"$";case"&":return t;case"`":return nv(e,0,n);case"'":return nv(e,s);case"<":h=r[nv(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var f=eq(d/10);return f===0?u:f<=a?i[f-1]===void 0?tv(c,1):i[f-1]+tv(c,1):u}h=i[d-1]}return h===void 0?"":h})},oq=dt,sq=An,yb=Kt,NM=fd,aq=rn,lq=fp,uq=zX,Sc=vp,cq=pd,hq=QX,dq=rq,fq=Mr,gq=fq("replace"),mq=TypeError,iv=yb("".indexOf);yb("".replace);var DM=yb("".slice),pq=Math.max;oq({target:"String",proto:!0},{replaceAll:function(e,n){var i=NM(this),r,o,s,a,l,u,c,h,d,f,p=0,S="";if(!lq(e)){if(r=uq(e),r&&(o=Sc(NM(hq(e))),!~iv(o,"g")))throw new mq("`.replaceAll` does not allow non-global regexes");if(s=cq(e,gq),s)return sq(s,e,i,n)}for(a=Sc(i),l=Sc(e),u=aq(n),u||(n=Sc(n)),c=l.length,h=pq(1,c),d=iv(a,l);d!==-1;)f=u?Sc(n(l,d,a)):dq(l,a,d,[],void 0,n),S+=DM(a,p,d)+f,p=d+c,d=d+h>a.length?-1:iv(a,l,d+h);return p<a.length&&(S+=DM(a,p)),S}});var wq=dt,vq=Zu,Cq=hi,yq=on,Sq=wo,bq=TypeError;wq({target:"Iterator",proto:!0,real:!0},{reduce:function(e){yq(this),Cq(e);var n=Sq(this),i=arguments.length<2,r=i?void 0:arguments[1],o=0;if(vq(n,function(s){i?(i=!1,r=s):r=e(r,s,o),o++},{IS_RECORD:!0}),i)throw new bq("Reduce of empty iterator with no initial value");return r}});const iH={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Rq=new RegExp(Object.keys(iH).map(t=>`(${t})`).join("|"),"gi");function Eq(t){return(t&&t.nodeName||"")==="TABLE"}function $M(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),i=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],r=t.getData(...i),o=r.length,s=o>0?r[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,p=[];for(let y=0;y<s;y+=1){const R=!f&&n&&y===0;let T="";if(f)T=`<th>${t.getColHeader(y-c)}</th>`;else if(R)T=`<th>${t.getRowHeader(d-h)}</th>`;else{const V=r[d][y],{hidden:B,rowspan:W,colspan:$}=t.getCellMeta(d-h,y-c);if(!B){const L=[];if(W&&L.push(`rowspan="${W}"`),$&&L.push(`colspan="${$}"`),Wt(V))T=`<td ${L.join(" ")}></td>`;else{const z=V.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");T=`<td ${L.join(" ")}>${z}</td>`}}}p.push(T)}const S=["<tr>",...p,"</tr>"].join("");f?l.splice(1,0,S):u.splice(-1,0,S)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function LM(t){const e=t.length,n=["<table>"];for(let i=0;i<e;i+=1){const r=t[i],o=r.length,s=[];i===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=r[a],u=Wt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),i+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function Tq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},i=e.createDocumentFragment(),r=e.createElement("div");i.appendChild(r);let o=t;if(typeof o=="string"){const V=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,B=>{const W=B.match(/<td\b[^>]*?>/g)[0],$=/<p.*?>/g,L=B.substring(W.length,B.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll($,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${W}${L}</td>`});r.insertAdjacentHTML("afterbegin",`${V}`),o=r.querySelector("table")}if(!o||!Eq(o))return;const s=r.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((V,B)=>V+B.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,p=0;if(o.tHead){const V=Array.from(o.tHead.rows).filter(B=>{const W=B.querySelector("td")!==null;return W&&h.push(B),!W});f=V.length,d=f>0,f>1?n.nestedHeaders=Array.from(V).reduce((B,W)=>{const $=Array.from(W.cells).reduce((L,z,ie)=>{if(a&&ie===0)return L;const{colSpan:K,innerHTML:te}=z,se=K>1?{label:te,colspan:K}:te;return L.push(se),L},[]);return B.push($),B},[]):d&&(n.colHeaders=Array.from(V[0].children).reduce((B,W,$)=>(a&&$===0||B.push(W.innerHTML),B),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const S=[...h,...Array.from(o.tBodies).reduce((V,B)=>(V.push(...Array.from(B.rows)),V),[]),...c];p=S.length;const y=new Array(p);for(let V=0;V<p;V++)y[V]=new Array(u);const R=[],T=[];for(let V=0;V<p;V++){const B=S[V],W=Array.from(B.cells),$=W.length;for(let L=0;L<$;L++){const z=W[L],{nodeName:ie,innerHTML:K,rowSpan:te,colSpan:se}=z,Ce=y[V].findIndex(be=>be===void 0);if(ie==="TD"){if(te>1||se>1){for(let Pe=V;Pe<V+te;Pe++)if(Pe<p)for(let Ke=Ce;Ke<Ce+se;Ke++)y[Pe][Ke]=null;const je=z.getAttribute("style");je&&je.includes("mso-ignore:colspan")||R.push({col:Ce,row:V,rowspan:te,colspan:se})}let be="";s&&/excel/gi.test(s.content)?be=K.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):be=K.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[V][Ce]=be.replace(Rq,je=>iH[je])}else T.push(K)}}return R.length&&(n.mergeCells=R),T.length&&(n.rowHeaders=T),y.length&&(n.data=y),n}function Yn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const i=Array.from(new Set([".",...e])).map(r=>`\\${r}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function Mq(t){return Yn(t,[","])}function ce(t,e,n){let i=-1;for(typeof e=="function"?(n=e,e=t):i=t-1;++i<=e&&n(i)!==!1;);}function kM(t,e,n){let i=t+1;for(typeof e=="function"&&(n=e,e=0);--i>=e&&n(i)!==!1;);}function rH(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ue(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const xy="asc",_q="desc",FM=new Map([[xy,[-1,1]],[_q,[1,-1]]]),Iq=t=>`The priority '${t}' is already declared in a map.`,Pq=t=>`The priority '${t}' is not a number.`;function Oq(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=gt(t)?t:Iq,e=gt(e)?e:Pq;function i(o,s){if(!Yn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function r(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xy;const[s,a]=FM.get(o)||FM.get(xy);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:i,getItems:r}}const xq=t=>`The id '${t}' is already declared in a map.`;function Dp(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=gt(t)?t:xq;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function i(u){return e.delete(u)}function r(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:r,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:i}}const Hq=t=>`'${t}' value is already declared in a unique set.`;function Aq(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=gt(t)?t:Hq;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function i(){return[...e]}function r(){e.clear()}return{addItem:n,clear:r,getItems:i}}const Sb=t=>`There is already registered "${t}" plugin.`,Nq=t=>`There is already registered plugin on priority "${t}".`,Dq=t=>`The priority "${t}" is not a number.`,oH=Oq({errorPriorityExists:Nq,errorPriorityNaN:Dq}),sH=Aq({errorItemExists:Sb}),Hy=Dp({errorIdExists:Sb});function aH(){return[...oH.getItems(),...sH.getItems()]}function bb(t){const e=Rr(t);return Hy.getItem(e)}function $q(t){return!!bb(t)}function ze(t,e,n){[t,e,n]=kq(t,e,n),bb(t)===void 0&&Lq(t,e,n)}function Lq(t,e,n){const i=Rr(t);if(Hy.hasItem(i))throw new Error(Sb(i));n===void 0?sH.addItem(i):oH.addItem(n,i),Hy.addItem(i,e)}function kq(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:Fq,getItem:Vq,hasItem:lH,getNames:ope,getValues:spe}=Pr("renderers");function VM(t){if(typeof t=="function")return t;if(!lH(t))throw Error(`No registered renderer found under "${t}" name`);return Vq(t)}function $i(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Fq(t,e)}const{register:Wq,getItem:Bq,hasItem:uH,getNames:ape,getValues:lpe}=Pr("validators");function jq(t){if(typeof t=="function")return t;if(!uH(t))throw Error(`No registered validator found under "${t}" name`);return Bq(t)}function gu(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Wq(t,e)}var Uq=dt,zq=Gu,Yq=Xu,Gq=wd,Kq=Np;Uq({target:"Array",proto:!0},{at:function(e){var n=zq(this),i=Yq(n),r=Gq(e),o=r>=0?r:i+r;return o<0||o>=i?void 0:n[o]}});Kq("at");var Xq=dt,qq=Kt,Zq=fd,Qq=wd,Jq=vp,e4=bn,t4=qq("".charAt),n4=e4(function(){return"\u{20BB7}".at(-2)!=="\uD842"});Xq({target:"String",proto:!0,forced:n4},{at:function(e){var n=Jq(Zq(this)),i=n.length,r=Qq(e),o=r>=0?r:i+r;return o<0||o>=i?void 0:t4(n,o)}});function bc(t,e,n){return(e=i4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i4(t){var e=r4(t,"string");return typeof e=="symbol"?e:e+""}function r4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class o4{constructor(){bc(this,"count",0),bc(this,"startColumn",null),bc(this,"endColumn",null),bc(this,"startPosition",null),bc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:o,columnWidth:s}=n,a=r>0?o+1:o;i>=r&&i+s<=r+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const p=u[this.endColumn]+c-u[this.startColumn-1];if(p<=r&&(this.startColumn-=1),p>=r)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?r+1:r,d=i+r-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||i>u.at(-1)||-1*i-r>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Rc(t,e,n){return(e=s4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s4(t){var e=a4(t,"string");return typeof e=="symbol"?e:e+""}function a4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l4{constructor(){Rc(this,"count",0),Rc(this,"startRow",null),Rc(this,"endRow",null),Rc(this,"startPosition",null),Rc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:o,rowHeight:s}=n;i>=r&&i+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=r-o&&(this.startRow-=1),d>=r-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=i+r-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||i>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ec(t,e,n){return(e=u4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u4(t){var e=c4(t,"string");return typeof e=="symbol"?e:e+""}function c4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cH{constructor(){Ec(this,"count",0),Ec(this,"startColumn",null),Ec(this,"endColumn",null),Ec(this,"startPosition",null),Ec(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:o}=n;i<=r&&(this.startColumn=e);const s=r>0?o+1:o;i>=r&&i<=r+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>r)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?r+1:r;i+r-h<-1*o||i>u.at(-1)+c||-1*i-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Tc(t,e,n){return(e=h4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h4(t){var e=d4(t,"string");return typeof e=="symbol"?e:e+""}function d4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hH{constructor(){Tc(this,"count",0),Tc(this,"startRow",null),Tc(this,"endRow",null),Tc(this,"startPosition",null),Tc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:o}=n;i<=r&&(this.startRow=e),i>=r&&i<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=r-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,i+r-o<0||i>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Mc(t,e,n){return(e=f4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f4(t){var e=g4(t,"string");return typeof e=="symbol"?e:e+""}function g4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m4{constructor(){Mc(this,"count",0),Mc(this,"startColumn",0),Mc(this,"endColumn",0),Mc(this,"startPosition",0),Mc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function _c(t,e,n){return(e=p4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p4(t){var e=w4(t,"string");return typeof e=="symbol"?e:e+""}function w4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v4{constructor(){_c(this,"count",0),_c(this,"startRow",0),_c(this,"endRow",0),_c(this,"startPosition",0),_c(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function WM(t,e,n){return(e=C4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C4(t){var e=y4(t,"string");return typeof e=="symbol"?e:e+""}function y4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S4 extends cH{constructor(){super(...arguments),WM(this,"columnStartOffset",0),WM(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalColumns:r,startPositions:o}=e;if(this.startColumn!==null&&typeof i=="function"){const s=this.startColumn,a=this.endColumn;i(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,r<this.endColumn&&(this.endColumn=r-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function BM(t,e,n){return(e=b4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b4(t){var e=R4(t,"string");return typeof e=="symbol"?e:e+""}function R4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E4 extends hH{constructor(){super(...arguments),BM(this,"rowStartOffset",0),BM(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalRows:r,startPositions:o}=e;if(this.startRow!==null&&typeof i=="function"){const s=this.startRow,a=this.endRow;i(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,r<this.endRow&&(this.endRow=r-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function jM(t,e,n){return(e=T4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T4(t){var e=M4(t,"string");return typeof e=="symbol"?e:e+""}function M4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dH{constructor(e){jM(this,"calculationTypes",[]),jM(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[i,r]=n;this.calculationResults.set(i,r),r.initialize(e)})}_process(e,n){this.calculationTypes.forEach(i=>{let[,r]=i;return r.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,i]=n;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function er(t,e,n){return(e=_4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _4(t){var e=I4(t,"string");return typeof e=="symbol"?e:e+""}function I4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Wu=50;class P4 extends dH{constructor(e){let{calculationTypes:n,viewportWidth:i,scrollOffset:r,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),er(this,"viewportWidth",0),er(this,"scrollOffset",0),er(this,"zeroBasedScrollOffset",0),er(this,"totalColumns",0),er(this,"columnWidthFn",null),er(this,"columnWidth",0),er(this,"overrideFn",null),er(this,"inlineStartOffset",0),er(this,"totalCalculatedWidth",0),er(this,"startPositions",[]),er(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?Wu:n}}function Oi(t,e,n){return(e=O4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O4(t){var e=x4(t,"string");return typeof e=="symbol"?e:e+""}function x4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H4 extends dH{constructor(e){let{calculationTypes:n,viewportHeight:i,scrollOffset:r,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),Oi(this,"viewportHeight",0),Oi(this,"scrollOffset",0),Oi(this,"zeroBasedScrollOffset",0),Oi(this,"totalRows",0),Oi(this,"rowHeightFn",null),Oi(this,"rowHeight",0),Oi(this,"overrideFn",null),Oi(this,"horizontalScrollbarHeight",0),Oi(this,"innerViewportHeight",0),Oi(this,"totalCalculatedHeight",0),Oi(this,"startPositions",[]),Oi(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u!=null?u:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function A4(t,e,n){N4(t,e),e.set(t,n)}function N4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UM(t,e,n){return(e=D4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D4(t){var e=$4(t,"string");return typeof e=="symbol"?e:e+""}function $4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pl(t,e){return t.get(fH(t,e))}function zM(t,e,n){return t.set(fH(t,e),n),n}function fH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ro=new WeakMap;class Mm{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;UM(this,"row",null),UM(this,"col",null),A4(this,Ro,!1),zM(Ro,this,i),typeof e!="undefined"&&typeof n!="undefined"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:i,countRowHeaders:r,countColHeaders:o}=Me({countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0},e);return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-r||this.row>=n||this.col>=i)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Pl(Ro,this)}isSouthEastOf(e){return this.row>=e.row&&(Pl(Ro,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Pl(Ro,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Pl(Ro,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Pl(Ro,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Mm&&zM(Ro,this,e.isRtl()),this}clone(){return new Mm(this.row,this.col,Pl(Ro,this))}toObject(){return{row:this.row,col:this.col}}}var _m=Mm;function L4(t,e,n){k4(t,e),e.set(t,n)}function k4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rv(t,e,n){return(e=F4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F4(t){var e=V4(t,"string");return typeof e=="symbol"?e:e+""}function V4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xi(t,e){return t.get(gH(t,e))}function W4(t,e,n){return t.set(gH(t,e),n),n}function gH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Qn=new WeakMap;class Rb{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;rv(this,"highlight",null),rv(this,"from",null),rv(this,"to",null),L4(this,Qn,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=i.clone(),W4(Qn,this,r)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:i}=e,r=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<=n&&o.row>=n&&r.col<=i&&o.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(i.row,s.row),u=Math.min(i.col,s.col),c=Math.max(r.row,a.row),h=Math.max(r.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return xi(Qn,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return xi(Qn,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return xi(Qn,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return xi(Qn,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return xi(Qn,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return xi(Qn,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return xi(Qn,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return xi(Qn,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof _m))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return n.top===i.top&&r.push("top"),n.right===i.right&&r.push(xi(Qn,this)?"left":"right"),n.bottom===i.bottom&&r.push("bottom"),n.left===i.left&&r.push(xi(Qn,this)?"right":"left"),r}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let o=e.col;o<=n.col;o++)!(this.from.row===r&&this.from.col===o)&&!(this.to.row===r&&this.to.col===o)&&i.push(this._createCellCoords(r,o));return i}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let o=e.col;o<=n.col;o++)e.row===r&&e.col===o?i.push(e):n.row===r&&n.col===o?i.push(n):i.push(this._createCellCoords(r,o));return i}forAll(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let r=n.row;r<=i.row;r++)for(let o=n.col;o<=i.col;o++)if(e(r,o)===!1)return}clone(){return new Rb(this.highlight,this.from,this.to,xi(Qn,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new _m(e,n,xi(Qn,this))}}var Eb=Rb;function Nr(t,e,n){B4(t,e),e.set(t,n)}function B4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function he(t,e){return t.get(mH(t,e))}function gs(t,e,n){return t.set(mH(t,e),n),n}function mH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hi=new WeakMap,ov=new WeakMap,gn=new WeakMap,Ol=new WeakMap,hf=new WeakMap,tr=new WeakMap,sv=new WeakMap,Ic=new WeakMap,la=new WeakMap,Dr=new WeakMap;class j4{constructor(e,n,i,r,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Nr(this,Hi,void 0),Nr(this,ov,void 0),Nr(this,gn,void 0),Nr(this,Ol,void 0),Nr(this,hf,void 0),Nr(this,tr,void 0),Nr(this,sv,void 0),Nr(this,Ic,void 0),Nr(this,la,[null,null]),Nr(this,Dr,[null,null]),gs(Hi,this,i),gs(ov,this,n),gs(gn,this,o),gs(Ol,this,s),gs(hf,this,a),gs(tr,this,r),gs(sv,this,e),this.registerEvents()}registerEvents(){he(tr,this).addEventListener(he(gn,this).holder,"contextmenu",i=>this.onContextMenu(i)),he(tr,this).addEventListener(he(gn,this).TABLE,"mouseover",i=>this.onMouseOver(i)),he(tr,this).addEventListener(he(gn,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{he(tr,this).addEventListener(he(gn,this).holder,"touchstart",i=>this.onTouchStart(i)),he(tr,this).addEventListener(he(gn,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),he(tr,this).addEventListener(he(gn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||he(Hi,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,he(Hi,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{he(tr,this).addEventListener(he(gn,this).holder,"mouseup",i=>this.onMouseUp(i)),he(tr,this).addEventListener(he(gn,this).holder,"mousedown",i=>this.onMouseDown(i))};qo()?e():(Y1()&&e(),n())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if(he(Ic,this)&&i){const[r,o]=[i.row,he(Ic,this).from.row],[s,a]=[i.col,he(Ic,this).from.col];return r===o&&s===a}return!1}parentCell(e){const n={},i=he(gn,this).TABLE,r=of(e,["TD","TH"],i);return r?(n.coords=he(gn,this).getCoords(r),n.TD=r):pe(e,"wtBorder")&&pe(e,"current")?(n.coords=he(Ol,this).getFocusSelection().cellRange.highlight,n.TD=he(gn,this).getCell(n.coords)):pe(e,"wtBorder")&&pe(e,"area")&&he(Ol,this).getAreaSelection().cellRange&&(n.coords=he(Ol,this).getAreaSelection().cellRange.to,n.TD=he(gn,this).getCell(n.coords)),n}onMouseDown(e){const n=he(ov,this).rootDocument.activeElement,i=W1(a3,e.target),r=e.target;if(!["TD","TH"].includes(n.nodeName)&&(r===n||i(0)===n||i(1)===n))return;const o=this.parentCell(r);pe(r,"corner")?he(Hi,this).getSetting("onCellCornerMouseDown",e,r):o.TD&&he(Hi,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(he(Dr,this)[0]=o.TD,clearTimeout(he(la,this)[0]),he(la,this)[0]=setTimeout(()=>{he(Dr,this)[0]=null},1e3))}onContextMenu(e){if(he(Hi,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!he(Hi,this).has("onCellMouseOver"))return;const n=he(gn,this).TABLE,i=of(e.target,["TD","TH"],n),r=he(hf,this)||this;i&&i!==r.lastMouseOver&&rl(i,n)&&(r.lastMouseOver=i,this.callListener("onCellMouseOver",e,he(gn,this).getCoords(i),i))}onMouseOut(e){if(!he(Hi,this).has("onCellMouseOut"))return;const n=he(gn,this).TABLE,i=of(e.target,["TD","TH"],n),r=of(e.relatedTarget,["TD","TH"],n),o=he(hf,this)||this;i&&i!==r&&rl(i,n)&&(this.callListener("onCellMouseOut",e,he(gn,this).getCoords(i),i),r===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&he(Hi,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===he(Dr,this)[0]&&n.TD===he(Dr,this)[1]?(pe(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),he(Dr,this)[0]=null,he(Dr,this)[1]=null):n.TD===he(Dr,this)[0]&&(he(Dr,this)[1]=n.TD,clearTimeout(he(la,this)[1]),he(la,this)[1]=setTimeout(()=>{he(Dr,this)[1]=null},500)))}onTouchStart(e){gs(Ic,this,he(Ol,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const i=e.target,r=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,o=re(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&o&&he(Hi,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];X1()&&(V3()||W3())&&this.selectedCellWasTouched(i)&&!a.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,i,r){const o=he(Hi,this).getSettingPure(e);o&&o(n,i,r,he(sv,this).call(this))}destroy(){clearTimeout(he(la,this)[0]),clearTimeout(he(la,this)[1]),he(tr,this).destroy()}}var pH=j4;function av(t,e,n){return(e=U4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U4(t){var e=z4(t,"string");return typeof e=="symbol"?e:e+""}function z4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Y4{constructor(e,n,i){av(this,"offset",void 0),av(this,"total",void 0),av(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}var G4=Y4;function lv(t,e,n){return(e=K4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K4(t){var e=X4(t,"string");return typeof e=="symbol"?e:e+""}function X4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q4{constructor(e,n,i){lv(this,"offset",void 0),lv(this,"total",void 0),lv(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}var Z4=q4;function df(t,e,n){return(e=Q4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q4(t){var e=J4(t,"string");return typeof e=="symbol"?e:e+""}function J4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e6{constructor(){df(this,"currentSize",0),df(this,"nextSize",0),df(this,"currentOffset",0),df(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const t6=0,YM=1,Ay=2;function uv(t,e,n){return(e=n6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n6(t){var e=i6(t,"string");return typeof e=="symbol"?e:e+""}function i6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class r6{constructor(){uv(this,"size",new e6),uv(this,"workingSpace",t6),uv(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=YM,e.workingSpace=Ay,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Ay,e.workingSpace=YM,this.sharedSize=e.getViewSize()}}var GM=mp,o6=TypeError,s6=function(t,e){if(!delete t[e])throw new o6("Cannot delete property "+GM(e)+" of "+GM(t))},a6=dt,l6=Gu,u6=Xu,c6=kO,h6=s6,d6=FO,f6=[].unshift(0)!==1,g6=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},m6=f6||!g6();a6({target:"Array",proto:!0,arity:1,forced:m6},{unshift:function(e){var n=l6(this),i=u6(n),r=arguments.length;if(r){d6(i+r);for(var o=i;o--;){var s=o+r;o in n?n[s]=n[o]:h6(n,s)}for(var a=0;a<r;a++)n[a]=arguments[a]}return c6(n,i+r)}});function p6(t,e,n){return(e=w6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w6(t){var e=v6(t,"string");return typeof e=="symbol"?e:e+""}function v6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KM{constructor(e,n){p6(this,"order",[]),this.order=[...Array(n).keys()].map(i=>e+i)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function C6(t,e,n){return(e=y6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y6(t){var e=S6(t,"string");return typeof e=="symbol"?e:e+""}function S6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b6{constructor(e){C6(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:i}=e.getViewSize();let r=Math.max(i,n);if(r===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new KM(o,n),l=new KM(s,i),u=[];for(let c=0;c<r;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(Ay)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),i<=a.length&&(r-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function xl(t,e,n){return(e=R6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R6(t){var e=E6(t,"string");return typeof e=="symbol"?e:e+""}function E6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wH{constructor(e,n){xl(this,"rootNode",void 0),xl(this,"nodesPool",void 0),xl(this,"sizeSet",new r6),xl(this,"collectedNodes",[]),xl(this,"viewDiffer",new b6(this.sizeSet)),xl(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[i,r,o,s]=e,a=this.nodesPool(r);switch(this.collectedNodes.push(a),i){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class vH extends wH{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function XM(t,e,n){return(e=T6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T6(t){var e=M6(t,"string");return typeof e=="symbol"?e:e+""}function M6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _6{constructor(e){XM(this,"nodeType",void 0),XM(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const r=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(r))return this.pool.get(r);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(r,o),o}}function Pc(t,e,n){return(e=I6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I6(t){var e=P6(t,"string");return typeof e=="symbol"?e:e+""}function P6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Id{constructor(e,n){Pc(this,"nodesPool",null),Pc(this,"nodeType",void 0),Pc(this,"rootNode",void 0),Pc(this,"table",null),Pc(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new _6(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function qM(t,e,n){return(e=O6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O6(t){var e=x6(t,"string");return typeof e=="symbol"?e:e+""}function x6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H6 extends Id{constructor(){super("TH"),qM(this,"orderViews",new WeakMap),qM(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new vH(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:i,rows:r,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=r.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(i).setOffset(0).start();for(let h=0;h<i;h++){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),tc(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ve(d,[VK(),XK(),lb(h+1),bl(-1)]),n[h](a,d,h)}u.end()}}}class A6 extends Id{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,o=r+n;for(let a=0,l=e;a<l;a++){for(i=this.rootNode.childNodes[a],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<o;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)i.removeChild(i.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&rs(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&ve(this.rootNode,[b1()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:i,columnsToRender:r,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&ve(s,[Ty(),M1(n+1)]);for(let a=-1*o;a<r;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),tc(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ve(u,[lb(a+1+this.table.rowHeadersCount),bl(-1),WK(),...a>=0?[KK()]:[Ty()]]),i[n](l,u,n)}}}}let ZM=!1;class N6 extends Id{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,i=e+n;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!ZM&&e>1e3&&(ZM=!0,qe(tt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let r=0;r<n;r++){const o=this.table.renderedColumnToSource(r),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[r].style.width=`${s}px`}for(let r=0;r<e;r++){const o=this.table.renderedColumnToSource(r),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[r+n].style.width=`${s}px`}const i=this.rootNode.firstChild;i&&U(i,"rowHeader")}}function D6(t,e,n){return(e=$6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $6(t){var e=L6(t,"string");return typeof e=="symbol"?e:e+""}function L6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Hl={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let QM=!1;class k6 extends Id{constructor(e){super("TR",e),D6(this,"orderView",void 0),this.orderView=new wH(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!QM&&e>1e3&&(QM=!0,qe(tt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&ve(this.rootNode,[b1()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(r);if(this.table.isAriaEnabled()){var n,i;ve(o,[Ty(),M1(s+((n=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?pe(o,Hl.rowEven)||(ge(o,Hl.rowOdd),U(o,Hl.rowEven)):pe(o,Hl.rowOdd)||(ge(o,Hl.rowEven),U(o,Hl.rowOdd))}this.orderView.end()}}function JM(t,e,n){return(e=F6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F6(t){var e=V6(t,"string");return typeof e=="symbol"?e:e+""}function V6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class W6 extends Id{constructor(){super("TD"),JM(this,"orderViews",new WeakMap),JM(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new vH(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:i,rowHeaders:r}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=i.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=r.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),p=c.getCurrentNode();if(pe(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),tc(p,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,p),this.table.isAriaEnabled()){var o,s;ve(p,[...p.hasAttribute("role")?[]:[FK()],bl(-1),lb(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function Qt(t,e,n){return(e=B6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B6(t){var e=j6(t,"string");return typeof e=="symbol"?e:e+""}function j6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class U6{constructor(e){let{cellRenderer:n,stylesHandler:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Qt(this,"rootNode",void 0),Qt(this,"rootDocument",void 0),Qt(this,"rowHeaders",null),Qt(this,"columnHeaders",null),Qt(this,"colGroup",null),Qt(this,"rows",null),Qt(this,"cells",null),Qt(this,"rowFilter",null),Qt(this,"columnFilter",null),Qt(this,"rowUtils",null),Qt(this,"columnUtils",null),Qt(this,"rowsToRender",0),Qt(this,"columnsToRender",0),Qt(this,"rowHeaderFunctions",[]),Qt(this,"rowHeadersCount",0),Qt(this,"columnHeaderFunctions",[]),Qt(this,"columnHeadersCount",0),Qt(this,"cellRenderer",void 0),Qt(this,"activeOverlayName",void 0),Qt(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=i}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:i,rows:r,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),i.setTable(this),r.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=i,this.rows=r,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let i=0;i<e;i++){const r=n.getRenderedNode(i),o=this.rowUtils;if(r.firstChild){const s=this.renderedRowToSource(i),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?r.firstChild.style.height=`${a-u}px`:r.firstChild.style.height=""}}}}class z6{constructor(){let{TABLE:e,THEAD:n,COLGROUP:i,TBODY:r,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new U6(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new H6,columnHeaders:new A6(n),colGroup:new N6(i),rows:new k6(r),cells:new W6}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function cv(t,e,n){return(e=Y6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y6(t){var e=G6(t,"string");return typeof e=="symbol"?e:e+""}function G6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class K6{constructor(e,n){cv(this,"dataAccessObject",void 0),cv(this,"wtSettings",void 0),cv(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(n=n?Math.max(n,i):i),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const i=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let o=0;o<i;o++){let s=Array.isArray(n)?n[o]:n;s=s==null?r:s,this.headerWidths.set(o,s)}}}}function e_(t,e,n){return(e=X6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X6(t){var e=q6(t,"string");return typeof e=="symbol"?e:e+""}function q6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Z6{constructor(e,n){e_(this,"dataAccessObject",void 0),e_(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}getHeightByOverlayName(e,n){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(i=i===void 0?r:Math.max(i,r)),i}}function $r(t,e,n){return(e=Q6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q6(t){var e=J6(t,"string");return typeof e=="symbol"?e:e+""}function J6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e9{constructor(e,n,i,r,o){$r(this,"wtSettings",null),$r(this,"domBindings",void 0),$r(this,"TBODY",null),$r(this,"THEAD",null),$r(this,"COLGROUP",null),$r(this,"hasTableHeight",!0),$r(this,"hasTableWidth",!0),$r(this,"isTableVisible",!1),$r(this,"tableOffset",0),$r(this,"holderOffset",0),this.domBindings=i,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,O1(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new Z6(this.dataAccessObject,this.wtSettings),this.columnUtils=new K6(this.dataAccessObject,this.wtSettings),this.tableRenderer=new z6({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!pe(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&ve(i,[uo()]),i}createHider(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!pe(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ve(i,[uo()]),i}createHolder(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!pe(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",ve(i,[bl(-1)]),n&&n.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&ve(i.parentNode,[uo()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ve(i,[uo()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:i,wtViewport:r}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=xn(this.holder),h=r.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=i.inlineStartOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,p!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=xn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=o>0?this.getFirstRenderedRow():0,p=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new Z4(f,o,c),this.columnFilter=new G4(p,s,l);let S=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),S=y.skipRender!==!0}S&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(so)||this.is(Ks))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(so))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||r.createVisibleCalculators(),i.refresh(!1),i.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(so)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(d=i.bottomOverlay.resetFixedPosition()||d),d=i.inlineStartOverlay.resetFixedPosition()||d,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const r=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,o=this.getColumnHeaderHeight(i),s=this.getColumnHeader(n,i),s&&(a=_h(s),(!o&&r<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=a),Array.isArray(l)?l[i]!==null&&l[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(l[i]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders");for(let o=0,s=r.length;o<s;o++)if(i[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${i[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(so))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let r=0;r<i;r++){const o=this.rowFilter.renderedToSource(r);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,i=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",n,i,!this.isMaster,"render");if(r&&Array.isArray(r)&&([n,i]=r),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!s&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,i=null;if(e<0){var r;n=(r=this.rowFilter)===null||r===void 0?void 0:r.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(r=>{const o=r.childNodes[i];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(n>=i)return;const r=this.rowFilter.sourceToRendered(e),o=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,a=(r<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[r];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=al(n,["TD","TH"])),n===null)return null;const i=n.parentNode,r=i.parentNode;let o=c3(i),s=n.cellIndex;sa(dl,n,this.wtRootElement)||sa(cl,n,this.wtRootElement)?r.nodeName==="THEAD"&&(o-=r.childNodes.length):sa(Ks,n,this.wtRootElement)||sa(so,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-r.childNodes.length+o:r===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),sa(dl,n,this.wtRootElement)||sa(hl,n,this.wtRootElement)||sa(Ks,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),i=_h(this.TBODY)-1,r=this.wot.stylesHandler.areCellsBorderBox(),o=r?tn:_h,s=r?0:1,a=r?1:0;let l,u,c,h,d;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const f=c===0?a:0;d?u=o(d):u=o(h)-s,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-f||l<u)&&(r||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Yt(this.TABLE)}getHeight(){return tn(this.TABLE)}getTotalWidth(){const e=Yt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=tn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Vu(this.TABLE)}_modifyRowHeaderWidth(e){let n=gt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}var ic=e9;const t9="stickyRowsBottom",CH={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};hs(CH,"MIXIN_NAME",t9,{writable:!1,enumerable:!1});var yH=CH;const n9="stickyColumnsStart",SH={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};hs(SH,"MIXIN_NAME",n9,{writable:!1,enumerable:!1});var Tb=SH;class Mb extends ic{constructor(e,n,i,r){super(e,n,i,r,Ks)}}lt(Mb,yH);lt(Mb,Tb);var i9=Mb;const cl="top",so="bottom",hl="inline_start",dl="top_inline_start_corner",Ks="bottom_inline_start_corner",bH=[cl,so,hl,dl,Ks],r9=new Map([[cl,`ht_clone_${cl}`],[so,`ht_clone_${so}`],[hl,`ht_clone_${hl} ht_clone_left`],[dl,`ht_clone_${dl} ht_clone_top_left_corner`],[Ks,`ht_clone_${Ks} ht_clone_bottom_left_corner`]]);function o9(t,e){s9(t,e),e.add(t)}function s9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a9(t,e,n){return(e=l9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l9(t){var e=u9(t,"string");return typeof e=="symbol"?e:e+""}function u9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ff(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Oc=new WeakSet;class c9{constructor(e){o9(this,Oc),a9(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,i){if(e.col<0||e.row<0)return!1;const r=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,i);return r||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalColumns:r}=this.dataAccessObject;if(!i)return!1;const o=Mi(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>r)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalRows:r}=this.dataAccessObject;if(!i)return!1;const o=Mi(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>r)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>r-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return ff(Oc,this,n_).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return ff(Oc,this,n_).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return ff(Oc,this,t_).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return ff(Oc,this,t_).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function t_(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:i,wtViewport:r,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=xn(i.wtRootElement).left;const u=Math.abs(H1(s,s));if(l>u){const c=A1(s);let h=r.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function n_(t){const{topOverlay:e,wtTable:n,wtViewport:i,totalRows:r,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=xn(n.wtRootElement),a=hb(o,o);if(s.top>a){const l=_h(o);let u=i.getColumnHeaderHeight();for(let c=1;c<=r;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}var h9=c9;function Ai(t,e,n){return(e=d9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d9(t){var e=f9(t,"string");return typeof e=="symbol"?e:e+""}function f9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _b{get eventManager(){return new Er(this)}constructor(e,n){Ai(this,"wtTable",void 0),Ai(this,"wtScroll",void 0),Ai(this,"wtViewport",void 0),Ai(this,"wtOverlays",void 0),Ai(this,"selectionManager",void 0),Ai(this,"wtEvent",void 0),Ai(this,"guid",`wt_${C1()}`),Ai(this,"drawInterrupted",!1),Ai(this,"drawn",!1),Ai(this,"activeOverlayName","master"),Ai(this,"domBindings",void 0),Ai(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new h9(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,i){ll(i,e[n])}])}}createCellCoords(e,n){return new _m(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,i){return new Eb(e,n,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=i-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,i){return this.wtScroll.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function i_(t,e,n){return(e=g9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g9(t){var e=m9(t,"string");return typeof e=="symbol"?e:e+""}function m9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p9 extends _b{constructor(e,n,i){super(e,n),i_(this,"cloneSource",void 0),i_(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.stylesHandler=i.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new pH(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}function w9(t,e,n){return(e=v9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v9(t){var e=C9(t,"string");return typeof e=="symbol"?e:e+""}function C9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pd{constructor(e,n,i,r,o){w9(this,"wtSettings",null),hs(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=r;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Qh(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Qh(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Sm(e.TABLE)}getRelativeCellPosition(e,n,i){if(this.clone.wtTable.holder.contains(e)===!1){qe(`The provided element is not a child of the ${this.type} overlay`);return}const r=this.mainTableScrollableElement===this.domBindings.rootWindow,o=i<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return r?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,i,r){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=r.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+wn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=r.top,{start:i.start+s,top:i.top+a}}getRelativeCellPositionWithinHolder(e,n,i,r,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(i||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:r.start-a,top:r.top-l}}makeClone(){if(bH.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=i.createElement("div"),s=i.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${r9.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&ve(o,[uo()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===cl||u==="vertical"&&this.type===hl?this.mainTableScrollableElement=r:r.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Sm(e.TABLE),new p9(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=e.style,r=n.style,o=e.parentNode.style;[i,r,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class y9 extends Pd{constructor(e,n,i,r,o,s){super(e,n,Ks,i,r),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new i9(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else Hp(n),this.repositionOverlay();let i=tn(this.clone.wtTable.TABLE);const r=Yt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),n.style.height=`${i}px`,n.style.width=`${r}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=wn(i)),r.style.bottom=`${o}px`}}const S9="calculatedColumns",RH={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};hs(RH,"MIXIN_NAME",S9,{writable:!1,enumerable:!1});var Ib=RH;class Pb extends ic{constructor(e,n,i,r){super(e,n,i,r,so)}}lt(Pb,yH);lt(Pb,Ib);var b9=Pb;function R9(t,e,n){return(e=E9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E9(t){var e=T9(t,"string");return typeof e=="symbol"?e:e+""}function T9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M9 extends Pd{constructor(e,n,i,r){super(e,n,so,i,r),R9(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new b9(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let i=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!r||r!=="vertical")?(i=this.getOverlayOffset(),n.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=wn(i)),r.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let i=!1;return this.mainTableScrollableElement===n?(n.scrollTo(cb(n),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:i,stylesHandler:r}=this.wot,o=r.getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=i.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=wn(i)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=tn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let i=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=wn(this.domBindings.rootDocument)),n?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=s,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return hb(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=r-o,a=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+r,0),i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==n,r=this.wtSettings.getSetting("columnHeaders");let o=!1;if((i||n===0)&&r.length>0){const s=this.wot.wtTable.holder.parentNode,a=pe(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(U(s,"innerBorderBottom"),o=!a):(ge(s,"innerBorderBottom"),o=a)}return o}}const _9="calculatedRows",EH={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};hs(EH,"MIXIN_NAME",_9,{writable:!1,enumerable:!1});var TH=EH;class Ob extends ic{constructor(e,n,i,r){super(e,n,i,r,hl)}}lt(Ob,TH);lt(Ob,Tb);var I9=Ob;const P9="localHooks",MH={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,i,r,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)My(this._localHooks[t][l],this,e,n,i,r,o,s)}},clearLocalHooks(){return this._localHooks={},this}};hs(MH,"MIXIN_NAME",P9,{writable:!1,enumerable:!1});var Nn=MH;class _H{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}}lt(_H,Nn);var O9=_H;const IH="active-header",xb="header",Hb="area",Im="focus",x9="fill",H9="row",A9="column",N9="custom-selection",Ab=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),i=e.getCSSVariableValue("cell-autofill-border-width"),r=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:i,borderStyle:"solid",borderColor:r})};var D9=Np;D9("flat");function $9(t,e){PH(t,e),e.add(t)}function r_(t,e,n){PH(t,e),e.set(t,n)}function PH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pt(t,e){return t.get(Ih(t,e))}function o_(t,e,n){return t.set(Ih(t,e),n),n}function Ih(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ar=new WeakMap,_n=new WeakMap,gf=new WeakSet;class L9{constructor(){$9(this,gf),r_(this,ar,void 0),r_(this,_n,void 0)}setActiveOverlay(e){return o_(_n,this,e),this}setActiveSelection(e){return o_(ar,this,e),this}scan(){const e=Pt(ar,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="area"?this.scanCellsRange(i=>n.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i)),this.scanCellsRange(i=>n.add(i))):e==="fill"?this.scanCellsRange(i=>n.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>n.add(i)),this.scanRowsInCellsRange(i=>n.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanColumnsInCellsRange(i=>n.add(i))),n}scanColumnsInHeadersRange(e){const[n,i,r,o]=Pt(ar,this).getCorners(),{wtTable:s}=Pt(_n,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<i||h>o)){for(let d=-l;d<0;d++){if(d<n||d>r)continue;const f=d+l;let p=s.getColumnHeader(h,f);const S=Pt(_n,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Pt(ar,this).settings.selectionType,columnCursor:u,selectionWidth:o-i+1});S!==null&&(S!==h&&(p=s.getColumnHeader(S,f)),e(p))}u+=1}}}scanRowsInHeadersRange(e){const[n,i,r,o]=Pt(ar,this).getCorners(),{wtTable:s}=Pt(_n,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>r)){for(let d=-l;d<0;d++){if(d<i||d>o)continue;const f=d+l;let p=s.getRowHeader(h,f);const S=Pt(_n,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Pt(ar,this).settings.selectionType,rowCursor:u,selectionHeight:r-n+1});S!==null&&(S!==h&&(p=s.getRowHeader(S,f)),e(p))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Pt(_n,this);Ih(gf,this,k9).call(this,(i,r)=>{const o=n.getCell(Pt(_n,this).createCellCoords(i,r)),s=Pt(_n,this).getSetting("onAfterDrawSelection",i,r,Pt(ar,this).settings.layerLevel);typeof s=="string"&&U(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,i]=Pt(ar,this).getCorners(),{wtTable:r}=Pt(_n,this);Ih(gf,this,s_).call(this,(o,s)=>{if(o>=n&&o<=i){const a=r.getCell(Pt(_n,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,i]=Pt(ar,this).getCorners(),{wtTable:r}=Pt(_n,this);Ih(gf,this,s_).call(this,(o,s)=>{if(s>=n&&s<=i){const a=r.getCell(Pt(_n,this).createCellCoords(o,s));e(a)}})}}function k9(t){let[e,n,i,r]=Pt(ar,this).getCorners();if(e<0&&i<0||n<0&&r<0)return;const{wtTable:o}=Pt(_n,this),s=e!==i||n!==r;if(n=Math.max(n,0),r=Math.max(r,0),e=Math.max(e,0),i=Math.max(i,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),r=Math.min(r,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),i=Math.min(i,o.getLastRenderedRow()),r<n||i<e)return}else{const a=o.getCell(Pt(_n,this).createCellCoords(e,n));if(!Ys(a))return}for(let a=e;a<=i;a+=1)for(let l=n;l<=r;l+=1)t(a,l)}function s_(t){const{wtTable:e}=Pt(_n,this),n=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let r=0;r<n;r+=1){const o=e.rowFilter.renderedToSource(r);for(let s=0;s<i;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class F9{constructor(e,n){!n||(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Ab(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,i=this.main.childNodes.length;n<i;n++){const r=this.main.childNodes[n];this.eventManager.addEventListener(r,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ir(e);const i=this,r=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(i.eventManager.removeEventListener(r,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(r,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const i=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let a=0;a<5;a++){const l=i[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),r=u.style,r.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,r.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,r.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),qo()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:n}=this.wot,i=n.getCSSVariableValue("cell-mobile-handle-size"),r=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),s=n.getCSSVariableValue("cell-mobile-handle-border-width"),a=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const c={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};Ae(c,(d,f)=>{this.selectionHandles.styles.bottomHitArea[f]=d,this.selectionHandles.styles.topHitArea[f]=d});const h=n.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${r}px`,background:`${o}`,border:`${s}px solid ${a}`};Ae(h,(d,f)=>{this.selectionHandles.styles.bottom[f]=d,this.selectionHandles.styles.top[f]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||n!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,i,r,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),p=parseInt(u.width,10),S=parseInt(c.width,10),y=this.wot.wtTable.getWidth(),R=this.wot.wtTable.getHeight();u.top=`${parseInt(i-p-1,10)}px`,u[l]=`${parseInt(r-p-1,10)}px`,c.top=`${parseInt(i-S/4*3,10)}px`,c[l]=`${parseInt(r-S/4*3,10)}px`;const T=Math.min(parseInt(r+o,10),y-p-f*2),V=Math.min(parseInt(r+o-S/4,10),y-S-f*2);h[l]=`${T}px`,d[l]=`${V}px`;const B=Math.min(parseInt(i+s,10),R-p-f*2),W=Math.min(parseInt(i+s-S/4,10),R-S-f*2);h.top=`${B}px`,d.top=`${W}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,i,r,o]=e;if(n<0&&r<0||i<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==r||i!==o,c=s.getFirstRenderedRow(),h=s.getLastRenderedRow(),d=s.getFirstRenderedColumn(),f=s.getLastRenderedColumn();let p;if(u){if(i=Math.max(i,d),o=Math.min(o,f),n=Math.max(n,c),r=Math.min(r,h),o<i||r<n){this.disappear();return}p=s.getCell(this.wot.createCellCoords(n,i))}else if(p=s.getCell(this.wot.createCellCoords(n,i)),!Ys(p)){this.disappear();return}const S=u?s.getCell(this.wot.createCellCoords(r,o)):p,y=xn(p),R=u?xn(S):y,T=xn(s.TABLE),V=y.top,B=y.left,W=this.wot.wtSettings.getSetting("rtlMode");let $=0,L=0;if(W){const Pe=Yt(s.TABLE),Ke=Yt(p),bt=l.innerWidth-T.left-Pe;L=B+Ke-R.left,$=l.innerWidth-B-Ke-bt-1}else L=R.left+Yt(S)-B,$=B-T.left-1;if(this.isEntireColumnSelected(n,r)){const Pe=n,Ke=this.getDimensionsFromHeader("columns",i,o,Pe,T);let bt=null;Ke&&([bt,$,L]=Ke),bt&&(p=bt)}let z=V-T.top-1,ie=R.top+tn(S)-V;if(this.isEntireRowSelected(i,o)){const Pe=i,Ke=this.getDimensionsFromHeader("rows",n,r,Pe,T);let bt=null;Ke&&([bt,z,ie]=Ke),bt&&(p=bt)}const K=l.getComputedStyle(p);parseInt(K.borderTopWidth,10)>0&&(z+=1,ie=ie>0?ie-1:0),parseInt(K[W?"borderRightWidth":"borderLeftWidth"],10)>0&&($+=1,L=L>0?L-1:0);const te=W?"right":"left";this.topStyle.top=`${z}px`,this.topStyle[te]=`${$}px`,this.topStyle.width=`${L}px`,this.topStyle.display="block",this.startStyle.top=`${z}px`,this.startStyle[te]=`${$}px`,this.startStyle.height=`${ie}px`,this.startStyle.display="block";const se=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${z+ie-se}px`,this.bottomStyle[te]=`${$}px`,this.bottomStyle.width=`${L}px`,this.bottomStyle.display="block",this.endStyle.top=`${z}px`,this.endStyle[te]=`${$+L-se}px`,this.endStyle.height=`${ie+1}px`,this.endStyle.display="block";let Ce=this.settings.border.cornerVisible;Ce=typeof Ce=="function"?Ce(this.settings.layerLevel):Ce;const be=this.wot.getSetting("onModifyGetCellCoords",r,o,!1,"render");let[je,jt]=[r,o];if(be&&Array.isArray(be)&&([,,je,jt]=be),qo()||!Ce||this.isPartRange(je,jt))this.cornerStyle.display="none";else{this.cornerStyle.top=`${z+ie+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[te]=`${$+L+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Pe=Qh(s.TABLE);const Ke=Pe===l;Ke&&(Pe=a.documentElement);const bt=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,qt=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),g=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const m=Ke?S.getBoundingClientRect().left:S.offsetLeft;let w=!1,b=0;W?(b=m-parseInt(this.cornerDefaultStyle.width,10)/2,w=b<0):(b=m+Yt(S)+parseInt(this.cornerDefaultStyle.width,10)/2,w=b>=A1(Pe)),w&&(this.cornerStyle[te]=`${Math.floor($+L+this.cornerCenterPointOffset-qt-bt)}px`,this.cornerStyle[W?"borderLeftWidth":"borderRightWidth"]=0)}if(r===this.wot.getSetting("totalRows")-1){const b=(Ke?S.getBoundingClientRect().top:S.offsetTop)+tn(S)+parseInt(this.cornerDefaultStyle.height,10)/2>=_h(Pe),P=this.wot.stylesHandler.isClassicTheme();if(b){const k=Math.floor(z+ie+this.cornerCenterPointOffset-g-bt);P?(this.cornerStyle.top=`${k}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${k-1}px`}}this.cornerStyle.display="block"}qo()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(r,o,z,$,L,ie)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,i,r,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,p=null,S=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return tn(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return Yt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const y=this.wot.getSetting("columnHeaders").length;if(p=l(n,y-r),S=l(i,y-r),!p||!S)return!1;const R=xn(p),T=xn(S);return p&&S&&(h=R[f]-o[f]-1,d=T[f]+u(S)-R[f]),[p,h,d]}return!1}changeBorderStyle(e,n){const i=this[e].style,r=n[e];!r||r.hide?U(this[e],"hidden"):(pe(this[e],"hidden")&&ge(this[e],"hidden"),i.backgroundColor=r.color,(e==="top"||e==="bottom")&&(i.height=`${r.width}px`),(e==="start"||e==="end")&&(i.width=`${r.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},i=this[e].style;i.backgroundColor=n.color,i.width=`${n.width}px`,i.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?U(this[e],"hidden"):ge(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",qo()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}var a_=F9;function V9(t,e){OH(t,e),e.add(t)}function Al(t,e,n){OH(t,e),e.set(t,n)}function OH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oe(t,e){return t.get(Nb(t,e))}function l_(t,e,n){return t.set(Nb(t,e),n),n}function Nb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var In=new WeakMap,si=new WeakMap,hv=new WeakMap,wh=new WeakMap,dv=new WeakMap,ua=new WeakMap,u_=new WeakSet;class W9{constructor(e){V9(this,u_),Al(this,In,void 0),Al(this,si,void 0),Al(this,hv,new L9),Al(this,wh,new WeakMap),Al(this,dv,new WeakSet),Al(this,ua,new Map),l_(si,this,e)}setActiveOverlay(e){return l_(In,this,e),Oe(hv,this).setActiveOverlay(Oe(In,this)),Oe(wh,this).has(Oe(In,this))||Oe(wh,this).set(Oe(In,this),new Set),this}getFocusSelection(){return Oe(si,this)!==null?Oe(si,this).getFocus():null}getAreaSelection(){return Oe(si,this)!==null?Oe(si,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Oe(ua,this).has(e)){const i=Oe(ua,this).get(e);if(i.has(Oe(In,this)))return i.get(Oe(In,this));const r=new a_(Oe(In,this),e.settings);return i.set(Oe(In,this),r),r}const n=new a_(Oe(In,this),e.settings);return Oe(ua,this).set(e,new Map([[Oe(In,this),n]])),n}getBorderInstances(e){var n,i;return Array.from((n=(i=Oe(ua,this).get(e))===null||i===void 0?void 0:i.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Oe(ua,this).get(e).forEach(n=>n.destroy()),Oe(ua,this).delete(e)}render(e){if(Oe(si,this)===null)return;e&&Nb(u_,this,B9).call(this);const n=Array.from(Oe(si,this)),i=new Map,r=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;Oe(dv,this).has(s)||(Oe(dv,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&Oe(hv,this).setActiveSelection(s).scan().forEach(p=>{if(i.has(p)){const S=i.get(p);S.has(a)&&u===!0?S.set(a,S.get(a)+1):S.set(a,1)}else i.set(p,new Map([[a,1]]));l&&(r.has(p)||r.set(p,[]),p.nodeName==="TH"&&r.get(p).push(...l))});const d=s.getCorners();Oe(In,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}i.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>Oe(wh,this).get(Oe(In,this)).add(u)),U(s,l),s.nodeName==="TD"&&Array.isArray((a=Oe(si,this).options)===null||a===void 0?void 0:a.cellAttributes)&&ve(s,Oe(si,this).options.cellAttributes)}),Array.from(r.keys()).forEach(o=>{ve(o,[...r.get(o)])})}}function B9(){const t=Oe(wh,this).get(Oe(In,this)),e=Oe(In,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var i,r;const o=Oe(In,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((i=Oe(si,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(s=Oe(si,this).options.cellAttributes.map(a=>a[0])),Array.isArray((r=Oe(si,this).options)===null||r===void 0?void 0:r.headerAttributes)&&(s=[...s,...Oe(si,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)ge(o[a],n),tc(o[a],s)}),t.clear()}class j9 extends Pd{constructor(e,n,i,r){super(e,n,hl,i,r)}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new I9(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!r||r!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),db(i,`${o}px`,"0px")):(o=this.getScrollPosition(),Hp(i));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let i=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,x1(n)),i=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("defaultColumnWidth");let r=e,o=0;for(;r<n;)o+=this.wot.wtTable.getColumnWidth(r)||i,r+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=wn(i)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=Yt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=Ab(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:i}=this,r=i.getSetting("rowHeaders"),o=i.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&r.length>0&&!pe(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=wn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,f3(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(H1(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const r=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=r-o;i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,r=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?ge(i,"emptyRows"):U(i,"emptyRows");let l=!1;if(!a){if(o&&!r.length)U(i,"innerBorderLeft innerBorderInlineStart");else if(!o&&r.length){const u=pe(i,"innerBorderInlineStart");e?(U(i,"innerBorderLeft innerBorderInlineStart"),l=!u):(ge(i,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const U9="stickyRowsTop",xH={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};hs(xH,"MIXIN_NAME",U9,{writable:!1,enumerable:!1});var HH=xH;class Db extends ic{constructor(e,n,i,r){super(e,n,i,r,dl)}}lt(Db,HH);lt(Db,Tb);var z9=Db;function c_(t,e,n){return(e=Y9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y9(t){var e=G9(t,"string");return typeof e=="symbol"?e:e+""}function G9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class K9 extends Pd{constructor(e,n,i,r,o,s){super(e,n,dl,i,r),c_(this,"topOverlay",void 0),c_(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new z9(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const r=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();db(e,`${r}px`,`${o}px`)}else Hp(e);let n=tn(this.clone.wtTable.TABLE);const i=Yt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${i}px`,!1}}class $b extends ic{constructor(e,n,i,r){super(e,n,i,r,cl)}}lt($b,HH);lt($b,Ib);var X9=$b;function q9(t,e,n){return(e=Z9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z9(t){var e=Q9(t,"string");return typeof e=="symbol"?e:e+""}function Q9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J9 extends Pd{constructor(e,n,i,r){super(e,n,cl,i,r),q9(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new X9(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let r=0,o=!1;if(this.trimmingContainer===n&&(!i||i!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,r=this.getOverlayOffset(),db(e,"0px",`${r}px`)}else r=this.getScrollPosition(),Hp(e);const s=this.adjustHeaderBordersPosition(r,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let i=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(cb(n),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const i=this.wot.stylesHandler.getDefaultRowHeight();let r=e,o=0;for(;r<n;){const s=this.wot.wtTable.getRowHeight(r);o+=s===void 0?i:s,r+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=wn(i)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=tn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=Ab(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:i,wtSettings:r}=this,s=(i.cloneSource?i.cloneSource:i).wtTable.holder,a=r.getSetting("columnHeaders"),u=r.getSetting("fixedRowsTop")===0&&a.length>0&&!pe(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=wn(this.domBindings.rootDocument)),n){const d=r.getSetting("fixedRowsBottom"),f=r.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=i.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return c+=h,d3(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return hb(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=r-o;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,r=this.wot.wtTable.holder.parentNode,o=i.getSetting("totalColumns"),s=i.getSetting("preventOverflow")==="horizontal";o?ge(r,"emptyColumns"):U(r,"emptyColumns");let a=!1;if(!n&&!s){const l=i.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=i.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=pe(r,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(U(r,"innerBorderTop"),a=!h):(ge(r,"innerBorderTop"),a=h)}}return a}}function mf(t,e,n){e5(t,e),e.set(t,n)}function e5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eo(t,e,n){return(e=t5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t5(t){var e=n5(t,"string");return typeof e=="symbol"?e:e+""}function n5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ca(t,e,n){return t.set(AH(t,e),n),n}function To(t,e){return t.get(AH(t,e))}function AH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Nl=new WeakMap,pf=new WeakMap,Dl=new WeakMap,wf=new WeakMap;class i5{constructor(e,n,i,r,o,s){Eo(this,"wot",null),mf(this,Nl,[]),Eo(this,"topOverlay",null),Eo(this,"bottomOverlay",null),Eo(this,"inlineStartOverlay",null),Eo(this,"topInlineStartCornerOverlay",null),Eo(this,"bottomInlineStartCornerOverlay",null),Eo(this,"browserLineHeight",void 0),Eo(this,"wtSettings",null),mf(this,pf,!1),mf(this,Dl,0),mf(this,wf,null),Eo(this,"resizeObserver",new ResizeObserver(c=>{Rm(()=>{!Array.isArray(c)||!c.length||(ca(Dl,this,To(Dl,this)+1),To(Dl,this)===100&&(qe("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),To(wf,this)!==null&&clearTimeout(To(wf,this)),ca(wf,this,setTimeout(()=>{ca(Dl,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=r,this.domBindings=i,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=wn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Sm(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...To(Nl,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,i=e.getComputedStyle(n.body),r=parseInt(i.lineHeight,10),o=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=r||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new J9(...e),this.bottomOverlay=new M9(...e),this.inlineStartOverlay=new j9(...e),this.topInlineStartCornerOverlay=new K9(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new y9(...e,this.bottomOverlay,this.inlineStartOverlay),ca(Nl,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){ca(pf,this,To(Nl,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),To(Nl,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),To(Nl,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(!!this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0}),i!==r&&this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!G1())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{Rm(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{ca(Dl,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(r!==n&&o!==n&&!e.target.contains(r)||i!==n&&o!==n&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==i&&s!==i&&!s.contains(o),l=r!==i&&s!==i&&!s.contains(r);if(this.keyPressed&&(a||l)||this.scrollableElement===i)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==i&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=_d(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);const r=this.scrollVertically(n),o=this.scrollHorizontally(i);return r||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,[r,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==r||this.lastScrollX!==e.scrollX,this.verticalScrolling=i.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=r;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=r)}this.verticalScrolling&&(i.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){if(!To(pf,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),ca(pf,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Sm(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,i=e.clientHeight,r=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),r}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:i}=this.domBindings,r=this.scrollableElement===i,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>r?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),p=()=>r?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),S=f()?1:0,y=p()?1:0;d.width=`${c+y}px`,d.height=`${u+S}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){!this.wtTable.isVisible()||(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return M(n,r=>{!r||r.clone&&r.clone.wtTable.TABLE.contains(e)&&(i=r.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];M(n,i=>{!i||(i.clone.wtTable.TABLE.className=e.className)})}}var r5=i5;function h_(t,e,n){return(e=o5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o5(t){var e=s5(t,"string");return typeof e=="symbol"?e:e+""}function s5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class a5{constructor(e){h_(this,"settings",{}),h_(this,"defaults",Object.freeze(this.getDefaults())),Ae(this.defaults,(n,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(n===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,i)=>{const r=this.getSetting("data",e,n);ll(i,r==null?"":r)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Ae(e,(i,r)=>{this.settings[r]=i}):this.settings[e]=n,this}getSetting(e,n,i,r,o){return typeof this.settings[e]=="function"?this.settings[e](n,i,r,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Lb extends ic{constructor(e,n,i,r){super(e,n,i,r,"master")}alignOverlaysWithTrimmingContainer(){const e=Qh(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,r=bm(e,"height",n),o=bm(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?i.insertBefore(d,e.nextElementSibling):i.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);i.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=r==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Vu(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,i="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[i]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[i]=!0}}}lt(Lb,TH);lt(Lb,Ib);var l5=Lb;class u5{constructor(e,n,i,r,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=i,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new v4:new E4],["fullyVisible",()=>new l4],["partiallyVisible",()=>new hH]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new m4:new S4],["fullyVisible",()=>new o4],["partiallyVisible",()=>new cH]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return n===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=tn(n)>0&&n.clientHeight>0?n.clientHeight:1/0,i}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let r;if(i===n){const o=this.wtSettings.getSetting("totalColumns");r=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>r&&(r=e.documentElement.clientWidth)}else r=i.clientWidth;return r}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,i=e.clientHeight,r=n.offsetHeight;return i<r?!0:r>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,i=e.clientWidth,r=n.offsetWidth;return i<r?!0:r>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let i=0,r=e;for(;r<n;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getWorkspaceOffset(){return xn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=tn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,r=n.length;i<r;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,o=n.length;r<o;r++)i?(this.rowHeaderWidth+=Yt(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,r-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),r-=s),i.holder.clientHeight===i.holder.offsetHeight?o=0:o=wn(this.domBindings.rootDocument),new H4({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:r,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>i.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,r-=a}return i.holder.clientWidth!==i.holder.offsetWidth&&(r-=wn(this.domBindings.rootDocument)),new P4({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:r,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>i.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,i=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:i}=e;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,i=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:r,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),i=Math.min(l,i+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),i=Math.min(l,i+Math.ceil(a/2))),n<r||n===r&&n>0?!1:!(i>o||i===o&&i<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:i}=e;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,i=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:r,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),i=Math.min(l,i+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),i=Math.min(l,i+Math.ceil(a/2))),n<r||n===r&&n>0?!1:!(i>o||i===o&&i<l)}resetHasOversizedColumnHeadersMarked(){Ae(this.hasOversizedColumnHeadersMarked,(e,n,i)=>{i[n]=void 0})}}var c5=u5;function h5(t,e){NH(t,e),e.add(t)}function ha(t,e,n){NH(t,e),e.set(t,n)}function NH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ct(t,e){return t.get(pr(t,e))}function mr(t,e,n){return t.set(pr(t,e),n),n}function pr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const d_=23;var qr=new WeakMap,Go=new WeakMap,kb=new WeakMap,Ny=new WeakMap,Ps=new WeakMap,vh=new WeakMap,ed=new WeakMap,Jr=new WeakSet;class d5{constructor(e){h5(this,Jr),ha(this,qr,void 0),ha(this,Go,void 0),ha(this,kb,void 0),ha(this,Ny,void 0),ha(this,Ps,!0),ha(this,vh,{}),ha(this,ed,{}),mr(Go,this,e.rootTable.parentElement.parentElement),mr(Ny,this,e.rootDocument)}isClassicTheme(){return Ct(Ps,this)}getCSSVariableValue(e){var n;if(Ct(Ps,this))return null;if(Ct(vh,this)[`--ht-${e}`])return Ct(vh,this)[`--ht-${e}`];const i=(n=pr(Jr,this,p5).call(this,`--ht-${e}`))!==null&&n!==void 0?n:pr(Jr,this,DH).call(this,`--ht-${e}`);if(i!==null)return Ct(vh,this)[`--ht-${e}`]=i,i}getStyleForTD(e){var n;return(n=Ct(ed,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(Ct(Ps,this))return d_;const e=pr(Jr,this,f5).call(this);return!e&&pe(Ct(Go,this),"ht-wrapper")?(qe(`The "${Ct(qr,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),mr(Ps,this,!0),this.useTheme(),d_):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){pr(Jr,this,f_).call(this),mr(Ps,this,!0),mr(qr,this,e||void 0);return}e&&e!==Ct(qr,this)&&(Ct(qr,this)&&pr(Jr,this,w5).call(this),mr(qr,this,e),mr(Ps,this,!1),pr(Jr,this,g5).call(this),pr(Jr,this,f_).call(this))}getThemeName(){return Ct(qr,this)}removeClassNames(){pe(Ct(Go,this),Ct(qr,this))&&ge(Ct(Go,this),Ct(qr,this))}}function f5(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function g5(){ge(Ct(Go,this),/ht-theme-.*/g),U(Ct(Go,this),Ct(qr,this))}function f_(){this.isClassicTheme()||mr(kb,this,getComputedStyle(Ct(Go,this)));const t=pr(Jr,this,m5).call(this,["box-sizing","border-bottom-width"]);Ct(ed,this).td=Cn(Me({},Ct(ed,this).td),{"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]})}function m5(t){const e=Ct(Ny,this),n=Ct(Go,this),i=e.createElement("table"),r=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),r.appendChild(o),r.appendChild(s),i.appendChild(r),n.appendChild(i);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(i),u}function p5(t){const e=Math.ceil(parseFloat(pr(Jr,this,DH).call(this,t)));return Number.isNaN(e)?null:e}function DH(t){const e=Ct(kb,this).getPropertyValue(t);return e===""?null:e}function w5(){mr(ed,this,{}),mr(vh,this,{}),mr(Ps,this,!0)}class v5 extends _b{constructor(e,n){super(e,new a5(n)),this.stylesHandler=new d5(this.domBindings);const i=this.wtSettings.getSetting("facade",this);this.wtTable=new l5(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new c5(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new W9(this.wtSettings.getSetting("selections")),this.wtEvent=new pH(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new r5(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],i=[];Ae(e,(r,o)=>{this.wtSettings.getSetting(o).length&&i.push(r),n.push(r)}),ge(this.wtTable.wtRootElement.parentNode,n),U(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var n;if(!bH.includes(e))return null;const i=e.replace(/_([a-z])/g,r=>r[1].toUpperCase());return(n=this.wtOverlays[`${i}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Fb{constructor(e){e instanceof _b?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const i=new Fb(n);return()=>i},this._wot=new v5(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,i){return this._wot.createCellRange(e,n,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,i){return this._wot.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,i,r,o){return this._wot.wtSettings.getSetting(e,n,i,r,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function g_(t){let{isShiftKey:e,isLeftClick:n,isRightClick:i,coords:r,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)r.row>=0&&r.col>=0&&!s.cell?o.setRangeEnd(r):(u||c)&&r.row>=0&&r.col>=0&&!s.cell?o.setRangeEnd(a(r.row,r.col)):u&&r.row<0&&!s.column?o.setRangeEnd(a(l.to.row,r.col)):c&&r.col<0&&!s.row?o.setRangeEnd(a(r.row,l.to.col)):(!u&&!c&&r.col<0||u&&r.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),r.row,r.col):(!u&&!c&&r.row<0||c&&r.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),r.col,r.row);else{const h=!o.inInSelection(r),d=n||i&&h;r.row<0&&r.col>=0&&!s.column?d&&o.selectColumns(r.col,r.col,r.row):r.col<0&&r.row>=0&&!s.row?d&&o.selectRows(r.row,r.row,r.col):r.col>=0&&r.row>=0&&!s.cell?d&&o.setRangeStart(r):r.col<0&&r.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function C5(t){let{isLeftClick:e,coords:n,selection:i,controller:r,cellCoordsFactory:o}=t;if(!e)return;const s=i.isSelectedByRowHeader(),a=i.isSelectedByColumnHeader(),l=i.tableProps.countCols(),u=i.tableProps.countRows();i.markSource("mouse"),a&&!r.column?i.setRangeEnd(o(u-1,n.col)):s&&!r.row?i.setRangeEnd(o(n.row,l-1)):r.cell||i.setRangeEnd(n),i.markEndSource()}const y5=new Map([["mousedown",g_],["mouseover",C5],["touchstart",g_]]);function m_(t,e){let{coords:n,selection:i,controller:r,cellCoordsFactory:o}=e;y5.get(t.type)({coords:n,selection:i,controller:r,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:pb(t)||t.type==="touchstart",isRightClick:ul(t)})}const $H=new WeakMap,Vb=Symbol("rootInstance");function S5(t){$H.set(t,!0)}function b5(t){return t===Vb}function Xg(t){return $H.has(t)}function R5(t,e){LH(t,e),e.add(t)}function ms(t,e,n){LH(t,e),e.set(t,n)}function LH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ps(t,e,n){return(e=E5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E5(t){var e=T5(t,"string");return typeof e=="symbol"?e:e+""}function T5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ut(t,e){return t.get(Au(t,e))}function Jn(t,e,n){return t.set(Au(t,e),n),n}function Au(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fv=new WeakMap,vf=new WeakMap,Cf=new WeakMap,Mo=new WeakMap,nr=new WeakMap,gv=new WeakMap,mv=new WeakMap,$l=new WeakMap,Ch=new WeakSet;class M5{constructor(e){R5(this,Ch),ps(this,"hot",void 0),ps(this,"eventManager",void 0),ps(this,"settings",void 0),ps(this,"THEAD",void 0),ps(this,"TBODY",void 0),ps(this,"_wt",void 0),ps(this,"activeWt",void 0),ms(this,fv,0),ms(this,vf,0),ps(this,"postponedAdjustElementsSize",!1),ms(this,Cf,!1),ms(this,Mo,void 0),ms(this,nr,void 0),ms(this,gv,0),ms(this,mv,0),ms(this,$l,null),this.hot=e,this.eventManager=new Er(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!this.hot.forceFullRender),Au(Ch,this,I5).call(this),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const i=this._wt.getCell(e,n);return i<0?null:i}scrollViewport(e,n,i){return this._wt.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),U(e,"handsontable"),Jn(nr,this,n.createElement("TABLE")),U(Ut(nr,this),"htCore"),this.hot.getSettings().tableClassName&&U(Ut(nr,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(ve(Ut(nr,this),[uo()]),ve(e,[kK(),T1(-1),Op(this.hot.countCols()),QK()])),this.THEAD=n.createElement("THEAD"),Ut(nr,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),Ut(nr,this).appendChild(this.TBODY),this.hot.table=Ut(nr,this),this.hot.container.insertBefore(Ut(nr,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:i,rootWindow:r}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{Jn(Cf,this,!0),this.isTextSelectionAllowed(a.target)||(fM(r),a.preventDefault(),r.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Jn(Cf,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{Ut(Cf,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&fM(r),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{i.isInProgress()&&!a.shiftKey&&i.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{i.isInProgress()&&pb(a)&&i.finish(),Jn(Mo,this,!1);const l=L1(n.activeElement);Kg(n.activeElement)&&!l||(l||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!e.contains(a.target)&&!ul(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{i.isInProgress()&&ul(a)&&(i.finish(),Jn(Mo,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{i.isInProgress()&&i.finish(),Jn(Mo,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(Ut(Mo,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const p=wn(n);if(n.elementFromPoint(u+p,c)!==d||n.elementFromPoint(u,c+p)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=Fu(r);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=Fu(s);this.eventManager.addEventListener(Ut(nr,this),"selectstart",a=>{this.settings.fragmentSelection||Kg(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,i))}translateFromRenderableToVisualIndex(e,n){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=e),r===null&&(r=n),[i,r]}countRenderableIndexes(e,n){const i=Math.min(e.getNotTrimmedIndexesLength(),n),r=e.getNearestNotHiddenIndex(i-1,-1);return r===null?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,i,r){if(isNaN(e)||e<0)return 0;const o=i.getNearestNotHiddenIndex(e,n),s=i.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=r-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}countRenderableRowsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&U(i,e)}removeClassNameFromLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&ge(i,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Ut(nr,this),isDataViewInstance:()=>Xg(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Jn(vf,this,o.length),this.hot.getSettings().ariaTags&&Au(Ch,this,kH).call(this)===this.hot.countCols()&&Au(Ch,this,_5).call(this,Ut(vf,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Jn(fv,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),p=this.hot.colToProp(d);let S=this.hot.getDataAtRowProp(h,p);this.hot.hasHook("beforeValueRender")&&(S=this.hot.runHooks("beforeValueRender",S,f)),this.hot.runHooks("beforeRenderer",a,l,u,p,S,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,p,S,f),this.hot.runHooks("afterRenderer",a,l,u,p,S,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Vu(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Jn(Mo,this,!0),Jn($l,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Ka(o)&&(m_(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Jn(Mo,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Ka(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Ka(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Ka(o)&&(Ut(Mo,this)&&(!Ut($l,this)||Ut($l,this).x!==o.clientX||Ut($l,this).y!==o.clientY)&&m_(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,Jn($l,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Ka(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a!=null?a:0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[p,S,y,R]=f;return[p>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(p,1)):p,S>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(S,1)):S,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y,R>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(R,-1)):R]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Fb(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:i,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,r),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(Kg(e))return!0;const n=rl(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Ut(Mo,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const i=n.firstChild;if(!pe(i,"relative")){rs(n),this.appendRowHeader(e,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:r}=this.hot,o=i.createElement("div"),s=i.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,r),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;pe(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,i,r),s.className="",U(s,["relative",...o()])):(rs(n),this.appendColHeader(e,n,i,r))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(ve(a,...uo()),ve(l,...uo())),this.updateCellHeader(l,e,i,r),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,r)}updateCellHeader(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(pe(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):pe(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?nc(e,i(n,r)):(ll(e,String.fromCharCode(160)),U(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,n){Jn(gv,this,e),Jn(mv,this,n)}getLastSize(){return{width:Ut(gv,this),height:Ut(mv,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n!=null?n:0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n!=null?n:this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n!=null?n:0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n!=null?n:this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Ut(fv,this)}getRowHeadersCount(){return Ut(vf,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function kH(){return parseInt(this.hot.rootElement.getAttribute(Op()[0]),10)}function _5(t){const e=Au(Ch,this,kH).call(this)+t;ve(this.hot.rootElement,...Op(e))}function I5(){const t=this.hot.rootElement;this.hasVerticalScroll()?U(t,"htHasScrollY"):ge(t,"htHasScrollY"),this.hasHorizontalScroll()?U(t,"htHasScrollX"):ge(t,"htHasScrollX")}var P5=M5,O5=dt,x5=Zu,H5=hi,A5=on,N5=wo;O5({target:"Iterator",proto:!0,real:!0},{every:function(e){A5(this),H5(e);var n=N5(this),i=0;return!x5(n,function(r,o){if(!e(r,i++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const D5="ABCDEFGHIJKLMNOPQRSTUVWXYZ",p_=D5.length;function $5(t){let e=t+1,n="",i;for(;e>0;)i=(e-1)%p_,n=String.fromCharCode(65+i)+n,e=parseInt((e-i)/p_,10);return n}function FH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const i=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((r,o)=>{Array.isArray(r)?r.forEach((s,a)=>{i.push([o+e,a,s])}):Object.keys(r).forEach(s=>{i.push([o+e,s,r[s]])})}),i}function VH(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&He(t[0])&&(e=mb(t[0]))),e}function L5(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function k5(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function xc(t,e,n){return(e=F5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F5(t){var e=V5(t,"string");return typeof e=="symbol"?e:e+""}function V5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class W5{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];xc(this,"hot",void 0),xc(this,"data",void 0),xc(this,"dataType","array"),xc(this,"colToProp",()=>{}),xc(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return M(this.data,(i,r)=>{const o=this.getAtCell(r,e);n.push(o)}),n}getAtRow(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&i===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):ce(n,i,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(He(a)||gt(a))if(r?l=[]:l={},!o||r){const c=this.countFirstRowKeys()-1;ce(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(i||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);r?l.push(f):s?Yw(l,d,f):l[d]=f}})}else Ae(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Yw(l,c,h):l[c]=h});return l}setAtCell(e,n,i){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=Mi(i);this.hot.runHooks("modifySourceData",e,n,r,"set"),r.isTouched()&&(i=r.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=i:Yw(this.data[e],n,i))}}getAtPhysicalCell(e,n,i){let r=null;if(i)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();r=o?D3(i,n):i[n]}else typeof n=="function"?r=n(i):r=i[n];if(this.hot.hasHook("modifySourceData")){const o=Mi(r);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(r=o.value)}return r}getAtCell(e,n){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=!1,o=null,s=null,a=null,l=null;e===null||n===null?(r=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return ce(o,a,c=>{u.push(r?this.getAtRow(c,void 0,void 0,i):this.getAtRow(c,s,l,i))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return VH(this.data)}destroy(){this.data=null,this.hot=null}}var B5=W5,j5=dt,U5=Zu,z5=hi,Y5=on,G5=wo;j5({target:"Iterator",proto:!0,real:!0},{some:function(e){Y5(this),z5(e);var n=G5(this),i=0;return U5(n,function(r,o){if(e(r,i++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function w_(t,e,n){return(e=K5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K5(t){var e=X5(t,"string");return typeof e=="symbol"?e:e+""}function X5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;w_(this,"indexedValues",[]),w_(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,gt(this.initValueOrFn)?ce(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):ce(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}lt(Rl,Nn);function Wb(t,e,n,i){const r=n.length?n[0]:void 0;return[...t.slice(0,r),...n.map((o,s)=>gt(i)?i(o,s):i),...r===void 0?[]:t.slice(r)]}function Bb(t,e){return sl(t,(n,i)=>e.includes(i)===!1)}class ta extends Rl{insert(e,n){this.indexedValues=Wb(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=Bb(this.indexedValues,e),super.remove(e)}}class $p extends ta{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return di(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}function jb(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function td(t,e){return sl(t,n=>e.includes(n)===!1)}function Ub(t,e){return We(t,n=>n-e.filter(i=>i<n).length)}function zb(t,e){const n=e[0],i=e.length;return We(t,r=>r>=n?r+i:r)}function q5(t,e,n){return(e=Z5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z5(t){var e=Q5(t,"string");return typeof e=="symbol"?e:e+""}function Q5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lp extends Rl{constructor(){super(...arguments),q5(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=td(this.orderOfIndexes,[e]),gt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=Wb(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=zb(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=Bb(this.indexedValues,e),this.orderOfIndexes=td(this.orderOfIndexes,e),this.orderOfIndexes=Ub(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Od extends ta{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return di(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}const v_=new Map([["indexesSequence",{getListWithInsertedItems:jb,getListWithRemovedItems:td}],["physicallyIndexed",{getListWithInsertedItems:Wb,getListWithRemovedItems:Bb}]]),WH=t=>{if(v_.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return v_.get(t)};class BH extends Rl{constructor(){super(e=>e)}insert(e,n){const i=zb(this.indexedValues,n);this.indexedValues=jb(i,e,n),super.insert(e,n)}remove(e){const n=td(this.indexedValues,e);this.indexedValues=Ub(n,e),super.remove(e)}}const C_=new Map([["hiding",$p],["index",Rl],["linkedPhysicalIndexToValue",Lp],["physicalIndexToValue",ta],["trimming",Od]]);function J5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!C_.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(C_.get(t))(e)}function e8(t,e,n){return(e=t8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t8(t){var e=n8(t,"string");return typeof e=="symbol"?e:e+""}function n8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yb{constructor(){e8(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)))}unregister(e){const n=this.collection.get(e);re(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n))}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Tt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(i=>{i.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}lt(Yb,Nn);function pv(t,e,n){return(e=i8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i8(t){var e=r8(t,"string");return typeof e=="symbol"?e:e+""}function r8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y_ extends Yb{constructor(e,n){super(),pv(this,"mergedValuesCache",[]),pv(this,"aggregationFunction",void 0),pv(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=We(this.get(),o=>o.getValues()),i=[],r=re(n[0])&&n[0].length||0;for(let o=0;o<r;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);i.push(s)}return We(i,this.aggregationFunction)}getMergedValueAtIndex(e,n){const i=this.getMergedValues(n)[e];return re(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function o8(t,e,n){s8(t,e),e.set(t,n)}function s8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a8(t,e,n){return t.set(jH(t,e),n),n}function l8(t,e){return t.get(jH(t,e))}function jH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wv=new WeakMap;class UH{constructor(){o8(this,wv,[])}subscribe(e){return this.addLocalHook("change",e),this._write(l8(wv,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){a8(wv,this,e)}}lt(UH,Nn);function S_(t,e){const n=[];let i=0,r=0;for(;i<t.length&&r<e.length;i++,r++)t[i]!==e[r]&&n.push({op:"replace",index:r,oldValue:t[i],newValue:e[r]});for(;i<e.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;r<t.length;r++)n.push({op:"remove",index:r,oldValue:t[r],newValue:void 0});return n}function Hc(t,e,n){u8(t,e),e.set(t,n)}function u8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ni(t,e){return t.get(zH(t,e))}function yf(t,e,n){return t.set(zH(t,e),n),n}function zH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sf=new WeakMap,Ac=new WeakMap,bf=new WeakMap,Rf=new WeakMap,Ef=new WeakMap;class c8{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Hc(this,Sf,new Set),Hc(this,Ac,[]),Hc(this,bf,[]),Hc(this,Rf,!1),Hc(this,Ef,!1),yf(Ef,this,e!=null?e:!1)}createObserver(){const e=new UH;return Ni(Sf,this).add(e),e.addLocalHook("unsubscribe",()=>{Ni(Sf,this).delete(e)}),e._writeInitialChanges(S_(Ni(Ac,this),Ni(bf,this))),e}emit(e){let n=Ni(bf,this);(!Ni(Rf,this)||Ni(Ac,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Ni(Ef,this)):yf(Ac,this,new Array(e.length).fill(Ni(Ef,this))),Ni(Rf,this)||(yf(Rf,this,!0),n=Ni(Ac,this)));const i=S_(n,e);Ni(Sf,this).forEach(r=>r._write(i)),yf(bf,this,e)}}function kn(t,e,n){return(e=h8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h8(t){var e=d8(t,"string");return typeof e=="symbol"?e:e+""}function d8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dy{constructor(){kn(this,"indexesSequence",new BH),kn(this,"trimmingMapsCollection",new y_(e=>e.some(n=>n===!0),!1)),kn(this,"hidingMapsCollection",new y_(e=>e.some(n=>n===!0),!1)),kn(this,"variousMapsCollection",new Yb),kn(this,"hidingChangesObservable",new c8({initialIndexValue:!1})),kn(this,"notTrimmedIndexesCache",[]),kn(this,"notHiddenIndexesCache",[]),kn(this,"isBatched",!1),kn(this,"indexesSequenceChanged",!1),kn(this,"indexesChangeSource",void 0),kn(this,"trimmedIndexesChanged",!1),kn(this,"hiddenIndexesChanged",!1),kn(this,"renderablePhysicalIndexesCache",[]),kn(this,"fromPhysicalToVisualIndexesCache",new Map),kn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,i){return this.registerMap(e,J5(n,i))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Od?this.trimmingMapsCollection.register(e,n):n instanceof $p?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const i=this.getNumberOfIndexes();return i>0&&n.init(i),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return re(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return re(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return re(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return re(n)?n:null}getNearestNotHiddenIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?i?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(r=>r+e);this.removeIndexes(i)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const i=We(e,u=>this.getPhysicalFromVisualIndex(u)),r=this.getNotTrimmedIndexesLength(),o=e.length,s=td(this.getIndexesSequence(),i),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<r){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(jb(s,l,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const i=this.getNotTrimmedIndexes()[e],r=re(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=We(new Array(n).fill(r),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromRenderableIndex(n),r=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(r,n)}}}lt(Dy,Nn);function f8(t,e){return Ae(e,(n,i)=>{Tt(t[i])&&(t[i]=n)}),t}function YH(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function GH(t){re(t)&&wb(tt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function g8(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:m8,getValues:p8}=Pr("phraseFormatters");function w8(t,e){m8(t,e)}function v8(){return p8()}w8("pluralize",g8);const KH="ContextMenu:items",Ee=KH,Gb=`${Ee}.noItems`,Kb=`${Ee}.insertRowAbove`,Xb=`${Ee}.insertRowBelow`,qb=`${Ee}.insertColumnOnTheLeft`,Zb=`${Ee}.insertColumnOnTheRight`,Qb=`${Ee}.removeRow`,Jb=`${Ee}.removeColumn`,eR=`${Ee}.undo`,tR=`${Ee}.redo`,Pm=`${Ee}.readOnly`,nR=`${Ee}.clearColumn`,iR=`${Ee}.copy`,rR=`${Ee}.copyWithHeaders`,oR=`${Ee}.copyWithGroupHeaders`,sR=`${Ee}.copyHeadersOnly`,aR=`${Ee}.cut`,lR=`${Ee}.freezeColumn`,uR=`${Ee}.unfreezeColumn`,cR=`${Ee}.mergeCells`,hR=`${Ee}.unmergeCells`,dR=`${Ee}.addComment`,fR=`${Ee}.editComment`,gR=`${Ee}.removeComment`,mR=`${Ee}.readOnlyComment`,pR=`${Ee}.align`,wR=`${Ee}.align.left`,vR=`${Ee}.align.center`,CR=`${Ee}.align.right`,yR=`${Ee}.align.justify`,SR=`${Ee}.align.top`,bR=`${Ee}.align.middle`,RR=`${Ee}.align.bottom`,ER=`${Ee}.borders`,TR=`${Ee}.borders.top`,MR=`${Ee}.borders.right`,_R=`${Ee}.borders.bottom`,IR=`${Ee}.borders.left`,PR=`${Ee}.borders.remove`,OR=`${Ee}.nestedHeaders.insertChildRow`,xR=`${Ee}.nestedHeaders.detachFromParent`,HR=`${Ee}.hideColumn`,AR=`${Ee}.showColumn`,NR=`${Ee}.hideRow`,DR=`${Ee}.showRow`,qn="Filters:",At=`${qn}conditions`,kp=`${At}.none`,$R=`${At}.isEmpty`,LR=`${At}.isNotEmpty`,kR=`${At}.isEqualTo`,FR=`${At}.isNotEqualTo`,VR=`${At}.beginsWith`,WR=`${At}.endsWith`,BR=`${At}.contains`,jR=`${At}.doesNotContain`,C8=`${At}.byValue`,UR=`${At}.greaterThan`,zR=`${At}.greaterThanOrEqualTo`,YR=`${At}.lessThan`,GR=`${At}.lessThanOrEqualTo`,KR=`${At}.isBetween`,XR=`${At}.isNotBetween`,qR=`${At}.after`,ZR=`${At}.before`,QR=`${At}.today`,JR=`${At}.tomorrow`,e0=`${At}.yesterday`,t0=`${qn}labels.filterByCondition`,n0=`${qn}labels.filterByValue`,i0=`${qn}labels.conjunction`,Fp=`${qn}labels.disjunction`,Om=`${qn}values.blankCells`,r0=`${qn}buttons.selectAll`,o0=`${qn}buttons.clear`,s0=`${qn}buttons.ok`,a0=`${qn}buttons.cancel`,l0=`${qn}buttons.placeholder.search`,u0=`${qn}buttons.placeholder.value`,c0=`${qn}buttons.placeholder.secondValue`,h0="CheckboxRenderer:",d0=`${h0}checked`,f0=`${h0}unchecked`;var y8=Object.freeze(Object.defineProperty({__proto__:null,CONTEXT_MENU_ITEMS_NAMESPACE:KH,CONTEXTMENU_ITEMS_NO_ITEMS:Gb,CONTEXTMENU_ITEMS_ROW_ABOVE:Kb,CONTEXTMENU_ITEMS_ROW_BELOW:Xb,CONTEXTMENU_ITEMS_INSERT_LEFT:qb,CONTEXTMENU_ITEMS_INSERT_RIGHT:Zb,CONTEXTMENU_ITEMS_REMOVE_ROW:Qb,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Jb,CONTEXTMENU_ITEMS_UNDO:eR,CONTEXTMENU_ITEMS_REDO:tR,CONTEXTMENU_ITEMS_READ_ONLY:Pm,CONTEXTMENU_ITEMS_CLEAR_COLUMN:nR,CONTEXTMENU_ITEMS_COPY:iR,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:rR,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:oR,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:sR,CONTEXTMENU_ITEMS_CUT:aR,CONTEXTMENU_ITEMS_FREEZE_COLUMN:lR,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:uR,CONTEXTMENU_ITEMS_MERGE_CELLS:cR,CONTEXTMENU_ITEMS_UNMERGE_CELLS:hR,CONTEXTMENU_ITEMS_ADD_COMMENT:dR,CONTEXTMENU_ITEMS_EDIT_COMMENT:fR,CONTEXTMENU_ITEMS_REMOVE_COMMENT:gR,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:mR,CONTEXTMENU_ITEMS_ALIGNMENT:pR,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:wR,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:vR,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:CR,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:yR,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:SR,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:bR,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:RR,CONTEXTMENU_ITEMS_BORDERS:ER,CONTEXTMENU_ITEMS_BORDERS_TOP:TR,CONTEXTMENU_ITEMS_BORDERS_RIGHT:MR,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:_R,CONTEXTMENU_ITEMS_BORDERS_LEFT:IR,CONTEXTMENU_ITEMS_REMOVE_BORDERS:PR,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:OR,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:xR,CONTEXTMENU_ITEMS_HIDE_COLUMN:HR,CONTEXTMENU_ITEMS_SHOW_COLUMN:AR,CONTEXTMENU_ITEMS_HIDE_ROW:NR,CONTEXTMENU_ITEMS_SHOW_ROW:DR,FILTERS_NAMESPACE:qn,FILTERS_CONDITIONS_NAMESPACE:At,FILTERS_CONDITIONS_NONE:kp,FILTERS_CONDITIONS_EMPTY:$R,FILTERS_CONDITIONS_NOT_EMPTY:LR,FILTERS_CONDITIONS_EQUAL:kR,FILTERS_CONDITIONS_NOT_EQUAL:FR,FILTERS_CONDITIONS_BEGINS_WITH:VR,FILTERS_CONDITIONS_ENDS_WITH:WR,FILTERS_CONDITIONS_CONTAINS:BR,FILTERS_CONDITIONS_NOT_CONTAIN:jR,FILTERS_CONDITIONS_BY_VALUE:C8,FILTERS_CONDITIONS_GREATER_THAN:UR,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:zR,FILTERS_CONDITIONS_LESS_THAN:YR,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:GR,FILTERS_CONDITIONS_BETWEEN:KR,FILTERS_CONDITIONS_NOT_BETWEEN:XR,FILTERS_CONDITIONS_AFTER:qR,FILTERS_CONDITIONS_BEFORE:ZR,FILTERS_CONDITIONS_TODAY:QR,FILTERS_CONDITIONS_TOMORROW:JR,FILTERS_CONDITIONS_YESTERDAY:e0,FILTERS_DIVS_FILTER_BY_CONDITION:t0,FILTERS_DIVS_FILTER_BY_VALUE:n0,FILTERS_LABELS_CONJUNCTION:i0,FILTERS_LABELS_DISJUNCTION:Fp,FILTERS_VALUES_BLANK_CELLS:Om,FILTERS_BUTTONS_SELECT_ALL:r0,FILTERS_BUTTONS_CLEAR:o0,FILTERS_BUTTONS_OK:s0,FILTERS_BUTTONS_CANCEL:a0,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:l0,FILTERS_BUTTONS_PLACEHOLDER_VALUE:u0,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:c0,CHECKBOX_RENDERER_NAMESPACE:h0,CHECKBOX_CHECKED:d0,CHECKBOX_UNCHECKED:f0},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const S8={languageCode:"en-US",[Gb]:"No available options",[Kb]:"Insert row above",[Xb]:"Insert row below",[qb]:"Insert column left",[Zb]:"Insert column right",[Qb]:["Remove row","Remove rows"],[Jb]:["Remove column","Remove columns"],[eR]:"Undo",[tR]:"Redo",[Pm]:"Read only",[nR]:"Clear column",[pR]:"Alignment",[wR]:"Left",[vR]:"Center",[CR]:"Right",[yR]:"Justify",[SR]:"Top",[bR]:"Middle",[RR]:"Bottom",[lR]:"Freeze column",[uR]:"Unfreeze column",[ER]:"Borders",[TR]:"Top",[MR]:"Right",[_R]:"Bottom",[IR]:"Left",[PR]:"Remove border(s)",[dR]:"Add comment",[fR]:"Edit comment",[gR]:"Delete comment",[mR]:"Read-only comment",[cR]:"Merge cells",[hR]:"Unmerge cells",[iR]:"Copy",[rR]:["Copy with header","Copy with headers"],[oR]:["Copy with group header","Copy with group headers"],[sR]:["Copy header only","Copy headers only"],[aR]:"Cut",[OR]:"Insert child row",[xR]:"Detach from parent",[HR]:["Hide column","Hide columns"],[AR]:["Show column","Show columns"],[NR]:["Hide row","Hide rows"],[DR]:["Show row","Show rows"],[kp]:"None",[$R]:"Is empty",[LR]:"Is not empty",[kR]:"Is equal to",[FR]:"Is not equal to",[VR]:"Begins with",[WR]:"Ends with",[BR]:"Contains",[jR]:"Does not contain",[UR]:"Greater than",[zR]:"Greater than or equal to",[YR]:"Less than",[GR]:"Less than or equal to",[KR]:"Is between",[XR]:"Is not between",[qR]:"After",[ZR]:"Before",[QR]:"Today",[JR]:"Tomorrow",[e0]:"Yesterday",[Om]:"Blank cells",[t0]:"Filter by condition",[n0]:"Filter by value",[i0]:"And",[Fp]:"Or",[r0]:"Select all",[o0]:"Clear",[s0]:"OK",[a0]:"Cancel",[l0]:"Search",[u0]:"Value",[c0]:"Second value",[d0]:"Checked",[f0]:"Unchecked"};var XH=S8;const b8=y8,$y=XH.languageCode,{register:R8,getItem:qH,hasItem:E8,getValues:T8}=Pr("languagesDictionaries");ZH(XH);function ZH(t,e){let n=t,i=e;return He(t)&&(i=t,n=i.languageCode),M8(n,i),R8(n,Xn(i)),Xn(i)}function M8(t,e){t!==$y&&f8(e,qH($y))}function QH(t){return g0(t)?Xn(qH(t)):null}function g0(t){return E8(t)}function _8(){return T8()}function JH(t,e,n){const i=QH(t);if(i===null)return null;const r=i[e];if(Tt(r))return null;const o=I8(r,n);return Array.isArray(o)?o[0]:o}function I8(t,e){let n=t;return M(v8(),i=>{n=i(t,e)}),n}function P8(t){let e=YH(t);return g0(e)||(e=$y,GH(t)),e}function O8(t,e,n){return(e=x8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x8(t){var e=H8(t,"string");return typeof e=="symbol"?e:e+""}function H8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A8 extends O9{constructor(e,n){super(e,null),O8(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:i}=e,r=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(i,-1);return r===null||o===null?null:((r.row>o.row||r.col>o.col)&&(r=n,o=i),this.settings.createCellRange(r,r,o))}getNearestNotHiddenCoords(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(r===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return o===null?null:this.settings.createCellCoords(r,o)}getNearestNotHiddenIndex(e,n,i){return n<0?n:e.getNearestNotHiddenIndex(n,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,i,r)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const i=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(n);return i.row===null||i.col===null||r.row===null||r.col===null?null:this.settings.createCellRange(i,i,r)}}var ds=A8;function vv(t){let i=t,{activeHeaderClassName:e}=i,n=$n(i,["activeHeaderClassName"]);return new ds(Cn(Me({className:e},n),{selectionType:IH}))}function N8(t){let i=t,{areaCornerVisible:e}=i,n=$n(i,["areaCornerVisible"]);return new ds(Cn(Me({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e}},n),{selectionType:Hb}))}function D8(t){let e=$n(t,[]);return new ds(Cn(Me({className:"highlight"},e),{selectionType:Hb}))}function $8(t){let i=t,{columnClassName:e}=i,n=$n(i,["columnClassName"]);return new ds(Cn(Me({className:e},n),{selectionType:A9}))}function L8(t){let i=t,{cellCornerVisible:e}=i,n=$n(i,["cellCornerVisible"]);return new ds(Cn(Me({className:"current",headerAttributes:[ub()],border:{width:2,color:"#4b89ff",cornerVisible:e}},n),{selectionType:Im}))}function k8(t){let r=t,{border:e,visualCellRange:n}=r,i=$n(r,["border","visualCellRange"]);return new ds(Cn(Me(Me({},e),i),{selectionType:N9}),n)}function F8(t){let e=$n(t,[]);return new ds(Cn(Me({className:"fill",border:{width:1,color:"#ff0000"}},e),{selectionType:x9}))}function b_(t){let i=t,{headerClassName:e}=i,n=$n(i,["headerClassName"]);return new ds(Cn(Me({className:e},n),{selectionType:xb}))}function V8(t){let i=t,{rowClassName:e}=i,n=$n(i,["rowClassName"]);return new ds(Cn(Me({className:e},n),{selectionType:H9}))}function W8(t,e){B8(t,e),e.add(t)}function B8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ei(t,e,n){return(e=j8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j8(t){var e=U8(t,"string");return typeof e=="symbol"?e:e+""}function U8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _o(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Lr=new WeakSet;class z8{constructor(e){W8(this,Lr),ei(this,"options",void 0),ei(this,"layerLevel",0),ei(this,"focus",void 0),ei(this,"fill",void 0),ei(this,"layeredAreas",new Map),ei(this,"areas",new Map),ei(this,"rowHeaders",new Map),ei(this,"columnHeaders",new Map),ei(this,"activeRowHeaders",new Map),ei(this,"activeColumnHeaders",new Map),ei(this,"activeCornerHeaders",new Map),ei(this,"rowHighlights",new Map),ei(this,"columnHighlights",new Map),ei(this,"customSelections",[]),this.options=e,this.focus=L8(e),this.fill=F8(e)}isEnabledFor(e,n){let i=e;e===Im&&(i="current");let r=this.options.disabledCellSelection(n.row,n.col);return typeof r=="string"&&(r=[r]),r===!1||Array.isArray(r)&&!r.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return _o(Lr,this,Io).call(this,this.layeredAreas,N8)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return _o(Lr,this,Io).call(this,this.areas,D8)}getAreas(){return[...this.areas.values()]}createRowHeader(){return _o(Lr,this,Io).call(this,this.rowHeaders,b_)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return _o(Lr,this,Io).call(this,this.columnHeaders,b_)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return _o(Lr,this,Io).call(this,this.activeRowHeaders,vv)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return _o(Lr,this,Io).call(this,this.activeColumnHeaders,vv)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return _o(Lr,this,Io).call(this,this.activeCornerHeaders,vv)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return _o(Lr,this,Io).call(this,this.rowHighlights,V8)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return _o(Lr,this,Io).call(this,this.columnHighlights,$8)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(k8(Me(Me({},this.options),e)))}clear(){this.focus.clear(),this.fill.clear(),M(this.areas.values(),e=>void e.clear()),M(this.layeredAreas.values(),e=>void e.clear()),M(this.rowHeaders.values(),e=>void e.clear()),M(this.columnHeaders.values(),e=>void e.clear()),M(this.activeRowHeaders.values(),e=>void e.clear()),M(this.activeColumnHeaders.values(),e=>void e.clear()),M(this.activeCornerHeaders.values(),e=>void e.clear()),M(this.rowHighlights.values(),e=>void e.clear()),M(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Io(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const i=e(Me({layerLevel:n},this.options));return t.set(n,i),i}var Y8=z8;function R_(t,e,n){return(e=G8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G8(t){var e=K8(t,"string");return typeof e=="symbol"?e:e+""}function K8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X8{constructor(e){R_(this,"ranges",[]),R_(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}var q8=X8;function Z8(t,e){eA(t,e),e.add(t)}function Cv(t,e,n){eA(t,e),e.set(t,n)}function eA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ye(t,e){return t.get(Jt(t,e))}function Tf(t,e,n){return t.set(Jt(t,e),n),n}function Jt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mf=new WeakMap,ft=new WeakMap,yr=new WeakMap,an=new WeakSet;class tA{constructor(e,n){Z8(this,an),Cv(this,Mf,void 0),Cv(this,ft,void 0),Cv(this,yr,{x:0,y:0}),Tf(Mf,this,e),Tf(ft,this,n)}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=Ye(ft,this).createCellCoords(e,n);let o=Ye(Mf,this).current().highlight;const s=Ye(ft,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",r),s.row!==null&&s.col!==null){const{width:u,height:c}=Jt(an,this,nA).call(this),{row:h,col:d}=Jt(an,this,T_).call(this,o),f=Ye(ft,this).fixedRowsBottom(),p=Ye(ft,this).minSpareRows(),S=Ye(ft,this).minSpareCols(),y=Ye(ft,this).autoWrapRow(),R=Ye(ft,this).autoWrapCol(),T=Ye(ft,this).createCellCoords(h+r.row,d+r.col);if(T.row>=c){const W=Mi(i&&p>0&&f===0),$=T.col+1,L=Ye(ft,this).createCellCoords(T.row-c,$>=u?$-u:$);this.runLocalHooks("beforeColumnWrap",W,Jt(an,this,Ll).call(this,L),$>=u),W.value?this.runLocalHooks("insertRowRequire",Ye(ft,this).countRenderableRows()):R&&T.assign(L)}else if(T.row<0){const W=Mi(R),$=T.col-1,L=Ye(ft,this).createCellCoords(c+T.row,$<0?u+$:$);this.runLocalHooks("beforeColumnWrap",W,Jt(an,this,Ll).call(this,L),$<0),R&&T.assign(L)}if(T.col>=u){const W=Mi(i&&S>0),$=T.row+1,L=Ye(ft,this).createCellCoords($>=c?$-c:$,T.col-u);this.runLocalHooks("beforeRowWrap",W,Jt(an,this,Ll).call(this,L),$>=c),W.value?this.runLocalHooks("insertColRequire",Ye(ft,this).countRenderableColumns()):y&&T.assign(L)}else if(T.col<0){const W=Mi(y),$=T.row-1,L=Ye(ft,this).createCellCoords($<0?c+$:$,u+T.col);this.runLocalHooks("beforeRowWrap",W,Jt(an,this,Ll).call(this,L),$<0),y&&T.assign(L)}const{rowDir:V,colDir:B}=Jt(an,this,E_).call(this,T);a=V,l=B,o=Jt(an,this,Ll).call(this,T)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const i=Ye(ft,this).createCellCoords(e,n),r=Ye(Mf,this).current(),o=Ye(ft,this).visualToRenderableCoords(r.highlight),s=Jt(an,this,yv).call(this,r.to.row,r.from.row),a=Jt(an,this,Sv).call(this,r.to.col,r.from.col),l=r.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",i),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=Jt(an,this,T_).call(this,r.highlight),f=Ye(ft,this).createCellCoords(s+i.row,a+i.col),p=r.getTopStartCorner(),S=r.getTopEndCorner(),y=r.getBottomEndCorner();if(i.col<0&&a>=d&&f.col<d){const B=f.col-d;f.col=Jt(an,this,Sv).call(this,p.col,S.col)+B}else if(i.col>0&&a<=d&&f.col>d){const B=Jt(an,this,Sv).call(this,S.col,p.col),W=Math.max(f.col-B,1);f.col=B+W}if(i.row<0&&s>=h&&f.row<h){const B=f.row-h;f.row=Jt(an,this,yv).call(this,p.row,y.row)+B}else if(i.row>0&&s<=h&&f.row>h){const B=Jt(an,this,yv).call(this,y.row,p.row),W=Math.max(f.row-B,1);f.row=B+W}const{rowDir:R,colDir:T}=Jt(an,this,E_).call(this,f);u=R,c=T;const V=Jt(an,this,Ll).call(this,f);i.row===0&&i.col!==0?l.col=V.col:i.row!==0&&i.col===0?l.row=V.row:(l.row=V.row,l.col=V.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:i}=e;Tf(yr,this,{x:n,y:i})}resetOffsetSize(){Tf(yr,this,{x:0,y:0})}}function E_(t){const{width:e,height:n}=Jt(an,this,nA).call(this);let i=0,r=0;return t.row<0?(i=-1,t.row=0):t.row>0&&t.row>=n&&(i=1,t.row=n-1),t.col<0?(r=-1,t.col=0):t.col>0&&t.col>=e&&(r=1,t.col=e-1),{rowDir:i,colDir:r}}function nA(){return{width:Ye(yr,this).x+Ye(ft,this).countRenderableColumns(),height:Ye(yr,this).y+Ye(ft,this).countRenderableRows()}}function yv(t,e){const n=Ye(ft,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:Ye(yr,this).y+n}function Sv(t,e){const n=Ye(ft,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Ye(yr,this).x+n}function T_(t){const{row:e,col:n}=Ye(ft,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return Ye(ft,this).createCellCoords(Ye(yr,this).y+e,Ye(yr,this).x+n)}function Ll(t){const e=t.clone();return e.col=t.col-Ye(yr,this).x,e.row=t.row-Ye(yr,this).y,Ye(ft,this).renderableToVisualCoords(e)}lt(tA,Nn);var M_=tA;const Vp=0,Wp=1,iA=2,m0=3,Q8=[m0,iA],J8=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],bv=Symbol("root"),__=Symbol("child");function Bu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bv;if(e!==bv&&e!==__)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),i=e===bv;let r=Vp;if(n){const o=t[0];t.length===0?r=Wp:i&&o instanceof Eb?r=m0:i&&Array.isArray(o)?r=Bu(o,__):t.length>=2&&t.length<=4&&!t.some((a,l)=>!J8[l].includes(typeof a))&&(r=iA)}return r}function nd(t){let{createCellCoords:e,createCellRange:n,keepDirection:i=!1,propToCol:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Q8.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===m0;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof r=="function"&&(typeof l=="string"&&(l=r(l)),typeof c=="string"&&(c=r(c))),Tt(u)&&(u=a),Tt(c)&&(c=l),!i){const f=a,p=l,S=u,y=c;a=Math.min(f,S),l=Math.min(p,y),u=Math.max(f,S),c=Math.max(p,y)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function e7(t){const e=Bu(t.getSelected());if(e===Vp||e===Wp)return[];const n=nd(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;M(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;M(Array.from(new Array(c),(h,d)=>u+d),h=>{i.has(h)||i.add(h)})});const r=Array.from(i).sort((s,a)=>s-a);return di(r,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function t7(t){const e=Bu(t.getSelected());if(e===Vp||e===Wp)return[];const n=nd(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;M(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;M(Array.from(new Array(c),(h,d)=>u+d),h=>{i.has(h)||i.add(h)})});const r=Array.from(i).sort((s,a)=>s-a);return di(r,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function kl(t,e,n){n7(t,e),e.set(t,n)}function n7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function da(t,e,n){return(e=i7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i7(t){var e=r7(t,"string");return typeof e=="symbol"?e:e+""}function r7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pt(t,e){return t.get(rA(t,e))}function kr(t,e,n){return t.set(rA(t,e),n),n}function rA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var En=new WeakMap,fa=new WeakMap,_f=new WeakMap,Nc=new WeakMap,If=new WeakMap,Dc=new WeakMap;class oA{constructor(e,n){var i=this;da(this,"settings",void 0),da(this,"tableProps",void 0),da(this,"inProgress",!1),da(this,"selectedRange",new q8((r,o,s)=>this.tableProps.createCellRange(r,o,s))),da(this,"highlight",void 0),kl(this,En,void 0),kl(this,fa,void 0),da(this,"selectedByRowHeader",new Set),da(this,"selectedByColumnHeader",new Set),kl(this,_f,!1),kl(this,Nc,!1),kl(this,If,"unknown"),kl(this,Dc,-1),this.settings=e,this.tableProps=n,this.highlight=new Y8({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[ub()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(r,o)=>this.tableProps.isDisabledCellSelection(r,o),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),createCellRange:(r,o,s)=>this.tableProps.createCellRange(r,o,s)}),kr(En,this,new M_(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),kr(fa,this,new M_(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const r=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,r.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const r=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,r.getOuterBottomEndCorner().col)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),pt(En,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformStart",...o)}),pt(En,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("afterModifyTransformStart",...o)}),pt(En,this).addLocalHook("beforeTransformEnd",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformEnd",...o)}),pt(En,this).addLocalHook("afterTransformEnd",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("afterModifyTransformEnd",...o)}),pt(En,this).addLocalHook("insertRowRequire",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("insertRowRequire",...o)}),pt(En,this).addLocalHook("insertColRequire",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("insertColRequire",...o)}),pt(En,this).addLocalHook("beforeRowWrap",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeRowWrap",...o)}),pt(En,this).addLocalHook("beforeColumnWrap",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeColumnWrap",...o)}),pt(fa,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformFocus",...o)}),pt(fa,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){kr(If,this,e)}markEndSource(){kr(If,this,"unknown")}getSelectionSource(){return pt(If,this)}setExpectedLayers(e){kr(Dc,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,kr(Dc,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Tt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();kr(_f,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,a),(!o||o&&!s&&Tt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(r.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,i)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),i=this.tableProps.countRows(),r=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((i>0||r>0)&&(i===0&&n.col<0&&!o||r===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}i>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=pt(Dc,this)===-1||this.selectedRange.size()===pt(Dc,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),r=this.tableProps.countCols();n<this.highlight.layerLevel&&(M(this.highlight.getAreas(),p=>void p.clear()),M(this.highlight.getLayeredAreas(),p=>void p.clear()),M(this.highlight.getRowHeaders(),p=>void p.clear()),M(this.highlight.getColumnHeaders(),p=>void p.clear()),M(this.highlight.getActiveRowHeaders(),p=>void p.clear()),M(this.highlight.getActiveColumnHeaders(),p=>void p.clear()),M(this.highlight.getActiveCornerHeaders(),p=>void p.clear()),M(this.highlight.getRowHighlights(),p=>void p.clear()),M(this.highlight.getColumnHighlights(),p=>void p.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(Hb,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const p=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(p.from).commit().syncWith(p),this.highlight.createLayeredArea().add(p.from).commit().syncWith(p),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(xb,e.highlight)){if(!e.isSingleHeader()){const y=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),R=this.tableProps.createCellCoords(e.to.row,-1),T=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),V=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(y).commit(),l.add(T).commit(),d.add(y).commit(),f.add(T).commit()):(a.add(y).add(R).commit(),l.add(T).add(V).commit(),d.add(y).add(R).commit(),f.add(T).add(V).commit())}const p=!pt(Nc,this)&&this.isEntireRowSelected()&&(r>0&&r===e.getWidth()||r===0&&this.isSelectedByRowHeader()),S=!pt(Nc,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());p&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),S&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),p&&S&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Im,n.highlight)&&i.add(n.highlight).commit().syncWith(n),this.inProgress||(kr(_f,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?pt(En,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):pt(En,this).resetOffsetSize(),this.setRangeStart(pt(En,this).transformStart(e,n,i))}transformEnd(e,n){this.settings.navigableHeaders?pt(En,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):pt(En,this).resetOffsetSize(),this.setRangeEnd(pt(En,this).transformEnd(e,n))}transformFocus(e,n){const i=this.selectedRange.current(),{row:r,col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,r-1);i.highlight.isHeader()?pt(fa,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:r<0?Math.abs(r):-a}):pt(fa,this).setOffsetSize({x:o<0?0:-s,y:r<0?0:-a});const l=pt(fa,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:r,to:o,highlight:s}=i,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Ue(r.row+h,c,a-1),r.col),f=this.tableProps.createCellCoords(Ue(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Ue(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:r,to:o,highlight:s}=i,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(r.row,Ue(r.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,Ue(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Ue(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Mi(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&pt(_f,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&r.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{row:o}=r.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&r.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){!this.isSelected()||(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=i?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=r;kr(Nc,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Ue(d.row,u,o-1),Ue(d.col,c,s-1)));const p=this.tableProps.createCellCoords(u,c),S=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(p,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.finish(),kr(Nc,this,!1)}selectCells(e){var n=this;const i=Bu(e);if(i===Wp)return!1;if(i===Vp)throw new Error(tt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=nd(i,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=r(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),M(e,l=>{const{from:u,to:c}=r(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,r),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,p=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(f=Ue(i.row,u,s-1),p=Ue(i.col,Math.min(r,o),Math.max(r,o))):(f=Ue(i,u,s-1),p=r);const S=this.tableProps.createCellCoords(f,p),y=l===0?0:Ue(S.row,u,-1),R=s-1,T=this.tableProps.createCellCoords(y,r),V=this.tableProps.createCellCoords(R,o);this.runLocalHooks("beforeSelectColumns",T,V,S),T.row=y,V.row=R,this.setRangeStartOnly(T,void 0,S),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(V),this.runLocalHooks("afterSelectColumns",T,V,S),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:r,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(h=Ue(i.row,Math.min(e,n),Math.max(e,n)),d=Ue(i.col,a,o-1)):(h=e,d=Ue(i,a,o-1));const f=this.tableProps.createCellCoords(h,d),p=s===0?0:Ue(f.col,a,-1),S=o-1,y=this.tableProps.createCellCoords(e,p),R=this.tableProps.createCellCoords(n,S);this.runLocalHooks("beforeSelectRows",y,R,f),y.col=p,R.col=S,this.setRangeStartOnly(y,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(R),this.runLocalHooks("afterSelectRows",y,R,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const i=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:r,to:o,highlight:s}=i;this.clear(),s.assign({row:Ue(s.row,-1/0,e-1),col:Ue(s.col,-1/0,n-1)}),r.assign({row:Ue(r.row,-1/0,e-1),col:Ue(r.col,-1/0,n-1)}),o.assign({row:Ue(o.row,0,e-1),col:Ue(o.col,0,n-1)}),this.selectedRange.ranges.push(i),this.highlight.getFocus().add(s).commit().syncWith(i),this.applyAndCommit(i)}commit(){if(this.highlight.getCustomSelections().forEach(r=>{r.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),i=this.selectedRange.current();this.highlight.isEnabledFor(Im,i.highlight)&&this.highlight.getFocus().commit().syncWith(i);for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}lt(oA,Nn);var o7=oA;const I_=/^(\r\n|\n\r|\r|\n)/,s7=/^[^\t\r\n]+/,P_=/^\t/;function a7(t){const e=[[""]];if(t.length===0)return e;let n=0,i=0,r;for(;t.length>0&&r!==t.length;)if(r=t.length,t.match(P_))t=t.replace(P_,""),n+=1,e[i][n]="";else if(t.match(I_))t=t.replace(I_,""),n=0,i+=1,e[i]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(s7);o=s?s[0]:"",t=t.slice(o.length)}e[i][n]=o}return e}function Ph(t){let e,n,i,r,o="",s;for(e=0,n=t.length;e<n;e+=1){for(r=t[e].length,i=0;i<r;i+=1)i>0&&(o+="	"),s=t[e][i],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function ga(t,e,n){return(e=l7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l7(t){var e=u7(t,"string");return typeof e=="symbol"?e:e+""}function u7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ru{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,i){ga(this,"hot",void 0),ga(this,"metaManager",void 0),ga(this,"tableMeta",void 0),ga(this,"dataSource",void 0),ga(this,"duckSchema",void 0),ga(this,"colToPropCache",void 0),ga(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e=="undefined")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,n){let r=0,o=0,s=!1;if(typeof n=="function"){const a=mb(e);r=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;r=Math.min(a,n.length)}for(i=0;i<r;i++){const a=s?n(i):n[i];if(He(a)){if(typeof a.data!="undefined"){const l=s?o:i;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return VH(this.dataSource)}recursiveDuckColumns(e,n,i){let r=n,o=i,s;return typeof r=="undefined"&&(r=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ae(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,r),r+=1):r=this.recursiveDuckColumns(a,r,`${l}.`)}),r}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&re(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(re(n))return this.hot.toVisualColumn(n);const i=this.hot.toVisualColumn(e);return i===null?e:i}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Jh(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,i)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let p=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?p=Xn(this.getSchema()):(p=[],ce(h-1,()=>p.push(null))):this.hot.dataType==="function"?p=this.tableMeta.dataSchema(l+a):(p={},Ap(p,this.getSchema())),d.push(p),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),r==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):i!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,i),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,i)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,p=c;r==="end"&&(p=Math.min(p+1,a));const S=p;for(;f<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let R=0;R<h;R+=1)typeof o[R]=="undefined"&&(o[R]=[]),o[R].push(null);else o.push([null]);else for(let R=0;R<h;R++)o[R].splice(p,0,null);f+=1,p+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):i!=="auto"&&this.metaManager.createColumn(S,n));const y=this.hot.toVisualColumn(S);return this.hot.runHooks("afterCreateCol",y,f,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:f,startPhysicalIndex:S}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(r,n),s=this.hot.countSourceRows();if(r=(s+r)%s,this.hot.runHooks("beforeRemoveRow",r,o.length,o,i)===!1)return!1;const l=o.length;if(this.filterData(r,l,o),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=re(this.tableMeta.columns)||re(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",r,l,o,i),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let r=typeof e!="number"?-n:e;r=(this.hot.countCols()+r)%this.hot.countCols();const o=this.visualColumnsToPhysical(r,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",r,n,o,i)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,n,o,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,i){const r=this.hot.getDataAtCol(e),o=r.slice(n,n+i),s=r.slice(n+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];iM(l,s);let c=0;for(;c<i;)l.push(null),c+=1;return xK(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,i){const r=this.hot.getSourceDataAtRow(e),o=r.slice(n,n+i),s=r.slice(n+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];iM(l,s);let c=0;for(;c<i;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,i){if(this.hot.runHooks("beforeDataSplice",e,n,i)!==!1){const o=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,i){let r=this.hot.runHooks("filterData",e,n,i);Array.isArray(r)===!1&&(r=this.dataSource.filter((o,s)=>i.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,n){const i=this.hot.toPhysicalRow(e);let r=this.dataSource[i];const o=this.hot.runHooks("modifyRowData",i);r=isNaN(o)?o:r;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(r&&r.hasOwnProperty&&en(r,n))a=r[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=r;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l=="undefined")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){const l=Mi(a);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,i){const r=this.hot.toPhysicalRow(e);let o=i,s=this.dataSource[r];const a=this.hot.runHooks("modifyRowData",r);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Mi(o);this.hot.runHooks("modifyData",r,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&en(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]=="undefined"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(r,r+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const i=this.hot.countSourceRows(),r=[];let o=(i+e)%i,s=n,a;for(;o<i&&s;)a=this.hot.toPhysicalRow(o),r.push(a),s-=1,o+=1;return r}visualColumnsToPhysical(e,n){const i=this.hot.countCols(),r=[];let o=(i+e)%i,s=n;for(;o<i&&s;){const a=this.hot.toPhysicalColumn(o);r.push(a),s-=1,o+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Ru.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,i){const r=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=i===Ru.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&r.push(a)}return r}getText(e,n){return Ph(this.getRange(e,n,Ru.DESTINATION_RENDERER))}getCopyableText(e,n){return Ph(this.getRange(e,n,Ru.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}var c7=Ru;const{register:h7,getItem:d7,hasItem:sA,getNames:upe,getValues:cpe}=Pr("cellTypes");function f7(t){if(!sA(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return d7(t)}function lr(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:i,validator:r}=e;n&&vi(t,n),i&&$i(t,i),r&&gu(t,r),h7(t,e)}function g7(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!en(e,t)}function Bp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=typeof e.type=="string"?f7(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ae(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!He(i))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const r={};Ae(i,(o,s)=>{if(g7(s,n)){var a;r[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),nn(t,r)}function m7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}N3(n,t);for(let i=0;i<e.length;i++)n.prototype[e[i]]=void 0;return n}function qg(t){return Number.isInteger(t)&&t>=0}function Zg(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Pf(t){return t==null}var aA=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,i;for(e=0,n=this.countRows();e<n;e++)if(i=this.getDataAtCell(e,t),Wt(i)===!1)return!1;return!0},isEmptyRow(t){let e,n,i,r;for(e=0,n=this.countCols();e<n;e++)if(i=this.getDataAtCell(t,e),Wt(i)===!1)return typeof i=="object"?(r=this.getCellMeta(t,e),gb(this.getSchema()[r.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function O_(t,e,n){return(e=p7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p7(t){var e=w7(t,"string");return typeof e=="symbol"?e:e+""}function w7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function v7(){return class{}}class C7{constructor(e){O_(this,"metaCtor",v7()),O_(this,"meta",void 0),this.meta=this.metaCtor.prototype,nn(this.meta,aA()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;nn(this.meta,e),Bp(this.meta,Cn(Me({},e),{type:(n=e.type)!==null&&n!==void 0?n:this.meta.type}),e)}}function y7(t,e,n){return(e=S7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S7(t){var e=b7(t,"string");return typeof e=="symbol"?e:e+""}function b7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R7{constructor(e){y7(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){nn(this.meta,e),Bp(this.meta,e,e)}}function Of(t,e,n){return(e=E7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E7(t){var e=T7(t,"string");return typeof e=="symbol"?e:e+""}function T7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xm{constructor(e){Of(this,"valueFactory",void 0),Of(this,"data",[]),Of(this,"index",[]),Of(this,"holes",new Set),this.valueFactory=e}obtain(e){Zg(()=>qg(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let i;if(n>=0)i=this.data[n],i===void 0&&(i=this.valueFactory(e),this.data[n]=i);else if(i=this.valueFactory(e),this.holes.size>0){const r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=i,this.index[e]=r}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Zg(()=>qg(e)||Pf(e),"Expecting an unsigned number or null/undefined argument.");const i=[],r=this.data.length;for(let s=0;s<n;s++)i.push(r+s),this.data.push(void 0);const o=Pf(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...i,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Zg(()=>qg(e)||Pf(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(Pf(e)?this.index.length-n:e,n);for(let r=0;r<i.length;r++){const o=i[r];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const r=this._getKeyByStorageIndex(i);r!==-1&&this.data[i]!==void 0&&e.push([r,this.data[i]])}let n=0;return{next:()=>{if(n<e.length){const i=e[n];return n+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function x_(t,e,n){return(e=M7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M7(t){var e=_7(t,"string");return typeof e=="symbol"?e:e+""}function _7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const I7=["data","width"];class P7{constructor(e){x_(this,"globalMeta",void 0),x_(this,"metas",new xm(()=>this._createMeta())),this.globalMeta=e,this.metas=new xm(()=>this._createMeta())}updateMeta(e,n){const i=this.getMeta(e);nn(i,n),Bp(i,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return m7(this.globalMeta.getMetaConstructor(),I7).prototype}}function H_(t,e,n){return(e=O7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O7(t){var e=x7(t,"string");return typeof e=="symbol"?e:e+""}function x7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H7{constructor(e){H_(this,"columnMeta",void 0),H_(this,"metas",new xm(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,i){const r=this.getMeta(e,n);nn(r,i),Bp(r,i)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,n)}getMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);return i===void 0?r:r[i]}setMeta(e,n,i,r){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(i),s[i]=r}removeMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);delete r[i]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let i=0;i<n.length;i++)re(n[i])&&e.push(...n[i].values());return e}getMetasAtRow(e){Zg(()=>qg(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new xm(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class lA{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new C7(e),this.tableMeta=new R7(this.globalMeta),this.columnMeta=new P7(this.globalMeta),this.cellMeta=new H7(this.columnMeta),i.forEach(r=>new r(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,i){let{visualRow:r,visualColumn:o}=i;const s=this.cellMeta.getMeta(e,n);return s.visualRow=r,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,i)}setCellMeta(e,n,i,r){this.cellMeta.setMeta(e,n,i,r)}updateCellMeta(e,n,i){this.cellMeta.updateMeta(e,n,i)}removeCellMeta(e,n,i){this.cellMeta.removeMeta(e,n,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}lt(lA,Nn);function A_(t,e,n,i){const{hotInstance:r,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=i,h=Rr(a),d=r.getSettings();Array.isArray(d.dataSchema)?r.dataType="array":gt(d.dataSchema)?r.dataType="function":r.dataType="object",o&&o.destroy(),t=r.runHooks(`before${h}`,t,c,l);const f=new c7(r,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const p=f.getSchema();t=[];let S,y=0,R=0;for(y=0,R=d.startRows;y<R;y++)if((r.dataType==="object"||r.dataType==="function")&&d.dataSchema)S=Xn(p),t.push(S);else if(r.dataType==="array")S=Xn(p[0]),t.push(S);else{S=[];for(let T=0,V=d.startCols;T<V;T++)S.push(null);t.push(S)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(r.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=r.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),r.runHooks(`after${h}`,t,c,l),c||(r.runHooks("afterChange",null,a),r.render()),r.getSettings().ariaTags&&ve(r.rootElement,[T1(-1),Op(r.countCols()+(r.view?r.countRowHeaders():0))])}function N_(t,e,n){return(e=A7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A7(t){var e=N7(t,"string");return typeof e=="symbol"?e:e+""}function N7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D7{constructor(e){N_(this,"metaManager",void 0),N_(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),ee.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:i,col:r}=e;if((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(r))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=en(e,"type")?e.type:null;let c=gt(e.cells)?e.cells(i,r,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(i,r,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(r)}}function $7(t,e,n){L7(t,e),e.set(t,n)}function L7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rv(t,e,n){return(e=k7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k7(t){var e=F7(t,"string");return typeof e=="symbol"?e:e+""}function F7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function V7(t,e){return t.get(W7(t,e))}function W7(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var D_=new WeakMap;class B7{constructor(e){Rv(this,"metaManager",void 0),Rv(this,"usageTracker",new Set),Rv(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),$7(this,D_,(n,i,r)=>{if(!r)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:i,target:r,onChange:o}=e,s=typeof r=="string",a=s?r:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(r,l,o)):i&&(this.installPropWatcher(n,l,V7(D_,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,i){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!r.usageTracker.has(e);r.usageTracker.add(e),i.call(r,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const uA="gridDefault",na="editorManager.handlingEditor",j7={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},U7="hooksRefRegisterer",cA={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){M(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ae(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};hs(cA,"MIXIN_NAME",U7,{writable:!1,enumerable:!1});var z7=cA;function ir(t,e,n){return(e=Y7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y7(t){var e=G7(t,"string");return typeof e=="symbol"?e:e+""}function G7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const K7="base",Ft=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class rc{static get EDITOR_TYPE(){return K7}constructor(e){ir(this,"hot",void 0),ir(this,"state",Ft.VIRGIN),ir(this,"_opened",!1),ir(this,"_fullEditMode",!1),ir(this,"_closeCallback",null),ir(this,"TD",null),ir(this,"row",null),ir(this,"col",null),ir(this,"prop",null),ir(this,"originalValue",null),ir(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,i,r,o,s){this.TD=r,this.row=e,this.col=n,this.prop=i,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Ft.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let i,r,o,s;if(n){const l=this.hot.getSelectedLast();i=Math.max(Math.min(l[0],l[2]),0),r=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[i,r,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");Array.isArray(a)&&([i,r]=a),this.hot.populateFromArray(i,r,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Ft.VIRGIN)return;const i=this.hot,r=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=i.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Ft.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Gt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),i.view.scrollViewport(i._createCellCoords(r,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,i){let r;if(i){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),i(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Ft.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Ft.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?r=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:r=[[o]],this.state=Ft.WAITING,this.saveValue(r,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Ft.FINISHED,this.discardEditor(s)}):(this.state=Ft.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Ft.FINISHED,this.discardEditor()}discardEditor(e){this.state===Ft.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Ft.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Ft.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Ft.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:i,wtViewport:r}=this.hot.view._wt,o=this.hot.rootWindow,s=xn(n),a=Yt(n),l=xn(this.hot.rootElement),u=Yt(this.hot.rootElement),c=i.topOverlay.holder,h=i.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,p=o.innerWidth-l.left-u,{wtTable:S}=(e=i.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,y=S.name,R=["master","inline_start"].includes(y)?d:0,T=["master","top","bottom"].includes(y)?f:0,V=s.top===l.top?0:1;let B=s.top-l.top-V-R,W=0;this.hot.isRtl()?W=o.innerWidth-s.left-a-p-1+T:W=s.left-l.left-1-T,["top","top_inline_start_corner"].includes(y)&&(B+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(W+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const $=this.hot.hasColHeaders(),L=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),z=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),K=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");($&&L<=0||L===K)&&(B+=1),z<=0&&(W+=1);const te=r.rowsRenderCalculator.startPosition,se=r.columnsRenderCalculator.startPosition,Ce=Math.abs(i.inlineStartOverlay.getScrollPosition()),be=i.topOverlay.getScrollPosition(),je=wn(this.hot.rootDocument);let jt=n.offsetTop;if(["inline_start","master"].includes(y)&&(jt+=te-be),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:G,wtTable:ne}=i.bottomOverlay.clone;jt+=G.getWorkspaceHeight()-ne.getHeight()-je}let Pe=n.offsetLeft;this.hot.isRtl()?(Pe>=0?Pe=S.getWidth()-n.offsetLeft:Pe=Math.abs(Pe),Pe+=se-Ce-a):["top","master","bottom"].includes(y)&&(Pe+=se-Ce);const Ke=o.getComputedStyle(this.TD),bt=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",qt=parseInt(Ke[bt],10)>0?0:1,g=parseInt(Ke.borderTopWidth,10)>0?0:1,m=Yt(n)+qt,w=tn(n)+g,b=D1(c)?je:0,P=$1(h)?je:0,k=this.hot.view.maximumVisibleElementWidth(Pe)-b+qt,Y=Math.max(this.hot.view.maximumVisibleElementHeight(jt)-P+g,this.hot.view.getDefaultRowHeight());return{top:B,start:W,height:w,maxHeight:Y,width:m,maxWidth:k}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}lt(rc,z7);const X7={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const i=t._getEditorManager(),r=i.getActiveEditor();r.isInFullEditMode()&&r.state===Ft.EDITING||(i.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},q7={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},Z7={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},Q7={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},J7={name:"editorOpen",callback(t,e,n){const i=t._getEditorManager(),r=t.getSelectedRangeLast(),{highlight:o}=r;if(t.selection.isMultiple()&&!r.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),Ir(e))}};function eZ(){return[j7,X7,q7,Z7,Q7,J7]}const tZ={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},nZ={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),i=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(i!==null){const r=t._createCellCoords(i,e.col),o=e.row-t.getFirstFullyVisibleRow(),s=Math.min(r.row-o,t.countRows()-1);t.selection.setRangeEnd(r),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},iZ={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},rZ={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},oZ={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:i}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,i.col,e)}},sZ={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast(),s=i.isHeader()&&t.selection.isSelectedByRowHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=r.clone();l.row=i.row,e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},aZ={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&i.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=r.clone();a.col=i.col,e.setRangeStart(a,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(o.row,s))}}},lZ={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&i.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=r.clone();l.col=i.col,e.setRangeStart(l,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},uZ={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast(),s=i.isHeader()&&t.selection.isSelectedByColumnHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=r.clone();l.col=i.col,e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},cZ={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast(),s=i.isHeader()&&t.selection.isSelectedByColumnHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=r.clone();l.col=i.col,e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},hZ={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeLast(),s=i.isHeader()&&t.selection.isSelectedByRowHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=r.clone();l.row=i.row,e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},dZ={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:i}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,i.row,e)}},fZ={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},gZ={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),i=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(i!==null){const r=t._createCellCoords(i,e.col),o=e.row-t.getFirstFullyVisibleRow(),s=Math.max(r.row-o,0);t.selection.setRangeEnd(r),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function mZ(){return[tZ,nZ,iZ,rZ,oZ,sZ,aZ,lZ,uZ,cZ,hZ,dZ,fZ,gZ]}const pZ={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},wZ={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let r=t.countVisibleRows()+n;r=r===0?1:r,i===t.countRows()-1?r=1:i+r>t.countRows()&&(r=t.countRows()-i-1),t.selection.transformStart(r,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},vZ={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),i=t.getSelectedRangeLast(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-r.row,-r.col):t.selection.transformStart(-r.row,-r.col)}},CZ={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),i=t.getSelectedRangeLast(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(r.row,r.col):t.selection.transformStart(r.row,r.col)}},yZ={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},SZ={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},bZ={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},RZ={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-r-1,-1),s=i.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},EZ={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},TZ={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedColumnsStart,10),r=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(i,1);e.setRangeStart(t._createCellCoords(r,o))}},MZ={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,i=t.getSelectedRangeLast().highlight.row;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);r===null&&(r=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(i,r))}},_Z={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:i}=t.getSelectedRangeLast().highlight;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);r===null&&(r=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(i,r))}},IZ={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},PZ={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(r,1),a=i.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},OZ={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},xZ={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let r=t.countVisibleRows()+n;r=r===0?-1:-r,i===-n?r=-1:i+r<n&&(r=-(i+n)),t.selection.transformStart(r,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function HZ(){return[pZ,wZ,vZ,CZ,yZ,SZ,bZ,RZ,EZ,TZ,MZ,_Z,IZ,PZ,OZ,xZ]}const AZ={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},NZ={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,i=t.getFirstFullyVisibleColumn()-1,r=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,i),a=t._createCellCoords(r,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo(Cn(Me({},u),{verticalSnap:"top",horizontalSnap:"start"}))}}},DZ={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},$Z={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},LZ={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:i}=e[e.length-1].highlight.normalize(),r=t.getDataAtCell(n,i),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==i)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,r])}});t.setDataAtCell(Array.from(o.values()))}},kZ=[...eZ(),...mZ(),...HZ(),AZ,NZ,DZ,$Z,LZ];function hA(t){const e={};return kZ.forEach(n=>{let{name:i,callback:r}=n;e[i]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r(t,...s)}}),e}function FZ(t){const e=t.getShortcutManager().addContext("editor"),n=hA(t),i={group:na};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(r,o)=>n.editorCloseAndSaveByEnter(r,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(r,o)=>n.editorCloseAndSaveByEnter(r,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(r,o)=>n.editorCloseAndSave(r,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(r,o)=>n.editorCloseAndSaveByArrowKeys(r,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],i)}function VZ(t){const e=t.getShortcutManager().addContext("grid"),n=hA(t),i={runOnlyIf:()=>{const{navigableHeaders:r}=t.getSettings();return re(t.getSelected())&&(r||!r&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:uA};e.addShortcuts([{keys:[["F2"]],callback:r=>n.editorFastOpen(r)},{keys:[["Enter"],["Enter","Shift"]],callback:(r,o)=>n.editorOpen(r,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:na,runOnlyIf:()=>re(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var r;return!((r=t.getSelectedRangeLast())!==null&&r!==void 0&&r.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var r;return(r=t.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var r,o;return!((r=t.getSelectedRangeLast())!==null&&r!==void 0&&r.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:r=>n.moveCellSelectionInlineStart(r)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:r=>n.moveCellSelectionInlineEnd(r)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],i)}function WZ(t){[VZ,FZ].forEach(e=>e(t))}function BZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,i=$_(t),r=$_(t);return i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(i),n.lastChild.after(r),{activate(){t._registerTimeout(()=>{i.tabIndex=0,r.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{i.tabIndex=-1,r.tabIndex=-1},10)}}}function $_(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&ve(n,[uo(),Js()]),n}function jZ(t){const e=UZ(t);let n;const{activate:i,deactivate:r}=BZ(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:Ly(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:ky(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>i()),t.addHook("afterSelection",(h,d,f,p,S)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,S.value=!0),s){var y;n=(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:uA,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([Cn(Me({},c),{callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"}),Cn(Me({},c),{callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?Ly(t):ky(t)),u(),!1;h.preventDefault()},position:"after"})])}function Ly(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:i}=t.getSettings();let r=i&&t.countColHeaders()>0?-t.countColHeaders():0,o=i&&t.countRowHeaders()>0?-t.countRowHeaders():0;return r===0&&(r=e.getVisualFromRenderableIndex(r)),o===0&&(o=n.getVisualFromRenderableIndex(o)),r===null||o===null?null:t._createCellCoords(r,o)}function ky(t){var e,n;const{rowIndexMapper:i,columnIndexMapper:r}=t,{navigableHeaders:o}=t.getSettings();let s=i.getRenderableIndexesLength()-1,a=r.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=i.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=r.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function UZ(t){return e=>{if(!e)return null;const n=Ly(t),i=ky(t);return e.col<n.col&&(e.col=n.col),e.col>i.col&&(e.col=i.col),e.row<n.row&&(e.row=n.row),e.row>i.row&&(e.row=i.row),e}}function zZ(t){return e=>{let{col:n}=e;t.scrollViewportTo({col:n})}}function YZ(){return()=>{}}function GZ(t){return e=>{t.scrollViewportTo(e.toObject())}}function KZ(t){return e=>{t.scrollViewportTo(e.toObject())}}function XZ(t){return e=>{t.scrollViewportTo(e.toObject())}}function qZ(t){return e=>{let{row:n}=e;t.scrollViewportTo({row:n})}}function ZZ(t){return e=>{const n=t.selection.getSelectionSource(),{row:i,col:r}=e;if(i<0&&r>=0)t.scrollViewportTo({col:r});else if(r<0&&i>=0)t.scrollViewportTo({row:i});else{if(n==="mouse"&&(r===t.view.getLastPartiallyVisibleColumn()||i===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:i,col:r})}}}function QZ(t){const{selection:e}=t;let n=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){n=!0},scrollTo(r){var o;if(n||i){n=!1;return}let s;e.isFocusSelectionChanged()?s=GZ(t):e.isSelectedByCorner()?s=YZ():e.isSelectedByRowHeader()?s=qZ(t):e.isSelectedByColumnHeader()?s=zZ(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=KZ(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=ZZ(t):e.getSelectedRange().size()>1&&(s=XZ(t)),(o=s)===null||o===void 0||o(r)}}}const L_=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),xf=t=>t.map(e=>{const n=e.toLowerCase();return L_.has(n)?L_.get(n):n}).sort().join("+"),JZ=t=>t.split("+"),k_=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Ev=t=>{let{which:e,key:n}=t;if(k_.has(e))return k_.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:n.toLowerCase()},dA=Symbol("shortcut-context");function fA(t){return He(t)&&t.__kindOf===dA}const eQ=t=>{const e=Dp({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:p=!1,relativeToGroup:S,position:y,forwardToContext:R}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Tt(c))throw new Error("You need to define the shortcut's group.");if(gt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(tt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const T={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:p};re(S)&&(T.relativeToGroup=S,T.position=y),fA(R)&&(T.forwardToContext=R),l.forEach(V=>{const B=xf(V);if(e.hasItem(B)){const $=e.getItem(B);let L=$.findIndex(z=>z.group===S);L!==-1?y==="before"?L-=1:L+=1:L=$.length,$.splice(L,0,T)}else e.addItem(B,[T])})},i=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ae(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},r=l=>{const u=xf(l);e.removeItem(u)};return{__kindOf:dA,addShortcut:n,addShortcuts:i,getShortcuts:l=>{const u=xf(l),c=e.getItem(u);return re(c)?c.slice():[]},hasShortcut:l=>{const u=xf(l);return e.hasItem(u)},removeShortcutsByKeys:r,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(p=>p.group!==l);f.length===0?r(JZ(h)):(d.length=0,d.push(...f))})}}};function tQ(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const nQ=["meta","alt","shift","control"],$c=tQ(),Lc=[];let Hf=0;function iQ(t,e,n,i,r){const o=f=>nQ.includes(f),s=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const S=[];return f.altKey&&S.push("alt"),p&&(f.ctrlKey||f.metaKey)?S.push("control/meta"):(f.ctrlKey&&S.push("control"),f.metaKey&&S.push("meta")),f.shiftKey&&S.push("shift"),S},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||Ka(f))return;const S=Ev(f);let y=[];o(S)||(y=s(f));const R=[S].concat(y);!r(f,R)&&(TM()&&y.includes("meta")||!TM()&&y.includes("control"))&&r(f,[S].concat(s(f,!0))),i(f)},l=f=>{if(typeof f.key=="string"){const p=Ev(f);o(p)&&$c.press(p)}},u=f=>{if(typeof f.key=="string"){const p=Ev(f);o(p)&&$c.release(p)}},c=()=>{$c.releaseAll()};return{mount:()=>{let f=t;for(Hf+=1;f;)Hf===1&&(f.document.documentElement.addEventListener("keydown",l),Lc.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),Lc.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=Fu(f)},unmount:()=>{let f=t;for(Hf-=1;f;){if(Hf===0){for(let p=0;p<Lc.length;p++){const{event:S,listener:y}=Lc[p];f.document.documentElement.removeEventListener(S,y)}Lc.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=Fu(f)}},isPressed:f=>$c.isPressed(f),releasePressedKeys:()=>$c.releaseAll()}}const rQ=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:i,afterKeyDown:r}=t;const o=Dp({errorIdExists:p=>`The "${p}" context name is already registered.`});let s="grid";const a=p=>{const S=eQ(p);return o.addItem(p,S),S},l=()=>s,u=p=>o.getItem(p),c=p=>{if(!o.hasItem(p))throw new Error(tt`You've tried to activate the "${p}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=p};let h=!1;const d=function(p,S){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const R=fA(y)?y:u(y);let T=!1;if(!R.hasShortcut(S))return T;const V=R.getShortcuts(S);for(let B=0;B<V.length;B++){const{callback:W,runOnlyIf:$,preventDefault:L,stopPropagation:z,captureCtrl:ie,forwardToContext:K}=V[B];if($(p)===!0){if(h=ie,T=W(p,S)===!1,h=!1,L&&p.preventDefault(),z&&(Ir(p),p.stopPropagation()),T)break;K&&d(p,S,K)}}return T},f=iQ(e,n,i,r,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function F_(t){const{classNames:e}=u3(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let Tv=null;const Mv=new Map;function gA(t,e){var n,i=this;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Er(o);let a,l,u,c,h,d,f=!0;b5(r)&&S5(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const p=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",S=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",S),this.isRtl=function(){return S==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=P8(e.language);const y=new lA(o,e,[D7,B7]),R=y.getTableMeta(),T=y.getGlobalMeta(),V=Dp();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Xg(this)&&($K(e.licenseKey,t),U(t,"ht-wrapper")),this.guid=`ht_${C1()}`,Mv.set(this.guid,this),this.columnIndexMapper=new Dy,this.rowIndexMapper=new Dy,this.columnIndexMapper.addLocalHook("indexesSequenceChange",g=>{o.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",g=>{o.runHooks("afterRowSequenceChange",g)}),l=new B5(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const B=g=>{const{row:m,col:w}=g;return o._createCellCoords(m>=0?o.rowIndexMapper.getRenderableFromVisualIndex(m):m,w>=0?o.columnIndexMapper.getRenderableFromVisualIndex(w):w)},W=g=>{const{row:m,col:w}=g;return o._createCellCoords(m>=0?o.rowIndexMapper.getVisualFromRenderableIndex(m):m,w>=0?o.columnIndexMapper.getVisualFromRenderableIndex(w):w)},$=(g,m)=>{const w=m>g?1:-1,b=Math.min(g,m),P=Math.max(g,m),k=o.rowIndexMapper.getNearestNotHiddenIndex(g,w);return k===null||w===1&&k>P||w===-1&&k<b?null:k>=0?o.rowIndexMapper.getRenderableFromVisualIndex(k):k},L=(g,m)=>{const w=m>g?1:-1,b=Math.min(g,m),P=Math.max(g,m),k=o.columnIndexMapper.getNearestNotHiddenIndex(g,w);return k===null||w===1&&k>P||w===-1&&k<b?null:k>=0?o.columnIndexMapper.getRenderableFromVisualIndex(k):k};let z=new o7(R,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:g=>a.propToCol(g),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(g,m)=>o._createCellCoords(g,m),createCellRange:(g,m,w)=>o._createCellRange(g,m,w),visualToRenderableCoords:B,renderableToVisualCoords:W,findFirstNonHiddenRenderableRow:$,findFirstNonHiddenRenderableColumn:L,isDisabledCellSelection:(g,m)=>g<0||m<0?o.getSettings().disableVisualSelection:o.getCellMeta(g,m).disableVisualSelection});this.selection=z;const ie=g=>{let{hiddenIndexesChanged:m}=g;m&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",ie),this.rowIndexMapper.addLocalHook("cacheUpdated",ie),this.selection.addLocalHook("afterSetRangeEnd",(g,m)=>{const w=Mi(!1),b=this.selection.getSelectedRange(),{from:P,to:k}=b.current(),Y=b.size()-1;this.runHooks("afterSelection",P.row,P.col,k.row,k.col,w,Y),this.runHooks("afterSelectionByProp",P.row,o.colToProp(P.col),k.row,o.colToProp(k.col),w,Y),m&&(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(g);const G=z.isSelectedByRowHeader(),ne=z.isSelectedByColumnHeader();G&&ne?U(this.rootElement,["ht__selection--rows","ht__selection--columns"]):G?(ge(this.rootElement,"ht__selection--columns"),U(this.rootElement,"ht__selection--rows")):ne?(ge(this.rootElement,"ht__selection--rows"),U(this.rootElement,"ht__selection--columns")):ge(this.rootElement,["ht__selection--rows","ht__selection--columns"]),z.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",g=>{this.runHooks("beforeSelectionFocusSet",g.row,g.col)}),this.selection.addLocalHook("afterSetFocus",g=>{const m=Mi(!1);this.runHooks("afterSelectionFocusSet",g.row,g.col,m),(!m.isTouched()||m.isTouched()&&!m.value)&&d.scrollTo(g),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",g=>{const m=g.length-1,{from:w,to:b}=g[m];this.runHooks("afterSelectionEnd",w.row,w.col,b.row,b.col,m),this.runHooks("afterSelectionEndByProp",w.row,o.colToProp(w.col),b.row,o.colToProp(b.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{const m=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),ge(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return i.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return i.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return i.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return i.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return i.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return i.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return i.runHooks("afterSelectRows",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return i.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return i.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformFocus",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return i.runHooks("modifyTransformFocus",...m)}).addLocalHook("afterModifyTransformFocus",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return i.runHooks("afterModifyTransformFocus",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return i.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return i.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return i.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return i.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",g=>this.alter("insert_row_above",g,1,"auto")).addLocalHook("insertColRequire",g=>this.alter("insert_col_start",g,1,"auto")),u={alter(g,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,b=arguments.length>3?arguments[3]:void 0,P=arguments.length>4?arguments[4]:void 0;const k=Y=>{if(Y.length===0)return[];const G=[...Y];return G.sort((v,C)=>{let[E]=v,[x]=C;return E===x?0:E>x?1:-1}),di(G,(v,C)=>{let[E,x]=C;const I=v[v.length-1],[A,F]=I,_=A+F;if(E<=_){const H=Math.max(x-(_-E),0);I[1]+=H}else v.push([E,x]);return v},[G[0]])};switch(g){case"insert_row_below":case"insert_row_above":const Y=o.countSourceRows();if(R.maxRows===Y)return;const G=g==="insert_row_below"?"below":"above";m=m!=null?m:G==="below"?Y:0;const{delta:ne,startPhysicalIndex:v}=a.createRow(m,w,{source:b,mode:G});z.shiftRows(o.toVisualRow(v),ne);break;case"insert_col_start":case"insert_col_end":const C=g==="insert_col_end"?"end":"start";m=m!=null?m:C==="end"?o.countSourceCols():0;const{delta:E,startPhysicalIndex:x}=a.createCol(m,w,{source:b,mode:C});if(E){if(Array.isArray(R.colHeaders)){const F=[o.toVisualColumn(x),0];F.length+=E,Array.prototype.splice.apply(R.colHeaders,F)}z.shiftColumns(o.toVisualColumn(x),E)}break;case"remove_row":const I=F=>{let _=0;M(F,H=>{let[N,D]=H;const j=Wt(N)?o.countRows()-1:Math.max(N-_,0);if(Number.isInteger(N)&&(N=Math.max(N-_,0)),!a.removeRow(N,D,b))return;if(z.isSelected()){const{row:Ve}=o.getSelectedRangeLast().highlight;Ve>=N&&Ve<=N+D-1&&c.closeEditor(!0)}const ue=o.countRows();ue===0?z.deselect():b==="ContextMenu.removeRow"?z.refresh():z.shiftRows(N,-D);const ye=R.fixedRowsTop;ye>=j+1&&(R.fixedRowsTop-=Math.min(D,ye-j));const Ne=R.fixedRowsBottom;Ne&&j>=ue-Ne&&(R.fixedRowsBottom-=Math.min(D,Ne)),_+=D})};Array.isArray(m)?I(k(m)):I([[m,w]]);break;case"remove_col":const A=F=>{let _=0;M(F,H=>{let[N,D]=H;const j=Wt(N)?o.countCols()-1:Math.max(N-_,0);let ae=o.toPhysicalColumn(j);if(Number.isInteger(N)&&(N=Math.max(N-_,0)),!a.removeCol(N,D,b))return;if(z.isSelected()){const{col:Ve}=o.getSelectedRangeLast().highlight;Ve>=N&&Ve<=N+D-1&&c.closeEditor(!0)}o.countCols()===0?z.deselect():b==="ContextMenu.removeColumn"?z.refresh():z.shiftColumns(N,-D);const Ne=R.fixedColumnsStart;Ne>=j+1&&(R.fixedColumnsStart-=Math.min(D,Ne-j)),Array.isArray(R.colHeaders)&&(typeof ae=="undefined"&&(ae=-1),R.colHeaders.splice(ae,D)),_+=D})};Array.isArray(m)?A(k(m)):A([[m,w]]);break;default:throw new Error(`There is no such action "${g}"`)}P||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const g=R.minRows,m=R.minSpareRows,w=R.minCols,b=R.minSpareCols;if(g){const P=o.countRows();P<g&&a.createRow(P,g-P,{source:"auto"})}if(m){const P=o.countEmptyRows(!0);if(P<m){const k=m-P,Y=Math.min(k,R.maxRows-o.countSourceRows());a.createRow(o.countRows(),Y,{source:"auto"})}}{let P;(w||b)&&(P=o.countEmptyCols(!0));let k=o.countCols();if(w&&!R.columns&&k<w){const Y=w-k;P+=Y,a.createCol(k,Y,{source:"auto"})}if(b&&!R.columns&&o.dataType==="array"&&P<b){k=o.countCols();const Y=b-P,G=Math.min(Y,R.maxCols-k);a.createCol(k,G,{source:"auto"})}}},populateFromArray(g,m,w,b,P){let k,Y,G,ne;const v=[],C={},E=[],x=g.row,I=g.col;if(Y=m.length,Y===0)return!1;let A=0,F=0;switch(He(w)&&(A=w.col-I+1,F=w.row-x+1),P){case"shift_down":const _=Yg(m),H=_.length,N=Math.max(H,A),D=o.getData().slice(x),j=Yg(D).slice(I,I+N);for(G=0;G<N;G+=1)if(G<H){for(k=0,Y=_[G].length;k<F-Y;k+=1)_[G].push(_[G][k%Y]);G<j.length?E.push(_[G].concat(j[G])):E.push(_[G].concat(new Array(D.length).fill(null)))}else E.push(_[G%H].concat(j[G]));o.populateFromArray(x,I,Yg(E));break;case"shift_right":const ae=m.length,ue=Math.max(ae,F),ye=o.getData().slice(x).map(dn=>dn.slice(I));for(k=0;k<ue;k+=1)if(k<ae){for(G=0,ne=m[k].length;G<A-ne;G+=1)m[k].push(m[k][G%ne]);if(k<ye.length)for(let dn=0;dn<ye[k].length;dn+=1)m[k].push(ye[k][dn]);else m[k].push(...new Array(ye[0].length).fill(null))}else m.push(m[k%Y].slice(0,ue).concat(ye[k]));o.populateFromArray(x,I,m);break;case"overwrite":default:C.row=g.row,C.col=g.col;let Ne=0,Ve=0,Te=!0,$e;const Nt=function(Zt){let Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const mt=m[Zt%m.length];return Dt!==null?mt[Dt%mt.length]:mt},Ji=m.length,Or=w?w.row-g.row+1:0;for(w?Y=Or:Y=Math.max(Ji,Or),k=0;k<Y&&!(w&&C.row>w.row&&Or>Ji||!R.allowInsertRow&&C.row>o.countRows()-1||C.row>=R.maxRows);k++){const dn=k-Ne,Zt=Nt(dn).length,Dt=w?w.col-g.col+1:0;if(w?ne=Dt:ne=Math.max(Zt,Dt),C.col=g.col,$e=o.getCellMeta(C.row,C.col),(b==="CopyPaste.paste"||b==="Autofill.fill")&&$e.skipRowOnPaste){Ne+=1,C.row+=1,Y+=1;continue}for(Ve=0,G=0;G<ne&&!(w&&C.col>w.col&&Dt>Zt||!R.allowInsertColumn&&C.col>o.countCols()-1||C.col>=R.maxCols);G++){if($e=o.getCellMeta(C.row,C.col),(b==="CopyPaste.paste"||b==="Autofill.fill")&&$e.skipColumnOnPaste){Ve+=1,C.col+=1,ne+=1;continue}if($e.readOnly&&b!=="UndoRedo.undo"){C.col+=1;continue}const mt=G-Ve;let nt=Nt(dn,mt),Le=o.getDataAtCell(C.row,C.col);if(nt!==null&&typeof nt=="object")if(Array.isArray(nt)&&Le===null&&(Le=[]),Le===null||typeof Le!="object")Te=!1;else{const Wd=Jh(Array.isArray(Le)?Le:Le[0]||Le),ia=Jh(Array.isArray(nt)?nt:nt[0]||nt);gb(Wd,ia)||Array.isArray(Wd)&&Array.isArray(ia)?nt=Xn(nt):Te=!1}else Le!==null&&typeof Le=="object"&&(Te=!1);Te&&v.push([C.row,C.col,nt]),Te=!0,C.col+=1}C.row+=1}o.setDataAtCell(v,null,null,b||"populateFromArray");break}}};function K(g){const m=YH(g);g0(m)?(o.runHooks("beforeLanguageChange",m),T.language=m,o.runHooks("afterLanguageChange",m)):GH(g)}function te(g,m){const w=g==="className"?o.rootElement:o.table;if(f)U(w,m);else{let b=[],P=[];T[g]&&(b=Array.isArray(T[g])?T[g]:oM(T[g])),m&&(P=Array.isArray(m)?m:oM(m));const k=rM(b,P),Y=rM(P,b);k.length&&ge(w,k),Y.length&&U(w,Y)}T[g]=m}this.init=function(){l.setData(R.data),o.runHooks("beforeInit"),(qo()||q1())&&U(o.rootElement,"mobile"),this.updateSettings(R,!0),this.view=new P5(this);const g=R.themeName||F_(o.rootElement);o.useTheme(g),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),c=$X.getInstance(o,R,z),d=QZ(o),h=new kX(o),Xg(this)&&jZ(o),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),!!f&&o.rootElement.offsetParent===null&&p3(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function se(){let g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function Ce(g){const m=g.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):g}function be(g,m,w){if(!g.length){w();return}const b=o.getActiveEditor(),P=new se;let k=!0;P.onQueueEmpty=()=>{b&&k&&b.cancelChanges(),w()};for(let Y=g.length-1;Y>=0;Y--){const[G,ne]=g[Y],v=a.propToCol(ne);let C;Number.isInteger(v)?C=o.getCellMeta(G,v):C=Me(Me({},Object.getPrototypeOf(R)),R),o.getCellValidator(C)&&(P.addValidatorToQueue(),o.validateCell(g[Y][3],C,function(E,x){return function(I){if(typeof I!="boolean")throw new Error("Validation error: result is not boolean");I===!1&&x.allowInvalid===!1&&(k=!1,g.splice(E,1),x.valid=!0),P.removeValidatorFormQueue()}}(Y,C),m))}P.checkIfQueueIsEmpty()}function je(g,m){for(let b=g.length-1;b>=0;b--){let P=!1;if(g[b]===null){g.splice(b,1);continue}if(!((g[b][2]===null||g[b][2]===void 0)&&(g[b][3]===null||g[b][3]===void 0))){if(R.allowInsertRow)for(;g[b][0]>o.countRows()-1;){const{delta:k}=a.createRow(void 0,void 0,{source:"auto"});if(k===0){P=!0;break}}if(o.dataType==="array"&&(!R.columns||R.columns.length===0)&&R.allowInsertColumn)for(;a.propToCol(g[b][1])>o.countCols()-1;){const{delta:k}=a.createCol(void 0,void 0,{source:"auto"});if(k===0){P=!0;break}}P||a.set(g[b][0],g[b][1],g[b][3])}}const w=g.length>0;if(o.forceFullRender=!0,w){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",g,m),c.closeEditor(),o.view.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",g,m||"edit");const b=o.getActiveEditor();b&&re(b.refreshValue)&&b.refreshValue()}else o.view.render()}this._createCellCoords=function(g,m){return o.view._wt.createCellCoords(g,m)},this._createCellRange=function(g,m,w){return o.view._wt.createCellRange(g,m,w)},this.validateCell=function(g,m,w,b){let P=o.getCellValidator(m);function k(Y){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){w(Y);return}const ne=m.visualCol,v=m.visualRow,C=o.getCell(v,ne,!0);if(C&&C.nodeName!=="TH"){const E=o.rowIndexMapper.getRenderableFromVisualIndex(v),x=o.columnIndexMapper.getRenderableFromVisualIndex(ne);o.view._wt.getSetting("cellRenderer",E,x,C)}w(Y)}AK(P)&&(P=function(Y){return function(G,ne){ne(Y.test(G))}}(P)),gt(P)?(g=o.runHooks("beforeValidate",g,m.visualRow,m.prop,b),o._registerImmediate(()=>{P.call(m,g,Y=>{!o||(Y=o.runHooks("afterValidate",Y,g,m.visualRow,m.prop,b),m.valid=Y,k(Y),o.runHooks("postAfterValidate",Y,g,m.visualRow,m.prop,b))})})):o._registerImmediate(()=>{m.valid=!0,k(m.valid,!1)})};function jt(g,m,w){return Array.isArray(g)?g:[[g,m,w]]}function Pe(g,m){const w=o.runHooks("beforeChange",g,m||"edit"),b=g.filter(k=>k!==null);if(w===!1||b.length===0){var P;return(P=o.getActiveEditor())===null||P===void 0||P.cancelChanges(),[]}for(let k=b.length-1;k>=0;k--){const[Y,G,,ne]=b[k],v=a.propToCol(G);let C;Number.isInteger(v)?C=o.getCellMeta(Y,v):C=Me(Me({},Object.getPrototypeOf(R)),R),C.type==="numeric"&&typeof ne=="string"&&Mq(ne)&&(b[k][3]=Ce(ne))}return b}this.setDataAtCell=function(g,m,w,b){const P=jt(g,m,w),k=[];let Y=b,G,ne,v;for(G=0,ne=P.length;G<ne;G++){if(typeof P[G]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof P[G][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");P[G][1]>=this.countCols()?v=P[G][1]:v=a.colToProp(P[G][1]),k.push([P[G][0],v,l.getAtCell(this.toPhysicalRow(P[G][0]),P[G][1]),P[G][2]])}!Y&&typeof g=="object"&&(Y=m);const C=Pe(k,Y);o.runHooks("afterSetDataAtCell",C,Y),be(C,Y,()=>{je(C,Y)})},this.setDataAtRowProp=function(g,m,w,b){const P=jt(g,m,w),k=[];let Y=b,G,ne;for(G=0,ne=P.length;G<ne;G++)k.push([P[G][0],P[G][1],l.getAtCell(this.toPhysicalRow(P[G][0]),P[G][1]),P[G][2]]);!Y&&typeof g=="object"&&(Y=m);const v=Pe(k,b);o.runHooks("afterSetDataAtRowProp",v,Y),be(v,Y,()=>{je(v,Y)})},this.listen=function(){o&&!o.isListening()&&(Mv.forEach(g=>{o!==g&&g.unlisten()}),Tv=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Tv=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return Tv===o.guid},this.destroyEditor=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(g),o.view.render(),m&&z.isSelected()&&c.prepareEditor()},this.populateFromArray=function(g,m,w,b,P,k,Y){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const G=typeof b=="number"?o._createCellCoords(b,P):null;return u.populateFromArray(o._createCellCoords(g,m),w,G,k,Y)},this.spliceCol=function(g,m,w){for(var b=arguments.length,P=new Array(b>3?b-3:0),k=3;k<b;k++)P[k-3]=arguments[k];return a.spliceCol(g,m,w,...P)},this.spliceRow=function(g,m,w){for(var b=arguments.length,P=new Array(b>3?b-3:0),k=3;k<b;k++)P[k-3]=arguments[k];return a.spliceRow(g,m,w,...P)},this.getSelected=function(){if(z.isSelected())return We(z.getSelectedRange(),g=>{let{from:m,to:w}=g;return[m.row,m.col,w.row,w.col]})},this.getSelectedLast=function(){const g=this.getSelected();let m;return g&&g.length>0&&(m=g[g.length-1]),m},this.getSelectedRange=function(){if(z.isSelected())return Array.from(z.getSelectedRange())},this.getSelectedRangeLast=function(){const g=this.getSelectedRange();let m;return g&&g.length>0&&(m=g[g.length-1]),m},this.emptySelectedCells=function(g){if(!z.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];M(z.getSelectedRange(),w=>{if(w.isSingleHeader())return;const b=w.getTopStartCorner(),P=w.getBottomEndCorner();ce(b.row,P.row,k=>{ce(b.col,P.col,Y=>{this.getCellMeta(k,Y).readOnly||m.push([k,Y,null])})})}),m.length>0&&this.setDataAtCell(m,g)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&(this.renderCall?this.render():o.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(g){this.suspendRender();const m=g();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const w=g();return this.resumeExecution(m),w},this.batch=function(g){this.suspendRender(),this.suspendExecution();const m=g();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!o.view)return;const g=o.view,{width:m,height:w}=g.getLastSize(),{width:b,height:P}=o.rootElement.getBoundingClientRect(),k=b!==m||P!==w;o.runHooks("beforeRefreshDimensions",{width:m,height:w},{width:b,height:P},k)!==!1&&((k||g._wt.wtOverlays.scrollableElement===o.rootWindow)&&(g.setLastSize(b,P),o.render(),g.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:m,height:w},{width:b,height:P},k))},this.updateData=function(g,m){A_(g,w=>{a=w},w=>{a=w,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),z.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:m,metaManager:y,firstRun:f})},this.loadData=function(g,m){A_(g,w=>{a=w},()=>{y.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),z.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:m,metaManager:y,firstRun:f})},this.getInitialColumnCount=function(){const g=R.columns;let m=0;if(Array.isArray(g))m=g.length;else if(gt(g))if(o.dataType==="array"){const w=this.countSourceCols();for(let b=0;b<w;b+=1)g(b)&&(m+=1)}else(o.dataType==="object"||o.dataType==="function")&&(m=a.colToPropCache.length);else if(re(R.dataSchema)){const w=a.getSchema();m=Array.isArray(w)?w.length:mb(w)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,m,w,b){return Tt(g)?a.getAll():a.getRange(o._createCellCoords(g,m),o._createCellCoords(w,b),a.DESTINATION_RENDERER)},this.getCopyableText=function(g,m,w,b){return a.getCopyableText(o._createCellCoords(g,m),o._createCellCoords(w,b))},this.getCopyableData=function(g,m){return a.getCopyable(g,a.colToProp(m))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=(f?o.loadData:o.updateData).bind(this);let b=!1,P,k;if(re(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(re(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(re(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(P in g)P==="data"||(P==="language"?K(g.language):P==="className"?te("className",g.className):P==="tableClassName"&&o.table?(te("tableClassName",g.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames()):ee.getSingleton().isRegistered(P)||ee.getSingleton().isDeprecated(P)?gt(g[P])?ee.getSingleton().addAsFixed(P,g[P],o):Array.isArray(g[P])&&ee.getSingleton().add(P,g[P],o):!m&&en(g,P)&&(T[P]=g[P]));g.data===void 0&&R.data===void 0?w(null,"updateSettings"):g.data!==void 0?w(g.data,"updateSettings"):g.columns!==void 0&&(a.createMap(),o.initIndexMappers());const Y=o.countCols(),G=R.columns;if(G&&gt(G)&&(b=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&y.clearCache(),Y>0)for(P=0,k=0;P<Y;P++){if(G){const C=b?G(P):G[k];C&&y.updateColumnMeta(k,C)}k+=1}re(g.cell)&&Ae(g.cell,C=>{o.setCellMetaObject(C.row,C.col,C)}),o.runHooks("afterCellMetaReset");let ne=o.rootElement.style.height;ne!==""&&(ne=parseInt(o.rootElement.style.height,10));let v=g.height;if(gt(v)&&(v=v()),m&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),v===null){const C=o.rootElement.getAttribute("data-initialstyle");C&&(C.indexOf("height")>-1||C.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",C):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else v!==void 0&&(o.rootElement.style.height=isNaN(v)?`${v}`:`${v}px`,o.rootElement.style.overflow="hidden");if(typeof g.width!="undefined"){let C=g.width;gt(C)&&(C=C()),o.rootElement.style.width=isNaN(C)?`${C}`:`${C}px`}if(!m){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const C=o.getCurrentThemeName(),E=en(g,"themeName");C&&E&&C!==g.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(C));const x=E&&g.themeName||F_(o.rootElement);o.useTheme(x),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",g)}u.adjustRowsAndCols(),o.view&&!f&&(o.forceFullRender=!0,o.view.render(),o.view._wt.wtOverlays.adjustElementsSize()),!m&&o.view&&(ne===""||v===""||v===void 0)&&ne!==v&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const g=o.getSelectedLast();if(R.getValue){if(gt(R.getValue))return R.getValue.call(o);if(g)return o.getData()[g[0][0]][R.getValue]}else if(g)return o.getDataAtCell(g[0],g[1])},this.getSettings=function(){return R},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,m,w,b,P){u.alter(g,m,w,b,P)},this.getCell=function(g,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,b=m,P=g;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;b=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;P=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return P===null||b===null||P===void 0||b===void 0?null:o.view.getCellAtCoords(o._createCellCoords(P,b),w)},this.getCoords=function(g){const m=this.view._wt.wtTable.getCoords(g);if(m===null)return null;const{row:w,col:b}=m;let P=w,k=b;return w>=0&&(P=this.rowIndexMapper.getVisualFromRenderableIndex(w)),b>=0&&(k=this.columnIndexMapper.getVisualFromRenderableIndex(b)),o._createCellCoords(P,k)},this.colToProp=function(g){return a.colToProp(g)},this.propToCol=function(g){return a.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,m){return a.get(g,a.colToProp(m))},this.getDataAtRowProp=function(g,m){return a.get(g,m)},this.getDataAtCol=function(g){const m=[],w=a.getRange(o._createCellCoords(0,g),o._createCellCoords(R.data.length-1,g),a.DESTINATION_RENDERER);for(let b=0;b<w.length;b+=1)for(let P=0;P<w[b].length;P+=1)m.push(w[b][P]);return m},this.getDataAtProp=function(g){const m=[],w=a.getRange(o._createCellCoords(0,a.propToCol(g)),o._createCellCoords(R.data.length-1,a.propToCol(g)),a.DESTINATION_RENDERER);for(let b=0;b<w.length;b+=1)for(let P=0;P<w[b].length;P+=1)m.push(w[b][P]);return m},this.getSourceData=function(g,m,w,b){let P;return g===void 0?P=l.getData():P=l.getByRange(o._createCellCoords(g,m),o._createCellCoords(w,b)),P},this.getSourceDataArray=function(g,m,w,b){let P;return g===void 0?P=l.getData(!0):P=l.getByRange(o._createCellCoords(g,m),o._createCellCoords(w,b),!0),P},this.getSourceDataAtCol=function(g){return l.getAtColumn(g)},this.setSourceDataAtCell=function(g,m,w,b){const P=jt(g,m,w),k=this.hasHook("afterSetSourceDataAtCell"),Y=[];k&&M(P,ne=>{let[v,C,E]=ne;Y.push([v,C,l.getAtCell(v,C),E])}),M(P,ne=>{let[v,C,E]=ne;l.setAtCell(v,C,E)}),k&&this.runHooks("afterSetSourceDataAtCell",Y,b),this.render();const G=o.getActiveEditor();G&&re(G.refreshValue)&&G.refreshValue()},this.getSourceDataAtRow=function(g){return l.getAtRow(g)},this.getSourceDataAtCell=function(g,m){return l.getAtCell(g,m)},this.getDataAtRow=function(g){return a.getRange(o._createCellCoords(g,0),o._createCellCoords(g,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,m,w,b){const P=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,m,w,b],[k,Y]=P;let[,,G,ne]=P,v=null,C=null;G===void 0&&(G=k),ne===void 0&&(ne=Y);let E="mixed";return ce(Math.max(Math.min(k,G),0),Math.max(k,G),x=>{let I=!0;return ce(Math.max(Math.min(Y,ne),0),Math.max(Y,ne),A=>(C=this.getCellMeta(x,A).type,v?I=v===C:v=C,I)),E=I?C:"mixed",I}),E},this.removeCellMeta=function(g,m,w){const[b,P]=[this.toPhysicalRow(g),this.toPhysicalColumn(m)];let k=y.getCellMetaKeyValue(b,P,w);o.runHooks("beforeRemoveCellMeta",g,m,w,k)!==!1&&(y.removeCellMeta(b,P,w),o.runHooks("afterRemoveCellMeta",g,m,w,k)),k=null},this.spliceCellsMeta=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,b=new Array(w>2?w-2:0),P=2;P<w;P++)b[P-2]=arguments[P];if(b.length>0&&!Array.isArray(b[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&y.removeRow(this.toPhysicalRow(g),m),b.length>0&&M(b.reverse(),k=>{y.createRow(this.toPhysicalRow(g)),M(k,(Y,G)=>this.setCellMetaObject(g,G,Y))}),o.render()},this.setCellMetaObject=function(g,m,w){typeof w=="object"&&Ae(w,(b,P)=>{this.setCellMeta(g,m,P,b)})},this.setCellMeta=function(g,m,w,b){if(o.runHooks("beforeSetCellMeta",g,m,w,b)===!1)return;let k=g,Y=m;g<this.countRows()&&(k=this.toPhysicalRow(g)),m<this.countCols()&&(Y=this.toPhysicalColumn(m)),y.setCellMeta(k,Y,w,b),o.runHooks("afterSetCellMeta",g,m,w,b)},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(g,m){let w=this.toPhysicalRow(g),b=this.toPhysicalColumn(m);return w===null&&(w=g),b===null&&(b=m),y.getCellMeta(w,b,{visualRow:g,visualColumn:m})},this.getColumnMeta=function(g){return y.getColumnMeta(this.toPhysicalColumn(g))},this.getCellMetaAtRow=function(g){return y.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||R.columns)},this.getCellRenderer=function(g,m){const w=typeof g=="number"?o.getCellMeta(g,m).renderer:g.renderer;return typeof w=="string"?VM(w):Tt(w)?VM("text"):w},this.getCellEditor=function(g,m){const w=typeof g=="number"?o.getCellMeta(g,m).editor:g.editor;return typeof w=="string"?PM(w):Tt(w)?PM("text"):w},this.getCellValidator=function(g,m){const w=typeof g=="number"?o.getCellMeta(g,m).validator:g.validator;return typeof w=="string"?jq(w):w},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,m){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,g)},this.validateColumns=function(g,m){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,g)},this._validateCells=function(g,m,w){const b=new se;g&&(b.onQueueEmpty=g);let P=o.countRows()-1;for(;P>=0;){if(m!==void 0&&m.indexOf(P)===-1){P-=1;continue}let k=o.countCols()-1;for(;k>=0;){if(w!==void 0&&w.indexOf(k)===-1){k-=1;continue}b.addValidatorToQueue(),o.validateCell(o.getDataAtCell(P,k),o.getCellMeta(P,k),Y=>{if(typeof Y!="boolean")throw new Error("Validation error: result is not boolean");Y===!1&&(b.valid=!1),b.removeValidatorFormQueue()},"validateCells"),k-=1}P-=1}b.checkIfQueueIsEmpty()},this.getRowHeader=function(g){let m=R.rowHeaders,w=g;return w!==void 0&&(w=o.runHooks("modifyRowHeader",w)),w===void 0?(m=[],ce(o.countRows()-1,b=>{m.push(o.getRowHeader(b))})):Array.isArray(m)&&m[w]!==void 0?m=m[w]:gt(m)?m=m(w):m&&typeof m!="string"&&typeof m!="number"&&(m=w+1),m},this.hasRowHeaders=function(){return!!R.rowHeaders},this.hasColHeaders=function(){if(R.colHeaders!==void 0&&R.colHeaders!==null)return!!R.colHeaders;for(let g=0,m=o.countCols();g<m;g++)if(o.getColHeader(g))return!0;return!1},this.getColHeader=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const w=o.runHooks("modifyColHeader",g);if(w===void 0){const G=[],ne=o.countCols();for(let v=0;v<ne;v++)G.push(o.getColHeader(v));return G}let b=R.colHeaders;const P=function(G){const ne=[],v=o.countCols();let C=0;for(;C<v;C++)gt(R.columns)&&R.columns(C)&&ne.push(C);return ne[G]},k=o.toPhysicalColumn(w),Y=P(k);return R.colHeaders===!1?b=null:R.columns&&gt(R.columns)&&R.columns(Y)&&R.columns(Y).title?b=R.columns(Y).title:R.columns&&R.columns[k]&&R.columns[k].title?b=R.columns[k].title:Array.isArray(R.colHeaders)&&R.colHeaders[k]!==void 0?b=R.colHeaders[k]:gt(R.colHeaders)?b=R.colHeaders(k):R.colHeaders&&typeof R.colHeaders!="string"&&typeof R.colHeaders!="number"&&(b=$5(w)),b=o.runHooks("modifyColumnHeaderValue",b,g,m),b},this._getColWidthFromSettings=function(g){let m;if(g>=0&&(m=o.getCellMeta(0,g).width),(m===void 0||m===R.width)&&(m=R.colWidths),m!=null){switch(typeof m){case"object":m=m[g];break;case"function":m=m(g);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(g,m){let w=o._getColWidthFromSettings(g);return w=o.runHooks("modifyColWidth",w,g,m),w===void 0&&(w=Wu),w},this._getRowHeightFromSettings=function(g){const m=this.view.getDefaultRowHeight();let w=R.rowHeights;if(w!=null){switch(typeof w){case"object":w=w[g];break;case"function":w=w(g);break}typeof w=="string"&&(w=parseInt(w,10))}return w!=null&&w<m?m:w},this.getRowHeight=function(g,m){let w=o._getRowHeightFromSettings(g);return w=o.runHooks("modifyRowHeight",w,g,m),w},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const g=R.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,m)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return kM(o.countRows()-1,w=>{if(o.isEmptyRow(w))m+=1;else if(g===!0)return!1}),m},this.countEmptyCols=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return kM(o.countCols()-1,w=>{if(o.isEmptyCol(w))m+=1;else if(g===!0)return!1}),m},this.isEmptyRow=function(g){return R.isEmptyRow.call(o,g)},this.isEmptyCol=function(g){return R.isEmptyCol.call(o,g)},this.selectCell=function(g,m,w,b){let P=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,k=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Tt(g)||Tt(m)?!1:this.selectCells([[g,m,w,b]],P,k)},this.selectCells=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&d.suspend();const b=z.selectCells(g);return b&&w&&o.listen(),d.resume(),b},this.selectColumns=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,w=arguments.length>2?arguments[2]:void 0;return z.selectColumns(g,m,w)},this.selectRows=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,w=arguments.length>2?arguments[2]:void 0;return z.selectRows(g,m,w)},this.deselectCell=function(){z.deselect()},this.selectAll=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,w=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),z.selectAll(g,m,w)};const Ke=(g,m)=>g.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(g){if(typeof g=="number"){var m;g={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(m=arguments[4])!==null&&m!==void 0?m:!0}}const{row:w,col:b,considerHiddenIndexes:P}=g!=null?g:{};let k=w,Y=b;if(P===void 0||P){const v=Number.isInteger(w)&&w>=0,C=Number.isInteger(b)&&b>=0,E=v?Ke(this.rowIndexMapper,w):void 0,x=C?Ke(this.columnIndexMapper,b):void 0;if(E===null||x===null)return!1;k=v?o.rowIndexMapper.getRenderableFromVisualIndex(E):w,Y=C?o.columnIndexMapper.getRenderableFromVisualIndex(x):b}const G=Number.isInteger(k),ne=Number.isInteger(Y);return G&&k>=0&&ne&&Y>=0?o.view.scrollViewport(o._createCellCoords(k,Y),g.horizontalSnap,g.verticalSnap):G&&k>=0&&(ne&&Y<0||!ne)?o.view.scrollViewportVertically(k,g.verticalSnap):ne&&Y>=0&&(G&&k<0||!G)?o.view.scrollViewportHorizontally(Y,g.horizontalSnap):!1},this.scrollToFocusedCell=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",g);const{highlight:m}=this.getSelectedRangeLast();this.scrollViewportTo(m.toObject())?this.view.render():(this.removeHook("afterScroll",g),this._registerImmediate(()=>g()))},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),y.clearCache(),Mv.delete(this.guid),Xg(o)){const g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}rs(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),V.getItems().forEach(g=>{let[,m]=g;m.destroy()}),V.clear(),o.runHooks("afterDestroy")},!0),ee.getSingleton().destroy(o),Ae(o,(g,m,w)=>{gt(g)?w[m]=bt(m):m!=="guid"&&(w[m]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,z=null,c=null,o=null};function bt(g){return()=>{throw new Error(`The "${g}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(g){return V.getItem(Rr(g))},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:V.getId(g)},this.getInstance=function(){return o},this.addHook=function(g,m,w){ee.getSingleton().add(g,m,o,w)},this.hasHook=function(g){return ee.getSingleton().has(g,o)||ee.getSingleton().has(g)},this.addHookOnce=function(g,m,w){ee.getSingleton().once(g,m,o,w)},this.removeHook=function(g,m){ee.getSingleton().remove(g,m,o)},this.runHooks=function(g,m,w,b,P,k,Y){return ee.getSingleton().run(o,g,m,w,b,P,k,Y)},this.getTranslatedPhrase=function(g,m){return JH(R.language,g,m)},this.toHTML=()=>$M(this),this.toTableElement=()=>{const g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",$M(this)),g.firstElementChild},this.timeouts=[],this.useTheme=g=>{this.view.getStylesHandler().useTheme(g),this.runHooks("afterSetTheme",g,!!f)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=g;typeof w=="function"&&(w=setTimeout(w,m)),this.timeouts.push(w)},this._clearTimeouts=function(){M(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){M(this.immediates,g=>{clearImmediate(g)})},this._getEditorManager=function(){return c};const qt=rQ({handleEvent(){return o.isListening()},beforeKeyDown:g=>this.runHooks("beforeKeyDown",g),afterKeyDown:g=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",g)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",g=>{g.ctrlKey===!1&&g.metaKey===!1&&qt.releasePressedKeys()}),this.getShortcutManager=function(){return qt},this.getFocusManager=function(){return h},aH().forEach(g=>{const m=bb(g);V.addItem(g,new m(this))}),WZ(o),qt.setActiveContextName("grid"),ee.getSingleton().run(o,"construct")}function V_(t,e,n){t.addEventListener(e,n,!1)}function W_(t,e,n){t.removeEventListener(e,n,!1)}function Af(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function mA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=Me({minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value},e),i=t.body,r=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;r.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=Af(s).fontSize,o.style.fontFamily=Af(s).fontFamily,o.style.whiteSpace="pre",i.appendChild(o);const f=parseInt(((h=Af(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),p=parseInt(((d=Af(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),S=o.clientWidth+f+p+1;i.removeChild(o);const y=s.style;y.height=`${n.minHeight}px`,n.minWidth>S?y.width=`${n.minWidth}px`:S>n.maxWidth?y.width=`${n.maxWidth}px`:y.width=`${S}px`;const R=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>R?y.height=`${n.minHeight}px`:n.maxHeight<R?(y.height=`${n.maxHeight}px`,y.overflowY="visible"):y.height=`${R}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(V_(s,"input",a),V_(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){W_(s,"input",a),W_(s,"keydown",l)}}}function B_(t,e){const n=N1(e),i=e.value.split(`
`);let r=n,o=0;for(let s=0;s<i.length;s++){const a=i[s];s!==0&&(o+=i[s-1].length+1);const l=o+a.length;if(t==="home"?r=o:t==="end"&&(r=l),n<=l)break}xp(e,r)}function ma(t,e,n){return(e=oQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oQ(t){var e=sQ(t,"string");return typeof e=="symbol"?e:e+""}function sQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const aQ="ht_editor_visible",Nf="ht_editor_hidden",j_="textEditor",lQ="text";class El extends rc{static get EDITOR_TYPE(){return lQ}constructor(e){super(e),ma(this,"eventManager",new Er(this)),ma(this,"autoResize",mA(this.hot.rootDocument)),ma(this,"TEXTAREA",void 0),ma(this,"textareaStyle",void 0),ma(this,"TEXTAREA_PARENT",void 0),ma(this,"textareaParentStyle",void 0),ma(this,"layerClass",void 0),this.eventManager=new Er(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Gg(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,i,r,o,s){const a=this.state;if(super.prepare(e,n,i,r,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Ft.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Ft.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),xp(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),ve(this.TEXTAREA,[["data-hot-input",""],bl(-1)]),U(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),U(this.TEXTAREA_PARENT,"handsontableInputHolder"),pe(this.TEXTAREA_PARENT,this.layerClass)&&ge(this.TEXTAREA_PARENT,this.layerClass),U(this.TEXTAREA_PARENT,Nf),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){B3()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ge(this.TEXTAREA_PARENT,this.layerClass),U(this.TEXTAREA_PARENT,Nf)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;ce(e.length-1,i=>{const r=e[i];if(pe(r,"handsontableEditor"))return n=!0,!1}),pe(this.TEXTAREA_PARENT,Nf)&&ge(this.TEXTAREA_PARENT,Nf),n?(this.layerClass=aQ,U(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),U(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Ft.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:i,width:r,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(r,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){X1()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Ft.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Ft.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>re(this.hot.getSelected()),group:j_},r=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;B_(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;B_(a,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(j_)}}const uQ="base";function xd(t,e,n,i,r,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&U(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(hM())):a&&c.push(hM()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(dM())):(u.push(s.invalidCellClassName),a&&c.push(dM()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),ge(e,u),U(e,l),tc(e,c),ve(e,h)}xd.RENDERER_TYPE=uQ;const cQ="text";function fs(t,e,n,i,r,o,s){xd.apply(this,[t,e,n,i,r,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Gt(a),s.trimWhitespace&&(a=a.trim()),ll(e,a)}fs.RENDERER_TYPE=cQ;const hQ="text",pA={CELL_TYPE:hQ,editor:El,renderer:fs};lr(pA);Ii.editors={BaseEditor:rc};function Ii(t,e){const n=new gA(t,e||{},Vb);return n.init(),n}Ii.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new gA(t,e,Vb)};Ii.DefaultSettings=aA();Ii.hooks=ee.getSingleton();Ii.CellCoords=_m;Ii.CellRange=Eb;Ii.packageName="handsontable";Ii.buildDate="19/03/2025 09:41:52";Ii.version="15.2.0";Ii.languages={dictionaryKeys:b8,getLanguageDictionary:QH,getLanguagesDictionaries:_8,registerLanguageDictionary:ZH,getTranslatedPhrase:JH};function dQ(t,e,n){return(e=mQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function fQ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?U_(Object(n),!0).forEach(function(i){dQ(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U_(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function gQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mQ(t){var e=gQ(t,"string");return typeof e=="symbol"?e:e+""}function Oh(t){return Oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oh(t)}var Nu=Symbol("unassigned"),pQ="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function Hm(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function wA(t){var e=Ii.hooks.getRegistered(),n={};Object.assign(n,Ii.DefaultSettings);for(var i in n)n[i]={default:Nu};for(var r=0;r<e.length;r++)n[e[r]]={default:Nu};return n.settings={default:Nu},t==="HotTable"&&(n.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),n}function vA(t){var e={},n=t.settings;if(n!==Nu)for(var i in n)Hm(n,i)&&n[i]!==Nu&&(e[i]=n[i]);for(var r in t)Hm(t,r)&&r!=="settings"&&t[r]!==Nu&&(e[r]=t[r]);return e}function z_(t,e){var n=vA(t),i=t.settings?t.settings:n,r=t.settings?n:null,o={};for(var s in i)Hm(i,s)&&i[s]!==void 0&&(e&&s!=="data"?!Y_(e[s],i[s]):!0)&&(o[s]=i[s]);for(var a in r)Hm(r,a)&&a!=="id"&&a!=="settings"&&r[a]!==void 0&&(e&&a!=="data"?!Y_(e[a],r[a]):!0)&&(o[a]=r[a]);return o}function Y_(t,e){var n=function(r){var o=function(){var s=new WeakSet;return function(a,l){if(Oh(l)==="object"&&l!==null){if(s.has(l))return;s.add(l)}return l}}();return JSON.stringify(r,o)};return typeof t=="function"&&typeof e=="function"?t.toString()===e.toString():Oh(t)!==Oh(e)?!1:n(t)===n(e)}var wQ="15.2.0",p0=mS({name:"HotTable",props:wA("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(e){var n=z_(e,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||n===void 0||(n.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete n.data),Object.keys(n).length?this.hotInstance.updateSettings(n):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(pQ),null)},set hotInstance(e){this.__hotInstance=e}}},methods:{hotInit:function(){var e=z_(this.$props);e.columns=this.columnSettings?this.columnSettings:e.columns,this.hotInstance=GD(new Ii.Core(this.$el,e)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(!!this.hotInstance){var n=this.hotInstance.getSourceData(),i=[],r=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),a=0;if(n&&n.length!==o&&n.length<o)for(var l=n.length;l<o;l++)i.push(l);if(s){var u;if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&((u=n[0])===null||u===void 0?void 0:u.length)!==a&&n[0].length<a)for(var c=n[0].length;c<a;c++)r.push(c)}this.hotInstance.batch(function(){i.length>0?e.hotInstance.rowIndexMapper.removeIndexes(i):e.hotInstance.rowIndexMapper.insertIndexes(o-1,n.length-o),s&&n.length!==0&&(r.length>0?e.hotInstance.columnIndexMapper.removeIndexes(r):e.hotInstance.columnIndexMapper.insertIndexes(a-1,n[0].length-a))})}},getColumnSettings:function(){var e=Array.from(this.columnsCache.values());return e.length?e:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:wQ}),vQ=["id"];function CQ(t,e,n,i,r,o){return oO(),sO("div",{id:t.id},[KD(t.$slots,"default")],8,vQ)}p0.render=CQ;p0.__file="src/HotTable.vue";var yQ=mS({name:"HotColumn",props:wA("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var e=vA(this.$props),n=fQ({},e);e.renderer&&(n.renderer=e.renderer),e.editor&&(n.editor=e.editor),this.columnsCache.set(this,n)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});yQ.__file="src/HotColumn.vue";const G_="handsontableEditor",SQ="handsontable";class w0 extends El{static get EDITOR_TYPE(){return SQ}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),xp(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&nn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const r=this.htEditor.getValue();r!==void 0&&this.setValue(r)}super.finishEditing(e,n,i)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{if(!n){var i;(i=this.htEditor)===null||i===void 0||i.useTheme(e)}})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:G_,relativeToGroup:na,position:"before"},r=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Ir(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),r(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return r(a,o)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(G_)}}function bQ(t,e){CA(t,e),e.add(t)}function RQ(t,e,n){CA(t,e),e.set(t,n)}function CA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Df(t,e,n){return(e=EQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EQ(t){var e=TQ(t,"string");return typeof e=="symbol"?e:e+""}function TQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function K_(t,e){return t.get(Fy(t,e))}function Fy(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const MQ="autocomplete";var _v=new WeakMap,Iv=new WeakSet;class v0 extends w0{constructor(){super(...arguments),bQ(this,Iv),Df(this,"query",null),Df(this,"strippedChoices",[]),Df(this,"rawChoices",[]),RQ(this,_v,this.hot.guid.slice(0,9)),Df(this,"sortByRelevance",function(e,n,i){const r=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=cM(Gt(n[c])),i)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,r.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(r.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=r.length;c<a;c++)o.push(r[c].baseIndex);return o})}static get EDITOR_TYPE(){return MQ}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return re(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),U(this.htContainer,"autocompleteEditor"),U(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[qK(),zK(),E1("listbox"),e3()])}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[Yi("false"),t3(`${K_(_v,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=i==null?void 0:i.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.updateSettings({colWidths:e?[Yt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,autoRowSize:!0,renderer:(a,l,u,c,h,d,f)=>{fs(a,l,u,c,h,d,f);const{filteringCaseSensitive:p,allowHtml:S,locale:y}=this.cellProperties,R=this.query;let T=Gt(d),V,B;T&&!S&&(V=p===!0?T.indexOf(R):T.toLocaleLowerCase(y).indexOf(R.toLocaleLowerCase(y)),V!==-1&&(B=T.substr(V,R.length),T=T.replace(B,`<strong>${B}</strong>`))),n&&ve(l,[YK(),...i?[o3(r)]:[],...i?[s3(i.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=T},afterSelectionEnd:(a,l)=>{if(n){const u=this.htEditor.getCell(a,l,!0);ve(u,[ub()]),ve(this.TEXTAREA,...n3(u.id))}}}),n&&(ve(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...uo()),ve(this.htEditor.rootElement,[R1(),i3("polite"),r3("text"),["id",`${K_(_v,this)}-listbox-${o}-${s}`]]),ve(this.TEXTAREA,...Yi("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[Yi("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=N1(this.TEXTAREA),i=g3(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;r&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)a=u>0?s[0]:0;else{const c=[];for(let h=0,d=l.length;h<d&&!(r&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Yg([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),xp(this.TEXTAREA,n,n===i?void 0:i)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),n=e.height;let i=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const a=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;i=Math.max(i+a,0)}const r=this.getHeight(),o=this.hot.view.getWorkspaceHeight()-i-n,s=r>o&&i>o+n;return s?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(s?i:o,r),s}limitDropdownIfNeeded(e,n){if(n>e){let i=0,r=0,o=0,s=null;do o=this.htEditor.getRowHeight(r)||this.htEditor.view.getDefaultRowHeight(),i+=o,r+=1;while(i<e);s=i-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(i-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),Fy(Iv,this,X_).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),Fy(Iv,this,X_).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),i=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:i},(o,s)=>s).reduce((o,s)=>o+this.htEditor.getRowHeight(s),0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,i=We(e,o=>Gt(o));return We(i,o=>n?o:cM(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),i={row:n?n.from.row:-1};let r=!1;return e===fe.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(r=!0),e===fe.ARROW_UP&&i.row>-1&&(r=!0),r}onBeforeKeyDown(e){if(U3(e.keyCode)||e.keyCode===fe.BACKSPACE||e.keyCode===fe.DELETE||e.keyCode===fe.INSERT){let n=10;if(e.keyCode===fe.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function X_(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.htEditor.getSettings().width+wn(this.hot.rootDocument)})}const _Q="checkbox";class yA extends rc{static get EDITOR_TYPE(){return _Q}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');pe(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Ws=()=>window,Bi=()=>window.document,Vy=(t,e)=>window.setTimeout(t,e),Zr=function(t,e,n,i){t.addEventListener(e,n,!!i)},Po=function(t,e,n,i){t.removeEventListener(e,n,!!i)},IQ=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},wi=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},Pv=function(t,e){wi(t,e)||(t.className=t.className===""?e:t.className+" "+e)},Ov=function(t,e){t.className=IQ((" "+t.className+" ").replace(" "+e+" "," "))},C0=function(t){return/Array/.test(Object.prototype.toString.call(t))},Si=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},PQ=function(t){let e=t.getDay();return e===0||e===6},OQ=function(t){return t%4===0&&t%100!==0||t%400===0},q_=function(t,e){return[31,OQ(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},$f=function(t){Si(t)&&t.setHours(0,0,0,0)},Lf=function(t,e){return t.getTime()===e.getTime()},Am=function(t,e,n){let i,r;for(i in e)r=t[i]!==void 0,r&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?Si(e[i])?n&&(t[i]=new Date(e[i].getTime())):C0(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=Am({},e[i],n):(n||!r)&&(t[i]=e[i]);return t},Z_=function(t,e,n){let i=Bi().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=Am(i,n),t.dispatchEvent(i)},Q_=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Fr={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},J_=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},xQ=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},HQ=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),i=t.getDay(),r=e,o=r-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(i));let l=new Date(t.getFullYear(),0,r),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},AQ=function(t,e,n,i,r){let o=new Date(i,n,e),s=t.hasMoment?t.moment(o).isoWeek():HQ(o,r);return'<td class="pika-week">'+s+"</td>"},NQ=function(t,e,n,i){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},DQ=function(t){return"<tbody>"+t.join("")+"</tbody>"},$Q=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+J_(t,e)+'">'+J_(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},LQ=function(t,e,n,i,r,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,p,S=!0,y=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===r?s-e:12+s-e)+'"'+(s===i?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",C0(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return p='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=p+f:d+=f+p,c&&(i===0||u.minMonth>=i)&&(S=!1),h&&(i===11||u.maxMonth<=i)&&(y=!1),e===0&&(d+='<button class="pika-prev'+(S?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(y?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},kQ=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+$Q(t)+DQ(e)+"</table>"};function Wy(t){let e=this,n=e.config(t);e._onMouseDown=function(r){if(!e._v)return;r=r||Ws().event;let o=r.target||r.srcElement;if(!!o)if(wi(o,"is-disabled")||(wi(o,"pika-button")&&!wi(o,"is-empty")&&!wi(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&Vy(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):wi(o,"pika-prev")?e.prevMonth():wi(o,"pika-next")&&e.nextMonth()),wi(o,"pika-select"))e._c=!0;else if(r.preventDefault)r.preventDefault();else return r.returnValue=!1,!1},e._onChange=function(r){r=r||Ws().event;let o=r.target||r.srcElement;!o||(wi(o,"pika-select-month")?e.gotoMonth(o.value):wi(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(r){if(r=r||Ws().event,e.isVisible())switch(r.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let r=this.moment(n.field.value,n.format,n.formatStrict);return r&&r.isValid()?r.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(r){let o;r.firedBy!==e&&(o=e._parseFieldValue(),Si(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let r=Bi().activeElement;do if(wi(r,"pika-single"))return;while(r=r.parentNode);e._c||(e._b=Vy(function(){e.hide()},50)),e._c=!1},e._onClick=function(r){r=r||Ws().event;let o=r.target||r.srcElement,s=o;if(!!o){!hasEventListeners&&wi(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Zr(o,"change",e._onChange)));do if(wi(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=Bi().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Zr(e.el,"mousedown",e._onMouseDown,!0),Zr(e.el,"touchend",e._onMouseDown,!0),Zr(e.el,"change",e._onChange),n.keyboardInput&&Zr(Bi(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?Bi().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Zr(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let i=n.defaultDate;Si(i)?n.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Zr(n.trigger,"click",e._onInputClick),Zr(n.trigger,"focus",e._onInputFocus),Zr(n.trigger,"blur",e._onInputBlur)):this.show()}Wy.prototype={config:function(t){this._o||(this._o=Am({},Fr,!0));let e=Am(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Si(e.minDate)||(e.minDate=!1),Si(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),C0(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Fr.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Si(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Si(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",Z_(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Si(t))return;let n=this._o.minDate,i=this._o.maxDate;Si(n)&&t<n?t=n:Si(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),$f(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),Z_(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(!!Si(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=r<n.getTime()||i.getTime()<r}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,r;t==="add"?r=new Date(n.valueOf()+i):t==="subtract"&&(r=new Date(n.valueOf()-i)),this.setDate(r)},adjustCalendars:function(){this.calendars[0]=Q_(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=Q_({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?($f(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Fr.minDate,this._o.minYear=Fr.minYear,this._o.minMonth=Fr.minMonth,this._o.startRange=Fr.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?($f(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Fr.maxDate,this._o.maxYear=Fr.maxYear,this._o.maxMonth=Fr.maxMonth,this._o.endRange=Fr.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,i=e.maxYear,r=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=i&&(this._y=i,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+LQ(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&Vy(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,i,r,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,i=Ws().innerWidth||Bi().documentElement.clientWidth,r=Ws().innerHeight||Bi().documentElement.clientHeight,o=Bi().body.scrollTop||Bi().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+Ws().pageXOffset,a=l.bottom+Ws().pageYOffset,(this._o.reposition&&s+e>i||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>r+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",Pv(this.el,u?"left-aligned":"right-aligned"),Pv(this.el,c?"bottom-aligned":"top-aligned"),Ov(this.el,u?"right-aligned":"left-aligned"),Ov(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let i=this._o,r=new Date,o=q_(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];$f(r),i.firstDay>0&&(s-=i.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=q_(h,u),p=o+s,S=p;for(;S>7;)S-=7;p+=7-S;let y=!1;for(let R=0,T=0;R<p;R++){let V=new Date(t,e,1+(R-s)),B=Si(this._d)?Lf(V,this._d):!1,W=Lf(V,r),$=i.events.indexOf(V.toDateString())!==-1,L=R<s||R>=o+s,z=1+(R-s),ie=e,K=t,te=i.startRange&&Lf(i.startRange,V),se=i.endRange&&Lf(i.endRange,V),Ce=i.startRange&&i.endRange&&i.startRange<V&&V<i.endRange,be=i.minDate&&V<i.minDate||i.maxDate&&V>i.maxDate||i.disableWeekends&&PQ(V)||i.disableDayFn&&i.disableDayFn(V);L&&(R<s?(z=f+z,ie=u,K=h):(z=z-o,ie=c,K=d));let je={day:z,month:ie,year:K,hasEvent:$,isSelected:B,isToday:W,isDisabled:be,isEmpty:L,isStartRange:te,isEndRange:se,isInRange:Ce,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&B&&(y=!0),l.push(xQ(je)),++T===7&&(i.showWeekNumber&&l.unshift(AQ(this,R-s,e,t,i.firstWeekOfYearMinDays)),a.push(NQ(l,i.isRTL,i.pickWholeWeek,y)),l=[],T=0,y=!1)}return kQ(i,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),Ov(this.el,"is-hidden"),this._o.bound&&(Zr(Bi(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Po(Bi(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Pv(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Po(this.el,"mousedown",this._onMouseDown,!0),Po(this.el,"touchend",this._onMouseDown,!0),Po(this.el,"change",this._onChange),t.keyboardInput&&Po(Bi(),"keydown",this._onKeyChange),t.field&&(Po(t.field,"change",this._onInputChange),t.bound&&(Po(t.trigger,"click",this._onInputClick),Po(t.trigger,"focus",this._onInputFocus),Po(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function FQ(t,e){VQ(t,e),e.add(t)}function VQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eI(t,e,n){return(e=WQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WQ(t){var e=BQ(t,"string");return typeof e=="symbol"?e:e+""}function BQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const SA="date",tI="dateEditor",jQ="DD/MM/YYYY";var kf=new WeakSet;class bA extends El{constructor(){super(...arguments),FQ(this,kf),eI(this,"parentDestroyed",!1),eI(this,"$datePicker",null)}static get EDITOR_TYPE(){return SA}init(){if(typeof X!="function")throw new Error("You need to include moment.js to your project.");if(typeof Wy!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(ge(this.datePicker,/ht-theme-.*/g),U(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),U(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();ge(this.datePicker,/ht-theme-.*/g),U(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{pe(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:tI})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const r=this.hot._getEditorManager();r.closeEditor(),this.hot.view.render(),r.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(tI),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=xv(kf,this,Hv).call(this),i=this.hot.view.isMouseDown(),r=e?Z1(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new Wy(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(X),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,X(o,n,!0).isValid()&&this.$datePicker.setMoment(X(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!r&&!i&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,X(o,n,!0).isValid()&&this.$datePicker.setMoment(X(o,n),!0),!r&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,i={};this.cellProperties&&this.cellProperties.datePickerConfig&&Ap(i,this.cellProperties.datePickerConfig);const r=i.onSelect,o=i.onClose;return i.field=n,i.trigger=n,i.container=this.datePicker,i.bound=!1,i.keyboardInput=!1,i.format=(e=i.format)!==null&&e!==void 0?e:xv(kf,this,Hv).call(this),i.reposition=i.reposition||!1,i.isRTL=!1,i.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=X(a).format(xv(kf,this,Hv).call(this))),this.setValue(a),r&&r(),qo()&&this.hideDatepicker()},i.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},i}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Ft.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:r}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+tn(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-Yt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function Hv(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:jQ}const UQ="dropdown";class RA extends v0{static get EDITOR_TYPE(){return UQ}prepare(e,n,i,r,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,i,r,o,s)}}const zQ="numeric";class EA extends El{static get EDITOR_TYPE(){return zQ}}function YQ(t,e,n){return(e=GQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GQ(t){var e=KQ(t,"string");return typeof e=="symbol"?e:e+""}function KQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const XQ="password";class TA extends El{constructor(){super(...arguments),YQ(this,"autoResize",mA(this.hot.rootDocument,{textContent:e=>"\u2022".repeat(e.value.length)}))}static get EDITOR_TYPE(){return XQ}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,rs(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Av="ht_editor_visible",nI="selectEditor",qQ="select";class MA extends rc{static get EDITOR_TYPE(){return qQ}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Js()),e.appendChild(this.hot.rootDocument.createTextNode(String.fromCharCode(9660))),U(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",pe(this.selectWrapper,Av)&&ge(this.selectWrapper,Av),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),rs(this.select),Ae(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,nc(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let i=0,r=e.length;i<r;i++)n[e[i]]=e[i];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Ft.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:i,height:r}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${r}px`,o.width=`${i}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",U(this.selectWrapper,Av)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={group:nI};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const r=this.select.selectedIndex-1;r>=0&&(this.select[r].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const r=this.select.selectedIndex+1;r<=this.select.length-1&&(this.select[r].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(nI)}}const ZQ="time";class _A extends El{static get EDITOR_TYPE(){return ZQ}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s),this.TEXTAREA.dir="ltr"}}function QQ(){vi(rc),vi(v0),vi(yA),vi(bA),vi(RA),vi(w0),vi(EA),vi(TA),vi(MA),vi(El),vi(_A)}const JQ="html";function y0(t,e,n,i,r,o,s){xd.apply(this,[t,e,n,i,r,o,s]),nc(e,o==null?"":o,!1)}y0.RENDERER_TYPE=JQ;const eJ="autocomplete";function oc(t,e,n,i,r,o,s){const{rootDocument:a}=t,l=s.allowHtml?y0:fs,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Js()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,i,r,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),U(e,"htAutocomplete"),!t.acArrowListener){const h=new Er(t);t.acArrowListener=function(d){pe(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,i),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}oc.RENDERER_TYPE=eJ;const tJ="dropdown";function S0(t,e,n,i,r,o,s){oc.apply(this,[t,e,n,i,r,o,s])}S0.RENDERER_TYPE=tJ;const iI=new WeakMap,rI=new WeakMap,nJ="htBadValue",ju="data-row",Uu="data-col",iJ="checkboxRenderer",IA="checkbox";ee.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:i,type:r,row:o,column:s,prop:a}=e;if(r===IA){if(i){const{value:l,property:u}=i;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function b0(t,e,n,i,r,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;xd.apply(this,[t,e,n,i,r,o,s]),rJ(t);let u=oJ(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate=="undefined"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate=="undefined"&&(s.uncheckedTemplate=!1),rs(e),o===s.checkedTemplate||Gt(o).toLocaleLowerCase(s.locale)===Gt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Gt(o).toLocaleLowerCase(s.locale)===Gt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Wt(o)?U(u,"noValue"):(u.style.display="none",U(u,nJ),h=!0),ve(u,[[ju,n],[Uu,i]]),l&&ve(u,[ym(u.checked?t.getTranslatedPhrase(d0):t.getTranslatedPhrase(f0)),_1(u.checked),GK()]),!h&&c){let S="";if(c.value)S=typeof c.value=="function"?c.value.call(this,n,i,r,o):c.value;else if(c.property){const R=t.getDataAtRowProp(n,c.property);S=R!==null?R:""}const y=sJ(a,S,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(y),e.appendChild(u)):(y.appendChild(u),u=y):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(y)):(y.insertBefore(u,y.firstChild),u=y))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),iI.has(t)||(iI.set(t,!0),d());function d(){const y=t.getShortcutManager().getContext("grid"),R={group:iJ,relativeToGroup:na,position:"before"};y.addShortcuts([{keys:[["space"]],callback:()=>(f(),!p()),runOnlyIf:()=>{var T;return(T=t.getSelectedRangeLast())===null||T===void 0?void 0:T.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!p()),runOnlyIf:()=>{const T=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(T==null?void 0:T.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!p()),runOnlyIf:()=>{var T;return(T=t.getSelectedRangeLast())===null||T===void 0?void 0:T.highlight.isCell()}}],R)}function f(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=t.getSelectedRange(),R=[],T=new Map;let V=[],B=0;if(!!y){for(let W=0;W<y.length;W++){const{row:$,col:L}=y[W].getTopStartCorner(),{row:z,col:ie}=y[W].getBottomEndCorner();for(let K=$;K<=z;K+=1)for(let te=L;te<=ie;te+=1){const se=t.getCellMeta(K,te);if(se.hidden)continue;const Ce={checkedTemplate:se.checkedTemplate,uncheckedTemplate:se.uncheckedTemplate};if(se.type!=="checkbox"){S===!0&&!se.readOnly&&(T.has(R.length)?T.set(R.length,[...T.get(R.length),[K,te,null]]):T.set(R.length,[[K,te,null]]));continue}if(se.readOnly===!0)continue;typeof se.checkedTemplate=="undefined"&&(se.checkedTemplate=!0),typeof se.uncheckedTemplate=="undefined"&&(se.uncheckedTemplate=!1);const be=t.getDataAtCell(K,te);S===!1?[se.checkedTemplate,se.checkedTemplate.toString()].includes(be)?V.push([K,te,se.uncheckedTemplate,Ce]):[se.uncheckedTemplate,se.uncheckedTemplate.toString(),null,void 0].includes(be)&&V.push([K,te,se.checkedTemplate,Ce]):V.push([K,te,se.uncheckedTemplate,Ce]),B+=1}R.push(B),B=0}V.every(W=>{let[,,$]=W;return $===V[0][2]})?V=V.map(W=>{let[$,L,z]=W;return[$,L,z]}):V=V.map(W=>{let[$,L,,z]=W;return[$,L,z.checkedTemplate]}),V.length>0&&R.forEach((W,$)=>{let L=V.splice(0,W);T.size&&T.has($)&&(L=[...L,...T.get($)]),t.setDataAtCell(L)})}}function p(){const S=t.getSelectedRange();if(!!S){for(let y=0;y<S.length;y++){const R=S[y].getTopStartCorner(),T=S[y].getBottomEndCorner();for(let V=R.row;V<=T.row;V++)for(let B=R.col;B<=T.col;B++){if(t.getCellMeta(V,B).readOnly)continue;const $=t.getCell(V,B);if(Ys($)&&$.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}b0.RENDERER_TYPE=IA;function rJ(t){let e=rI.get(t);if(!e){const{rootElement:n}=t;e=new Er(t),e.addEventListener(n,"click",i=>lJ(i,t)),e.addEventListener(n,"mouseup",i=>aJ(i,t)),e.addEventListener(n,"change",i=>uJ(i,t)),rI.set(t,e)}return e}function oJ(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function sJ(t,e,n){const i=t.createElement("label");i.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const r=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(r),i.appendChild(o)}else i.appendChild(r);return i.cloneNode(!0)}function aJ(t,e){const{target:n}=t;!R0(n)||!n.hasAttribute(ju)||!n.hasAttribute(Uu)||setTimeout(e.listen,10)}function lJ(t,e){const{target:n}=t;if(!R0(n)||!n.hasAttribute(ju)||!n.hasAttribute(Uu))return;const i=parseInt(n.getAttribute(ju),10),r=parseInt(n.getAttribute(Uu),10);e.getCellMeta(i,r).readOnly&&t.preventDefault()}function uJ(t,e){const{target:n}=t;if(!R0(n)||!n.hasAttribute(ju)||!n.hasAttribute(Uu))return;const i=parseInt(n.getAttribute(ju),10),r=parseInt(n.getAttribute(Uu),10),o=e.getCellMeta(i,r);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(i,r,s)}}function R0(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const cJ="handsontable";function E0(t,e,n,i,r,o,s){oc.apply(this,[t,e,n,i,r,o,s])}E0.RENDERER_TYPE=cJ;var hJ=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function dJ(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Nv,oI;function fJ(){return oI||(oI=1,Nv={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),Nv}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Dv,sI;function PA(){if(sI)return Dv;sI=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,p){if(!isNaN(+l))return+l;let S="",y=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(y!==l)return-1*n(y,u,c,h,d,f);for(let $=0;$<t.length;$++){let L=t[$];if(S=l.replace(RegExp(`([0-9 ])(${L.key})$`),"$1"),S!==l)return n(S,u,c,h,d,f)*L.factor}if(S=l.replace("%",""),S!==l)return n(S,u,c,h,d,f)/100;let R=parseFloat(l);if(isNaN(R))return;let T=h(R);if(T&&T!=="."&&(S=l.replace(new RegExp(`${e(T)}$`),""),S!==l))return n(S,u,c,h,d,f);let V={};Object.keys(f).forEach($=>{V[f[$]]=$});let B=Object.keys(V).sort().reverse(),W=B.length;for(let $=0;$<W;$++){let L=B[$],z=V[L];if(S=l.replace(L,""),S!==l){let ie;switch(z){case"thousand":ie=Math.pow(10,3);break;case"million":ie=Math.pow(10,6);break;case"billion":ie=Math.pow(10,9);break;case"trillion":ie=Math.pow(10,12);break}return n(S,u,c,h,d,f)*ie}}}function i(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function r(l,u,c="",h,d,f,p){if(l==="")return;if(l===d)return 0;let S=i(l,u,c);return n(S,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],p=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(p)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=_0();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),p=c.getZeroFormat(),S=c.currentAbbreviations(),y;if(typeof l=="string")o(l,h)?y=s(l):y=r(l,h,d,f,p,S);else if(typeof l=="number")y=l;else return;if(y!==void 0)return y}return Dv={unformat:a},Dv}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var $v,aI;function T0(){if(aI)return $v;aI=1;let t=PA();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],i=["trillion","billion","million","thousand"],r=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(y,R)=>R.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:y=>y.output==="byte"},characteristic:{type:"number",restriction:y=>y>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:i},average:"boolean",lowPrecision:{type:"boolean",restriction:(y,R)=>R.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:r},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:y=>y>=0,message:"value must be positive"},{restriction:(y,R)=>!R.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:y=>y>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(y,R)=>R.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:y=>y.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(y,R){let T=d(y),V=p(R);return T&&V}function d(y){return t.unformat(y)!==void 0}function f(y,R,T,V=!1){let B=Object.keys(y).map(W=>{if(!R[W])return console.error(`${T} Invalid key: ${W}`),!1;let $=y[W],L=R[W];if(typeof L=="string"&&(L={type:L}),L.type==="format"){if(!f($,u,`[Validate ${W}]`,!0))return!1}else if(typeof $!==L.type)return console.error(`${T} ${W} type mismatched: "${L.type}" expected, "${typeof $}" provided`),!1;if(L.restrictions&&L.restrictions.length){let z=L.restrictions.length;for(let ie=0;ie<z;ie++){let{restriction:K,message:te}=L.restrictions[ie];if(!K($,y))return console.error(`${T} ${W} invalid value: ${te}`),!1}}return L.restriction&&!L.restriction($,y)?(console.error(`${T} ${W} invalid value: ${L.message}`),!1):L.validValues&&L.validValues.indexOf($)===-1?(console.error(`${T} ${W} invalid value: must be among ${JSON.stringify(L.validValues)}, "${$}" provided`),!1):!(L.children&&!f($,L.children,`[Validate ${W}]`))});return V||B.push(...Object.keys(R).map(W=>{let $=R[W];if(typeof $=="string"&&($={type:$}),$.mandatory){let L=$.mandatory;if(typeof L=="function"&&(L=L(y)),L&&y[W]===void 0)return console.error(`${T} Missing mandatory key "${W}"`),!1}return!0})),B.reduce((W,$)=>W&&$,!0)}function p(y){return f(y,u,"[Validate format]")}function S(y){return f(y,c,"[Validate language]")}return $v={validate:h,validateFormat:p,validateInput:d,validateLanguage:S},$v}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function gJ(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function mJ(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function pJ(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function wJ(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function vJ(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function CJ(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function yJ(t,e){let i=t.split(".")[0].match(/0+/);i&&(e.characteristic=i[0].length)}function SJ(t,e){let n=t.split(".")[1];if(n){let i=n.match(/0+/);i&&(e.mantissa=i[0].length)}}function bJ(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function RJ(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function EJ(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function TJ(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function MJ(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function _J(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function IJ(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function PJ(t,e={}){return typeof t!="string"?t:(t=gJ(t,e),t=mJ(t,e),pJ(t,e),CJ(t,e),yJ(t,e),MJ(t,e),RJ(t,e),EJ(t,e),SJ(t,e),TJ(t,e),bJ(t,e),wJ(t,e),vJ(t,e),_J(t,e),IJ(t,e),e)}var M0={parseFormat:PJ};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Lv,lI;function _0(){if(lI)return Lv;lI=1;const t=fJ(),e=T0(),n=M0;let i={},r,o={},s=null,a={};function l(c){r=c}function u(){return o[r]}return i.languages=()=>Object.assign({},o),i.currentLanguage=()=>r,i.currentBytes=()=>u().bytes||{},i.currentCurrency=()=>u().currency,i.currentAbbreviations=()=>u().abbreviations,i.currentDelimiters=()=>u().delimiters,i.currentOrdinal=()=>u().ordinal,i.currentDefaults=()=>Object.assign({},u().defaults,a),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().timeFormat),i.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},i.getZeroFormat=()=>s,i.setZeroFormat=c=>s=typeof c=="string"?c:null,i.hasZeroFormat=()=>s!==null,i.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},i.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},i.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(p=>p.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},i.registerLanguage(t),r=t.languageTag,Lv=i,Lv}function OJ(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function xJ(t,e){t.forEach(n=>{let i;try{i=OJ(`../languages/${n}`)}catch(r){console.error(`Unable to load "${n}". No matching language file found.`)}i&&e.registerLanguage(i)})}var HJ=t=>({loadLanguagesInNode:e=>xJ(e,t)}),OA={exports:{}};(function(t){(function(e){var n,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function p($){var L,z,ie,K=b.prototype={constructor:b,toString:null,valueOf:null},te=new b(1),se=20,Ce=4,be=-7,je=21,jt=-1e7,Pe=1e7,Ke=!1,bt=1,qt=0,g={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},m="0123456789abcdefghijklmnopqrstuvwxyz",w=!0;function b(v,C){var E,x,I,A,F,_,H,N,D=this;if(!(D instanceof b))return new b(v,C);if(C==null){if(v&&v._isBigNumber===!0){D.s=v.s,!v.c||v.e>Pe?D.c=D.e=null:v.e<jt?D.c=[D.e=0]:(D.e=v.e,D.c=v.c.slice());return}if((_=typeof v=="number")&&v*0==0){if(D.s=1/v<0?(v=-v,-1):1,v===~~v){for(A=0,F=v;F>=10;F/=10,A++);A>Pe?D.c=D.e=null:(D.e=A,D.c=[v]);return}N=String(v)}else{if(!i.test(N=String(v)))return ie(D,N,_);D.s=N.charCodeAt(0)==45?(N=N.slice(1),-1):1}(A=N.indexOf("."))>-1&&(N=N.replace(".","")),(F=N.search(/e/i))>0?(A<0&&(A=F),A+=+N.slice(F+1),N=N.substring(0,F)):A<0&&(A=N.length)}else{if(T(C,2,m.length,"Base"),C==10&&w)return D=new b(v),G(D,se+D.e+1,Ce);if(N=String(v),_=typeof v=="number"){if(v*0!=0)return ie(D,N,_,C);if(D.s=1/v<0?(N=N.slice(1),-1):1,b.DEBUG&&N.replace(/^0\.0*|\./,"").length>15)throw Error(a+v)}else D.s=N.charCodeAt(0)===45?(N=N.slice(1),-1):1;for(E=m.slice(0,C),A=F=0,H=N.length;F<H;F++)if(E.indexOf(x=N.charAt(F))<0){if(x=="."){if(F>A){A=H;continue}}else if(!I&&(N==N.toUpperCase()&&(N=N.toLowerCase())||N==N.toLowerCase()&&(N=N.toUpperCase()))){I=!0,F=-1,A=0;continue}return ie(D,String(v),_,C)}_=!1,N=z(N,C,10,D.s),(A=N.indexOf("."))>-1?N=N.replace(".",""):A=N.length}for(F=0;N.charCodeAt(F)===48;F++);for(H=N.length;N.charCodeAt(--H)===48;);if(N=N.slice(F,++H)){if(H-=F,_&&b.DEBUG&&H>15&&(v>c||v!==o(v)))throw Error(a+D.s*v);if((A=A-F-1)>Pe)D.c=D.e=null;else if(A<jt)D.c=[D.e=0];else{if(D.e=A,D.c=[],F=(A+1)%u,A<0&&(F+=u),F<H){for(F&&D.c.push(+N.slice(0,F)),H-=u;F<H;)D.c.push(+N.slice(F,F+=u));F=u-(N=N.slice(F)).length}else F-=H;for(;F--;N+="0");D.c.push(+N)}}else D.c=[D.e=0]}b.clone=p,b.ROUND_UP=0,b.ROUND_DOWN=1,b.ROUND_CEIL=2,b.ROUND_FLOOR=3,b.ROUND_HALF_UP=4,b.ROUND_HALF_DOWN=5,b.ROUND_HALF_EVEN=6,b.ROUND_HALF_CEIL=7,b.ROUND_HALF_FLOOR=8,b.EUCLID=9,b.config=b.set=function(v){var C,E;if(v!=null)if(typeof v=="object"){if(v.hasOwnProperty(C="DECIMAL_PLACES")&&(E=v[C],T(E,0,f,C),se=E),v.hasOwnProperty(C="ROUNDING_MODE")&&(E=v[C],T(E,0,8,C),Ce=E),v.hasOwnProperty(C="EXPONENTIAL_AT")&&(E=v[C],E&&E.pop?(T(E[0],-f,0,C),T(E[1],0,f,C),be=E[0],je=E[1]):(T(E,-f,f,C),be=-(je=E<0?-E:E))),v.hasOwnProperty(C="RANGE"))if(E=v[C],E&&E.pop)T(E[0],-f,-1,C),T(E[1],1,f,C),jt=E[0],Pe=E[1];else if(T(E,-f,f,C),E)jt=-(Pe=E<0?-E:E);else throw Error(s+C+" cannot be zero: "+E);if(v.hasOwnProperty(C="CRYPTO"))if(E=v[C],E===!!E)if(E)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ke=E;else throw Ke=!E,Error(s+"crypto unavailable");else Ke=E;else throw Error(s+C+" not true or false: "+E);if(v.hasOwnProperty(C="MODULO_MODE")&&(E=v[C],T(E,0,9,C),bt=E),v.hasOwnProperty(C="POW_PRECISION")&&(E=v[C],T(E,0,f,C),qt=E),v.hasOwnProperty(C="FORMAT"))if(E=v[C],typeof E=="object")g=E;else throw Error(s+C+" not an object: "+E);if(v.hasOwnProperty(C="ALPHABET"))if(E=v[C],typeof E=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(E))w=E.slice(0,10)=="0123456789",m=E;else throw Error(s+C+" invalid: "+E)}else throw Error(s+"Object expected: "+v);return{DECIMAL_PLACES:se,ROUNDING_MODE:Ce,EXPONENTIAL_AT:[be,je],RANGE:[jt,Pe],CRYPTO:Ke,MODULO_MODE:bt,POW_PRECISION:qt,FORMAT:g,ALPHABET:m}},b.isBigNumber=function(v){if(!v||v._isBigNumber!==!0)return!1;if(!b.DEBUG)return!0;var C,E,x=v.c,I=v.e,A=v.s;e:if({}.toString.call(x)=="[object Array]"){if((A===1||A===-1)&&I>=-f&&I<=f&&I===o(I)){if(x[0]===0){if(I===0&&x.length===1)return!0;break e}if(C=(I+1)%u,C<1&&(C+=u),String(x[0]).length==C){for(C=0;C<x.length;C++)if(E=x[C],E<0||E>=l||E!==o(E))break e;if(E!==0)return!0}}}else if(x===null&&I===null&&(A===null||A===1||A===-1))return!0;throw Error(s+"Invalid BigNumber: "+v)},b.maximum=b.max=function(){return k(arguments,-1)},b.minimum=b.min=function(){return k(arguments,1)},b.random=function(){var v=9007199254740992,C=Math.random()*v&2097151?function(){return o(Math.random()*v)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(E){var x,I,A,F,_,H=0,N=[],D=new b(te);if(E==null?E=se:T(E,0,f),F=r(E/u),Ke)if(crypto.getRandomValues){for(x=crypto.getRandomValues(new Uint32Array(F*=2));H<F;)_=x[H]*131072+(x[H+1]>>>11),_>=9e15?(I=crypto.getRandomValues(new Uint32Array(2)),x[H]=I[0],x[H+1]=I[1]):(N.push(_%1e14),H+=2);H=F/2}else if(crypto.randomBytes){for(x=crypto.randomBytes(F*=7);H<F;)_=(x[H]&31)*281474976710656+x[H+1]*1099511627776+x[H+2]*4294967296+x[H+3]*16777216+(x[H+4]<<16)+(x[H+5]<<8)+x[H+6],_>=9e15?crypto.randomBytes(7).copy(x,H):(N.push(_%1e14),H+=7);H=F/7}else throw Ke=!1,Error(s+"crypto unavailable");if(!Ke)for(;H<F;)_=C(),_<9e15&&(N[H++]=_%1e14);for(F=N[--H],E%=u,F&&E&&(_=h[u-E],N[H]=o(F/_)*_);N[H]===0;N.pop(),H--);if(H<0)N=[A=0];else{for(A=-1;N[0]===0;N.splice(0,1),A-=u);for(H=1,_=N[0];_>=10;_/=10,H++);H<u&&(A-=u-H)}return D.e=A,D.c=N,D}}(),b.sum=function(){for(var v=1,C=arguments,E=new b(C[0]);v<C.length;)E=E.plus(C[v++]);return E},z=function(){var v="0123456789";function C(E,x,I,A){for(var F,_=[0],H,N=0,D=E.length;N<D;){for(H=_.length;H--;_[H]*=x);for(_[0]+=A.indexOf(E.charAt(N++)),F=0;F<_.length;F++)_[F]>I-1&&(_[F+1]==null&&(_[F+1]=0),_[F+1]+=_[F]/I|0,_[F]%=I)}return _.reverse()}return function(E,x,I,A,F){var _,H,N,D,j,ae,ue,ye,Ne=E.indexOf("."),Ve=se,Te=Ce;for(Ne>=0&&(D=qt,qt=0,E=E.replace(".",""),ye=new b(x),ae=ye.pow(E.length-Ne),qt=D,ye.c=C(W(y(ae.c),ae.e,"0"),10,I,v),ye.e=ye.c.length),ue=C(E,x,I,F?(_=m,v):(_=v,m)),N=D=ue.length;ue[--D]==0;ue.pop());if(!ue[0])return _.charAt(0);if(Ne<0?--N:(ae.c=ue,ae.e=N,ae.s=A,ae=L(ae,ye,Ve,Te,I),ue=ae.c,j=ae.r,N=ae.e),H=N+Ve+1,Ne=ue[H],D=I/2,j=j||H<0||ue[H+1]!=null,j=Te<4?(Ne!=null||j)&&(Te==0||Te==(ae.s<0?3:2)):Ne>D||Ne==D&&(Te==4||j||Te==6&&ue[H-1]&1||Te==(ae.s<0?8:7)),H<1||!ue[0])E=j?W(_.charAt(1),-Ve,_.charAt(0)):_.charAt(0);else{if(ue.length=H,j)for(--I;++ue[--H]>I;)ue[H]=0,H||(++N,ue=[1].concat(ue));for(D=ue.length;!ue[--D];);for(Ne=0,E="";Ne<=D;E+=_.charAt(ue[Ne++]));E=W(E,N,_.charAt(0))}return E}}(),L=function(){function v(x,I,A){var F,_,H,N,D=0,j=x.length,ae=I%d,ue=I/d|0;for(x=x.slice();j--;)H=x[j]%d,N=x[j]/d|0,F=ue*H+N*ae,_=ae*H+F%d*d+D,D=(_/A|0)+(F/d|0)+ue*N,x[j]=_%A;return D&&(x=[D].concat(x)),x}function C(x,I,A,F){var _,H;if(A!=F)H=A>F?1:-1;else for(_=H=0;_<A;_++)if(x[_]!=I[_]){H=x[_]>I[_]?1:-1;break}return H}function E(x,I,A,F){for(var _=0;A--;)x[A]-=_,_=x[A]<I[A]?1:0,x[A]=_*F+x[A]-I[A];for(;!x[0]&&x.length>1;x.splice(0,1));}return function(x,I,A,F,_){var H,N,D,j,ae,ue,ye,Ne,Ve,Te,$e,Nt,Ji,Or,dn,Zt,Dt,mt=x.s==I.s?1:-1,nt=x.c,Le=I.c;if(!nt||!nt[0]||!Le||!Le[0])return new b(!x.s||!I.s||(nt?Le&&nt[0]==Le[0]:!Le)?NaN:nt&&nt[0]==0||!Le?mt*0:mt/0);for(Ne=new b(mt),Ve=Ne.c=[],N=x.e-I.e,mt=A+N+1,_||(_=l,N=S(x.e/u)-S(I.e/u),mt=mt/u|0),D=0;Le[D]==(nt[D]||0);D++);if(Le[D]>(nt[D]||0)&&N--,mt<0)Ve.push(1),j=!0;else{for(Or=nt.length,Zt=Le.length,D=0,mt+=2,ae=o(_/(Le[0]+1)),ae>1&&(Le=v(Le,ae,_),nt=v(nt,ae,_),Zt=Le.length,Or=nt.length),Ji=Zt,Te=nt.slice(0,Zt),$e=Te.length;$e<Zt;Te[$e++]=0);Dt=Le.slice(),Dt=[0].concat(Dt),dn=Le[0],Le[1]>=_/2&&dn++;do{if(ae=0,H=C(Le,Te,Zt,$e),H<0){if(Nt=Te[0],Zt!=$e&&(Nt=Nt*_+(Te[1]||0)),ae=o(Nt/dn),ae>1)for(ae>=_&&(ae=_-1),ue=v(Le,ae,_),ye=ue.length,$e=Te.length;C(ue,Te,ye,$e)==1;)ae--,E(ue,Zt<ye?Dt:Le,ye,_),ye=ue.length,H=1;else ae==0&&(H=ae=1),ue=Le.slice(),ye=ue.length;if(ye<$e&&(ue=[0].concat(ue)),E(Te,ue,$e,_),$e=Te.length,H==-1)for(;C(Le,Te,Zt,$e)<1;)ae++,E(Te,Zt<$e?Dt:Le,$e,_),$e=Te.length}else H===0&&(ae++,Te=[0]);Ve[D++]=ae,Te[0]?Te[$e++]=nt[Ji]||0:(Te=[nt[Ji]],$e=1)}while((Ji++<Or||Te[0]!=null)&&mt--);j=Te[0]!=null,Ve[0]||Ve.splice(0,1)}if(_==l){for(D=1,mt=Ve[0];mt>=10;mt/=10,D++);G(Ne,A+(Ne.e=D+N*u-1)+1,F,j)}else Ne.e=N,Ne.r=+j;return Ne}}();function P(v,C,E,x){var I,A,F,_,H;if(E==null?E=Ce:T(E,0,8),!v.c)return v.toString();if(I=v.c[0],F=v.e,C==null)H=y(v.c),H=x==1||x==2&&(F<=be||F>=je)?B(H,F):W(H,F,"0");else if(v=G(new b(v),C,E),A=v.e,H=y(v.c),_=H.length,x==1||x==2&&(C<=A||A<=be)){for(;_<C;H+="0",_++);H=B(H,A)}else if(C-=F,H=W(H,A,"0"),A+1>_){if(--C>0)for(H+=".";C--;H+="0");}else if(C+=A-_,C>0)for(A+1==_&&(H+=".");C--;H+="0");return v.s<0&&I?"-"+H:H}function k(v,C){for(var E,x,I=1,A=new b(v[0]);I<v.length;I++)x=new b(v[I]),(!x.s||(E=R(A,x))===C||E===0&&A.s===C)&&(A=x);return A}function Y(v,C,E){for(var x=1,I=C.length;!C[--I];C.pop());for(I=C[0];I>=10;I/=10,x++);return(E=x+E*u-1)>Pe?v.c=v.e=null:E<jt?v.c=[v.e=0]:(v.e=E,v.c=C),v}ie=function(){var v=/^(-?)0([xbo])(?=\w[\w.]*$)/i,C=/^([^.]+)\.$/,E=/^\.([^.]+)$/,x=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(A,F,_,H){var N,D=_?F:F.replace(I,"");if(x.test(D))A.s=isNaN(D)?null:D<0?-1:1;else{if(!_&&(D=D.replace(v,function(j,ae,ue){return N=(ue=ue.toLowerCase())=="x"?16:ue=="b"?2:8,!H||H==N?ae:j}),H&&(N=H,D=D.replace(C,"$1").replace(E,"0.$1")),F!=D))return new b(D,N);if(b.DEBUG)throw Error(s+"Not a"+(H?" base "+H:"")+" number: "+F);A.s=null}A.c=A.e=null}}();function G(v,C,E,x){var I,A,F,_,H,N,D,j=v.c,ae=h;if(j){e:{for(I=1,_=j[0];_>=10;_/=10,I++);if(A=C-I,A<0)A+=u,F=C,H=j[N=0],D=o(H/ae[I-F-1]%10);else if(N=r((A+1)/u),N>=j.length)if(x){for(;j.length<=N;j.push(0));H=D=0,I=1,A%=u,F=A-u+1}else break e;else{for(H=_=j[N],I=1;_>=10;_/=10,I++);A%=u,F=A-u+I,D=F<0?0:o(H/ae[I-F-1]%10)}if(x=x||C<0||j[N+1]!=null||(F<0?H:H%ae[I-F-1]),x=E<4?(D||x)&&(E==0||E==(v.s<0?3:2)):D>5||D==5&&(E==4||x||E==6&&(A>0?F>0?H/ae[I-F]:0:j[N-1])%10&1||E==(v.s<0?8:7)),C<1||!j[0])return j.length=0,x?(C-=v.e+1,j[0]=ae[(u-C%u)%u],v.e=-C||0):j[0]=v.e=0,v;if(A==0?(j.length=N,_=1,N--):(j.length=N+1,_=ae[u-A],j[N]=F>0?o(H/ae[I-F]%ae[F])*_:0),x)for(;;)if(N==0){for(A=1,F=j[0];F>=10;F/=10,A++);for(F=j[0]+=_,_=1;F>=10;F/=10,_++);A!=_&&(v.e++,j[0]==l&&(j[0]=1));break}else{if(j[N]+=_,j[N]!=l)break;j[N--]=0,_=1}for(A=j.length;j[--A]===0;j.pop());}v.e>Pe?v.c=v.e=null:v.e<jt&&(v.c=[v.e=0])}return v}function ne(v){var C,E=v.e;return E===null?v.toString():(C=y(v.c),C=E<=be||E>=je?B(C,E):W(C,E,"0"),v.s<0?"-"+C:C)}return K.absoluteValue=K.abs=function(){var v=new b(this);return v.s<0&&(v.s=1),v},K.comparedTo=function(v,C){return R(this,new b(v,C))},K.decimalPlaces=K.dp=function(v,C){var E,x,I,A=this;if(v!=null)return T(v,0,f),C==null?C=Ce:T(C,0,8),G(new b(A),v+A.e+1,C);if(!(E=A.c))return null;if(x=((I=E.length-1)-S(this.e/u))*u,I=E[I])for(;I%10==0;I/=10,x--);return x<0&&(x=0),x},K.dividedBy=K.div=function(v,C){return L(this,new b(v,C),se,Ce)},K.dividedToIntegerBy=K.idiv=function(v,C){return L(this,new b(v,C),0,1)},K.exponentiatedBy=K.pow=function(v,C){var E,x,I,A,F,_,H,N,D,j=this;if(v=new b(v),v.c&&!v.isInteger())throw Error(s+"Exponent not an integer: "+ne(v));if(C!=null&&(C=new b(C)),_=v.e>14,!j.c||!j.c[0]||j.c[0]==1&&!j.e&&j.c.length==1||!v.c||!v.c[0])return D=new b(Math.pow(+ne(j),_?v.s*(2-V(v)):+ne(v))),C?D.mod(C):D;if(H=v.s<0,C){if(C.c?!C.c[0]:!C.s)return new b(NaN);x=!H&&j.isInteger()&&C.isInteger(),x&&(j=j.mod(C))}else{if(v.e>9&&(j.e>0||j.e<-1||(j.e==0?j.c[0]>1||_&&j.c[1]>=24e7:j.c[0]<8e13||_&&j.c[0]<=9999975e7)))return A=j.s<0&&V(v)?-0:0,j.e>-1&&(A=1/A),new b(H?1/A:A);qt&&(A=r(qt/u+2))}for(_?(E=new b(.5),H&&(v.s=1),N=V(v)):(I=Math.abs(+ne(v)),N=I%2),D=new b(te);;){if(N){if(D=D.times(j),!D.c)break;A?D.c.length>A&&(D.c.length=A):x&&(D=D.mod(C))}if(I){if(I=o(I/2),I===0)break;N=I%2}else if(v=v.times(E),G(v,v.e+1,1),v.e>14)N=V(v);else{if(I=+ne(v),I===0)break;N=I%2}j=j.times(j),A?j.c&&j.c.length>A&&(j.c.length=A):x&&(j=j.mod(C))}return x?D:(H&&(D=te.div(D)),C?D.mod(C):A?G(D,qt,Ce,F):D)},K.integerValue=function(v){var C=new b(this);return v==null?v=Ce:T(v,0,8),G(C,C.e+1,v)},K.isEqualTo=K.eq=function(v,C){return R(this,new b(v,C))===0},K.isFinite=function(){return!!this.c},K.isGreaterThan=K.gt=function(v,C){return R(this,new b(v,C))>0},K.isGreaterThanOrEqualTo=K.gte=function(v,C){return(C=R(this,new b(v,C)))===1||C===0},K.isInteger=function(){return!!this.c&&S(this.e/u)>this.c.length-2},K.isLessThan=K.lt=function(v,C){return R(this,new b(v,C))<0},K.isLessThanOrEqualTo=K.lte=function(v,C){return(C=R(this,new b(v,C)))===-1||C===0},K.isNaN=function(){return!this.s},K.isNegative=function(){return this.s<0},K.isPositive=function(){return this.s>0},K.isZero=function(){return!!this.c&&this.c[0]==0},K.minus=function(v,C){var E,x,I,A,F=this,_=F.s;if(v=new b(v,C),C=v.s,!_||!C)return new b(NaN);if(_!=C)return v.s=-C,F.plus(v);var H=F.e/u,N=v.e/u,D=F.c,j=v.c;if(!H||!N){if(!D||!j)return D?(v.s=-C,v):new b(j?F:NaN);if(!D[0]||!j[0])return j[0]?(v.s=-C,v):new b(D[0]?F:Ce==3?-0:0)}if(H=S(H),N=S(N),D=D.slice(),_=H-N){for((A=_<0)?(_=-_,I=D):(N=H,I=j),I.reverse(),C=_;C--;I.push(0));I.reverse()}else for(x=(A=(_=D.length)<(C=j.length))?_:C,_=C=0;C<x;C++)if(D[C]!=j[C]){A=D[C]<j[C];break}if(A&&(I=D,D=j,j=I,v.s=-v.s),C=(x=j.length)-(E=D.length),C>0)for(;C--;D[E++]=0);for(C=l-1;x>_;){if(D[--x]<j[x]){for(E=x;E&&!D[--E];D[E]=C);--D[E],D[x]+=l}D[x]-=j[x]}for(;D[0]==0;D.splice(0,1),--N);return D[0]?Y(v,D,N):(v.s=Ce==3?-1:1,v.c=[v.e=0],v)},K.modulo=K.mod=function(v,C){var E,x,I=this;return v=new b(v,C),!I.c||!v.s||v.c&&!v.c[0]?new b(NaN):!v.c||I.c&&!I.c[0]?new b(I):(bt==9?(x=v.s,v.s=1,E=L(I,v,0,3),v.s=x,E.s*=x):E=L(I,v,0,bt),v=I.minus(E.times(v)),!v.c[0]&&bt==1&&(v.s=I.s),v)},K.multipliedBy=K.times=function(v,C){var E,x,I,A,F,_,H,N,D,j,ae,ue,ye,Ne,Ve,Te=this,$e=Te.c,Nt=(v=new b(v,C)).c;if(!$e||!Nt||!$e[0]||!Nt[0])return!Te.s||!v.s||$e&&!$e[0]&&!Nt||Nt&&!Nt[0]&&!$e?v.c=v.e=v.s=null:(v.s*=Te.s,!$e||!Nt?v.c=v.e=null:(v.c=[0],v.e=0)),v;for(x=S(Te.e/u)+S(v.e/u),v.s*=Te.s,H=$e.length,j=Nt.length,H<j&&(ye=$e,$e=Nt,Nt=ye,I=H,H=j,j=I),I=H+j,ye=[];I--;ye.push(0));for(Ne=l,Ve=d,I=j;--I>=0;){for(E=0,ae=Nt[I]%Ve,ue=Nt[I]/Ve|0,F=H,A=I+F;A>I;)N=$e[--F]%Ve,D=$e[F]/Ve|0,_=ue*N+D*ae,N=ae*N+_%Ve*Ve+ye[A]+E,E=(N/Ne|0)+(_/Ve|0)+ue*D,ye[A--]=N%Ne;ye[A]=E}return E?++x:ye.splice(0,1),Y(v,ye,x)},K.negated=function(){var v=new b(this);return v.s=-v.s||null,v},K.plus=function(v,C){var E,x=this,I=x.s;if(v=new b(v,C),C=v.s,!I||!C)return new b(NaN);if(I!=C)return v.s=-C,x.minus(v);var A=x.e/u,F=v.e/u,_=x.c,H=v.c;if(!A||!F){if(!_||!H)return new b(I/0);if(!_[0]||!H[0])return H[0]?v:new b(_[0]?x:I*0)}if(A=S(A),F=S(F),_=_.slice(),I=A-F){for(I>0?(F=A,E=H):(I=-I,E=_),E.reverse();I--;E.push(0));E.reverse()}for(I=_.length,C=H.length,I-C<0&&(E=H,H=_,_=E,C=I),I=0;C;)I=(_[--C]=_[C]+H[C]+I)/l|0,_[C]=l===_[C]?0:_[C]%l;return I&&(_=[I].concat(_),++F),Y(v,_,F)},K.precision=K.sd=function(v,C){var E,x,I,A=this;if(v!=null&&v!==!!v)return T(v,1,f),C==null?C=Ce:T(C,0,8),G(new b(A),v,C);if(!(E=A.c))return null;if(I=E.length-1,x=I*u+1,I=E[I]){for(;I%10==0;I/=10,x--);for(I=E[0];I>=10;I/=10,x++);}return v&&A.e+1>x&&(x=A.e+1),x},K.shiftedBy=function(v){return T(v,-c,c),this.times("1e"+v)},K.squareRoot=K.sqrt=function(){var v,C,E,x,I,A=this,F=A.c,_=A.s,H=A.e,N=se+4,D=new b("0.5");if(_!==1||!F||!F[0])return new b(!_||_<0&&(!F||F[0])?NaN:F?A:1/0);if(_=Math.sqrt(+ne(A)),_==0||_==1/0?(C=y(F),(C.length+H)%2==0&&(C+="0"),_=Math.sqrt(+C),H=S((H+1)/2)-(H<0||H%2),_==1/0?C="5e"+H:(C=_.toExponential(),C=C.slice(0,C.indexOf("e")+1)+H),E=new b(C)):E=new b(_+""),E.c[0]){for(H=E.e,_=H+N,_<3&&(_=0);;)if(I=E,E=D.times(I.plus(L(A,I,N,1))),y(I.c).slice(0,_)===(C=y(E.c)).slice(0,_))if(E.e<H&&--_,C=C.slice(_-3,_+1),C=="9999"||!x&&C=="4999"){if(!x&&(G(I,I.e+se+2,0),I.times(I).eq(A))){E=I;break}N+=4,_+=4,x=1}else{(!+C||!+C.slice(1)&&C.charAt(0)=="5")&&(G(E,E.e+se+2,1),v=!E.times(E).eq(A));break}}return G(E,E.e+se+1,Ce,v)},K.toExponential=function(v,C){return v!=null&&(T(v,0,f),v++),P(this,v,C,1)},K.toFixed=function(v,C){return v!=null&&(T(v,0,f),v=v+this.e+1),P(this,v,C)},K.toFormat=function(v,C,E){var x,I=this;if(E==null)v!=null&&C&&typeof C=="object"?(E=C,C=null):v&&typeof v=="object"?(E=v,v=C=null):E=g;else if(typeof E!="object")throw Error(s+"Argument not an object: "+E);if(x=I.toFixed(v,C),I.c){var A,F=x.split("."),_=+E.groupSize,H=+E.secondaryGroupSize,N=E.groupSeparator||"",D=F[0],j=F[1],ae=I.s<0,ue=ae?D.slice(1):D,ye=ue.length;if(H&&(A=_,_=H,H=A,ye-=A),_>0&&ye>0){for(A=ye%_||_,D=ue.substr(0,A);A<ye;A+=_)D+=N+ue.substr(A,_);H>0&&(D+=N+ue.slice(A)),ae&&(D="-"+D)}x=j?D+(E.decimalSeparator||"")+((H=+E.fractionGroupSize)?j.replace(new RegExp("\\d{"+H+"}\\B","g"),"$&"+(E.fractionGroupSeparator||"")):j):D}return(E.prefix||"")+x+(E.suffix||"")},K.toFraction=function(v){var C,E,x,I,A,F,_,H,N,D,j,ae,ue=this,ye=ue.c;if(v!=null&&(_=new b(v),!_.isInteger()&&(_.c||_.s!==1)||_.lt(te)))throw Error(s+"Argument "+(_.isInteger()?"out of range: ":"not an integer: ")+ne(_));if(!ye)return new b(ue);for(C=new b(te),N=E=new b(te),x=H=new b(te),ae=y(ye),A=C.e=ae.length-ue.e-1,C.c[0]=h[(F=A%u)<0?u+F:F],v=!v||_.comparedTo(C)>0?A>0?C:N:_,F=Pe,Pe=1/0,_=new b(ae),H.c[0]=0;D=L(_,C,0,1),I=E.plus(D.times(x)),I.comparedTo(v)!=1;)E=x,x=I,N=H.plus(D.times(I=N)),H=I,C=_.minus(D.times(I=C)),_=I;return I=L(v.minus(E),x,0,1),H=H.plus(I.times(N)),E=E.plus(I.times(x)),H.s=N.s=ue.s,A=A*2,j=L(N,x,A,Ce).minus(ue).abs().comparedTo(L(H,E,A,Ce).minus(ue).abs())<1?[N,x]:[H,E],Pe=F,j},K.toNumber=function(){return+ne(this)},K.toPrecision=function(v,C){return v!=null&&T(v,1,f),P(this,v,C,2)},K.toString=function(v){var C,E=this,x=E.s,I=E.e;return I===null?x?(C="Infinity",x<0&&(C="-"+C)):C="NaN":(v==null?C=I<=be||I>=je?B(y(E.c),I):W(y(E.c),I,"0"):v===10&&w?(E=G(new b(E),se+I+1,Ce),C=W(y(E.c),E.e,"0")):(T(v,2,m.length,"Base"),C=z(W(y(E.c),I,"0"),10,v,x,!0)),x<0&&E.c[0]&&(C="-"+C)),C},K.valueOf=K.toJSON=function(){return ne(this)},K._isBigNumber=!0,$!=null&&b.set($),b}function S($){var L=$|0;return $>0||$===L?L:L-1}function y($){for(var L,z,ie=1,K=$.length,te=$[0]+"";ie<K;){for(L=$[ie++]+"",z=u-L.length;z--;L="0"+L);te+=L}for(K=te.length;te.charCodeAt(--K)===48;);return te.slice(0,K+1||1)}function R($,L){var z,ie,K=$.c,te=L.c,se=$.s,Ce=L.s,be=$.e,je=L.e;if(!se||!Ce)return null;if(z=K&&!K[0],ie=te&&!te[0],z||ie)return z?ie?0:-Ce:se;if(se!=Ce)return se;if(z=se<0,ie=be==je,!K||!te)return ie?0:!K^z?1:-1;if(!ie)return be>je^z?1:-1;for(Ce=(be=K.length)<(je=te.length)?be:je,se=0;se<Ce;se++)if(K[se]!=te[se])return K[se]>te[se]^z?1:-1;return be==je?0:be>je^z?1:-1}function T($,L,z,ie){if($<L||$>z||$!==o($))throw Error(s+(ie||"Argument")+(typeof $=="number"?$<L||$>z?" out of range: ":" not an integer: ":" not a primitive number: ")+String($))}function V($){var L=$.c.length-1;return S($.e/u)==L&&$.c[L]%2!=0}function B($,L){return($.length>1?$.charAt(0)+"."+$.slice(1):$)+(L<0?"e":"e+")+L}function W($,L,z){var ie,K;if(L<0){for(K=z+".";++L;K+=z);$=K+$}else if(ie=$.length,++L>ie){for(K=z,L-=ie;--L;K+=z);$+=K}else L<ie&&($=$.slice(0,L)+"."+$.slice(L));return $}n=p(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self!="undefined"&&self?self:window),e.BigNumber=n)})(hJ)})(OA);var xA=OA.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const hr=_0(),AJ=T0(),NJ=M0,DJ=xA,yn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Hd={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:HA,decimalSuffixes:Nm}=hr.currentBytes(),I0={general:{scale:1024,suffixes:Nm,marker:"bd"},binary:{scale:1024,suffixes:HA,marker:"b"},decimal:{scale:1e3,suffixes:Nm,marker:"d"}};function $J(t,e={},n){if(typeof e=="string"&&(e=NJ.parseFormat(e)),!AJ.validateFormat(e))return"ERROR: invalid format";let r=e.prefix||"",o=e.postfix||"",s=LJ(t,e,n);return s=nee(s,r),s=iee(s,o),s}function LJ(t,e,n){switch(e.output){case"currency":return e=mu(e,hr.currentCurrencyDefaultFormat()),zJ(t,e,hr);case"percent":return e=mu(e,hr.currentPercentageDefaultFormat()),UJ(t,e,hr,n);case"byte":return e=mu(e,hr.currentByteDefaultFormat()),WJ(t,e,hr,n);case"time":return e=mu(e,hr.currentTimeDefaultFormat()),jJ(t);case"ordinal":return e=mu(e,hr.currentOrdinalDefaultFormat()),BJ(t,e,hr);case"number":default:return Ad({instance:t,providedFormat:e,numbro:n})}}function kJ(t){let e=I0.decimal;return jp(t._value,e.suffixes,e.scale).suffix}function FJ(t){let e=I0.binary;return jp(t._value,e.suffixes,e.scale).suffix}function VJ(t){let e=I0.general;return jp(t._value,e.suffixes,e.scale).suffix}function jp(t,e,n){let i=e[0],r=Math.abs(t);if(r>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(r>=s&&r<a){i=e[o],t=t/s;break}}i===e[0]&&(t=t/Math.pow(n,e.length-1),i=e[e.length-1])}return{value:t,suffix:i}}function WJ(t,e,n,i){let r=e.base||"binary",o=Object.assign({},Hd,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||Nm,marker:"bd"},binary:{scale:1024,suffixes:s||HA,marker:"b"},decimal:{scale:1e3,suffixes:a||Nm,marker:"d"}}[r],{value:c,suffix:h}=jp(t._value,u.suffixes,u.scale);return`${Ad({instance:i(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function BJ(t,e,n){let i=n.currentOrdinal(),r=Object.assign({},Hd,e),o=Ad({instance:t,providedFormat:e,state:n}),s=i(t._value);return`${o}${r.spaceSeparated?" ":""}${s}`}function jJ(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),i=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${i<10?"0":""}${i}`}function UJ(t,e,n,i){let r=e.prefixSymbol,o=Ad({instance:i(t._value*100),providedFormat:e,state:n}),s=Object.assign({},Hd,e);return r?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function zJ(t,e,n){const i=n.currentCurrency();let r=Object.assign({},e),o=Object.assign({},Hd,r),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=r.currencyPosition||i.position,c=r.currencySymbol||i.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;r.lowPrecision===void 0&&(r.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=Ad({instance:t,providedFormat:r,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function YJ({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:i,spaceSeparated:r=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&i[e]&&yn[e]?(a=i[e],t=t/yn[e]):l>=yn.trillion||n&&s(l/yn.trillion)===1?(a=i.trillion,t=t/yn.trillion):l<yn.trillion&&l>=yn.billion||n&&s(l/yn.billion)===1?(a=i.billion,t=t/yn.billion):l<yn.billion&&l>=yn.million||n&&s(l/yn.million)===1?(a=i.million,t=t/yn.million):(l<yn.million&&l>=yn.thousand||n&&s(l/yn.thousand)===1)&&(a=i.thousand,t=t/yn.thousand),a&&(a=(r?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function GJ({value:t,characteristicPrecision:e}){let[n,i]=t.toExponential().split("e"),r=+n;if(!e)return{value:r,abbreviation:`e${i}`};let o=1;return o<e&&(r=r*Math.pow(10,e-o),i=+i-(e-o),i=i>=0?`+${i}`:i),{value:r,abbreviation:`e${i}`}}function Ff(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function KJ(t,e){let n=t.toString(),[i,r]=n.split("e"),[o,s=""]=i.split(".");if(+r>0)n=o+s+Ff(r-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(Ff(-r-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=Ff(e-l.length)),n=a+l}return+r>0&&e>0&&(n+=`.${Ff(e)}`),n}function XJ(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?KJ(t,e):new DJ(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function qJ(t,e,n,i,r,o){if(i===-1)return t;let s=XJ(e,i,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||r))return a;let u=l.match(/0+$/);return r&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function ZJ(t,e,n,i){let r=t,[o,s]=r.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),r=r.slice(1)),o.length<i){let l=i-o.length;for(let u=0;u<l;u++)r=`0${r}`}return a&&(r=`-${r}`),r.toString()}function QJ(t,e){let n=[],i=0;for(let r=t;r>0;r--)i===e&&(n.unshift(r),i=0),i++;return n}function JJ(t,e,n,i,r){let o=i.currentDelimiters(),s=o.thousands;r=r||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),QJ(u.length,a).forEach((f,p)=>{u=u.slice(0,f+p)+s+u.slice(f+p)}),h&&(u=`-${u}`)),c?l=u+r+c:l=u,l}function eee(t,e){return t+e}function tee(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function nee(t,e){return e+t}function iee(t,e){return t+e}function Ad({instance:t,providedFormat:e,state:n=hr,decimalSeparator:i,defaults:r=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},Hd,r,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,p=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,S=s.trimMantissa,y=s.thousandSeparated,R=s.spaceSeparated,T=s.negative,V=s.forceSign,B=s.exponential,W=s.roundingFunction,$="";if(d){let z=YJ({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:R,roundingFunction:W,totalLength:a});o=z.value,$+=z.abbreviation,a&&(f=z.mantissaPrecision)}if(B){let z=GJ({value:o,characteristicPrecision:l});o=z.value,$=z.abbreviation+$}let L=qJ(o.toString(),o,p,f,S,W);return L=ZJ(L,o,u,l),L=JJ(L,o,y,n,i),(d||B)&&(L=eee(L,$)),(V||o<0)&&(L=tee(L,o,T)),L}function mu(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var ree=t=>({format:(...e)=>$J(...e,t),getByteUnit:(...e)=>VJ(...e,t),getBinaryByteUnit:(...e)=>FJ(...e,t),getDecimalByteUnit:(...e)=>kJ(...e,t),formatOrDefault:mu});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const os=xA;function oee(t,e,n){let i=new os(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new os(r),t._value=i.plus(r).toNumber(),t}function AA(t,e,n){let i=new os(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new os(r),t._value=i.minus(r).toNumber(),t}function see(t,e,n){let i=new os(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new os(r),t._value=i.times(r).toNumber(),t}function aee(t,e,n){let i=new os(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new os(r),t._value=i.dividedBy(r).toNumber(),t}function lee(t,e,n){let i=e;return n.isNumbro(e)&&(i=e._value),t._value=i,t}function uee(t,e,n){let i=n(t._value);return AA(i,e,n),Math.abs(i._value)}var cee=t=>({add:(e,n)=>oee(e,n,t),subtract:(e,n)=>AA(e,n,t),multiply:(e,n)=>see(e,n,t),divide:(e,n)=>aee(e,n,t),set:(e,n)=>lee(e,n,t),difference:(e,n)=>uee(e,n,t),BigNumber:os});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const hee="2.5.0",yo=_0(),dee=T0(),fee=HJ(Bt),gee=PA();let pa=ree(Bt),za=cee(Bt);const mee=M0;class NA{constructor(e){this._value=e}clone(){return Bt(this._value)}format(e={}){return pa.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=mee.parseFormat(e)),e=pa.formatOrDefault(e,yo.currentCurrencyDefaultFormat()),e.output="currency",pa.format(this,e)}formatTime(e={}){return e.output="time",pa.format(this,e)}binaryByteUnits(){return pa.getBinaryByteUnit(this)}decimalByteUnits(){return pa.getDecimalByteUnit(this)}byteUnits(){return pa.getByteUnit(this)}difference(e){return za.difference(this,e)}add(e){return za.add(this,e)}subtract(e){return za.subtract(this,e)}multiply(e){return za.multiply(this,e)}divide(e){return za.divide(this,e)}set(e){return za.set(this,DA(e))}value(){return this._value}valueOf(){return this._value}}function DA(t){let e=t;return Bt.isNumbro(t)?e=t._value:typeof t=="string"?e=Bt.unformat(t):isNaN(t)&&(e=NaN),e}function Bt(t){return new NA(DA(t))}Bt.version=hee;Bt.isNumbro=function(t){return t instanceof NA};Bt.language=yo.currentLanguage;Bt.registerLanguage=yo.registerLanguage;Bt.setLanguage=yo.setLanguage;Bt.languages=yo.languages;Bt.languageData=yo.languageData;Bt.zeroFormat=yo.setZeroFormat;Bt.defaultFormat=yo.currentDefaults;Bt.setDefaults=yo.setDefaults;Bt.defaultCurrencyFormat=yo.currentCurrencyDefaultFormat;Bt.validate=dee.validate;Bt.loadLanguagesInNode=fee.loadLanguagesInNode;Bt.unformat=gee.unformat;Bt.BigNumber=za.BigNumber;var pee=Bt,wa=dJ(pee);const wee="numeric";function $A(t,e){if(Yn(t)){const n=e.numericFormat,i=n&&n.culture||"-",r=n&&n.pattern;if(typeof i!="undefined"&&!wa.languages()[i]){const o=i.replace("-",""),s=wa.allLanguages?wa.allLanguages[i]:wa[o];s&&wa.registerLanguage(s)}wa.setLanguage(i),t=wa(t).format(r||"0")}return t}function P0(t,e,n,i,r,o,s){let a=o;if(Yn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=$A(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}fs(t,e,n,i,r,a,s)}P0.RENDERER_TYPE=wee;const vee="password";function O0(t,e,n,i,r,o,s){fs.apply(this,[t,e,n,i,r,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";ce(a-1,()=>{u+=l}),nc(e,u)}O0.RENDERER_TYPE=vee;const Cee="select";function x0(t,e,n,i,r,o,s){fs.apply(this,[t,e,n,i,r,o,s])}x0.RENDERER_TYPE=Cee;const yee="time";function H0(t,e,n,i,r,o,s){fs.apply(this,[t,e,n,i,r,o,s]),e.dir="ltr"}H0.RENDERER_TYPE=yee;function See(){$i(oc),$i(xd),$i(b0),$i(S0),$i(E0),$i(y0),$i(P0),$i(O0),$i(x0),$i(fs),$i(H0)}const bee="autocomplete";function Up(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,uI(n,e)):uI(n,e)(this.source):e(!0)}Up.VALIDATOR_TYPE=bee;function uI(t,e){const n=t;return function(i){let r=!1;for(let o=0,s=i.length;o<s;o++)if(n===i[o]){r=!0;break}e(r)}}function Ree(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const Eee="date";function A0(t,e){const n=tH(SA,this.instance);let i=t,r=!0;i==null&&(i="");let o=X(i,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=X(new Date(i)).isValid()||o;if(this.allowEmpty&&i===""&&(s=!0,o=!0),s||(r=!1),!s&&o&&(r=!0),s&&!o)if(this.correctFormat===!0){const a=Tee(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),r=!0}else r=!1;e(r)}A0.VALIDATOR_TYPE=Eee;function Tee(t,e){const n=X(Ree(t)),i=X(t,e),r=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===i.format("x")||!i.isValid()||r?o=n:o=i,o.format(e)}const Mee="dropdown";function N0(t,e){Up.apply(this,[t,e])}N0.VALIDATOR_TYPE=Mee;const _ee="numeric";function D0(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Yn(t))}D0.VALIDATOR_TYPE=_ee;const Iee=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Pee="time";function $0(t,e){const n=this.timeFormat||"h:mm:ss a";let i=!0,r=t;r===null&&(r=""),r=/^\d{3,}$/.test(r)?parseInt(r,10):r;const o=/^\d{1,2}$/.test(r);o&&(r+=":00");const s=X(r,Iee,!0).isValid()?X(r):X(r,n);let a=s.isValid(),l=X(r,n,!0).isValid()&&!o;if(this.allowEmpty&&r===""&&(a=!0,l=!0),a||(i=!1),!a&&l&&(i=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),i=!0}else i=!1;e(i)}$0.VALIDATOR_TYPE=Pee;function Oee(){gu(Up),gu(N0),gu(A0),gu(D0),gu($0)}const xee="autocomplete",Hee={CELL_TYPE:xee,editor:v0,renderer:oc,validator:Up},Aee="checkbox",Nee={CELL_TYPE:Aee,editor:yA,renderer:b0},Dee="date";function LA(t,e,n,i,r,o,s){oc.apply(this,[t,e,n,i,r,o,s])}LA.RENDERER_TYPE=Dee;const $ee="date",Lee={CELL_TYPE:$ee,editor:bA,renderer:LA,validator:A0},kee="dropdown",Fee={CELL_TYPE:kee,editor:RA,renderer:S0,validator:N0,filter:!1,strict:!0},Vee="handsontable",Wee={CELL_TYPE:Vee,editor:w0,renderer:E0},Bee="numeric",jee={CELL_TYPE:Bee,editor:EA,renderer:P0,validator:D0,dataType:"number"},Uee="password",zee={CELL_TYPE:Uee,editor:TA,renderer:O0,copyable:!1},Yee="select",Gee={CELL_TYPE:Yee,editor:MA,renderer:x0},Kee="time",Xee={CELL_TYPE:Kee,editor:_A,renderer:H0,validator:$0};function qee(){lr(Hee),lr(Nee),lr(Lee),lr(Fee),lr(Wee),lr(jee),lr(zee),lr(Gee),lr(pA),lr(Xee)}function Zee(t,e){kA(t,e),e.add(t)}function Qee(t,e,n){kA(t,e),e.set(t,n)}function kA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fl(t,e,n){return(e=Jee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jee(t){var e=ete(t,"string");return typeof e=="symbol"?e:e+""}function ete(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vl(t,e){return t.get(FA(t,e))}function FA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cI=new Map([["plugin",$q],["cell-type",sA],["editor",eH],["renderer",lH],["validator",uH]]),VA=Symbol("mainSetting"),tte="base",Vf=[];let va=null;var Ca=new WeakMap,hI=new WeakSet;class Xe{static get PLUGIN_KEY(){return tte}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){Zee(this,hI),Fl(this,"eventManager",new Er(this)),Fl(this,"pluginName",null),Fl(this,"pluginsInitializedCallbacks",[]),Fl(this,"isPluginsReady",!1),Fl(this,"enabled",!1),Fl(this,"initialized",!1),Qee(this,Ca,{}),hs(this,"hot",e,{writable:!1}),va=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const r=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!cI.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);cI.get(s)(a)||r.push(` - ${a} (${s})`)}),r.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${r.join(`
`)}
`].join("");Vf.push(o)}}if(va||(va=aH()),va.indexOf(this.pluginName)>=0&&va.splice(va.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),va.length===0){if(Vf.length>0){const r=[`${Vf.join(`
`)}
`,"You have to import and register them manually."].join("");throw Vf.length=0,new Error(r)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const i=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||He(n))&&i[VA]===e){var r;return Array.isArray(n)?n:(r=n[e])!==null&&r!==void 0?r:i[e]}if(He(n)){var o;return(o=n[e])!==null&&o!==void 0?o:i[e]}return i[e]}addHook(e,n,i){Vl(Ca,this)[e]=Vl(Ca,this)[e]||[];const r=Vl(Ca,this)[e];this.hot.addHook(e,n,i),r.push(n),Vl(Ca,this)[e]=r}removeHooks(e){M(Vl(Ca,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Vl(Ca,this);Ae(e,(n,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){M(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=FA(hI,this,nte).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ae(this,(n,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function nte(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function ya(t,e,n){return(e=ite(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ite(t){var e=rte(t,"string");return typeof e=="symbol"?e:e+""}function rte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ote{constructor(e){ya(this,"hot",null),ya(this,"container",null),ya(this,"injected",!1),ya(this,"rows",[]),ya(this,"columns",[]),ya(this,"samples",null),ya(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),M(this.rows,n=>{const{height:i}=n.table.getBoundingClientRect();e(n.row,Math.ceil(i))})}getWidths(e){this.injected||this.injectTable(),M(this.columns,n=>{const{width:i}=n.table.getBoundingClientRect();e(n.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{M(i.strings,r=>{n.appendChild(this.createColElement(r.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),i.appendChild(r)),this.samples.forEach(o=>{M(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),i.appendChild(c)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const r=e.createElement("th");i.push([-1,r]),n.appendChild(r)}this.samples.forEach(r=>{M(r.strings,o=>{const s=o.col,a=e.createElement("th");i.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),M(i,r=>{const[o,s]=r;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment();return this.samples.forEach(r=>{M(r.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),i.appendChild(c)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const i=this.hot.rootDocument.createElement("col");let r=0;n>=0&&e>=0&&(r=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(r>1)for(let s=e+1;s<e+r;s++)o+=this.hot.getColWidth(s);return i.style.width=`${o}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&r.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&s.appendChild(l),r.appendChild(s),U(r,e),i.appendChild(r),{fragment:i,table:r,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return U(r,o),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}var WA=ote;function Wf(t,e,n){return(e=ste(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ste(t){var e=ate(t,"string");return typeof e=="symbol"?e:e+""}function ate(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L0{static get SAMPLE_COUNT(){return 3}constructor(e){Wf(this,"samples",null),Wf(this,"dataFactory",null),Wf(this,"customSampleCount",null),Wf(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:L0.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,i){const r=new Map,{from:o,to:s}=typeof i=="number"?{from:i,to:i}:i;return ce(o,s,a=>{const l=this.generateSample(e,n,a);r.set(a,l)}),r}generateSample(e,n,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const r=new Map,o=e==="row"?"col":"row",s=[];return ce(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(i,a):this.dataFactory(a,i);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:He(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Gt(u).length}`,r.has(d)||r.set(d,{needed:this.getSampleCount(),strings:[]});const f=r.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),r}}var BA=L0;function lte(t,e){jA(t,e),e.add(t)}function dI(t,e,n){jA(t,e),e.set(t,n)}function jA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kc(t,e,n){return(e=ute(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ute(t){var e=cte(t,"string");return typeof e=="symbol"?e:e+""}function cte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Za(t,e){return t.get(io(t,e))}function k0(t,e,n){return t.set(io(t,e),n),n}function io(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ee.getSingleton().register("modifyAutoColumnSizeSeed");const kv="autoColumnSize",hte=10,dte="autoColumnSize";var pu=new WeakMap,zu=new WeakMap,$o=new WeakSet;class xh extends Xe{static get PLUGIN_KEY(){return kv}static get PLUGIN_PRIORITY(){return hte}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),lte(this,$o),kc(this,"ghostTable",new WA(this.hot)),kc(this,"samplesGenerator",new BA((n,i)=>{const r=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,i);let a="";s.spanned||(a=this.hot.getDataAtCell(n,i));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),kc(this,"inProgress",!1),kc(this,"measuredColumns",0),kc(this,"columnWidthsMap",new ta),dI(this,pu,[]),dI(this,zu,[]),this.hot.columnIndexMapper.registerMap(dte,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,i,r)=>io($o,this,fI).call(this,n,i,r))}isEnabled(){return this.hot.getSettings()[kv]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return io($o,e,mte).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return io($o,e,pte).call(e,...r)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return io($o,e,vte).call(e,...r)}),this.addHook("beforeRender",()=>io($o,this,gte).call(this)),this.addHook("modifyColWidth",(i,r)=>this.getColumnWidth(r,i)),this.addHook("init",()=>io($o,this,wte).call(this)),super.enablePlugin()}updatePlugin(){k0(zu,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,i)=>io($o,this,fI).call(this,e,n,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const i=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:n},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;ce(r.from,r.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(i||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&this.samplesGenerator.generateColumnSamples(s,o).forEach((u,c)=>this.ghostTable.addColumn(c,u))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Em(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+xh.CALCULATION_STEP,r)},e,n),i=i+xh.CALCULATION_STEP+1,i<r?o=Rm(s):(Em(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),i=a+1),i<r?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[kv];let n=xh.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return He(e)&&(n=e.syncLimit,y1(n)?n=rH(i,n):n>>=0),Math.min(n,i)}getColumnWidth(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=n;return r===void 0&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof r=="number"&&(r=Math.max(r,Wu))),r}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,r,o)=>{const s=Za(pu,this).length;return(s-1<o||Za(pu,this)[o]!==r)&&i.push(this.hot.toVisualColumn(o)),s-1<o?Za(pu,this).push(r):Za(pu,this)[o]=r,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function fte(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const i=this.hot.toPhysicalColumn(n);i!==null&&(this.hot._getColWidthFromSettings(i)||this.samplesGenerator.generateColumnSamples(n,e).forEach((o,s)=>this.ghostTable.addColumn(s,o)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((n,i)=>{const r=this.hot.toPhysicalColumn(n);this.columnWidthsMap.setValueAtIndex(r,i)})},!0),this.ghostTable.clean())}function gte(){this.calculateVisibleColumnsWidth(),this.inProgress||(io($o,this,fte).call(this,Za(zu,this)),k0(zu,this,[]))}function mte(t,e){e||this.recalculateAllColumnsWidth()}function pte(t){const e=t.reduce((n,i)=>{let[,r]=i;const o=this.hot.propToCol(r);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Za(zu,this).push(...e)}function fI(t,e,n){let i=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function wte(){k0(pu,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function vte(t){const e=t.reduce((n,i)=>{var r;const o=(r=i.address)===null||r===void 0?void 0:r.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Za(zu,this).push(...e)}const Qa={horizontal:"horizontal",vertical:"vertical"};function Cte(t,e,n){let i,r,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",i=n(e[0],e[1]),r=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",i=n(e[0],t[3]+1),r=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",i=n(e[0],e[1]),r=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",i=n(t[2]+1,e[1]),r=n(e[2],e[3])),i&&i.normalize(),r&&r.normalize(),{directionOfDrag:o,startOfDragCoords:i,endOfDragCoords:r}}function yte(t){const e={};return t===!0?(e.directions=Object.keys(Qa),e.autoInsertRow=!0):He(t)?(re(t.autoInsertRow)?t.direction===Qa.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,re(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Qa)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Ste(t,e){bte(t,e),e.add(t)}function bte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wl(t,e,n){return(e=Rte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rte(t){var e=Ete(t,"string");return typeof e=="symbol"?e:e+""}function Ete(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ee.getSingleton().register("modifyAutofillRange");ee.getSingleton().register("beforeAutofill");ee.getSingleton().register("afterAutofill");const gI="autofill",Tte=20,Mte=["fillHandle"],_te="insert_row_below",Ite=200;var Bl=new WeakSet;class Pte extends Xe{constructor(){super(...arguments),Ste(this,Bl),Wl(this,"addingStarted",!1),Wl(this,"mouseDownOnCellCorner",!1),Wl(this,"mouseDragOutside",!1),Wl(this,"handleDraggedCells",0),Wl(this,"directions",[]),Wl(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return gI}static get PLUGIN_PRIORITY(){return Tte}static get SETTING_KEYS(){return[gI,...Mte]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Fc(Bl,this,xte).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Fc(Bl,this,Ote).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Fc(Bl,this,Hte).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:i}=e.getTopStartCorner(),{row:r,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:i,endRow:r,endCol:o}]),a=[],l=[],u=[];return M(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),M(a,c=>{const h=[];M(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,i,r]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,i),Math.max(a.col,r)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=Cte(l,u,(f,p)=>this.hot._createCellCoords(f,p));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),p=o.clone(),S=this.hot._createCellRange(h,h,d),y=this.hot.runHooks("beforeAutofill",f,p,S,c);if(y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let R=y;const T=y;if(["up","left"].indexOf(c)>-1&&!(T.length===1&&T[0].length===0))if(R=[],c==="up"){const V=d.row-h.row+1,B=V%T.length;for(let W=0;W<V;W++)R.push(T[(W+(T.length-B))%T.length])}else{const V=d.col-h.col+1,B=V%T[0].length;for(let W=0;W<T.length;W++){R.push([]);for(let $=0;$<V;$++)R[W].push(T[W][($+(T[W].length-B))%T[W].length])}}this.hot.populateFromArray(h.row,h.col,R,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",R,p,S,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),i=n.getBottomEndCorner();let r=e;if(this.directions.includes(Qa.vertical)&&this.directions.includes(Qa.horizontal)){const o=n.getTopStartCorner();(i.col<=e.col||o.col>=e.col)&&(r=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||o.row>e.row)&&(r=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(Qa.vertical))r=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(Qa.horizontal))r=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(_te,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},Ite)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&n[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),i=this.hot.countRows();let r;for(let o=e[2]+1;o<i;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!Wt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!Wt(s)||!Wt(a))&&(r=o)}return r}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...We(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,i=xn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+tn(this.hot.table),r=xn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+Yt(this.hot.table);return e.clientY>i&&e.clientX<=r}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Fc(Bl,this,Ate).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Fc(Bl,this,Nte).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=yte(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function Ote(){this.selectAdjacent()&&this.fillIn()}function xte(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function Hte(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Ate(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Nte(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Dte(t,e){UA(t,e),e.add(t)}function $te(t,e,n){UA(t,e),e.set(t,n)}function UA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jl(t,e,n){return(e=Lte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lte(t){var e=kte(t,"string");return typeof e=="symbol"?e:e+""}function kte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fte(t,e,n){return t.set(ro(t,e),n),n}function F0(t,e){return t.get(ro(t,e))}function ro(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Fv="autoRowSize",Vte=40,Wte="autoRowSize";var id=new WeakMap,Lo=new WeakSet;class Hh extends Xe{static get PLUGIN_KEY(){return Fv}static get PLUGIN_PRIORITY(){return Vte}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Dte(this,Lo),jl(this,"headerHeight",null),jl(this,"ghostTable",new WA(this.hot)),jl(this,"samplesGenerator",new BA((n,i)=>{const r=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&i>=0&&this.hot.getCellMeta(n,i).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,i):n===-1&&(s=this.hot.getColHeader(i)),{value:s}})),jl(this,"inProgress",!1),jl(this,"measuredRows",0),jl(this,"rowHeightsMap",new ta),$te(this,id,[]),this.hot.rowIndexMapper.registerMap(Wte,this.rowHeightsMap),this.addHook("beforeRowResize",(n,i,r)=>ro(Lo,this,mI).call(this,n,i,r))}isEnabled(){const e=this.hot.getSettings()[Fv];return e===!0||He(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return ro(Lo,e,Ute).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return ro(Lo,e,zte).call(e,...r)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return ro(Lo,e,Gte).call(e,...r)}),this.addHook("beforeRender",()=>ro(Lo,this,jte).call(this)),this.addHook("modifyRowHeight",(i,r)=>this.getRowHeight(r,i)),this.addHook("init",()=>ro(Lo,this,Yte).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,i)=>ro(Lo,this,mI).call(this,e,n,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const i=this.hot.renderCall;this.calculateRowsHeight({from:e,to:n},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}ce(r.from,r.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(i||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Em(o),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+Hh.CALCULATION_STEP,r)},e,n),i=i+Hh.CALCULATION_STEP+1,i<r?o=Rm(s):(Em(o),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),i=a+1),i<r?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Fv];let n=Hh.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return He(e)&&(n=e.syncLimit,y1(n)?n=rH(i,n):n>>=0),Math.min(n,i)}getRowHeight(e,n){const i=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let r=n;return i!==null&&i>(n||0)&&(r=i),r}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{ce(Math.min(n,i),Math.max(n,i),r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Bte(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((r,o)=>this.ghostTable.addRow(o,r))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,i)=>{const r=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(r,i)})},!0),this.ghostTable.clean())}function jte(){this.calculateVisibleRowsHeight(),this.inProgress||(ro(Lo,this,Bte).call(this,F0(id,this)),Fte(id,this,[]))}function mI(t,e,n){let i=t;return n&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function Ute(t,e){e||this.recalculateAllRowsHeight()}function zte(t){const e=t.reduce((n,i)=>{let[r]=i;return n.indexOf(r)===-1&&n.push(r),n},[]);F0(id,this).push(...e)}function Yte(){this.recalculateAllRowsHeight()}function Gte(t){const e=t.reduce((n,i)=>{var r;const o=(r=i.address)===null||r===void 0?void 0:r.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);F0(id,this).push(...e)}const{getListWithInsertedItems:Kte,getListWithRemovedItems:Xte}=WH("physicallyIndexed");class qte extends Rl{constructor(){super(e=>e)}insert(e,n){const i=zb(this.indexedValues,n);this.indexedValues=Kte(i,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=Xte(this.indexedValues,e);this.indexedValues=Ub(n,e),super.remove(e)}}var Zte=qte;const{getListWithInsertedItems:Qte,getListWithRemovedItems:Jte}=WH("physicallyIndexed");class ene extends Rl{constructor(){super(e=>e)}insert(e,n){this.indexedValues=Qte(this.indexedValues,e,n,(i,r)=>this.getNextValue(r)),super.insert(e,n)}remove(e){this.indexedValues=Jte(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}var tne=ene;function nne(t,e){ine(t,e),e.add(t)}function ine(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rne(t,e,n){return(e=one(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function one(t){var e=sne(t,"string");return typeof e=="symbol"?e:e+""}function sne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ane(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pI="bindRowsWithHeaders",lne=210,une="loose",wI=new Map([["loose",Zte],["strict",tne]]);var vI=new WeakSet;class cne extends Xe{constructor(){super(...arguments),nne(this,vI),rne(this,"headerIndexes",null)}static get PLUGIN_KEY(){return pI}static get PLUGIN_PRIORITY(){return lne}isEnabled(){return!!this.hot.getSettings()[pI]}enablePlugin(){var e;if(this.enabled)return;const n=(e=wI.get(this.getSetting()))!==null&&e!==void 0?e:wI.get(une);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",i=>ane(vI,this,hne).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function hne(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function dne(t,e){zA(t,e),e.add(t)}function fne(t,e,n){zA(t,e),e.set(t,n)}function zA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CI(t,e,n){return(e=gne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gne(t){var e=mne(t,"string");return typeof e=="symbol"?e:e+""}function mne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yI(t,e){return t.get(Eu(t,e))}function Vv(t,e,n){return t.set(Eu(t,e),n),n}function Eu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Qg="collapsibleColumns",pne=290,wne=["nestedHeaders"],Du="collapsibleIndicator",SI=Qg,bI=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Ul=new WeakMap,Vc=new WeakSet;class vne extends Xe{constructor(){super(...arguments),dne(this,Vc),CI(this,"nestedHeadersPlugin",null),CI(this,"headerStateManager",null),fne(this,Ul,null)}static get PLUGIN_KEY(){return Qg}static get PLUGIN_PRIORITY(){return pne}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Qg,...wne]}isEnabled(){return!!this.hot.getSettings()[Qg]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||qe("You need to configure the Nested Headers plugin in order to use collapsible headers."),Vv(Ul,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Eu(Vc,this,Sne).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Eu(Vc,e,bne).call(e,...r)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Eu(Vc,e,Cne).call(e,...r)}),this.addHook("beforeOnCellMouseDown",(i,r,o)=>Eu(Vc,this,yne).call(this,i,r,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!!this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Vv(Ul,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:r,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,i))!==null&&e!==void 0?e:{};if(!!r)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:SI,relativeToGroup:na,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SI)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};ce(0,e-1,s=>{const a=n.childNodes[s],l=i.childNodes[s],u=r?r.childNodes[s]:null;ce(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Du}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Du}`),o(h)),r&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Du}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(i=>{const{collapsible:r,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=i;if(r===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!bI.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const i=sl(e,f=>{let{row:p}=f;return p<0});let r=i.length>0;M(i,f=>{var p;let{row:S,col:y}=f;const{collapsible:R,isCollapsed:T}=(p=this.headerStateManager.getHeaderSettings(S,y))!==null&&p!==void 0?p:{};if(!R||T&&n==="collapse"||!T&&n==="expand")return r=!1,!1});const o=[],s=[];r&&M(i,f=>{let{row:p,col:S}=f;const{colspanCompensation:y,affectedColumns:R,rollbackModification:T}=this.headerStateManager.triggerNodeModification(n,p,S);y>0&&(s.push(...R),o.push(T))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=HK([...a,...s]):n==="expand"&&(l=sl(a,f=>!s.includes(f)));const u=bI.get(n);if(this.hot.runHooks(u.beforeHook,a,l,r)===!1){M(o,f=>{f()});return}this.hot.batchExecution(()=>{M(s,f=>{yI(Ul,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:p}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(p))&&s.includes(p)){const y=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,R=p>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(p,1,!0):p;y!==null&&R!==null&&this.hot.selectCell(y,R)}}this.hot.runHooks(u.afterHook,a,l,r,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return yI(Ul,this).getHiddenIndexes()}destroy(){Vv(Ul,this,null),super.destroy()}}function Cne(t,e,n){var i;const{collapsible:r,origColspan:o,isCollapsed:s}=(i=this.headerStateManager.getHeaderSettings(n,t))!==null&&i!==void 0?i:{},a=r&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Du}`);if(tc(e,[Yi("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),U(u,Du),e.querySelector("div:first-child").appendChild(u)),ge(u,["collapsed","expanded"]),s?(U(u,"collapsed"),ll(u,"+"),l&&ve(e,...Yi(!1))):(U(u,"expanded"),ll(u,"-"),l&&ve(e,...Yi(!0))),l&&ve(u,...Js());else{var c;(c=u)===null||c===void 0||c.remove()}}function yne(t,e){pe(t.target,Du)&&(pe(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):pe(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Ir(t))}function Sne(){this.updatePlugin()}function bne(t,e){e||this.updatePlugin()}function Sa(t,e,n){return(e=Rne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rne(t){var e=Ene(t,"string");return typeof e=="symbol"?e:e+""}function Ene(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Tne=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Mne=!1,_ne=!0,Ine=!0;class Pne{constructor(e,n){Sa(this,"hot",void 0),Sa(this,"sortingStates",new Lp),Sa(this,"sortEmptyCells",Mne),Sa(this,"indicator",_ne),Sa(this,"headerAction",Ine),Sa(this,"compareFunctionFactory",void 0),Sa(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){!He(e)||Ae(e,(n,i)=>{Tne.includes(i)&&(this[i]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[i]=n;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return He(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[i,r]=n;return Me({column:this.hot.toVisualColumn(i)},r)})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(re(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function YA(t,e,n){const i=e.locale;return function(r,o){const{sortEmptyCells:s}=n;return typeof r=="string"&&(r=r.toLocaleLowerCase(i)),typeof o=="string"&&(o=o.toLocaleLowerCase(i)),r===o?ho:Wt(r)?Wt(o)?ho:s&&t==="asc"?xt:Ht:Wt(o)?s&&t==="asc"?Ht:xt:isNaN(r)&&!isNaN(o)?t==="asc"?Ht:xt:!isNaN(r)&&isNaN(o)||(isNaN(r)||isNaN(o)||(r=parseFloat(r),o=parseFloat(o)),r<o)?t==="asc"?xt:Ht:r>o?t==="asc"?Ht:xt:ho}}const GA="default";function One(t,e,n){return function(i,r){const o=parseFloat(i),s=parseFloat(r),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return ho;if(a){if(Wt(i))return t==="asc"?xt:Ht;if(Wt(r))return t==="asc"?Ht:xt}return isNaN(o)?Ht:isNaN(s)?xt:o<s?t==="asc"?xt:Ht:o>s?t==="asc"?Ht:xt:ho}}const xne="numeric";function Hne(t,e,n){const i=e.checkedTemplate,r=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Wt(s),u=Wt(a),c=l?r:s,h=u?r:a,d=c===r||c===i,f=h===r||h===i;if(o===!1){if(l&&u===!1)return Ht;if(l===!1&&u)return xt}return d===!1&&f?t==="asc"?xt:Ht:d&&f===!1?t==="asc"?Ht:xt:d===!1&&f===!1?YA(t,e,n)(s,a):c===r&&h===i?t==="asc"?xt:Ht:c===i&&h===r?t==="asc"?Ht:xt:ho}}const Ane="checkbox";function Nne(t,e,n){return JA(t,e.dateFormat,n)}const Dne="date";function $ne(t,e,n){return JA(t,e.timeFormat,n)}const Lne="time",{register:Nd,getItem:RI,hasItem:kne}=Pr("sorting.compareFunctionFactory"),{register:KA,getItem:Fne}=Pr("sorting.mainSortComparator");function XA(t){return kne(t)?RI(t):RI(GA)}Nd(Ane,Hne);Nd(Dne,Nne);Nd(GA,YA);Nd(xne,One);Nd(Lne,$ne);const ho=0,xt=-1,Ht=1;function Vne(t,e){const n=Fne(e);for(var i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];t.sort(n(...r))}const Dm="asc",$m="desc",qA="colHeader";function Wne(t){if(He(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Dm,$m].includes(n)}function Bne(t){if(t.some(n=>Wne(n)===!1))return!1;const e=t.map(n=>{let{column:i}=n;return i});return new Set(e).size===e.length}function EI(t){if(t!==$m)return t===Dm?$m:Dm}function ZA(t){return t.querySelector(`.${qA}`)}function QA(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function V0(t,e,n){return t===-1&&e>=0&&ul(n)===!1}function JA(t,e,n){return function(i,r){const{sortEmptyCells:o}=n;if(i===r)return ho;if(Wt(i))return Wt(r)?ho:o&&t==="asc"?xt:Ht;if(Wt(r))return o&&t==="asc"?Ht:xt;const s=X(i,e),a=X(r,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?xt:Ht:a.isBefore(s)?t==="asc"?Ht:xt:ho:xt:Ht}}function jne(t,e){qe(tt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const Une="ascending",zne="descending",eN="indicatorDisabled",tN="columnSorting",nN="sortAction",iN=new Map([[Dm,Une],[$m,zne]]);function Yne(t,e,n,i){const r=[tN];if(i&&r.push(nN),n===!1)return r.push(eN),r;const o=t.getSortOrderOfColumn(e);return re(o)&&r.push(iN.get(o)),r}function Gne(){return Array.from(iN.values()).concat(nN,eN,tN)}function Kne(t,e){return function(n,i){const[,...r]=n,[,...o]=i;return function(a){const l=t[a],u=e[a],c=r[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:XA(u.type))(l,u,d)(c,h)}(0)}}function Xne(t,e){qne(t,e),e.add(t)}function qne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bf(t,e,n){return(e=Zne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zne(t){var e=Qne(t,"string");return typeof e=="symbol"?e:e+""}function Qne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Lm="columnSorting",Jne=50,km="append",eie="replace",TI=Lm;KA(Lm,Kne);ee.getSingleton().register("beforeColumnSort");ee.getSingleton().register("afterColumnSort");const Wc=new WeakMap;var Ya=new WeakSet;class rN extends Xe{constructor(){super(...arguments),Xne(this,Ya),Bf(this,"columnStatesManager",null),Bf(this,"columnMetaCache",null),Bf(this,"pluginKey",Lm),Bf(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Lm}static get PLUGIN_PRIORITY(){return Jne}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(Wc.has(this.hot)&&Wc.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),jne(Wc.get(this.hot),this.pluginKey);return}this.enabled||(Wc.set(this.hot,this.pluginKey),this.columnStatesManager=new Pne(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new ta(n=>{let i=this.hot.toVisualColumn(n);return i===null&&(i=n),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,i)=>wu(Ya,this,tie).call(this,n,i)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return wu(Ya,e,iie).call(e,...i)}),this.addHook("afterOnCellMouseDown",(n,i)=>this.onAfterOnCellMouseDown(n,i)),this.addHook("afterInit",()=>wu(Ya,this,By).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return wu(Ya,e,nie).call(e,...i)}),this.hot.view&&wu(Ya,this,By).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,i)=>{const r=ZA(i);QA(n,i)===!1||r===null||this.updateHeaderClasses(r)};Wc.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:na,position:"before",group:TI})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(TI)}sort(e){const n=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",n,i,r)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new BH),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",n,r?i:n,r),r&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return re(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return Bne(e)&&e.every(i=>{let{column:r}=i;return r<=n&&r>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),i=r=>{let a=r,{column:o}=a,s=$n(a,["column"]);return Me({column:this.hot.toPhysicalColumn(o)},s)};n.initialConfig=We(e,i),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,i=r=>{let a=r,{column:o}=a,s=$n(a,["column"]);return Me({column:this.hot.toVisualColumn(o)},s)};return re(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=We(n.initialConfig,i)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(re(n)){const r=EI(n);return re(r)?{column:e,sortOrder:r}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:EI()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:km;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=i!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(r){if(Tt(s))return[...o.slice(0,i),...o.slice(i+1)];if(n===km)return[...o.slice(0,i),...o.slice(i+1),s];if(n===eie)return[...o.slice(0,i),s,...o.slice(i+1)]}return re(s)?o.concat(s):o}getPluginColumnConfig(e){if(He(e)){const n=e[this.pluginKey];if(He(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(r);return Array.isArray(o.columns)?Object.assign(i,n,this.getPluginColumnConfig(o.columns[e])):gt(o.columns)?Object.assign(i,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(i,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),i=Object.create(n);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],i=this.hot.countRows(),r=u=>We(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(i);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(r(u)));const o=We(n,u=>u[0]);Vne(n,this.pluginKey,We(e,u=>u.sortOrder),We(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<i;u+=1)n.push([u].concat(r(u)));const s=We(n,u=>u[0]),a=new Map(We(o,(u,c)=>[u,s[c]])),l=We(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(He(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||He(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(ge(e,Gne()),this.enabled!==!1){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];U(e,Yne(...i))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),re(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&pe(e.target,qA)}onAfterOnCellMouseDown(e,n){if(V0(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const i=this.hot.getActiveEditor(),r=this.getColumnNextConfig(n.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(r)}):this.sort(r)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function By(){const t=this.getAllSavedSortSettings();if(He(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function tie(t,e){const n=ZA(e);if(QA(t,e)===!1||n===null)return;const i=this.getFirstCellSettings(t)[this.pluginKey],r=i.indicator,o=i.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,r,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);ve(e,...JK(s?`${s}ending`:"none"))}}function nie(t){t===!0&&this.hot.view&&wu(Ya,this,By).call(this)}function iie(t,e,n,i){V0(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function ba(t,e,n){return(e=rie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rie(t){var e=oie(t,"string");return typeof e=="symbol"?e:e+""}function oie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sie{constructor(e,n){ba(this,"plugin",void 0),ba(this,"hot",void 0),ba(this,"endpoints",[]),ba(this,"settings",void 0),ba(this,"settingsType","array"),ba(this,"currentEndpoint",null),ba(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),M(i,r=>{const o={};this.assignSetting(r,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(r,o,"reversedRowCoords",!1),this.assignSetting(r,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"sourceColumn",r.destinationColumn),this.assignSetting(r,o,"type","sum"),this.assignSetting(r,o,"forceNumeric",!1),this.assignSetting(r,o,"suppressDataTypeErrors",!0),this.assignSetting(r,o,"customFunction",null),this.assignSetting(r,o,"readOnly",!0),this.assignSetting(r,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,i,r){if(i==="ranges"&&e[i]===void 0){n[i]=r;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(r instanceof Error)throw r;n[i]=r}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-e[i]-1:n[i]=e[i]}resetSetupBeforeStructureAlteration(e,n,i){if(this.settingsType!=="function")return;const r=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();M(o,s=>{r==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=i:e==="remove_row"&&(s.alterRowOffset=-1*i)),r==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=i:e==="remove_col"&&(s.alterColumnOffset=-1*i))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,i,r,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;M(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*i),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*i)}),this.resetAllEndpoints(u,!c),c?M(u,d=>{this.extendEndpointRanges(d,h,r[0],r.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):M(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,i,r){M(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?i>o[1]?o[1]+=r:i<o[0]&&(o[0]-=r):i>=o[0]&&i<=o[1]&&(o[1]-=r,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,i=[],r=[];M(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));r.push(s)}),M(r,o=>{let s=[];M(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),i.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),i.push(s))})}),e.ranges=i}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,M(e.ranges,i=>{M(i,(r,o)=>{r>=n&&(i[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(r=>{const o=r.alterRowOffset||0,s=r.alterColumnOffset||0;return r.destinationRow+o>=this.hot.countRows()||r.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],M(e,r=>{this.resetEndpointValue(r,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],M(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],M(e,(i,r,o)=>{`${i[2]||""}`!=`${i[3]}`&&M(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[r][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),M(n,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const i=this.hot.getCellMeta(n,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?i:0)),this.hot.toVisualColumn(e.destinationColumn+(n?r:0)),""])}setEndpointValue(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}i?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){qe("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}var aie=sie;function Wv(t){return t==null||isNaN(t)}function lie(t,e){uie(t,e),e.add(t)}function uie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cie(t,e,n){return(e=hie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hie(t){var e=die(t,"string");return typeof e=="symbol"?e:e+""}function die(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Bv="columnSummary",fie=220;var Bc=new WeakSet;class gie extends Xe{constructor(){super(...arguments),lie(this,Bc),cie(this,"endpoints",null)}static get PLUGIN_KEY(){return Bv}static get PLUGIN_PRIORITY(){return fie}isEnabled(){return!!this.hot.getSettings()[Bv]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Bv],this.endpoints=new aie(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jf(Bc,e,mie).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jf(Bc,e,wie).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jf(Bc,e,pie).call(e,...i)}),this.addHook("beforeCreateRow",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,i,null,r)),this.addHook("beforeCreateCol",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,i,null,r)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,i,null,r)),this.addHook("afterCreateCol",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,i,null,r)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jf(Bc,e,vie).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ae(e.ranges,i=>{n+=this.getPartialSum(i,e.sourceColumn)}),n}getPartialSum(e,n){let i=0,r=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(r,n),o=Wv(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}i+=o||0,r-=1}while(r>=e[0]);return Math.round(i*lw(10,s))/lw(10,s)}calculateMinMax(e,n){let i=null;return Ae(e.ranges,r=>{const o=this.getPartialMinMax(r,e.sourceColumn,n);if(i===null&&o!==null&&(i=o),o!==null)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}}),i===null?"Not enough data":i}getPartialMinMax(e,n,i){let r=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=Wv(s)?null:s,r===null)r=s;else if(s!==null)switch(i){case"min":r=Math.min(r,s);break;case"max":r=Math.max(r,s);break}o-=1}while(o>=e[0]);return r}countEmpty(e,n){let i,r=0,o=e[1]||e[0];do i=this.getCellValue(o,n),i=Wv(i)?null:i,i===null&&(r+=1),o-=1;while(o>=e[0]);return r}countEntries(e){let n=0;const i=e.ranges;return Ae(i,r=>{const o=r[1]===void 0?1:r[1]-r[0]+1,s=this.countEmpty(r,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),i=this.countEntries(e);return n/i}getCellValue(e,n){const i=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(i!==null&&r!==null&&(s=this.hot.getCellMeta(i,r).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(tt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function mie(){this.endpoints.initEndpoints()}function pie(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function wie(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function vie(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Cie(t,e){oN(t,e),e.add(t)}function jv(t,e,n){oN(t,e),e.set(t,n)}function oN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vu(t,e){return t.get(W0(t,e))}function jy(t,e,n){return t.set(W0(t,e),n),n}function W0(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fm=new WeakMap,Uf=new WeakMap,zf=new WeakMap,MI=new WeakSet;class sN{constructor(){Cie(this,MI),jv(this,Fm,!0),jv(this,Uf,null),jv(this,zf,new ResizeObserver(e=>W0(MI,this,yie).call(this,e)))}setObservedElement(e){jy(Uf,this,e)}unobserve(){vu(zf,this).unobserve(vu(Uf,this))}observe(){jy(Fm,this,!0),vu(zf,this).observe(vu(Uf,this))}destroy(){vu(zf,this).disconnect()}}function yie(t){if(vu(Fm,this)||!Array.isArray(t)||!t.length){jy(Fm,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:i,blockSize:r}=n[0];this.runLocalHooks("resize",i,r)})}lt(sN,Nn);function Ra(t,e,n){Sie(t,e),e.set(t,n)}function Sie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function st(t,e){return t.get(aN(t,e))}function Oo(t,e,n){return t.set(aN(t,e),n),n}function aN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ea=new WeakMap,Uv=new WeakMap,xo=new WeakMap,ws=new WeakMap,vs=new WeakMap,Yf=new WeakMap,zl=new WeakMap;class Ja{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var i=this;Ra(this,Ea,void 0),Ra(this,Uv,!1),Ra(this,xo,null),Ra(this,ws,void 0),Ra(this,vs,void 0),Ra(this,Yf,!0),Ra(this,zl,new sN),Oo(Ea,this,e),Oo(Uv,this,n),Oo(ws,this,this.createEditor()),Oo(vs,this,st(ws,this).style),st(zl,this).setObservedElement(this.getInputElement()),st(zl,this).addLocalHook("resize",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){st(vs,this).left=`${e}px`,st(vs,this).top=`${n}px`}setSize(e,n){if(e&&n){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${n}px`}}getSize(){return{width:Yt(this.getInputElement()),height:tn(this.getInputElement())}}observeSize(){st(zl,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){st(vs,this).display="block",Oo(Yf,this,!1)}hide(){st(zl,this).unobserve(),st(Yf,this)||(st(vs,this).display="none"),Oo(Yf,this,!0)}isVisible(){return st(vs,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return st(Ea,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=st(Ea,this).createElement("div"),n=st(Ea,this).createElement("textarea");return e.style.display="none",Oo(xo,this,st(Ea,this).createElement("div")),st(xo,this).setAttribute("dir",st(Uv,this)?"rtl":"ltr"),U(st(xo,this),Ja.CLASS_EDITOR_CONTAINER),st(Ea,this).body.appendChild(st(xo,this)),U(e,Ja.CLASS_EDITOR),U(n,Ja.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),st(xo,this).appendChild(e),e}getInputElement(){return st(ws,this).querySelector(`.${Ja.CLASS_INPUT}`)}getEditorElement(){return st(ws,this)}destroy(){const e=st(xo,this)?st(xo,this).parentNode:null;st(ws,this).parentNode.removeChild(st(ws,this)),Oo(ws,this,null),Oo(vs,this,null),st(zl,this).destroy(),e&&e.removeChild(st(xo,this))}}lt(Ja,Nn);var bie=Ja;function zv(t,e,n){return(e=Rie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rie(t){var e=Eie(t,"string");return typeof e=="symbol"?e:e+""}function Eie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Tie=250,Mie=250;class lN{constructor(e){zv(this,"wasLastActionShow",!0),zv(this,"showDebounced",null),zv(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},Mie)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Tie;this.showDebounced=fb(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}lt(lN,Nn);var _ie=lN;function Iie(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Pie(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ta(t,e){const n={};return M(t,i=>{i.forAll((r,o)=>{r>=0&&o>=0&&(n[r]||(n[r]=[]),n[r][o]=e(r,o))})}),n}function Os(t,e,n,i,r){M(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&Oie(s,a,e,n,i,r)})})}function Oie(t,e,n,i,r,o){const s=r(t,e);let a=i;s.className&&(n==="vertical"?a=Iie(s.className,i):a=Pie(s.className,i)),o(t,e,"className",a)}function uN(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function Jg(t,e){let n=!1;return Array.isArray(t)&&M(t,i=>(i.forAll((r,o)=>{if(r>=0&&o>=0&&e(r,o))return n=!0,!1}),n)),n}function zp(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:i}=e.defaultView,{top:r,left:o}=i.getBoundingClientRect();n.top=r,n.left=o}return n}const xe="---------";function xie(){return{name:xe}}const Fi="alignment";function Hie(){return{key:Fi,name(){return this.getTranslatedPhrase(pR)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Fi}:left`,name(){return this.getTranslatedPhrase(wR)},callback(){const t=this.getSelectedRange(),e=Ta(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,t,n,i),Os(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Fi}:center`,name(){return this.getTranslatedPhrase(vR)},callback(){const t=this.getSelectedRange(),e=Ta(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,t,n,i),Os(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Fi}:right`,name(){return this.getTranslatedPhrase(CR)},callback(){const t=this.getSelectedRange(),e=Ta(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,t,n,i),Os(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Fi}:justify`,name(){return this.getTranslatedPhrase(yR)},callback(){const t=this.getSelectedRange(),e=Ta(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,t,n,i),Os(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{name:xe},{key:`${Fi}:top`,name(){return this.getTranslatedPhrase(SR)},callback(){const t=this.getSelectedRange(),e=Ta(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,t,n,i),Os(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Fi}:middle`,name(){return this.getTranslatedPhrase(bR)},callback(){const t=this.getSelectedRange(),e=Ta(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,i),Os(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Fi}:bottom`,name(){return this.getTranslatedPhrase(RR)},callback(){const t=this.getSelectedRange(),e=Ta(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,t,n,i),Os(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1}]}}}const Yp="clear_column";function Aie(){return{key:Yp,name(){return this.getTranslatedPhrase(nR)},callback(t,e){const n=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,i)=>{if(n<0||i<0)return!0;const{readOnly:r}=this.getCellMeta(n,i);return r?!0:(e=!0,!1)}),!e}}}const Dd="col_left";function Nie(){return{key:Dd,name(){return this.getTranslatedPhrase(qb)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const $d="col_right";function Die(){return{key:$d,name(){return this.getTranslatedPhrase(Zb)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Ld="make_read_only";function $ie(){return{key:Ld,checkable:!0,ariaChecked(){return Jg(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Pm)},name(){let t=this.getTranslatedPhrase(Pm);return Jg(this.getSelectedRange(),(n,i)=>this.getCellMeta(n,i).readOnly)&&(t=uN(t)),t},callback(){const t=this.getSelectedRange(),e=Jg(t,(n,i)=>this.getCellMeta(n,i).readOnly);M(t,n=>{n.forAll((i,r)=>{i>=0&&r>=0&&this.setCellMeta(i,r,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Gp="redo";function Lie(){return{key:Gp,name(){return this.getTranslatedPhrase(tR)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const kd="remove_col";function kie(){return{key:kd,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(Jb,e)},callback(){this.alter("remove_col",e7(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Kp="remove_row";function Fie(){return{key:Kp,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(Qb,e)},callback(){this.alter("remove_row",t7(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Xp="row_above";function Vie(){return{key:Xp,name(){return this.getTranslatedPhrase(Kb)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const qp="row_below";function Wie(){return{key:qp,name(){return this.getTranslatedPhrase(Xb)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const rd="no_items";function Bie(){return{key:rd,name(){return this.getTranslatedPhrase(Gb)},disabled:!0,isCommand:!1}}const Zp="undo";function jie(){return{key:Zp,name(){return this.getTranslatedPhrase(eR)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Uie=[Xp,qp,Dd,$d,Yp,Kp,kd,Zp,Gp,Ld,Fi,xe,rd],zie={[xe]:xie,[rd]:Bie,[Xp]:Vie,[qp]:Wie,[Dd]:Nie,[$d]:Die,[Yp]:Aie,[Kp]:Fie,[kd]:kie,[Zp]:jie,[Gp]:Lie,[Ld]:$ie,[Fi]:Hie};function cN(){const t={};return Ae(zie,(e,n)=>{t[n]=e()}),t}function Yie(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(fR):this.getTranslatedPhrase(dR)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Gie(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(gR)},callback(){this.getSelectedRangeLast().forAll((n,i)=>{n>=0&&i>=0&&t.removeCommentAtCell(n,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Kie(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(mR);return Jg(this.getSelectedRange(),(i,r)=>t.getCommentMeta(i,r,em))?uN(e):e},callback(){this.getSelectedRangeLast().forAll((n,i)=>{if(n>=0&&i>=0){const r=!!t.getCommentMeta(n,i,em);t.updateCommentMeta(n,i,{[em]:!r})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Xie(t,e){hN(t,e),e.add(t)}function Yl(t,e,n){hN(t,e),e.set(t,n)}function hN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qie(t,e,n){return(e=Zie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zie(t){var e=Qie(t,"string");return typeof e=="symbol"?e:e+""}function Qie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bs(t,e,n){return t.set(Ci(t,e),n),n}function _e(t,e){return t.get(Ci(t,e))}function Ci(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Vm="comments",Jie=60,Bo="comment",yh="value",dN="style",em="readOnly",jc=Vm,Uy=`plugin:${Vm}`;var rt=new WeakMap,eo=new WeakMap,Qp=new WeakMap,tm=new WeakMap,zy=new WeakMap,Wm=new WeakMap,Di=new WeakSet;class ere extends Xe{constructor(){super(...arguments),Xie(this,Di),qie(this,"range",{}),Yl(this,rt,null),Yl(this,eo,null),Yl(this,Qp,!1),Yl(this,tm,!1),Yl(this,zy,null),Yl(this,Wm,"")}static get PLUGIN_KEY(){return Vm}static get PLUGIN_PRIORITY(){return Jie}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Vm]}enablePlugin(){var e=this;this.enabled||(_e(rt,this)||(Bs(rt,this,new bie(this.hot.rootDocument,this.hot.isRtl())),_e(rt,this).addLocalHook("resize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ci(Di,e,lre).call(e,...i)})),_e(eo,this)||Bs(eo,this,new _ie(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,i,r,o,s,a)=>Ci(Di,this,ore).call(this,n,a)),this.addHook("afterScroll",()=>Ci(Di,this,cre).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Ci(Di,this,ure).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ci(Di,e,hre).call(e,...i)}),_e(eo,this).addLocalHook("hide",()=>this.hide()),_e(eo,this).addLocalHook("show",(n,i)=>this.showAtCell(n,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){_e(eo,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),i=e.addContext(Uy);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const r=this.hot.getSelectedRangeLast();Bs(tm,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(r),this.show(),this.focusEditor(),e.setActiveContextName(Uy),this.hot._registerTimeout(()=>{Bs(tm,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var r;return(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isCell()},group:jc}),i.addShortcut({keys:[["Escape"]],callback:()=>{_e(rt,this).setValue(_e(Wm,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>_e(rt,this).isVisible()&&_e(rt,this).isFocused(),group:jc}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>_e(rt,this).isVisible()&&_e(rt,this).isFocused(),group:jc}),i.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{_e(rt,this).setValue(_e(rt,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:jc})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jc)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>Ci(Di,this,ire).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Ci(Di,this,tre).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>Ci(Di,this,rre).call(this)),this.eventManager.addEventListener(n,"focus",()=>Ci(Di,this,are).call(this)),this.eventManager.addEventListener(n,"blur",()=>Ci(Di,this,sre).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",i=>Ci(Di,this,nre).call(this,i))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=al(e.target,"TD","TBODY");return!!(n&&pe(n,"htCommentCell")&&al(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=_e(rt,this).getValue();let i="";e!=null?i=e:n!=null&&(i=n);const r=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(r,o,{[yh]:i}),this.hot.render()}setCommentAtCell(e,n,i){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Bo),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(i)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,yh)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,yh)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:i}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return _e(eo,this).cancelHiding(),_e(rt,this).setValue((e=r[Bo]?r[Bo][yh]:null)!==null&&e!==void 0?e:""),_e(rt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){_e(rt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!_e(rt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{row:r,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(r),a=i.getRenderableFromVisualIndex(o);const l=s===null;_e(rt,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1))),a===null&&(a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s!=null?s:0,a=a!=null?a:0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,p=d.getCell({row:s,col:a},!0),S=this.getCommentMeta(r,o,dN);S?_e(rt,this).setSize(S.width,S.height):_e(rt,this).resetSize();const y=c?0:f.getColumnWidth(a),R=l&&!u?tn(p):0,{left:T,top:V,width:B,height:W}=p.getBoundingClientRect(),{width:$,height:L}=_e(rt,this).getSize(),{innerWidth:z,innerHeight:ie}=this.hot.rootWindow,K=this.hot.rootDocument.documentElement,te=wn(this.hot.rootDocument),se=D1(this.hot.rootWindow)?te:0,Ce=$1(this.hot.rootWindow)?te:0;let be=T+h.scrollX+y,je=V+h.scrollY+R;this.hot.isRtl()&&(be-=$+y),this.hot.isLtr()&&T+B+$>z-se?be=T+h.scrollX-$-1:this.hot.isRtl()&&be<-(K.scrollWidth-K.clientWidth)&&(be=T+h.scrollX+y+1),V+L>ie-Ce&&(je-=L-W+1),_e(rt,this).setPosition(be,je),_e(rt,this).setReadOnlyState(this.getCommentMeta(r,o,em)),_e(rt,this).observeSize()}focusEditor(){_e(rt,this).focus()}updateCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n)[Bo];let o;r?(o=Xn(r),Ap(o,i)):o=i,this.hot.setCellMeta(e,n,Bo,o)}getCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n);if(!!r[Bo])return r[Bo][i]}addToContextMenu(e){e.items.push({name:xe},Yie(this),Gie(this),Kie(this))}getEditorInputElement(){return _e(rt,this).getInputElement()}destroy(){var e,n;(e=_e(rt,this))===null||e===void 0||e.destroy(),(n=_e(eo,this))===null||n===void 0||n.destroy(),super.destroy()}}function tre(t){if(!(!this.hot.view||!this.hot.view._wt)&&!_e(Qp,this)&&!this.targetIsCommentTextArea(t)){const e=al(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function nre(t){t.stopPropagation()}function ire(t){const{rootDocument:e}=this.hot;if(!(_e(Qp,this)||_e(rt,this).isFocused()||pe(t.target,"wtBorder")||_e(zy,this)===t.target||!_e(rt,this)))if(Bs(zy,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));_e(eo,this).show(n)}else rl(t.target,e)&&!this.targetIsCommentTextArea(t)&&_e(eo,this).hide()}function rre(){Bs(Qp,this,!1)}function ore(t,e){e[Bo]&&e[Bo][yh]&&U(t,e.commentedCellClassName)}function sre(){Bs(Wm,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function are(){Bs(Wm,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(Uy)}function lre(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[dN]:{width:t,height:e}})}function ure(t){_e(rt,this).isFocused()&&Ir(t)}function cre(){_e(tm,this)||this.hide()}function hre(){const t=_e(rt,this).getEditorElement();ge(t,/ht-theme-.*/g),U(t,this.hot.getCurrentThemeName())}function Yv(t,e,n){return(e=dre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dre(t){var e=fre(t,"string");return typeof e=="symbol"?e:e+""}function fre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fN{constructor(e){Yv(this,"hot",void 0),Yv(this,"commands",{}),Yv(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=gre(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||en(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),i.unshift(o.join(":")),M(u,c=>c.apply(this.hot,i))}}function gre(t,e){let n;return M(e,i=>{const r=i.key?i.key.split(":"):null;if(Array.isArray(r)&&r[1]===t)return n=i,!1}),n}function Gv(t,e,n){return(e=mre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mre(t){var e=pre(t,"string");return typeof e=="symbol"?e:e+""}function pre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gN{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Gv(this,"hot",void 0),Gv(this,"predefinedItems",cN()),Gv(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ae(e,(i,r)=>{let o="";i.name===xe?(n[xe]=i,o=xe):isNaN(parseInt(r,10))?(i.key=i.key===void 0?r:i.key,n[r]=i,o=i.key):(n[i.key]=i,o=i.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return wre(e,this.defaultOrderPattern,this.predefinedItems)}}function wre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let r=t;return r&&r.items?r=r.items:Array.isArray(r)||(r=e),He(r)?Ae(r,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),He(o)?nn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),i.push(a)}):M(r,(o,s)=>{let a=n[o];!a&&Uie.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),He(o)&&nn(a,o),a.key===void 0&&(a.key=s),i.push(a))}),i}function Cs(t,e,n){return(e=vre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vre(t){var e=Cre(t,"string");return typeof e=="symbol"?e:e+""}function Cre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yre{constructor(e,n){Cs(this,"top",void 0),Cs(this,"topRelative",void 0),Cs(this,"left",void 0),Cs(this,"leftRelative",void 0),Cs(this,"scrollTop",void 0),Cs(this,"scrollLeft",void 0),Cs(this,"cellHeight",void 0),Cs(this,"cellWidth",void 0);const i=n.scrollY,r=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=i,a+=r):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-i,l=a-r),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=i,this.scrollLeft=r,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Uc(t,e,n){Sre(t,e),e.set(t,n)}function Sre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function De(t,e){return t.get(mN(t,e))}function Gf(t,e,n){return t.set(mN(t,e),n),n}function mN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fn=new WeakMap,Vr=new WeakMap,ti=new WeakMap,Kv=new WeakMap,Gl=new WeakMap;class bre{constructor(e){Uc(this,Fn,void 0),Uc(this,Vr,void 0),Uc(this,ti,void 0),Uc(this,Kv,!1),Uc(this,Gl,{above:0,below:0,left:0,right:0}),Gf(Kv,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return De(Gl,this)[e]=n,this}setElement(e){return Gf(Fn,this,e),this}setParentElement(e){return Gf(Vr,this,e),this}updatePosition(e){Gf(ti,this,new yre(e,De(Fn,this).ownerDocument.defaultView)),De(Kv,this)?(De(ti,this).fitsBelow(De(Fn,this))?this.setPositionBelowCursor():De(ti,this).fitsAbove(De(Fn,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){De(Fn,this).dir==="rtl"?De(ti,this).fitsOnLeft(De(Fn,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():De(ti,this).fitsOnRight(De(Fn,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=De(Gl,this).above+De(ti,this).top-De(Fn,this).offsetHeight;De(Vr,this)&&(e=De(ti,this).top+De(ti,this).cellHeight-De(Fn,this).offsetHeight+3),De(Fn,this).style.top=`${e}px`}setPositionBelowCursor(){let e=De(Gl,this).below+De(ti,this).top+1;De(Vr,this)&&(e=De(ti,this).top-1),De(Fn,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=De(ti,this).left;if(De(Vr,this)){const n=De(Vr,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(De(Vr,this).querySelector(".htCore")).borderRightWidth,10);e+=De(ti,this).cellWidth+i}else e+=De(Gl,this).right;De(Fn,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=De(Gl,this).left+De(ti,this).left-De(Fn,this).offsetWidth;if(De(Vr,this)){const n=De(Vr,this).ownerDocument.defaultView;e-=Number.parseInt(n.getComputedStyle(De(Vr,this).querySelector(".htCore")).borderLeftWidth,10)}De(Fn,this).style.left=`${e}px`}}function pN(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:i=()=>{},onClear:r=()=>{}}=t;const o=new Set;let s=Ue(e,-1,p()-1);function a(y,R){const T=p()-1;return y<0&&(y=T),y>T&&(y=0),o.has(y)?-1:(o.add(y),i(y,!1)===!1&&(y=a(R===1?++y:--y,R)),y)}function l(y){y>-1&&y<p()&&i(y,!0)!==!1&&(s=y)}function u(){return s}function c(){p()>0&&(o.clear(),s=a(0,1))}function h(){p()>0&&(o.clear(),s=a(p()-1,-1))}function d(){p()>0&&(o.clear(),s=a(++s,1))}function f(){p()>0&&(o.clear(),s=a(--s,-1))}function p(){return Math.max(n(),0)}function S(){o.clear(),s=e,r()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:p,clear:S}}function Rre(t){return We(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Yy(t){return en(t,"submenu")}function Gy(t){return new RegExp(xe,"i").test(t.name)}function nm(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function _I(t){return en(t,"disableSelection")}function Ere(t){return pe(t,"htSeparator")}function Tre(t){return pe(t,"htSubmenu")}function Mre(t){return pe(t,"htDisabled")}function _re(t){return pe(t,"htSelectionDisabled")}function Ire(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function wN(t,e){const n=t.slice(0);for(let i=0;i<n.length&&n[i].name===e;)n.shift();return n}function Pre(t,e){let n=t.slice(0);return n.reverse(),n=wN(n,e),n.reverse(),n}function Ore(t){const e=[];return M(t,(n,i)=>{i>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function xre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xe,n=t.slice(0);return n=wN(n,e),n=Pre(n,e),n=Ore(n),n}function Hre(t){return t.checkable===!0}function Are(t){return pN({size:()=>t.countRows(),onItemSelect(e,n){const i=t.getCell(e,0);if(!i||Ere(i)||Mre(i)||_re(i))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Nre(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,r)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(i):o.tabMoves;r.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const i=n.getSelectedLast();if(i){const r=t.openSubMenu(i[0]);r&&r.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const r=n.getSelectedLast();!r||(n.getSourceDataAtRow(r[0]).submenu?t.openSubMenu(r[0]).getNavigator().toFirstItem():(t.executeCommand(i),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const vN="menu",II=vN;function Dre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];i(Nre(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;r(c,h)});function i(u,c){a(c).addShortcuts(u,{group:vN})}function r(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(p=>h.removeShortcutsByKeys(p))}),n.push({shortcuts:u,contextName:c}),i(u,c)}function o(){return[...n]}function s(u){return u?`${II}:${u}`:II}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:r,getCustomShortcuts:o,getContext:a,listen:l}}function $re(t){return(e,n,i,r,o,s)=>{const a=e.getSourceDataAtRow(i),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(rs(n),U(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!nm(a,t)&&!_I(a)&&!Gy(a);ve(n,[...Hre(a)?[UK(),ym(c),_1(h)]:[jK(),ym(u)],...d?[bl(-1)]:[],...nm(a,t)?[ZK()]:[],...Yy(a)?[Yi(!1)]:[]])}n.className="",n.appendChild(l),Gy(a)?U(n,"htSeparator"):typeof a.renderer=="function"?(U(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,i,r,o,u))):nc(l,u),nm(a,t)?U(n,"htDisabled"):_I(a)?U(n,"htSelectionDisabled"):Yy(a)&&U(n,"htSubmenu")}}function Xv(t,e,n){Lre(t,e),e.set(t,n)}function Lre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wr(t,e,n){return(e=kre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kre(t){var e=Fre(t,"string");return typeof e=="symbol"?e:e+""}function Fre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qv(t,e,n){return t.set(CN(t,e),n),n}function Ma(t,e){return t.get(CN(t,e))}function CN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const PI=215;var zc=new WeakMap,Kf=new WeakMap,Xf=new WeakMap;class sc{get tableBorderWidth(){return Ma(Xf,this)===void 0&&this.hotMenu&&qv(Xf,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Ma(Xf,this)}constructor(e,n){var i=this;Wr(this,"hot",void 0),Wr(this,"options",void 0),Wr(this,"eventManager",new Er(this)),Wr(this,"container",void 0),Wr(this,"positioner",void 0),Wr(this,"hotMenu",null),Wr(this,"hotSubMenus",{}),Wr(this,"parentMenu",void 0),Wr(this,"menuItems",null),Wr(this,"origOutsideClickDeselects",null),Xv(this,zc,void 0),Xv(this,Kf,void 0),Xv(this,Xf,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:PI,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new bre(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(r,o)=>{if(!o){var s;(s=this.hotMenu)===null||s===void 0||s.useTheme(r)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Fu(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Ma(zc,this)}getKeyboardShortcutsCtrl(){return Ma(Kf,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=fb(a=>this.openSubMenu(a),300),n=this.options.minWidth||PI;let i=!1,r=sl(this.menuItems,a=>(a.key===rd&&(i=!0),Ire(a,this.hot)));if(r.length<1&&!i)r.push(cN()[rd]);else if(r.length===0)return;r=xre(r,xe);let o=!1;const s={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return re(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:$re(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeOnCellMouseOver:(a,l)=>{Ma(zc,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),EM()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!EM()||!ul(a))&&o&&this.hasSelectedItem()&&(qo()||q1()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),qv(zc,this,Are(this.hotMenu)),qv(Kf,this,Dre(this)),Ma(Kf,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!!this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Ma(zc,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const i=this.parentMenu.hotMenu.getCell(n[0],0);ve(i,[Yi(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!Tre(n))return!1;const i=this.hotMenu.getSourceDataAtRow(e),r=new sc(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=r,this.hot.getSettings().ariaTags&&ve(n,[Yi(!0)]),r}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[n.key];if(i){i.destroy(),delete this.hotSubMenus[n.key];const r=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&ve(r,[Yi(!1)])}}closeAllSubMenus(){M(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const i=this.hot.getSelectedRange(),r=i?Rre(i):[];this.runLocalHooks("executeCommand",n.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,r,e)}isCommandPassive(e){return e.isCommand===!1||Gy(e)||nm(e,this.hot)||Yy(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:n}=this.hotMenu.view._wt,i=this.hotMenu.getSettings().data,r=n.hider.style,o=n.holder.style,s=parseInt(r.width,10),a=di(i,(l,u,c)=>{const d=this.hotMenu.getCell(c,0)?tn(this.hotMenu.getCell(c,0)):0;return l+(u.name===xe?1:d)},0);e.isClassicTheme()?(o.width=`${s+3}px`,o.height=`${a+3}px`):(o.width=`${s}px`,o.height=`${a}px`),r.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let i=e,r;return i&&(gt(i)&&(i=i.call(this.hot),i===null||Tt(i)?i="":i=i.toString()),i=i.replace(/[^A-Za-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,r=n.querySelector(`.${this.options.className}.${i}`)),r||(r=n.createElement("div"),U(r,`htMenu handsontable ${this.options.className}`),i&&U(r,i),this.options.container.appendChild(r)),r}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&ve(this.hotMenu.rootElement,[BK(),bl(-1)])}onDocumentMouseDown(e){!this.isOpened()||(this.options.standalone&&this.hotMenu&&!rl(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!rl(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){!this.isOpened()||pe(e.target,"htCore")&&rl(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}lt(sc,Nn);function Vre(t,e){Wre(t,e),e.add(t)}function Wre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zv(t,e,n){return(e=Bre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bre(t){var e=jre(t,"string");return typeof e=="symbol"?e:e+""}function jre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Sh="contextMenu",Ure=70,OI=Sh;ee.getSingleton().register("afterContextMenuDefaultOptions");ee.getSingleton().register("beforeContextMenuShow");ee.getSingleton().register("afterContextMenuShow");ee.getSingleton().register("afterContextMenuHide");ee.getSingleton().register("afterContextMenuExecute");var Yc=new WeakSet;class Jp extends Xe{constructor(){super(...arguments),Vre(this,Yc),Zv(this,"commandExecutor",new fN(this.hot)),Zv(this,"itemsFactory",null),Zv(this,"menu",null)}static get PLUGIN_KEY(){return Sh}static get PLUGIN_PRIORITY(){return Ure}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Xp,qp,xe,Dd,$d,xe,Kp,kd,xe,Zp,Gp,xe,Ld,xe,Fi]}isEnabled(){return!!this.hot.getSettings()[Sh]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Sh];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new sc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>qf(Yc,this,Yre).call(this)),this.menu.addLocalHook("afterOpen",()=>qf(Yc,this,Gre).call(this)),this.menu.addLocalHook("afterClose",()=>qf(Yc,this,Kre).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e.executeCommand.call(e,...r)}),this.addHook("afterOnCellContextMenu",i=>qf(Yc,this,zre).call(this,i)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=zp(this.menu.container,this.hot.rootDocument);this.open({left:n.left+i.left,top:n.top+i.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:OI})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(OI)}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const r=this.menu.tableBorderWidth>0;Ae(i,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,r?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new gN(this.hot,Jp.DEFAULT_ITEMS);const e=this.hot.getSettings()[Sh],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),M(i,r=>this.commandExecutor.registerCommand(r.key,r))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function zre(t){const e=this.hot.getSettings(),n=e.rowHeaders,i=e.colHeaders;function r(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),pe(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||i)&&!r(o)&&!(pe(o,"current")&&pe(o,"wtBorder"))))return;const s=zp(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Yre(){this.hot.runHooks("beforeContextMenuShow",this)}function Gre(){this.hot.runHooks("afterContextMenuShow",this)}function Kre(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Jp.SEPARATOR={name:xe};function Xre(t){return{key:"copy",name(){return this.getTranslatedPhrase(iR)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function qre(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Ue(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(sR,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Zre(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ue(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(oR,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Qre(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ue(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(rR,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Jre(t){return{key:"cut",name(){return this.getTranslatedPhrase(aR)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class eoe{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class toe{constructor(){this.clipboardData=new eoe}preventDefault(){}}function noe(t,e){yN(t,e),e.add(t)}function Kl(t,e,n){yN(t,e),e.set(t,n)}function yN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bn(t,e){return t.get(Tu(t,e))}function Xl(t,e,n){return t.set(Tu(t,e),n),n}function Tu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ys=new WeakMap,Qv=new WeakMap,Gc=new WeakMap,Ky=new WeakMap,Xy=new WeakMap,Kc=new WeakMap,Xc=new WeakSet;class ioe{constructor(e){let{countRows:n,countColumns:i,rowsLimit:r,columnsLimit:o,countColumnHeaders:s}=e;noe(this,Xc),Kl(this,ys,void 0),Kl(this,Qv,void 0),Kl(this,Gc,void 0),Kl(this,Ky,void 0),Kl(this,Xy,void 0),Kl(this,Kc,void 0),Xl(Qv,this,n),Xl(Gc,this,i),Xl(Ky,this,r),Xl(Xy,this,o),Xl(Kc,this,s)}setSelectedRange(e){Xl(ys,this,e)}getCellsRange(){if(Bn(Qv,this).call(this)===0||Bn(Gc,this).call(this)===0)return null;const{row:e,col:n}=Bn(ys,this).getTopStartCorner(),{row:i,col:r}=Bn(ys,this).getBottomEndCorner(),o=Tu(Xc,this,roe).call(this,e,i),s=Tu(Xc,this,Jv).call(this,n,r);return{isRangeTrimmed:i!==o||r!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Bn(Gc,this).call(this)===0||Bn(Kc,this).call(this)===0)return null;const{col:e}=Bn(ys,this).getTopStartCorner(),{col:n}=Bn(ys,this).getBottomEndCorner(),i=Tu(Xc,this,Jv).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(Bn(Gc,this).call(this)===0||Bn(Kc,this).call(this)===0)return null;const{col:e}=Bn(ys,this).getTopStartCorner(),{col:n}=Bn(ys,this).getBottomEndCorner(),i=Tu(Xc,this,Jv).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-Bn(Kc,this).call(this),startCol:e,endRow:-1,endCol:i}}}function Jv(t,e){return Math.min(e,Math.max(t+Bn(Xy,this).call(this)-1,t))}function roe(t,e){return Math.min(e,Math.max(t+Bn(Ky,this).call(this)-1,t))}function SN(t){const e=[],n=[];return M(t,i=>{const r=Math.min(i.startRow,i.endRow),o=Math.max(i.startRow,i.endRow);ce(r,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(i.startCol,i.endCol),a=Math.max(i.startCol,i.endCol);ce(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function ooe(t,e){bN(t,e),e.add(t)}function Ss(t,e,n){bN(t,e),e.set(t,n)}function bN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qc(t,e,n){return(e=soe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function soe(t){var e=aoe(t,"string");return typeof e=="symbol"?e:e+""}function aoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ai(t,e){return t.get(li(t,e))}function ur(t,e,n){return t.set(li(t,e),n),n}function li(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ee.getSingleton().register("afterCopyLimit");ee.getSingleton().register("modifyCopyableRange");ee.getSingleton().register("beforeCut");ee.getSingleton().register("afterCut");ee.getSingleton().register("beforePaste");ee.getSingleton().register("afterPaste");ee.getSingleton().register("beforeCopy");ee.getSingleton().register("afterCopy");const eC="copyPaste",loe=80,uoe=["fragmentSelection"],xI=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var qy=new WeakMap,Zy=new WeakMap,Qy=new WeakMap,ql=new WeakMap,Zf=new WeakMap,Qf=new WeakMap,Zl=new WeakMap,Bm=new WeakMap,yi=new WeakSet;class coe extends Xe{constructor(){super(...arguments),ooe(this,yi),qc(this,"columnsLimit",1/0),qc(this,"rowsLimit",1/0),qc(this,"pasteMode","overwrite"),qc(this,"uiContainer",this.hot.rootDocument.body),Ss(this,qy,!1),Ss(this,Zy,!1),Ss(this,Qy,!1),Ss(this,ql,"cells-only"),Ss(this,Zf,!1),Ss(this,Qf,!1),Ss(this,Zl,new ioe({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ss(this,Bm,!1),qc(this,"copyableRanges",[])}static get PLUGIN_KEY(){return eC}static get SETTING_KEYS(){return[eC,...uoe]}static get PLUGIN_PRIORITY(){return loe}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[eC]}enablePlugin(){var e,n,i=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),ur(qy,this,this.getSetting("copyColumnHeaders")),ur(Zy,this,this.getSetting("copyColumnGroupHeaders")),ur(Qy,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",r=>li(yi,this,foe).call(this,r)),this.addHook("afterSelection",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return li(yi,i,goe).call(i,...o)}),this.addHook("afterSelectionEnd",()=>li(yi,this,moe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),K1()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return li(yi,i,poe).call(i,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return li(yi,i,woe).call(i,...o)}),this.addHook("afterSelection",()=>li(yi,this,voe).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";ur(ql,this,e),ur(Zf,this,!0),li(yi,this,HI).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){ur(Qf,this,!0),li(yi,this,HI).call(this,"cut")}getRangedCopyableData(e){return Ph(this.getRangedData(e))}getRangedData(e){const n=[],{rows:i,columns:r}=SN(e);return M(i,o=>{const s=[];M(r,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const i=new toe;e&&i.clipboardData.setData("text/plain",e),n&&i.clipboardData.setData("text/html",n),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}ai(Zl,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);ai(ql,this)==="column-headers-only"?n.set("headers",ai(Zl,this).getMostBottomColumnHeadersRange()):(ai(ql,this)==="with-column-headers"?n.set("headers",ai(Zl,this).getMostBottomColumnHeadersRange()):ai(ql,this)==="with-column-group-headers"&&n.set("headers",ai(Zl,this).getAllColumnHeadersRange()),n.set("cells",ai(Zl,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(r=>r!==null).map(r=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=r;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=n.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:r,startCol:o,endRow:s,endCol:a}=i;this.hot.runHooks("afterCopyLimit",s-r+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const i=e.length,r=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<i||c<=l;){const{skipRowOnPaste:p,visualRow:S}=this.hot.getCellMeta(c,a);if(c=S+1,p===!0)continue;d=S,h=a;const y=[],R=o.length%i;for(;y.length<r||h<=u;){const{skipColumnOnPaste:T,visualCol:V}=this.hot.getCellMeta(s,h);if(h=V+1,T===!0)continue;f=V;const B=y.length%r;y.push(e[R][B])}o.push(y)}return ur(Bm,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){var n;const i=this.hot.getFocusManager().getRefocusElement(),r=(n=e.target)===null||n===void 0?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ai(Zf,this)||this.isEditorOpened()||Ys(e.target)&&(r&&e.target!==i||!r&&e.target!==this.hot.rootDocument.body&&!Gg(e.target,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),ur(Zf,this,!1);const o=this.getRangedData(this.copyableRanges),s=li(yi,this,hoe).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=Ph(o);if(e&&e.clipboardData){const u=LM(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[xI,u].join(""))}else typeof ClipboardEvent=="undefined"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}ur(ql,this,"cells-only")}onCut(e){var n;const i=this.hot.getFocusManager().getRefocusElement(),r=(n=e.target)===null||n===void 0?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ai(Qf,this)||this.isEditorOpened()||Ys(e.target)&&(r&&e.target!==i||!r&&e.target!==this.hot.rootDocument.body&&!Gg(e.target,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),ur(Qf,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=Ph(o);if(e&&e.clipboardData){const l=LM(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[xI,l].join(""))}else typeof ClipboardEvent=="undefined"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){var n;const i=this.hot.getFocusManager().getRefocusElement(),r=(n=e.target)===null||n===void 0?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Ys(e.target)&&(r&&e.target!==i||!r&&e.target!==this.hot.rootDocument.body&&!Gg(e.target,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData!="undefined"){const c=ab(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=Tq(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent=="undefined"&&typeof this.hot.rootWindow.clipboardData!="undefined"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=a7(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function HI(t){if(K1()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:i}=e.highlight,r=this.hot.getCell(n,i,!0);r&&w3(r,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function hoe(t){const{rows:e}=SN(t);let n=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function doe(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i&&F1(i)}}}function RN(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i!=null&&i.hasAttribute("contenteditable")&&V1(i)}}}function foe(t){t.items.push({name:"---------"},Xre(this)),ai(qy,this)&&t.items.push(Qre(this)),ai(Zy,this)&&t.items.push(Zre(this)),ai(Qy,this)&&t.items.push(qre(this)),t.items.push(Jre(this))}function goe(t,e,n,i,r){ai(Bm,this)&&(r.value=!0),ur(Bm,this,!1)}function moe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function poe(){li(yi,this,RN).call(this)}function woe(){li(yi,this,doe).call(this)}function voe(){li(yi,this,RN).call(this)}function EN(t,e){return`border_row${t}col${e}`}function bh(){return{width:1,color:"#000"}}function Zo(){return{hide:!0}}function Coe(){return{width:1,color:"#000",cornerVisible:!1}}function tC(t){if(re(t.start)||re(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(re(t.end)||re(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Zc(t){return re(t.start)&&(t.left=t.start),re(t.end)&&(t.right=t.end),t}function nC(t,e){return{id:EN(t,e),border:Coe(),row:t,col:e,top:Zo(),bottom:Zo(),start:Zo(),end:Zo()}}function yoe(t,e){return en(e,"border")&&e.border&&(t.border=e.border),en(e,"top")&&re(e.top)&&(e.top?(He(e.top)||(e.top=bh()),t.top=e.top):(e.top=Zo(),t.top=e.top)),en(e,"bottom")&&re(e.bottom)&&(e.bottom?(He(e.bottom)||(e.bottom=bh()),t.bottom=e.bottom):(e.bottom=Zo(),t.bottom=e.bottom)),en(e,"start")&&re(e.start)&&(e.start?(He(e.start)||(e.start=bh()),t.start=e.start):(e.start=Zo(),t.start=e.start)),en(e,"end")&&re(e.end)&&(e.end?(He(e.end)||(e.end=bh()),t.end=e.end):(e.end=Zo(),t.end=e.end)),t}function ss(t,e){let n=!1;return M(t.getSelectedRange(),i=>{i.forAll((r,o)=>{if(r<0||o<0)return;const s=t.getCellMeta(r,o).borders;if(s)if(e){if(!en(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function ew(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function Soe(t){return t.some(e=>re(e.left)||re(e.right))}function boe(t){return t.some(e=>re(e.start)||re(e.end))}const Roe=new Map([["left","start"],["right","end"]]);function Eoe(t){var e;return(e=Roe.get(t))!==null&&e!==void 0?e:t}function Toe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(_R);return ss(this,"bottom")&&(e=ew(e)),e},callback(e,n){const i=ss(this,"bottom");t.prepareBorder(n,"bottom",i)}}}function Moe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(IR);return ss(this,e)&&(n=ew(n)),n},callback(n,i){const r=ss(this,e);t.prepareBorder(i,e,r)}}}function _oe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(PR)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!ss(this)}}}function Ioe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(MR);return ss(this,e)&&(n=ew(n)),n},callback(n,i){const r=ss(this,e);t.prepareBorder(i,e,r)}}}function Poe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(TR);return ss(this,"top")&&(e=ew(e)),e},callback(e,n){const i=ss(this,"top");t.prepareBorder(n,"top",i)}}}function Ooe(t,e){xoe(t,e),e.add(t)}function xoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hoe(t,e,n){return(e=Aoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aoe(t){var e=Noe(t,"string");return typeof e=="symbol"?e:e+""}function Noe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AI(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const im="customBorders",Doe=90;var iC=new WeakSet;class $oe extends Xe{constructor(){super(...arguments),Ooe(this,iC),Hoe(this,"savedBorders",[])}static get PLUGIN_KEY(){return im}static get PLUGIN_PRIORITY(){return Doe}isEnabled(){return!!this.hot.getSettings()[im]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>AI(iC,this,Loe).call(this,e)),this.addHook("init",()=>AI(iC,this,koe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let i=["top","bottom","start","end"],r=null;n&&(this.checkSettingsCohesion([n]),i=Object.keys(n),r=tC(n));const o=Bu(e),s=nd(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});M(e,a=>{s(a).forAll((l,u)=>{M(i,c=>{this.prepareBorderFromCustomAdded(l,u,r,Eoe(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Bu(e),i=nd(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),r=[];return M(e,o=>{i(o).forAll((s,a)=>{M(this.savedBorders,l=>{l.row===s&&l.col===a&&r.push(Zc(l))})})}),r}clearBorders(e){e?this.setBorders(e):(M(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const r=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,r,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}prepareBorderFromCustomAdded(e,n,i,r){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=nC(e,n);i&&(a=yoe(a,i),M(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,i),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Zc(a)),this.insertBorderIntoSettings(a,r)}prepareBorderFromCustomAddedRange(e,n){const i=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);ce(e.from.row,i,o=>{ce(e.from.col,r,s=>{const a=nC(o,s);let l=0;o===e.from.row&&en(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&en(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&en(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&en(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Zc(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const i=EN(e,n);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,i,r){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=nC(e,n):o=tC(o),r?(o[i]=Zo(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Zc(o)))):(o[i]=bh(),this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Zc(o)))}prepareBorder(e,n,i){M(e,r=>{let{start:o,end:s}=r;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,i);else switch(n){case"noBorders":ce(o.col,s.col,a=>{ce(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":ce(o.col,s.col,a=>{this.setBorder(o.row,a,n,i)});break;case"bottom":ce(o.col,s.col,a=>{this.setBorder(s.row,a,n,i)});break;case"start":ce(o.row,s.row,a=>{this.setBorder(a,o.col,n,i)});break;case"end":ce(o.row,s.row,a=>{this.setBorder(a,s.col,n,i)});break}})}createCustomBorders(e){M(e,n=>{const i=tC(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,i):this.prepareBorderFromCustomAdded(n.row,n.col,i)})}countHide(e){const{top:n,bottom:i,start:r,end:o}=e;return di([n,i,r,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=We(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){M(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){M(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=We(this.savedBorders,i=>i.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):M(this.savedBorders,(r,o)=>{if(e.id===r.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,i){let r=!1;return M(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return M(s,a=>{a.toggleHiddenClass(n,i)}),r=!0,!1}}),r}checkCustomSelections(e,n,i){const r=this.countHide(e);let o=!1;return r===4?(this.removeAllBorders(e.row,e.col),o=!0):M(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),i){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);M(a,l=>{l.changeBorderStyle(i,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[im];if(Array.isArray(e)){const n=Xn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=Soe(e),i=boe(e);if(n&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function Loe(t){!this.hot.getSettings()[im]||t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(ER)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Poe(this),Ioe(this),Toe(this),Moe(this),_oe(this)]}})}function koe(){this.changeBorderSettings()}function Foe(t,e){Voe(t,e),e.add(t)}function Voe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rC(t,e,n){return(e=Woe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Woe(t){var e=Boe(t,"string");return typeof e=="symbol"?e:e+""}function Boe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function NI(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const DI="dragToScroll",joe=100;var oC=new WeakSet;class Uoe extends Xe{constructor(){super(...arguments),Foe(this,oC),rC(this,"boundaries",null),rC(this,"callback",null),rC(this,"listening",!1)}static get PLUGIN_KEY(){return DI}static get PLUGIN_PRIORITY(){return joe}isEnabled(){return!!this.hot.getSettings()[DI]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>NI(oC,this,$I).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>NI(oC,this,$I).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let i=0,r=0;n<this.boundaries.top?r=n-this.boundaries.top:n>this.boundaries.bottom&&(r=n-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",i=>this.onMouseMove(i)),n=Fu(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){!this.isListening()||this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function $I(t){if(ul(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,i)=>{var r,o;const s=(r=e.scrollLeft)!==null&&r!==void 0?r:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(i)*20)}),this.listen()}function zoe(t,e){TN(t,e),e.add(t)}function Yoe(t,e,n){TN(t,e),e.set(t,n)}function TN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sC(t,e,n){return(e=Goe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Goe(t){var e=Koe(t,"string");return typeof e=="symbol"?e:e+""}function Koe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xoe(t,e){return t.get(Vi(t,e))}function MN(t,e,n){return t.set(Vi(t,e),n),n}function Vi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ee.getSingleton().register("afterDropdownMenuDefaultOptions");ee.getSingleton().register("beforeDropdownMenuShow");ee.getSingleton().register("afterDropdownMenuShow");ee.getSingleton().register("afterDropdownMenuHide");ee.getSingleton().register("afterDropdownMenuExecute");const rm="dropdownMenu",qoe=230,od="changeType",aC=rm;var tw=new WeakMap,dr=new WeakSet;class nw extends Xe{static get PLUGIN_KEY(){return rm}static get PLUGIN_PRIORITY(){return qoe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Dd,$d,xe,kd,xe,Yp,xe,Ld,xe,Fi]}constructor(e){super(e),zoe(this,dr),sC(this,"commandExecutor",new fN(this.hot)),sC(this,"itemsFactory",null),sC(this,"menu",null),Yoe(this,tw,!1),this.hot.addHook("afterGetColHeader",(n,i)=>Vi(dr,this,Qoe).call(this,n,i))}isEnabled(){return this.hot.getSettings()[rm]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new gN(this.hot,nw.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Vi(dr,e,rse).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Vi(dr,e,ise).call(e,...o)});const n=this.hot.getSettings()[rm],i={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const r=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new sc(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>Vi(dr,this,Joe).call(this)),this.menu.addLocalHook("afterOpen",()=>Vi(dr,this,ese).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>Vi(dr,this,tse).call(this,o)),this.menu.addLocalHook("afterClose",()=>Vi(dr,this,nse).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),M(r,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:i}=this.hot.getSelectedRangeLast();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:r}=this.hot.getSelectedRangeLast(),o=zp(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,r.col,!0).querySelector(`.${od}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:aC},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isCell()&&!this.menu.isOpened()},group:aC}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(aC)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Vi(dr,this,Zoe).call(this,e))}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ae(i,(r,o)=>{this.menu.setOffset(o,r)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function _N(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Zoe(t){if(pe(t.target,od)){const e=zp(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),MN(tw,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function Qoe(t,e){const n=e.parentNode;if(!n)return;const i=n.parentNode.childNodes,r=Array.prototype.indexOf.call(i,n);if(t<0||r!==i.length-1)return;const o=e.querySelector(`.${od}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=od,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(ve(s,[Js(),ym(" ")]),ve(e,[E1("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function Joe(){this.hot.runHooks("beforeDropdownMenuShow",this)}function ese(){this.hot.runHooks("afterDropdownMenuShow",this),Vi(dr,this,_N).call(this,this.menu)}function tse(t){Vi(dr,this,_N).call(this,t)}function nse(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function ise(t){return Xoe(tw,this)?null:t}function rse(t){pe(t.target,od)&&MN(tw,this,!0)}nw.SEPARATOR={name:xe};function LI(t,e,n){return(e=ose(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ose(t){var e=sse(t,"string");return typeof e=="symbol"?e:e+""}function sse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ase{constructor(e){LI(this,"hot",void 0),LI(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:i,endCol:r}=this._getDataRange(),o=this.options,s=[];return ce(e,i,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(ce(n,r,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:i}=this._getDataRange(),r=this.hot.getRowHeader();ce(n,i,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(r[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:i}=this._getDataRange(),r=this.hot.getColHeader();ce(n,i,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(r[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[i=0,r=0,o=n,s=e]=this.options.range;return i=Math.max(i,0),r=Math.max(r,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:i,startCol:r,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}var lse=ase;function kI(t,e,n){return(e=use(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function use(t){var e=cse(t,"string");return typeof e=="symbol"?e:e+""}function cse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B0{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){kI(this,"dataProvider",void 0),kI(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=go(this.constructor.DEFAULT_OPTIONS);const i=new Date;return n=nn(go(B0.DEFAULT_OPTIONS),n),n=nn(n,e),n.filename=S1(n.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),n}}var hse=B0;const dse=String.fromCharCode(13),fse=String.fromCharCode(34),gse=String.fromCharCode(10);class mse extends hse{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const r=i.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?String.fromCharCode(65279):"";return r&&(i=We(i,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=i.join(e.columnDelimiter),a+=e.rowDelimiter),M(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=Gt(e);return i!==""&&(n||i.indexOf(dse)>=0||i.indexOf(fse)>=0||i.indexOf(gse)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`),i}}var pse=mse;const wse="csv",Jy={[wse]:pse};function vse(t,e,n){return typeof Jy[t]=="function"?new Jy[t](e,n):null}const Cse="exportFile",yse=240;class Sse extends Xe{static get PLUGIN_KEY(){return Cse}static get PLUGIN_PRIORITY(){return yse}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:r}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=r.URL||r.webkitURL,l=i.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),i.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),i.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Jy[e])throw new Error(`Export format type "${e}" is not supported.`);return vse(e,new lse(this.hot),n)}_createBlob(e){let n=null;return typeof Blob!="undefined"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Ql(t,e,n){return(e=bse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bse(t){var e=Rse(t,"string");return typeof e=="symbol"?e:e+""}function Rse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fd{constructor(e,n){let{id:i,stateless:r=!0}=n;Ql(this,"hot",void 0),Ql(this,"id",void 0),Ql(this,"elements",[]),Ql(this,"hidden",!1),Ql(this,"stateId",""),Ql(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Lp)}getElements(){return this.elements}reset(){M(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),M(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}lt(Fd,Nn);const sd={};function Zs(t,e){if(!sd[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:i}=sd[t];let r=e;return i.inputValuesDecorator&&(r=i.inputValuesDecorator(r)),function(o){return n.apply(o.meta.instance,[].concat([o],[r]))}}function el(t){if(!sd[t])throw Error(`Filter condition "${t}" does not exist.`);return sd[t].descriptor}function Xt(t,e,n){n.key=t,sd[t]={condition:e,descriptor:n}}const pn="none";function Ese(){return!0}Xt(pn,Ese,{name:kp,inputsCount:0,showOperators:!1});const Ah="empty";function Tse(t){return Wt(t.value)}Xt(Ah,Tse,{name:$R,inputsCount:0,showOperators:!0});const om="not_empty";function Mse(t,e){return!Zs(Ah,e)(t)}Xt(om,Mse,{name:LR,inputsCount:0,showOperators:!0});const Nh="eq";function _se(t,e){let[n]=e;return Gt(t.value).toLocaleLowerCase(t.meta.locale)===Gt(n)}Xt(Nh,_se,{name:kR,inputsCount:1,showOperators:!0});const sm="neq";function Ise(t,e){return!Zs(Nh,e)(t)}Xt(sm,Ise,{name:FR,inputsCount:1,showOperators:!0});const IN="gt";function Pse(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}Xt(IN,Pse,{name:UR,inputsCount:1,showOperators:!0});const PN="gte";function Ose(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}Xt(PN,Ose,{name:zR,inputsCount:1,showOperators:!0});const ON="lt";function xse(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}Xt(ON,xse,{name:YR,inputsCount:1,showOperators:!0});const xN="lte";function Hse(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}Xt(xN,Hse,{name:GR,inputsCount:1,showOperators:!0});const j0="date_after";function Ase(t,e){let[n]=e;const i=X(t.value,t.meta.dateFormat),r=X(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)>=0}Xt(j0,Ase,{name:qR,inputsCount:1,showOperators:!0});const U0="date_before";function Nse(t,e){let[n]=e;const i=X(t.value,t.meta.dateFormat),r=X(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)<=0}Xt(U0,Nse,{name:ZR,inputsCount:1,showOperators:!0});const jm="between";function Dse(t,e){let[n,i]=e,r=n,o=i;if(t.meta.type==="numeric"){const s=parseFloat(r,10),a=parseFloat(o,10);r=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Zs(U0,[o]),a=Zs(j0,[r]);return s(t)&&a(t)}return t.value>=r&&t.value<=o}Xt(jm,Dse,{name:KR,inputsCount:2,showOperators:!0});const HN="not_between";function $se(t,e){return!Zs(jm,e)(t)}Xt(HN,$se,{name:XR,inputsCount:2,showOperators:!0});const AN="begins_with";function Lse(t,e){let[n]=e;return Gt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Gt(n))}Xt(AN,Lse,{name:VR,inputsCount:1,showOperators:!0});const NN="ends_with";function kse(t,e){let[n]=e;return Gt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Gt(n))}Xt(NN,kse,{name:WR,inputsCount:1,showOperators:!0});const z0="contains";function Fse(t,e){let[n]=e;return Gt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Gt(n))>=0}Xt(z0,Fse,{name:BR,inputsCount:1,showOperators:!0});const DN="not_contains";function Vse(t,e){return!Zs(z0,e)(t)}Xt(DN,Vse,{name:jR,inputsCount:1,showOperators:!0});const $N="date_tomorrow";function Wse(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().subtract(-1,"days").startOf("day"),"d"):!1}Xt($N,Wse,{name:JR,inputsCount:0});const LN="date_today";function Bse(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().startOf("day"),"d"):!1}Xt(LN,Bse,{name:QR,inputsCount:0});const kN="date_yesterday";function jse(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().subtract(1,"days").startOf("day"),"d"):!1}Xt(kN,jse,{name:e0,inputsCount:0});L3();function Use(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Vd(t){const e=new Set(t);return function(n){return e.has(n)}}function Y0(t){return t==null?"":t}function eS(t){return Array.from(new Set(t)).map(e=>Y0(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function FI(t,e,n,i){const r=[],o=t===e;let s;return o||(s=Vd(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:Use(a,n)};i&&i(u),r.push(u)}),r}const tl="by_value";function zse(t,e){let[n]=e;return n(t.value)}Xt(tl,zse,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Vd(e)]},showOperators:!1});const ad={};function Yse(t){if(!ad[t])throw Error(`Operation with id "${t}" does not exist.`);const e=ad[t].func;return function(n,i){return e(n,i)}}function Gse(t){return ad[t].name}function G0(t,e,n){ad[t]={name:e,func:n}}const Xs="conjunction",Kse=i0;function Xse(t,e){return t.every(n=>n.func(e))}G0(Xs,Kse,Xse);const Um="disjunction",qse=Fp;function Zse(t,e){return t.some(n=>n.func(e))}G0(Um,qse,Zse);const K0="disjunctionWithExtraCondition",Qse=Fp;function Jse(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}G0(K0,Qse,Jse);const eae="numeric",FN="text",tae="date",VI={[eae]:[pn,xe,Ah,om,xe,Nh,sm,xe,IN,PN,ON,xN,jm,HN],[FN]:[pn,xe,Ah,om,xe,Nh,sm,xe,AN,NN,xe,z0,DN],[tae]:[pn,xe,Ah,om,xe,Nh,sm,xe,U0,j0,jm,xe,$N,LN,kN]};function nae(t){const e=[];let n=t;return VI[n]||(n=FN),M(VI[n],i=>{let r;i===xe?r={name:xe}:r=go(el(i)),e.push(r)}),e}function Qc(t,e,n){return(e=iae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iae(t){var e=rae(t,"string");return typeof e=="symbol"?e:e+""}function rae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const lC="built",uC="building",WI=["click","input","keydown","keypress","keyup","focus","blur","change"];class _i{static get DEFAULTS(){return go({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Qc(this,"hot",void 0),Qc(this,"eventManager",new Er(this)),Qc(this,"options",void 0),Qc(this,"_element",void 0),Qc(this,"buildState",void 0),this.hot=e,this.options=nn(_i.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===uC?this._element:this.buildState===lC?(this.update(),this._element):(this.buildState=uC,this.build(),this.buildState=lC,this._element)}isBuilt(){return this.buildState===lC}translateIfPossible(e){return typeof e=="string"&&e.startsWith(qn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,i)=>{this.eventManager.addEventListener(n,i,r=>this.runLocalHooks(i,r,this))};if(this.buildState||(this.buildState=uC),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&U(this._element,this.options.className),this.options.children.length)M(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ae(this.options,(i,r)=>{n[r]!==void 0&&r!=="className"&&r!=="tagName"&&r!=="children"&&(n[r]=this.translateIfPossible(i))}),this._element.appendChild(n),M(WI,i=>e(n,i))}else M(WI,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}lt(_i,Nn);function oae(t,e){VN(t,e),e.add(t)}function sae(t,e,n){VN(t,e),e.set(t,n)}function VN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jf(t,e){return t.get(X0(t,e))}function aae(t,e,n){return t.set(X0(t,e),n),n}function X0(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Jl=new WeakMap,BI=new WeakSet;class qs extends _i{static get DEFAULTS(){return go({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,nn(qs.DEFAULTS,n)),oae(this,BI),sae(this,Jl,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>X0(BI,this,lae).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");aae(Jl,this,this._element.firstChild),U(this._element,"htUIInput"),U(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){!this.isBuilt()||(Jf(Jl,this).type=this.options.type,Jf(Jl,this).placeholder=this.translateIfPossible(this.options.placeholder),Jf(Jl,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Jf(Jl,this).focus()}}function lae(t){this.options.value=t.target.value}function uae(t,e){WN(t,e),e.add(t)}function Jc(t,e,n){WN(t,e),e.set(t,n)}function WN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eu(t,e,n){return t.set(Dh(t,e),n),n}function Mt(t,e){return t.get(Dh(t,e))}function Dh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sn=new WeakMap,eg=new WeakMap,tg=new WeakMap,cC=new WeakMap,ng=new WeakMap,ig=new WeakSet;class ld extends _i{static get DEFAULTS(){return go({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,nn(ld.DEFAULTS,n)),uae(this,ig),Jc(this,sn,null),Jc(this,eg,[]),Jc(this,tg,void 0),Jc(this,cC,void 0),Jc(this,ng,void 0),this.registerHooks()}getMenu(){return Mt(sn,this)}registerHooks(){this.addLocalHook("click",()=>Dh(ig,this,dae).call(this))}setItems(e){eu(eg,this,this.translateNames(e)),Mt(sn,this)&&Mt(sn,this).setMenuItems(Mt(eg,this))}translateNames(e){return M(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),eu(sn,this,new sc(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Mt(sn,this).setMenuItems(Mt(eg,this));const e=new _i(this.hot,{className:"htUISelectCaption"}),n=new _i(this.hot,{className:"htUISelectDropdown"});eu(tg,this,e),eu(cC,this,e.element),eu(ng,this,n),this.hot.getSettings().ariaTags&&(ve(n.element,[Js()]),ve(this._element,[R1()])),M([e,n],i=>this._element.appendChild(i.element)),Mt(sn,this).addLocalHook("select",i=>Dh(ig,this,cae).call(this,i)),Mt(sn,this).addLocalHook("afterClose",()=>Dh(ig,this,hae).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Mt(sn,this).hot.getTranslatedPhrase(kp),Mt(cC,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Mt(sn,this)&&(Mt(sn,this).open(),Mt(sn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Mt(sn,this).getNavigator().toFirstItem(),Mt(sn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Mt(sn,this)&&Mt(sn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Mt(sn,this)&&(Mt(sn,this).destroy(),eu(sn,this,null)),Mt(tg,this)&&Mt(tg,this).destroy(),Mt(ng,this)&&Mt(ng,this).destroy(),super.destroy()}}function cae(t){t.name!==xe&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function hae(){this.runLocalHooks("afterClose")}function dae(){this.openOptions()}function fae(t,e){gae(t,e),e.add(t)}function gae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jI(t,e,n){return(e=mae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mae(t){var e=pae(t,"string");return typeof e=="symbol"?e:e+""}function pae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UI(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hC=new WeakSet;class tS extends Fd{constructor(e,n){super(e,{id:n.id,stateless:!1}),fae(this,hC),jI(this,"name",""),jI(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new ld(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new qs(this.hot,{placeholder:u0})),this.elements.push(new qs(this.hot,{placeholder:c0})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>UI(hC,this,wae).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),M(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>UI(hC,this,vae).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=go(e.command);n.name.startsWith(At)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),M(e.args,(i,r)=>{if(r>n.inputsCount-1)return!1;const o=this.getInputElement(r);o.setValue(i),o[n.inputsCount>r?"show":"hide"](),r||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||el(pn),n=[];return M(this.getInputElements(),(i,r)=>{e.inputsCount>r&&n.push(i.getValue())}),{command:e,args:n}}updateState(e,n){const i=el(e?e.name:pn);this.state.setValueAtIndex(n,{command:i,args:e?e.args:[]}),e||M(this.getInputElements(),r=>r.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof ld)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof qs)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,o,s)=>{U(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&U(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return U(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||M(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[el(pn)];if(e!==null){const{visualIndex:i}=e;n=nae(this.hot.getDataType(0,i,this.hot.countRows(),i))}M(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function wae(t){M(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function vae(t){_d(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ir(t))}function zI(t,e,n){Cae(t,e),e.set(t,n)}function Cae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eh(t,e){return t.get(BN(t,e))}function YI(t,e,n){return t.set(BN(t,e),n),n}function BN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var tu=new WeakMap,dC=new WeakMap;class zm extends _i{static get DEFAULTS(){return go({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,nn(zm.DEFAULTS,n)),zI(this,tu,void 0),zI(this,dC,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),YI(dC,this,e),YI(tu,this,this._element.firstChild),eh(tu,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){!this.isBuilt()||(eh(dC,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?eh(tu,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(eh(tu,this).checked=e)}focus(){this.isBuilt()&&eh(tu,this).focus()}}function yae(t,e){Sae(t,e),e.add(t)}function Sae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bae(t,e,n){return(e=Rae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rae(t){var e=Eae(t,"string");return typeof e=="symbol"?e:e+""}function Eae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tae(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const GI=0;var KI=new WeakSet;class Mae extends Fd{constructor(e,n){super(e,{id:n.id,stateless:!1}),yae(this,KI),bae(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(U(n.parentNode,"htFiltersMenuOperators"),M(this.elements,i=>n.appendChild(i.element)),n)}}buildOperatorsElement(){const e=[Xs,Um];M(e,n=>{const i=new zm(this.hot,{name:"operator",label:{htmlFor:n,textContent:Gse(n)},value:n,checked:n===e[GI],id:n});i.addLocalHook("change",r=>Tae(KI,this,_ae).call(this,r)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(tt`Radio button with index ${e} doesn't exist.`);M(this.elements,(n,i)=>{n.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof zm&&n.isChecked());return e?e.getValue():Xs}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&M(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Xs,n=arguments.length>1?arguments[1]:void 0,i=e;i===K0&&(i=Um),this.state.setValueAtIndex(n,i)}reset(){this.setChecked(GI)}}function _ae(t){this.setState(t.target.value)}function Iae(t,e,n){Pae(t,e),e.set(t,n)}function Pae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fC(t,e){return t.get(jN(t,e))}function Oae(t,e,n){return t.set(jN(t,e),n),n}function jN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var th=new WeakMap;class ud extends _i{static get DEFAULTS(){return go({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,nn(ud.DEFAULTS,n)),Iae(this,th,void 0)}build(){super.build(),Oae(th,this,this._element.firstChild)}update(){!this.isBuilt()||(fC(th,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&fC(th,this).focus()}activate(){fC(th,this).click()}}function xae(t,e){UN(t,e),e.add(t)}function nu(t,e,n){UN(t,e),e.set(t,n)}function UN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Re(t,e){return t.get(Mu(t,e))}function rr(t,e,n){return t.set(Mu(t,e),n),n}function Mu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const XI="multipleSelect.itemBox";var fr=new WeakMap,kt=new WeakMap,gC=new WeakMap,Ho=new WeakMap,bs=new WeakMap,Rs=new WeakMap,nh=new WeakSet;class cd extends _i{static get DEFAULTS(){return go({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,nn(cd.DEFAULTS,n)),xae(this,nh),nu(this,fr,[]),nu(this,kt,void 0),nu(this,gC,void 0),nu(this,Ho,void 0),nu(this,bs,void 0),nu(this,Rs,void 0),rr(Ho,this,new qs(this.hot,{placeholder:l0,className:"htUIMultipleSelectSearch"})),rr(bs,this,new ud(this.hot,{textContent:r0,className:"htUISelectAll"})),rr(Rs,this,new ud(this.hot,{textContent:o0,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Re(kt,this)}registerHooks(){Re(Ho,this).addLocalHook("keydown",e=>Mu(nh,this,Aae).call(this,e)),Re(Ho,this).addLocalHook("input",e=>Mu(nh,this,Hae).call(this,e)),Re(bs,this).addLocalHook("click",e=>Mu(nh,this,Nae).call(this,e)),Re(Rs,this).addLocalHook("click",e=>Mu(nh,this,Dae).call(this,e))}setItems(e){var n;rr(fr,this,e),(n=Re(kt,this))===null||n===void 0||n.loadData(Re(fr,this))}setLocale(e){rr(gC,this,e)}getLocale(){return Re(gC,this)}getItems(){return[...Re(fr,this)]}getValue(){return Lae(Re(fr,this))}getSearchInputElement(){return Re(Ho,this)}getSelectAllElement(){return Re(bs,this)}getClearAllElement(){return Re(Rs,this)}isSelectedAllValues(){return Re(fr,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),i=new _i(this.hot,{className:"htUISelectionControls",children:[Re(bs,this),Re(Rs,this)]});this._element.appendChild(Re(Ho,this).element),this._element.appendChild(i.element),this._element.appendChild(n);const r=o=>{var s;if(!this._element)return;(s=Re(kt,this))===null||s===void 0||s.destroy(),U(o,"htUIMultipleSelectHot"),rr(kt,this,new this.hot.constructor(o,{data:Re(fr,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,p)=>{u.title=p.instance.getDataAtRowProp(c,p.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Re(kt,this).listen()},colWidths:()=>Re(kt,this).container.scrollWidth-wn(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Re(kt,this).init(),this.hot.addHook("afterSetTheme",(u,c)=>{c||Re(kt,this).useTheme(u)});const l=Re(kt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:XI}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Re(kt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:XI})};r(n),this.hot._registerTimeout(()=>r(n),100)}focus(){this.isBuilt()&&Re(kt,this).listen()}reset(){Re(Ho,this).reset(),Re(bs,this).reset(),Re(Rs,this).reset()}update(){!this.isBuilt()||(Re(kt,this).loadData($ae(Re(fr,this),this.options.value)),super.update())}destroy(){var e;(e=Re(kt,this))===null||e===void 0||e.destroy(),Re(Ho,this).destroy(),Re(Rs,this).destroy(),Re(bs,this).destroy(),rr(Ho,this,null),rr(Rs,this,null),rr(bs,this,null),rr(kt,this,null),rr(fr,this,null),super.destroy()}}function Hae(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Re(fr,this)]:n=Re(fr,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Re(kt,this).loadData(n)}function Aae(t){this.runLocalHooks("keydown",t,this),W1(_d,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Ir(t),Re(kt,this).listen(),Re(kt,this).selectCell(0,0))}function Nae(t){const e=[];t.preventDefault(),Re(kt,this).getSourceData().forEach((n,i)=>{n.checked=!0,e.push(FH(n,i)[0])}),Re(kt,this).setSourceDataAtCell(e)}function Dae(t){const e=[];t.preventDefault(),Re(kt,this).getSourceData().forEach((n,i)=>{n.checked=!1,e.push(FH(n,i)[0])}),Re(kt,this).setSourceDataAtCell(e)}function $ae(t,e){const n=Vd(e);return t.map(i=>(i.checked=n(i.value),i))}function Lae(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function kae(t,e){Fae(t,e),e.add(t)}function Fae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vae(t,e,n){return(e=Wae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wae(t){var e=Bae(t,"string");return typeof e=="symbol"?e:e+""}function Bae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ih=new WeakSet;class jae extends Fd{constructor(e,n){super(e,{id:n.id,stateless:!1}),kae(this,ih),Vae(this,"name",""),this.name=n.name,this.elements.push(new cd(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>rg(ih,this,Uae).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>rg(ih,this,zae).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===tl){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?pn:tl},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(i,r,o,s,a)=>{const[l]=sl(r,h=>h.name===tl),u={},c=this.hot.getTranslatedPhrase(Om);if(l){const h=s(i,a),d=We(h,T=>T.value),f=new Map(h.map(T=>[T.value,this.hot.getCellMeta(T.meta.visualRow,T.meta.visualCol)])),p=eS(d);o&&(l.args[0]=o);const S=[],y=FI(p,l.args[0],c,T=>{T.checked&&S.push(T.value),rg(ih,this,qI).call(this,T,f)}),R=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,R).locale,u.args=[S],u.command=el(tl),u.itemsSnapshot=y}else u.args=[],u.command=el(pn);this.state.setValueAtIndex(i,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof cd)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,o,s)=>{U(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return U(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||M(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Om),n=this._getColumnVisibleValues(),i=n.map(l=>l.value),r=new Map(n.map(l=>[l.value,l.meta])),o=eS(i),s=FI(o,o,e,l=>{rg(ih,this,qI).call(this,l,r)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:We(this.hot.getDataAtCol(e.visualIndex),(n,i)=>({value:Y0(n),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function Uae(t){_d(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ir(t))}function qI(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function zae(t,e){switch(e.type){case"numeric":return $A(t,e);default:return t}}var zN;function Yae(t,e){Gae(t,e),e.add(t)}function Gae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kae(t,e,n){return(e=Xae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xae(t){var e=qae(t,"string");return typeof e=="symbol"?e:e+""}function qae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zae(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ZI=new WeakSet;class hd extends Fd{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Yae(this,ZI),Kae(this,"name",""),this.name=n.name,this.elements.push(new qs(this.hot,{type:"button",value:s0,className:"htUIButton htUIButtonOK",identifier:hd.BUTTON_OK})),this.elements.push(new qs(this.hot,{type:"button",value:a0,className:"htUIButton htUIButtonCancel",identifier:hd.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){M(this.elements,e=>{e.addLocalHook("click",(n,i)=>Zae(ZI,this,Qae).call(this,n,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(U(n.parentNode,"htFiltersMenuActionBar"),M(this.elements,i=>n.appendChild(i.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}zN=hd;function Qae(t,e){e.options.identifier===zN.BUTTON_OK?this.accept():this.cancel()}function mC(t,e,n){return(e=Jae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jae(t){var e=ele(t,"string");return typeof e=="symbol"?e:e+""}function ele(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const QI="ConditionCollection.filteringStates";class YN{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;mC(this,"hot",void 0),mC(this,"isMapRegistrable",void 0),mC(this,"filteringStates",new Lp),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(QI,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var i;const r=this.filteringStates.getValueAtIndex(n),o=(i=r==null?void 0:r.conditions)!==null&&i!==void 0?i:[],s=r==null?void 0:r.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Xs;return e.length?Yse(i)(e,n):!0}addCondition(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Xs,r=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==i)throw Error(tt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Tt(ad[i]))throw new Error(tt`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:a,args:s,func:Zs(a,s)}]},r):u.push({name:a,args:s,func:Zs(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[i,{operation:r,conditions:o}]=n;return e.push({column:i,operation:r,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(i=>this.addCondition(n.column,i))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const i=this.getConditions(e);return n?i.some(r=>r.name===n):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(QI),this.filteringStates=null,this.clearLocalHooks()}}lt(YN,Nn);var GN=YN;function JI(t,e,n){return(e=tle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tle(t){var e=nle(t,"string");return typeof e=="symbol"?e:e+""}function nle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ile{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];JI(this,"conditionCollection",void 0),JI(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return M(this.conditionCollection.getFilteredColumns(),(n,i)=>{let r=this.columnDataFactory(n);i&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(n,r)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return M(n,r=>{r!==void 0&&this.conditionCollection.isMatch(r,e)&&i.push(r)}),i}_getIntersectData(e,n){const i=[];return M(n,r=>{const o=r.meta.visualRow;e[o]!==void 0&&(i[o]=e[o])}),i}}var KN=ile;function rle(t,e){ole(t,e),e.add(t)}function ole(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _a(t,e,n){return(e=sle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sle(t){var e=ale(t,"string");return typeof e=="symbol"?e:e+""}function ale(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var og=new WeakSet;class XN{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];rle(this,og),_a(this,"hot",void 0),_a(this,"conditionCollection",void 0),_a(this,"columnDataFactory",void 0),_a(this,"changes",[]),_a(this,"grouping",!1),_a(this,"latestEditedColumnPosition",-1),_a(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",r=>pC(og,this,lle).call(this,r)),this.conditionCollection.addLocalHook("afterRemove",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("afterAdd",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("beforeClean",()=>pC(og,this,ule).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>pC(og,this,cle).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,M(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const r=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=r.slice(0,o),a=r.slice(o);a.length&&a[0].column===e&&a.shift();const l=v3(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new GN(i.hot,!1),p=[].concat(c,d);f.importAllConditions(p);const S=i.columnDataFactory(h);let y;f.isEmpty()?y=S:y=new KN(f,T=>i.columnDataFactory(T)).filter(),y=We(y,T=>T.meta.visualRow);const R=Vd(y);return f.destroy(),sl(S,T=>R(T.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ae(this,(e,n)=>{this[n]=null})}}function lle(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function ule(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function cle(){M(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}lt(XN,Nn);var hle=XN;function dle(t){return pN({initialPage:0,size:()=>t.length,onItemSelect:(n,i)=>{const r=t[n];if(r instanceof cd)return i;if(r.element&&!Vu(r.element))return!1;r.focus()}})}const rh="filters";function fle(t,e){let n=-1,i;const r=dle(e),o=h=>()=>{i.isOpened()&&i.getKeyboardShortcutsCtrl().listen(rh),r.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof _i&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=i.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();r.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(rh),callback:()=>{h.isSubMenu()&&h.close(),d.listen(rh)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:p=>{const S=i.getNavigator();S.getCurrentPage()>-1&&(n=S.getCurrentPage()),S.clear(),p.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{i.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:p=>{const S=e[r.getCurrentPage()];S instanceof ld&&(S.openOptions(),p.preventDefault()),S instanceof ud&&(S.activate(),p.preventDefault()),S instanceof _i||p.preventDefault()}}],rh)}function a(){i.focus(),i.getKeyboardShortcutsCtrl().listen(rh)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||r.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),i=h}function u(){return i}function c(){return n}return Cn(Me({},r),{listen:a,setMenu:l,getMenu:u,getLastMenuPage:c})}function gle(t,e){qN(t,e),e.add(t)}function wC(t,e,n){qN(t,e),e.set(t,n)}function qN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oh(t,e,n){return(e=mle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mle(t){var e=ple(t,"string");return typeof e=="symbol"?e:e+""}function ple(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nS(t,e,n){return t.set(ri(t,e),n),n}function Wi(t,e){return t.get(ri(t,e))}function ri(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const iS="filters",wle=250,eP=iS;var ko=new WeakMap,rS=new WeakMap,_u=new WeakMap,fi=new WeakSet;class vle extends Xe{static get PLUGIN_KEY(){return iS}static get PLUGIN_PRIORITY(){return wle}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,gle(this,fi),oh(this,"dropdownMenuPlugin",null),oh(this,"conditionCollection",null),oh(this,"conditionUpdateObserver",null),oh(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),oh(this,"filtersRowsMap",null),wC(this,ko,void 0),wC(this,rS,new WeakSet),wC(this,_u,[]),this.hot.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return ri(fi,n,Tle).call(n,...r)})}isEnabled(){return!!this.hot.getSettings()[iS]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Od),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,i=n&&n.uiContainer||this.hot.rootDocument.body,r=a=>(a.addLocalHook("accept",()=>ri(fi,this,tP).call(this,"accept")),a.addLocalHook("cancel",()=>ri(fi,this,tP).call(this,"cancel")),a.addLocalHook("change",l=>ri(fi,this,Ele).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(t0)}:`,s=()=>`${this.hot.getTranslatedPhrase(n0)}:`;if(!this.components.get("filter_by_condition")){const a=new tS(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:i});a.addLocalHook("afterClose",()=>ri(fi,this,nP).call(this)),this.components.set("filter_by_condition",r(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Mae(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new tS(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});a.addLocalHook("afterClose",()=>ri(fi,this,nP).call(this)),this.components.set("filter_by_condition2",r(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new jae(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new hd(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new GN(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new hle(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>ri(fi,this,Mle).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return ri(fi,e,Rle).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>ri(fi,this,ble).call(this)),this.addHook("afterDropdownMenuShow",()=>ri(fi,this,yle).call(this)),this.addHook("afterDropdownMenuHide",()=>ri(fi,this,Sle).call(this)),this.addHook("afterChange",a=>ri(fi,this,Cle).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Wi(ko,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=Wi(ko,this).getMenu(),c=u.getNavigator(),h=Wi(ko,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];nS(ko,this,fle(this.dropdownMenuPlugin.menu,a));const l=u=>{Wi(ko,this).listen(),u.preventDefault(),_d(u.keyCode,"TAB")&&(u.shiftKey?Wi(ko,this).toPreviousItem():Wi(ko,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,i)=>{n.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:eP})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(eP)}addCondition(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Xs;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:i},r)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let r=[];const o=this.exportConditions();if(this.hot.runHooks("beforeFilter",o,Wi(_u,this))!==!1){if(i){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=We(n.filter(),u=>u.meta.visualRow);const l=Vd(r);ce(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),M(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!r.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();nS(_u,this,this.exportConditions()),this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render()}else this.importConditions(Wi(_u,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),i=[];return M(this.hot.getSourceDataAtCol(n),(r,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:p}=this.hot.getCellMeta(o,n),S=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:r;i.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:p},value:Y0(S)})}),i}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),i=eS(n);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var n;const i=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(r=>{r.isHidden()||r.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,i,r){let o=e;return o===Um&&n.command.key!==pn&&i.command.key!==pn&&r.command.key!==pn?o=K0:r.command.key!==pn&&(n.command.key===pn||i.command.key===pn)&&(o=Xs),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new KN(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return M(r,s=>{M(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,r=i.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?r.showRows(l):r.hideRows(l),i.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Cle(t){t&&M(t,e=>{const[,n]=e,i=this.hot.propToCol(n);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function yle(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function Sle(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function ble(){const t=this.dropdownMenuPlugin.menu;Wi(rS,this).has(t)||Wi(ko,this).setMenu(t),Wi(rS,this).add(t)}function Rle(t){t.items.push({name:xe}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function tP(t){var e;if(t==="accept"){const i=this.getSelectedColumn();if(i===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:r}=i,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(r);u===-1&&(u=void 0),this.conditionCollection.removeConditions(r),o.command.key!==pn&&(this.conditionCollection.addCondition(r,o,l,u),s.command.key!==pn&&this.conditionCollection.addCondition(r,s,l,u)),a.command.key!==pn&&this.conditionCollection.addCondition(r,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(r)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Ele(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===tS&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function nP(){this.setListeningDropdownMenu()}function Tle(t,e,n){const i=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(i)&&n===this.hot.view.getColumnHeadersCount()-1?U(e,"htFiltersActive"):ge(e,"htFiltersActive")}function Mle(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:i},conditionArgsChange:r}=t;Array.isArray(r)&&nS(_u,this,Wi(_u,this).map(a=>(a.column===i&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...r]])}),a)));const o=n.filter(a=>a.name===tl),s=n.filter(a=>a.name!==tl);if(o.length>=2||s.length>=3)qe(tt`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(s[0],i),this.components.get("filter_by_condition2").updateState(s[1],i),this.components.get("filter_operators").updateState(a,i),this.components.get("filter_by_value").updateState(t)}}const ZN="internal-use-in-handsontable",oS={licenseKey:ZN,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function QN(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[On])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function JN(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function _le(t){var e;const n=t[On],i=JN(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=QN(t);return Me(Me(Me({},oS),i),r)}function Ile(t){var e;const n=t[On],i=JN(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=QN(t);return Me(Me({},i),r)}function Ple(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function iw(){const t="engine_relationship",e=Pr(On);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function q0(){const t="shared_engine_usage",e=Pr(On);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Ole(t){const e=t.getSettings(),n=e[On],i=n==null?void 0:n.engine;if(n===!0||Tt(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var r;return xle((r=i.hyperformula)!==null&&r!==void 0?r:i,e,t)}else if(typeof i=="object"&&Tt(i.hyperformula)){const o=iw(),s=q0().get(i);return o.has(i)||o.set(i,[]),o.get(i).push(t),s&&s.push(t.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:ZN}),(i.getConfig().leapYear1900!==oS.leapYear1900||gb(i.getConfig().nullDate,oS.nullDate)===!1)&&qe(tt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function xle(t,e,n){const i=e[On],r=_le(e),o=iw(),s=q0();Hle(t,i.functions),Ale(t,i.language);const a=t.buildEmpty(r);return o.set(a,[n]),s.set(a,[n.guid]),Nle(a,i.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function iP(t){var e;const n=iw(),i=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(i.map(r=>[r.getPlugin("formulas").sheetId,r]))}function rP(t,e){if(t){const n=iw(),i=n.get(t),r=q0(),o=r.get(t);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(r.delete(t),t.destroy()))}}function Hle(t,e){e&&e.forEach(n=>{const{name:i,plugin:r,translations:o}=n;try{t.registerFunction(i,r,o)}catch(s){qe(s.message)}})}function Ale(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(i){qe(i.message)}}}function Nle(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:i,expression:r,scope:o,options:s}=n;try{t.addNamedExpression(i,r,o,s)}catch(a){qe(a.message)}}),t.resumeEvaluation())}function Dle(t,e){return(Tt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const eD="DD/MM/YYYY";function tD(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function $le(t){return tD(t)?t.substr(1):t}function Lle(t){return typeof t=="string"&&t.startsWith("=")}function Z0(t,e){return typeof t=="string"&&e==="date"}function nD(t,e){return X(t,e,!0).isValid()}function iD(t,e){return X(t,e,!0).format(eD)}function kle(t,e){return X(t,eD,!0).format(e)}function rD(t,e){const i=new Date(Date.UTC(0,0,t+-1));return X(i).format(e)}function Fle(t,e,n){const i=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var r;return(r=i[e])!==null&&r!==void 0?r:0}return i[e-1]+1}function Vle(t,e){const n=[];return t.forEach(i=>{const r={from:i,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=r.from;o.from>r.from&&a&&s&&(r.from+=1)}),r.from>=e&&(e+=1),n.push(r)}),n}function Wle(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(r=>{const o=r.from<r.to;r.from>e.from&&o&&(r.from-=1)})}),t}function Q0(t,e,n){const i=Vle(t,Fle(t,e,n));return Wle(i)}function Ia(t,e,n){Ble(t,e),e.set(t,n)}function Ble(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wt(t,e){return t.get(oD(t,e))}function Es(t,e,n){return t.set(oD(t,e),n),n}function oD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sh=new WeakMap,Ts=new WeakMap,gi=new WeakMap,sg=new WeakMap,vC=new WeakMap,CC=new WeakMap,ag=new WeakMap;class jle{constructor(e,n,i){Ia(this,sh,void 0),Ia(this,Ts,void 0),Ia(this,gi,void 0),Ia(this,sg,[]),Ia(this,vC,[]),Ia(this,CC,void 0),Ia(this,ag,[]),Es(sh,this,e),Es(Ts,this,n),Es(gi,this,i)}setRemovedHfIndexes(e){return Es(ag,this,e.map(n=>{const i=wt(Ts,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(i)})),wt(ag,this)}getRemovedHfIndexes(){return wt(ag,this)}getHfIndexFromVisualIndex(e){const n=wt(Ts,this).getIndexesSequence(),i=wt(Ts,this).getNotTrimmedIndexes();return n.indexOf(i[e])}syncMoves(e){const i=`move${Rr(wt(sh,this))}s`;wt(gi,this).getEngine().batch(()=>{e.forEach(r=>{const o=r.from!==r.to,s=r.from+1!==r.to;o&&s&&wt(gi,this).getEngine()[i](wt(gi,this).getSheetId(),r.from,1,r.to)})})}storeMovesInformation(e,n,i){i!==!1&&(Es(vC,this,e.map(r=>this.getHfIndexFromVisualIndex(r))),Es(CC,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(wt(gi,this).isPerformingUndoRedo()||e===!1||n===!1)return;const i=Q0(wt(vC,this),wt(CC,this),wt(Ts,this).getNumberOfIndexes());wt(gi,this).getSheetId()===null?wt(gi,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${Rr(wt(sh,this))}Order`;return n=>{if(wt(gi,this).isPerformingUndoRedo())return;const i=wt(Ts,this).getIndexesSequence();if(n==="update"&&i.length>0){const r=wt(sg,this).map(l=>i.indexOf(l)),o=wt(gi,this).getEngine().getSheetDimensions(wt(gi,this).getSheetId());let s;wt(sh,this)==="row"?s=o.height:s=o.width;const a=r.length;for(let l=a;l<s;l+=1)r.push(l);wt(gi,this).getEngine()[e](wt(gi,this).getSheetId(),r)}Es(sg,this,i)}}init(){Es(sg,this,wt(Ts,this).getIndexesSequence())}}var oP=jle;function Pa(t,e,n){Ule(t,e),e.set(t,n)}function Ule(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ao(t,e){return t.get(sD(t,e))}function Oa(t,e,n){return t.set(sD(t,e),n),n}function sD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lg=new WeakMap,ug=new WeakMap,yC=new WeakMap,SC=new WeakMap,bC=new WeakMap,RC=new WeakMap,EC=new WeakMap;class zle{constructor(e,n,i){Pa(this,lg,void 0),Pa(this,ug,void 0),Pa(this,yC,void 0),Pa(this,SC,!1),Pa(this,bC,!1),Pa(this,RC,null),Pa(this,EC,null),Oa(lg,this,new oP("row",e,this)),Oa(ug,this,new oP("column",n,this)),Oa(yC,this,i)}getForAxis(e){return e==="row"?Ao(lg,this):Ao(ug,this)}setPerformUndo(e){Oa(SC,this,e)}setPerformRedo(e){Oa(bC,this,e)}isPerformingUndoRedo(){return Ao(SC,this)||Ao(bC,this)}getSheetId(){return Ao(EC,this)}getEngine(){return Ao(RC,this)}getPostponeAction(){return Ao(yC,this)}setupSyncEndpoint(e,n){Oa(RC,this,e),Oa(EC,this,n),Ao(lg,this).init(),Ao(ug,this).init()}}var Yle=zle;function Gle(t,e){aD(t,e),e.add(t)}function iu(t,e,n){return(e=Kle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kle(t){var e=Xle(t,"string");return typeof e=="symbol"?e:e+""}function Xle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TC(t,e,n){aD(t,e),e.set(t,n)}function aD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qs(t,e,n){return t.set(at(t,e),n),n}function $u(t,e){return t.get(at(t,e))}function at(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const On="formulas",qle=["maxRows","maxColumns","language"],Zle=260;ee.getSingleton().register("afterNamedExpressionAdded");ee.getSingleton().register("afterNamedExpressionRemoved");ee.getSingleton().register("afterSheetAdded");ee.getSingleton().register("afterSheetRemoved");ee.getSingleton().register("afterSheetRenamed");ee.getSingleton().register("afterFormulasValuesUpdate");const ac=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var as=new WeakMap,J0=new WeakMap,ah=new WeakMap,ut=new WeakSet;class Qle extends Xe{constructor(){var e;super(...arguments),e=this,Gle(this,ut),TC(this,as,!1),TC(this,J0,!1),TC(this,ah,[["valuesUpdated",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return at(ut,e,gue).call(e,...i)}],["namedExpressionAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return at(ut,e,mue).call(e,...i)}],["namedExpressionRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return at(ut,e,pue).call(e,...i)}],["sheetAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return at(ut,e,wue).call(e,...i)}],["sheetRenamed",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return at(ut,e,vue).call(e,...i)}],["sheetRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return at(ut,e,Cue).call(e,...i)}]]),iu(this,"staticRegister",Pr("formulas")),iu(this,"engine",null),iu(this,"sheetName",null),iu(this,"indexSyncer",null),iu(this,"rowAxisSyncer",null),iu(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return On}static get PLUGIN_PRIORITY(){return Zle}static get SETTING_KEYS(){return[On,...qle]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[On]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Ole(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){qe("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&(this.sheetName=i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,sP).call(n,...r)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,aP).call(n,...r)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,sP).call(n,...r)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,aP).call(n,...r)}),this.addHook("modifyData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,nue).call(n,...r)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,iue).call(n,...r)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,Jle).call(n,...r)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,rue).call(n,...r)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,lP).call(n,...r)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,lP).call(n,...r)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,oue).call(n,...r)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,sue).call(n,...r)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,uue).call(n,...r)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,cue).call(n,...r)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,aue).call(n,...r)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,lue).call(n,...r)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,hue).call(n,...r)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,due).call(n,...r)}),this.indexSyncer=new Yle(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,r,o,s)=>{this.rowAxisSyncer.storeMovesInformation(i,r,s)}),this.hot.addHook("beforeColumnMove",(i,r,o,s)=>{this.columnAxisSyncer.storeMovesInformation(i,r,s)}),this.hot.addHook("afterRowMove",(i,r,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(i,r,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,r)}),this.hot.addHook("afterColumnFreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.hot.addHook("beforeColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,r)}),this.hot.addHook("afterColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,tue).call(n,...r)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,fue).call(n,...r)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return at(ut,n,eue).call(n,...r)}),$u(ah,this).forEach(i=>{let[r,o]=i;return this.engine.on(r,o)}),super.enablePlugin()}}disablePlugin(){$u(ah,this).forEach(e=>{let[n,i]=e;return this.engine.off(n,i)}),rP(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Ile(this.hot.getSettings());Ple(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const i=this.hot.getSettings()[On];if(re(i)&&re(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const r=this.hot.getSettings()[On].sheetName;r&&this.engine.doesSheetExist(r)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(r!=null?r:void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){$u(ah,this).forEach(e=>{var n;let[i,r]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(i,r)}),Qs(ah,this,null),rP(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(re(n)&&!L5(n))return qe("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return qe("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e!=null?e:void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(i),n),i}catch(i){return qe(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){wb(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Rr(On)}.switchSheet`)}getCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const r=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return r!==null&&o!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(r=>{var o;const s=r==null||(o=r.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(i.has(s)||i.add(s))}),iP(this.engine).forEach((r,o)=>{if((n||o!==this.sheetId)&&i.has(o)){var s;r.render(),(s=r.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return re(u)?`${u}:${a}x${l}`:""},r=new Set(n.map(o=>i(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(re(l)===!1||re(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=i(o);if(c!==void 0&&!r.has(h)){const d=iP(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,i){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r)){qe(`Not possible to set cell data at ${JSON.stringify(r)}`);return}const o=this.hot.getCellMeta(e,n);return Z0(i,o.type)&&(nD(i,o.dateFormat)?i=iD(i,o.dateFormat):Lle(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(r,i)}}function Jle(t,e,n){const i=this.hot.propToCol(n);if(this.isFormulaCellType(e,i)){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},o=this.hot.getCellMeta(e,i);let s=this.engine.getCellValue(r);return o.type==="date"&&Yn(s)&&(s=rD(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function eue(t,e,n){const{row:i,col:r}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:p,col:S}=h.start,{row:y,col:R}=h.end,T=y-p+1,V=R-S+1;for(let B=0;B<f.length;B+=1)for(let W=0;W<f[B].length;W+=1){const $=f[B][W],L=p+B%T,z=S+W%V,ie=this.hot.getCellMeta(L,z);Z0($,ie.type)&&($.startsWith("'")?f[B][W]=$.slice(1):this.isFormulaCellType(L,z,this.sheetId)===!1&&(f[B][W]=kle($,ie.dateFormat)))}return f}function sP(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Rr(On))||Qs(J0,this,Tt(this.hot.getSettings().data))}function tue(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,i)=>{n.forEach((r,o)=>{const s=this.hot.getCellMeta(i,o),a=s.dateFormat;Z0(r,s.type)&&(e=!0,nD(r,a)?t[i][o]=iD(r,a):this.isFormulaCellType(i,o)===!1&&(t[i][o]=`'${r}`))})}),e===!0&&(Qs(as,this,!0),this.engine.setSheetContent(this.sheetId,t),Qs(as,this,!1))}function aP(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Rr(On)))if(this.sheetName=Dle(this.engine,this.hot.getSettings()[On].sheetName),$u(J0,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Qs(as,this,!0);const r=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(r),Qs(as,this,!1)}}}function nue(t,e,n,i){if(i!=="get"||$u(as,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t);if(r===null||e===null)return;if(!this.isFormulaCellType(r,e)&&this.getCellType(r,e)!=="ARRAY"){tD(n.value)&&(n.value=$le(n.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s),l=this.hot.getCellsMeta().find(c=>c.visualRow===r&&c.visualCol===e);l===void 0&&(l={}),l.type==="date"&&Yn(a)&&(a=rD(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function iue(t,e,n,i){if(i!=="get"||$u(as,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(r===null||o===null||!this.isFormulaCellType(r,o)&&this.getCellType(r,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function lP(t,e){if(ac(e))return;const n=[],i=[],r=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),i.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}function rue(t,e){if(ac(e))return;const n=[],i=[];t.forEach(r=>{let[o,s,,a]=r;const l=this.hot.propToCol(s);if(!Yn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){qe(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}i.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,i)}function oue(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function sue(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function aue(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function lue(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function uue(t,e,n){if(ac(n))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function cue(t,e,n){if(ac(n))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function hue(t,e,n,i){if(ac(i))return;const r=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{r.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function due(t,e,n,i){if(ac(i))return;const r=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{r.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function fue(t,e,n){var i;Qs(as,this,!0);const r=this.hot.getSourceDataArray(n,0,n+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());Qs(as,this,!1),r.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function gue(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function mue(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function pue(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function wue(t){this.hot.runHooks("afterSheetAdded",t)}function vue(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function Cue(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function yue(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(HR,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.col,n.col),0),r=Math.max(e.col,n.col),o=[];for(let l=i;l<=r;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Sue(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(AR,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],o=e[e.length-1];r=(n=this.columnIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,o=(i=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-r+1===this.countCols()||this.selectColumns(r,o)},disabled:!1,hidden(){const n=We(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),r=i.getTopStartCorner().col,o=i.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(r),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(r!==o){const h=o-r+1,d=l-a+1;if(h>d){const f=u.slice(r,o+1);c.push(...f.filter(p=>n.includes(p)))}}else if(a===0&&a<r)c.push(...u.slice(0,r));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return M(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function bue(t,e){lD(t,e),e.add(t)}function Rue(t,e,n){lD(t,e),e.set(t,n)}function lD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xa(t,e){return t.get(Hs(t,e))}function uP(t,e,n){return t.set(Hs(t,e),n),n}function Hs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ee.getSingleton().register("beforeHideColumns");ee.getSingleton().register("afterHideColumns");ee.getSingleton().register("beforeUnhideColumns");ee.getSingleton().register("afterUnhideColumns");const cP="hiddenColumns",Eue=310;var Br=new WeakMap,Ha=new WeakSet;class Tue extends Xe{constructor(){super(...arguments),bue(this,Ha),Rue(this,Br,null)}static get PLUGIN_KEY(){return cP}static get PLUGIN_PRIORITY(){return Eue}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[cP]}enablePlugin(){var e=this;this.enabled||(uP(Br,this,new $p),xa(Br,this).addLocalHook("init",()=>Hs(Ha,this,xue).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,xa(Br,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Hs(Ha,e,Oue).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>Hs(Ha,this,_ue).call(this,n,i,r)),this.addHook("modifyColWidth",(n,i)=>Hs(Ha,this,Mue).call(this,n,i),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Hs(Ha,e,Pue).call(e,...i)}),this.addHook("modifyCopyableRange",n=>Hs(Ha,this,Iue).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;const o=xa(Br,this).getValues().slice(),s=e.length>0;if(i&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));M(l,u=>{o[u]=!1}),r=di(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,r,i&&s)!==!1&&(i&&s&&xa(Br,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,r,i&&s,i&&r.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{M(e,s=>{xa(Br,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,r,i,i&&r.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideColumns(n)}getHiddenColumns(){return We(xa(Br,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return xa(Br,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){M(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){uP(Br,this,null),super.destroy()}}function Mue(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function _ue(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenColumn");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function Iue(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,o,s)=>{e.push({startRow:i,endRow:r,startCol:o,endCol:s})};return M(t,i=>{let r=!0,o=0;ce(i.startCol,i.endCol,s=>{this.isHidden(s)?(r||n(i.startRow,i.endRow,o,s-1),r=!0):(r&&(o=s),s===i.endCol&&n(i.startRow,i.endRow,o,s),r=!1)})}),e}function Pue(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),U(e,n)}function Oue(t){t.items.push({name:xe},yue(this),Sue(this))}function xue(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Hue(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(NR,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.row,n.row),0),r=Math.max(e.row,n.row),o=[];for(let l=i;l<=r;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Aue(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(DR,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],o=e[e.length-1];r=(n=this.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,o=(i=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-r+1===this.countRows()||this.selectRows(r,o)},disabled:!1,hidden(){const n=We(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),r=i.getTopStartCorner().row,o=i.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(r),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(r!==o){const h=o-r+1,d=l-a+1;if(h>d){const f=u.slice(r,o+1);c.push(...f.filter(p=>n.includes(p)))}}else if(a===0&&a<r)c.push(...u.slice(0,r));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return M(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Nue(t,e){uD(t,e),e.add(t)}function Due(t,e,n){uD(t,e),e.set(t,n)}function uD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Aa(t,e){return t.get(As(t,e))}function hP(t,e,n){return t.set(As(t,e),n),n}function As(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ee.getSingleton().register("beforeHideRows");ee.getSingleton().register("afterHideRows");ee.getSingleton().register("beforeUnhideRows");ee.getSingleton().register("afterUnhideRows");const dP="hiddenRows",$ue=320;var jr=new WeakMap,Na=new WeakSet;class Lue extends Xe{constructor(){super(...arguments),Nue(this,Na),Due(this,jr,null)}static get PLUGIN_KEY(){return dP}static get PLUGIN_PRIORITY(){return $ue}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[dP]}enablePlugin(){var e=this;this.enabled||(hP(jr,this,new $p),Aa(jr,this).addLocalHook("init",()=>As(Na,this,jue).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Aa(jr,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return As(Na,e,Bue).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>As(Na,this,Fue).call(this,n,i,r)),this.addHook("modifyRowHeight",(n,i)=>As(Na,this,kue).call(this,n,i)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return As(Na,e,Wue).call(e,...i)}),this.addHook("modifyCopyableRange",n=>As(Na,this,Vue).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;const o=Aa(jr,this).getValues().slice(),s=e.length>0;if(i&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));M(l,u=>{o[u]=!1}),r=di(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,r,i&&s)!==!1&&(i&&s&&Aa(jr,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,r,i&&s,i&&r.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{M(e,s=>{Aa(jr,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,r,i,i&&r.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideRows(n)}getHiddenRows(){return We(Aa(jr,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Aa(jr,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){M(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){hP(jr,this,null),super.destroy()}}function kue(t,e){return this.isHidden(e)?0:t}function Fue(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenRow");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function Vue(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,o,s)=>{e.push({startRow:i,endRow:r,startCol:o,endCol:s})};return M(t,i=>{let r=!0,o=0;ce(i.startRow,i.endRow,s=>{this.isHidden(s)?(r||n(o,s-1,i.startCol,i.endCol),r=!0):(r&&(o=s),s===i.endRow&&n(o,s,i.startCol,i.endCol),r=!1)})}),e}function Wue(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),U(e,n)}function Bue(t){t.items.push({name:xe},Hue(this),Aue(this))}function jue(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function Uue(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(lR)},callback(e,n){const[{start:{col:i}}]=n;t.freezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function zue(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(uR)},callback(e,n){const[{start:{col:i}}]=n;t.unfreezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Yue(t,e){cD(t,e),e.add(t)}function Gue(t,e,n){cD(t,e),e.set(t,n)}function cD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sS(t,e){return t.get(Ym(t,e))}function MC(t,e,n){return t.set(Ym(t,e),n),n}function Ym(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ee.getSingleton().register("beforeColumnFreeze");ee.getSingleton().register("afterColumnFreeze");ee.getSingleton().register("beforeColumnUnfreeze");ee.getSingleton().register("afterColumnUnfreeze");const fP="manualColumnFreeze",Kue=110;var Ga=new WeakMap,_C=new WeakSet;class Xue extends Xe{constructor(){super(...arguments),Yue(this,_C),Gue(this,Ga,!1)}static get PLUGIN_KEY(){return fP}static get PLUGIN_PRIORITY(){return Kue}isEnabled(){return!!this.hot.getSettings()[fP]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Ym(_C,this,que).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Ym(_C,this,Zue).call(this,e,n)),super.enablePlugin())}disablePlugin(){MC(Ga,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;sS(Ga,this)||MC(Ga,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;sS(Ga,this)||MC(Ga,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function que(t){t.items.push({name:"---------"},Uue(this),zue(this))}function Zue(t,e){if(sS(Ga,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(i=>i<n))return!1}}function cg(t,e,n){return(e=Que(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Que(t){var e=Jue(t,"string");return typeof e=="symbol"?e:e+""}function Jue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const IC=0,gP=1,mP=2,ru="px";class ece{constructor(e){cg(this,"hot",void 0),cg(this,"_element",null),cg(this,"state",IC),cg(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=mP}build(){this.state===IC&&(this._element=this.hot.rootDocument.createElement("div"),this.state=gP)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=IC}isAppended(){return this.state===mP}isBuilt(){return this.state>=gP}setPosition(e,n){Yn(e)&&(this._element.style.top=e+ru),Yn(n)&&(this._element.style[this.inlineProperty]=n+ru)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Yn(e)&&(this._element.style.width=e+ru),Yn(n)&&(this._element.style.height=n+ru)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Yn(e)&&(this._element.style.marginTop=e+ru),Yn(n)&&(this._element.style[`margin${Rr(this.inlineProperty)}`]=n+ru)}getOffset(){const e=this._element.style,n=`margin${Rr(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}}var hD=ece;const tce="ht__manualColumnMove--backlight";class nce extends hD{build(){super.build(),U(this._element,tce)}}var ice=nce;const rce="ht__manualColumnMove--guideline";class oce extends hD{build(){super.build(),U(this._element,rce)}}var sce=oce;function ace(t,e){dD(t,e),e.add(t)}function or(t,e,n){dD(t,e),e.set(t,n)}function dD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ui(t,e,n){return t.set(Ns(t,e),n),n}function le(t,e){return t.get(Ns(t,e))}function Ns(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ee.getSingleton().register("beforeColumnMove");ee.getSingleton().register("afterColumnMove");const PC="manualColumnMove",lce=120,pP="ht__manualColumnMove",Gm="show-ui",aS="on-moving--columns",lS="after-selection--columns";var Un=new WeakMap,$s=new WeakMap,Qo=new WeakMap,am=new WeakMap,js=new WeakMap,jn=new WeakMap,hg=new WeakMap,Li=new WeakMap,Cu=new WeakMap,Km=new WeakMap,$h=new WeakMap,Da=new WeakSet;class uce extends Xe{constructor(){super(...arguments),ace(this,Da),or(this,Un,new ice(this.hot)),or(this,$s,new sce(this.hot)),or(this,Qo,[]),or(this,am,0),or(this,js,!1),or(this,jn,{}),or(this,hg,void 0),or(this,Li,void 0),or(this,Cu,void 0),or(this,Km,void 0),or(this,$h,void 0)}static get PLUGIN_KEY(){return PC}static get PLUGIN_PRIORITY(){return lce}isEnabled(){return!!this.hot.getSettings()[PC]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ns(Da,e,cce).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ns(Da,e,dce).call(e,...i)}),this.addHook("afterScrollVertically",()=>Ns(Da,this,gce).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ns(Da,e,mce).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),U(this.hot.rootElement,pP),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ge(this.hot.rootElement,pP),this.unregisterEvents(),le(Un,this).destroy(),le($s,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const i=le(hg,this),r=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,i,r);if(ui(hg,this,void 0),o===!1)return;r&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=r&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,i,r,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const i=this.countFinalIndex(e,n);return ui(hg,this,n),this.moveColumns(e,i)}isMovePossible(e,n){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=i);return!(r||o||s||a)}isColumnOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=di(e,(r,o)=>(o<n&&(r+=1),r),0);return n-i}getColumnsWidth(e,n){const i=this.hot.columnIndexMapper;let r=0;for(let o=e;o<=n;o+=1){const s=i.getRenderableFromVisualIndex(o);o<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(r+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[PC];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const i=[];return ce(e,n,r=>{i.push(r)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(le(Li,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,r=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,le(Li,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=le(Un,this).getOffset().start,u=le(Un,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const p=this.hot.rootWindow,S=Yt(this.hot.rootElement),y=p.innerWidth-le(Cu,this)-S;h=p.innerWidth-le(jn,this).eventPageX-y-(i.scrollX===void 0?r:0)}else h=le(jn,this).eventPageX-(le(Cu,this)-(i.scrollX===void 0?r:0));if(le(Km,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(le(Li,this))&&(o+=r),o+=c,le(Li,this)<0)le($h,this)>0?le(jn,this).col=0:le(jn,this).col=e>0?e-1:e;else if(le(jn,this).TD.offsetWidth/2+o<=h){const p=le(Li,this)>=le(am,this)?le(am,this)-1:le(Li,this);le(jn,this).col=p+1,o+=le(jn,this).TD.offsetWidth}else le(jn,this).col=le(Li,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:i.scrollX!==void 0&&le(Li,this)<le($h,this)&&(f-=le(Cu,this)<=i.scrollX?le(Cu,this):0),le(Un,this).setPosition(null,d),le($s,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ns(Da,this,hce).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ns(Da,this,fce).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){le(Un,this).build(),le($s,this).build()}destroy(){le(Un,this).destroy(),le($s,this).destroy(),super.destroy()}}function cce(t,e,n,i){const r=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=pe(t.target,"sortAction");if(!s||!o||le(js,this)||t.button!==0||a){ui(js,this,!1),le(Qo,this).length=0,ge(this.hot.rootElement,[aS,Gm]);return}const l=le($s,this).isBuilt()&&!le($s,this).isAppended(),u=le(Un,this).isBuilt()&&!le(Un,this).isAppended();l&&u&&(le($s,this).appendTo(r.hider),le(Un,this).appendTo(r.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){i.column=!0,ui(js,this,!0);const p=n.firstChild?G3(t,n.firstChild).x:t.offsetX;le(jn,this).eventPageX=t.pageX,ui(Li,this,e.col),le(jn,this).TD=n,le(jn,this).col=e.col,ui(Qo,this,this.prepareColumnsToMoving(d,f)),ui(Km,this,!!this.hot.getSettings().rowHeaders),ui(am,this,this.hot.countCols()),ui($h,this,this.hot.getSettings().fixedColumnsStart),ui(Cu,this,xn(this.hot.rootElement).left);const S=le(Km,this)?-1:0,y=r.holder.scrollTop+r.getColumnHeaderHeight(0)+1,R=e.col<le($h,this),T=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),V=Math.abs(p-(this.hot.isRtl()?n.offsetWidth:0)),B=this.getColumnsWidth(d,e.col-1)+V,W=this.getColumnsWidth(S,d-1)+(R?T:0)+B;le(Un,this).setPosition(y,W),le(Un,this).setSize(this.getColumnsWidth(d,f),r.hider.offsetHeight-y),le(Un,this).setOffset(null,-B),U(this.hot.rootElement,aS)}else ge(this.hot.rootElement,lS),ui(js,this,!1),le(Qo,this).length=0}function hce(t){!le(js,this)||(le(jn,this).eventPageX=t.pageX,this.refreshPositions())}function dce(t,e,n,i){!this.hot.getSelectedRangeLast()||!le(js,this)||(le(Qo,this).indexOf(e.col)>-1?ge(this.hot.rootElement,Gm):U(this.hot.rootElement,Gm),i.row=!0,i.column=!0,i.cell=!0,ui(Li,this,e.col),le(jn,this).TD=n)}function fce(){const t=le(jn,this).col,e=le(Qo,this).length;if(ui(Li,this,void 0),ui(js,this,!1),ge(this.hot.rootElement,[aS,Gm,lS]),this.hot.selection.isSelectedByColumnHeader()&&U(this.hot.rootElement,lS),e<1||t===void 0)return;const n=le(Qo,this)[0],i=this.hot.toPhysicalColumn(n),r=this.dragColumns(le(Qo,this),t);if(le(Qo,this).length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(i),s=o+e-1;this.hot.selectColumns(o,s)}}function gce(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,i=e+n;le(Un,this).setPosition(i),le(Un,this).setSize(null,t.hider.offsetHeight-i)}function mce(){this.moveBySettingsOrLoad()}function pce(t,e){fD(t,e),e.add(t)}function Tn(t,e,n){fD(t,e),e.set(t,n)}function fD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vt(t,e,n){return t.set(gr(t,e),n),n}function J(t,e){return t.get(gr(t,e))}function gr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Xm="manualColumnResize",wce=130,wP="manualColumnWidths";var jo=new WeakMap,dg=new WeakMap,bi=new WeakMap,qm=new WeakMap,ao=new WeakMap,vce=new WeakMap,Lu=new WeakMap,fg=new WeakMap,ii=new WeakMap,Fo=new WeakMap,fl=new WeakMap,Zm=new WeakMap,Lh=new WeakMap,kh=new WeakMap,Ei=new WeakMap,Fh=new WeakMap,Ur=new WeakSet;class Cce extends Xe{static get PLUGIN_KEY(){return Xm}static get PLUGIN_PRIORITY(){return wce}constructor(e){super(e),pce(this,Ur),Tn(this,jo,null),Tn(this,dg,null),Tn(this,bi,[]),Tn(this,qm,null),Tn(this,ao,null),Tn(this,vce,null),Tn(this,Lu,null),Tn(this,fg,null),Tn(this,ii,this.hot.rootDocument.createElement("DIV")),Tn(this,Fo,this.hot.rootDocument.createElement("DIV")),Tn(this,fl,null),Tn(this,Zm,!1),Tn(this,Lh,0),Tn(this,kh,null),Tn(this,Ei,void 0),Tn(this,Fh,void 0),U(J(ii,this),"manualColumnResizer"),U(J(Fo,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Xm]}enablePlugin(){var e=this;this.enabled||(Vt(Ei,this,new ta),J(Ei,this).addLocalHook("init",()=>gr(Ur,this,yce).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,J(Ei,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gr(Ur,e,Mce).call(e,...i)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gr(Ur,e,_ce).call(e,...i)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gr(Ur,e,Ice).call(e,...i)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Vt(Fh,this,J(Ei,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",wP,J(Ei,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",wP,e),e.value}setManualSize(e,n){const i=Math.max(n,20),r=this.hot.toPhysicalColumn(e);return J(Ei,this).setValueAtIndex(r,i),i}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);J(Ei,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Vt(jo,this,e);const{_wt:n}=this.hot.view,i=n.wtTable.getCoords(J(jo,this)),r=i.col;if(r<0)return;const o=tn(J(jo,this)),s=J(jo,this).getBoundingClientRect(),a=r<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(J(jo,this),i.row,i.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(J(jo,this),i.row,i.col)),Vt(dg,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)),Vt(bi,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();M(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;ce(d,f,p=>{J(bi,this).includes(p)||J(bi,this).push(p)})})}J(bi,this).includes(J(dg,this))||Vt(bi,this,[J(dg,this)]),Vt(fg,this,l.start-6),Vt(Lu,this,parseInt(s.width,10)),J(ii,this).style.top=`${l.top}px`,J(ii,this).style[this.inlineDir]=`${J(fg,this)+J(Lu,this)}px`,J(ii,this).style.height=`${o}px`,this.hot.rootElement.appendChild(J(ii,this))}refreshHandlePosition(){J(ii,this).style[this.inlineDir]=`${J(fg,this)+J(qm,this)}px`}setupGuidePosition(){const e=parseInt(tn(J(ii,this)),10),n=parseInt(J(ii,this).style.top,10)+e,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);U(J(ii,this),"active"),U(J(Fo,this),"active"),J(Fo,this).style.top=`${n}px`,this.refreshGuidePosition(),J(Fo,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(J(Fo,this))}refreshGuidePosition(){J(Fo,this).style[this.inlineDir]=J(ii,this).style[this.inlineDir]}hideHandleAndGuide(){ge(J(ii,this),"active"),ge(J(Fo,this),"active")}checkIfColumnHeader(e){const n=al(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},n=(i,r)=>{const o=this.hot.runHooks("beforeColumnResize",J(ao,this),i,!0);o!==void 0&&Vt(ao,this,o),this.setManualSize(i,J(ao,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",J(ao,this),i,!0),r&&e()};J(Lh,this)>=2&&(J(bi,this).length>1?(M(J(bi,this),r=>{n(r)}),e()):M(J(bi,this),r=>{n(r,!0)})),Vt(Lh,this,0),Vt(kh,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",i=>gr(Ur,this,Sce).call(this,i)),this.eventManager.addEventListener(n,"mousedown",i=>gr(Ur,this,bce).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>gr(Ur,this,Rce).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>gr(Ur,this,Ece).call(this)),this.eventManager.addEventListener(J(ii,this),"contextmenu",()=>gr(Ur,this,Tce).call(this))}destroy(){super.destroy()}}function yce(){const t=this.hot.getSettings()[Xm],e=this.loadManualColumnWidths();typeof e!="undefined"?this.hot.batchExecution(()=>{e.forEach((n,i)=>{J(Ei,this).setValueAtIndex(i,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,i)=>{J(Ei,this).setValueAtIndex(i,n)})},!0),Vt(Fh,this,t)):t===!0&&Array.isArray(J(Fh,this))&&this.hot.batchExecution(()=>{J(Fh,this).forEach((n,i)=>{J(Ei,this).setValueAtIndex(i,n)})},!0)}function Sce(t){if(!k1(t.target)&&J(Zm,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(J(fl,this)||this.setupHandlePosition(e))}}function bce(t){t.target.parentNode===this.hot.rootElement&&pe(t.target,"manualColumnResizer")&&(this.setupHandlePosition(J(jo,this)),this.setupGuidePosition(),Vt(fl,this,!0),J(kh,this)===null&&(Vt(kh,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(J(kh,this))),Vt(Lh,this,J(Lh,this)+1),this.startX=t.pageX,Vt(ao,this,J(Lu,this)))}function Rce(t){if(J(fl,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Vt(qm,this,J(Lu,this)+e),M(J(bi,this),n=>{Vt(ao,this,this.setManualSize(n,J(qm,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Ece(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(n,i)=>{this.hot.runHooks("beforeColumnResize",J(ao,this),n,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",J(ao,this),n,!1)};J(fl,this)&&(this.hideHandleAndGuide(),Vt(fl,this,!1),J(ao,this)!==J(Lu,this)&&(J(bi,this).length>1?(M(J(bi,this),i=>{e(i)}),t()):M(J(bi,this),i=>{e(i,!0)})),this.setupHandlePosition(J(jo,this)))}function Tce(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(J(ii,this)),this.hot.rootElement.removeChild(J(Fo,this)),Vt(fl,this,!1),Vt(Zm,this,!0),this.hot._registerImmediate(()=>{Vt(Zm,this,!1)})}function Mce(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalColumn(e),r=J(Ei,this).getValueAtIndex(i);this.hot.getSettings()[Xm]&&r&&(n=r)}return n}function _ce(t,e){const n=J(Ei,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function Ice(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function OC(t,e,n){return(e=Pce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pce(t){var e=Oce(t,"string");return typeof e=="symbol"?e:e+""}function Oce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const xC=0,vP=1,CP=2,ou="px";class xce{constructor(e){OC(this,"hot",void 0),OC(this,"_element",null),OC(this,"state",xC),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=CP}build(){this.state===xC&&(this._element=this.hot.rootDocument.createElement("div"),this.state=vP)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=xC}isAppended(){return this.state===CP}isBuilt(){return this.state>=vP}setPosition(e,n){e!==void 0&&(this._element.style.top=e+ou),n!==void 0&&(this._element.style.left=n+ou)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+ou),n&&(this._element.style.height=n+ou)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+ou),n&&(this._element.style.marginLeft=n+ou)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}var gD=xce;const Hce="ht__manualRowMove--backlight";class Ace extends gD{build(){super.build(),U(this._element,Hce)}}var Nce=Ace;const Dce="ht__manualRowMove--guideline";class $ce extends gD{build(){super.build(),U(this._element,Dce)}}var Lce=$ce;function kce(t,e){mD(t,e),e.add(t)}function su(t,e,n){mD(t,e),e.set(t,n)}function mD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nl(t,e,n){return t.set(Ds(t,e),n),n}function Se(t,e){return t.get(Ds(t,e))}function Ds(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ee.getSingleton().register("beforeRowMove");ee.getSingleton().register("afterRowMove");const HC="manualRowMove",Fce=140,yP="ht__manualRowMove",Qm="show-ui",uS="on-moving--rows",cS="after-selection--rows";var zn=new WeakMap,Ls=new WeakMap,Jo=new WeakMap,Us=new WeakMap,ci=new WeakMap,gg=new WeakMap,$a=new WeakSet;class Vce extends Xe{constructor(){super(...arguments),kce(this,$a),su(this,zn,new Nce(this.hot)),su(this,Ls,new Lce(this.hot)),su(this,Jo,[]),su(this,Us,void 0),su(this,ci,{}),su(this,gg,void 0)}static get PLUGIN_KEY(){return HC}static get PLUGIN_PRIORITY(){return Fce}isEnabled(){return!!this.hot.getSettings()[HC]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ds($a,e,Wce).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ds($a,e,jce).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>Ds($a,this,zce).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ds($a,e,Yce).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),U(this.hot.rootElement,yP),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ge(this.hot.rootElement,yP),this.unregisterEvents(),Se(zn,this).destroy(),Se(Ls,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const i=Se(gg,this),r=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,i,r);if(nl(gg,this,void 0),o===!1)return;r&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=r&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,i,r,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const i=this.countFinalIndex(e,n);return nl(gg,this,n),this.moveRows(e,i)}isMovePossible(e,n){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=i);return!(r||o||s||a)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=di(e,(r,o)=>(o<n&&(r+=1),r),0);return n-i}getRowsHeight(e,n){const i=this.hot.rowIndexMapper;let r=0;for(let o=e;o<=n;o++){const s=i.getRenderableFromVisualIndex(o);s!==null&&(r+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.view.getDefaultRowHeight())}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[HC];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:i,to:r}=e,o=Math.min(i.row,r.row),s=Math.max(i.row,r.row);return ce(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Se(ci,this).coords,n=this.hot.getFirstFullyVisibleRow(),i=this.hot.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&i<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Se(ci,this).TD,a=this.hot.rootElement,l=xn(a),u=Qh(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Se(ci,this).eventPageY-d+c,p=o.hider.offsetHeight,S=o.TBODY.offsetTop,y=Se(zn,this).getOffset().top,R=Se(zn,this).getSize().height,T=s.offsetHeight/2,V=s.offsetHeight;let B=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const W=f>=B+T;this.isFixedRowTop(e.row)&&(B+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Se(ci,this).row=n>0?n-1:n:W?(Se(ci,this).row=e.row+1,B+=e.row===0?V-1:V):Se(ci,this).row=e.row;let $=f,L=B;f+R+y>=p?$=p-R-y:f+y<S&&($=S+Math.abs(y)),B>=p-1&&(L=p-1),Se(zn,this).setPosition($),Se(Ls,this).setPosition(L)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ds($a,this,Bce).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ds($a,this,Uce).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Se(zn,this).build(),Se(Ls,this).build()}destroy(){Se(zn,this).destroy(),Se(Ls,this).destroy(),super.destroy()}}function Wce(t,e,n,i){const{wtTable:r,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Se(Us,this)||t.button!==0){nl(Us,this,!1),Se(Jo,this).length=0,ge(this.hot.rootElement,[uS,Qm]);return}const l=Se(Ls,this).isBuilt()&&!Se(Ls,this).isAppended(),u=Se(zn,this).isBuilt()&&!Se(zn,this).isAppended();l&&u&&(Se(Ls,this).appendTo(r.hider),Se(zn,this).appendTo(r.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){i.row=!0,nl(Us,this,!0),Se(ci,this).eventPageY=t.pageY,Se(ci,this).coords=e,Se(ci,this).TD=n,nl(Jo,this,this.prepareRowsToMoving());const p=r.holder.scrollLeft+o.getRowHeaderWidth(),S=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);Se(zn,this).setPosition(null,p),Se(zn,this).setSize(r.hider.offsetWidth-p,this.getRowsHeight(d,f)),Se(zn,this).setOffset(-S,null),U(this.hot.rootElement,uS),this.refreshPositions()}else ge(this.hot.rootElement,cS),nl(Us,this,!1),Se(Jo,this).length=0}function Bce(t){!Se(Us,this)||(Se(ci,this).eventPageY=t.pageY,this.refreshPositions())}function jce(t,e,n,i){!this.hot.getSelectedRangeLast()||!Se(Us,this)||(Se(Jo,this).indexOf(e.row)>-1?ge(this.hot.rootElement,Qm):U(this.hot.rootElement,Qm),i.row=!0,i.column=!0,i.cell=!0,Se(ci,this).coords=e,Se(ci,this).TD=n)}function Uce(){const t=Se(ci,this).row,e=Se(Jo,this).length;if(nl(Us,this,!1),ge(this.hot.rootElement,[uS,Qm,cS]),this.hot.selection.isSelectedByRowHeader()&&U(this.hot.rootElement,cS),e<1||t===void 0)return;const n=Se(Jo,this)[0],i=this.hot.toPhysicalRow(n),r=this.dragRows(Se(Jo,this),t);if(Se(Jo,this).length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(i),s=o+e-1;this.hot.selectRows(o,s)}}function zce(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,i=e+n;Se(zn,this).setPosition(null,i),Se(zn,this).setSize(t.hider.offsetWidth-i)}function Yce(){this.moveBySettingsOrLoad()}function Gce(t,e){pD(t,e),e.add(t)}function Mn(t,e,n){pD(t,e),e.set(t,n)}function pD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ot(t,e,n){return t.set(Uo(t,e),n),n}function Q(t,e){return t.get(Uo(t,e))}function Uo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Jm="manualRowResize",Kce=30,SP="manualRowHeights";var to=new WeakMap,mg=new WeakMap,Ri=new WeakMap,Vh=new WeakMap,ks=new WeakMap,eE=new WeakMap,ku=new WeakMap,pg=new WeakMap,Wn=new WeakMap,Qr=new WeakMap,gl=new WeakMap,ep=new WeakMap,Wh=new WeakMap,Bh=new WeakMap,wr=new WeakMap,jh=new WeakMap,Ms=new WeakSet;class Xce extends Xe{static get PLUGIN_KEY(){return Jm}static get PLUGIN_PRIORITY(){return Kce}constructor(e){super(e),Gce(this,Ms),Mn(this,to,null),Mn(this,mg,null),Mn(this,Ri,[]),Mn(this,Vh,null),Mn(this,ks,null),Mn(this,eE,null),Mn(this,ku,null),Mn(this,pg,null),Mn(this,Wn,this.hot.rootDocument.createElement("DIV")),Mn(this,Qr,this.hot.rootDocument.createElement("DIV")),Mn(this,gl,!1),Mn(this,ep,!1),Mn(this,Wh,0),Mn(this,Bh,null),Mn(this,wr,void 0),Mn(this,jh,void 0),U(Q(Wn,this),"manualRowResizer"),U(Q(Qr,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Jm]}enablePlugin(){this.enabled||(Ot(wr,this,new ta),Q(wr,this).addLocalHook("init",()=>Uo(Ms,this,nhe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Q(wr,this)),this.addHook("modifyRowHeight",(e,n)=>Uo(Ms,this,the).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Ot(jh,this,Q(wr,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",SP,Q(wr,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",SP,e),e.value}setManualSize(e,n){const i=this.hot.toPhysicalRow(e),r=Math.max(n,this.hot.view.getDefaultRowHeight());return Q(wr,this).setValueAtIndex(i,r),r}getLastDesiredRowHeight(){return Q(Vh,this)}setupHandlePosition(e){Ot(to,this,e);const{view:n}=this.hot,{_wt:i}=n,r=i.wtTable.getCoords(Q(to,this)),o=r.row;if(o<0)return;const s=Yt(Q(to,this)),a=Q(to,this).getBoundingClientRect(),l=o<i.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let c;l?c=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Q(to,this),r.row,r.col):u&&(c=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(Q(to,this),r.row,r.col)),c||(c=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(Q(to,this),r.row,r.col)),Ot(mg,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Ot(Ri,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();M(d,f=>{const p=f.getTopStartCorner().row,S=f.getBottomStartCorner().row;ce(p,S,y=>{Q(Ri,this).includes(y)||Q(Ri,this).push(y)})})}Q(Ri,this).includes(Q(mg,this))||Ot(Ri,this,[Q(mg,this)]),Ot(pg,this,c.top-6),Ot(ku,this,parseInt(a.height,10)),Q(Wn,this).style.top=`${Q(pg,this)+Q(ku,this)}px`,Q(Wn,this).style[this.inlineDir]=`${c.start}px`,Q(Wn,this).style.width=`${s}px`,this.hot.rootElement.appendChild(Q(Wn,this))}refreshHandlePosition(){Q(Wn,this).style.top=`${Q(pg,this)+Q(Vh,this)}px`}setupGuidePosition(){const e=parseInt(Yt(Q(Wn,this)),10),n=parseInt(Q(Wn,this).style[this.inlineDir],10)+e,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);U(Q(Wn,this),"active"),U(Q(Qr,this),"active"),Q(Qr,this).style.top=Q(Wn,this).style.top,Q(Qr,this).style[this.inlineDir]=`${n}px`,Q(Qr,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(Q(Qr,this))}refreshGuidePosition(){Q(Qr,this).style.top=Q(Wn,this).style.top}hideHandleAndGuide(){ge(Q(Wn,this),"active"),ge(Q(Qr,this),"active")}checkIfRowHeader(e){const n=al(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,r.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&Q(ks,this)<n?n:Q(ks,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},n=(i,r)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);o!==void 0&&Ot(ks,this,o),this.setManualSize(i,Q(ks,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),r&&e()};Q(Wh,this)>=2&&(Q(Ri,this).length>1?(M(Q(Ri,this),r=>{n(r)}),e()):M(Q(Ri,this),r=>{n(r,!0)})),Ot(Wh,this,0),Ot(Bh,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>Uo(Ms,this,qce).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Uo(Ms,this,Zce).call(this,i)),this.eventManager.addEventListener(n,"mousemove",i=>Uo(Ms,this,Qce).call(this,i)),this.eventManager.addEventListener(n,"mouseup",()=>Uo(Ms,this,Jce).call(this)),this.eventManager.addEventListener(Q(Wn,this),"contextmenu",()=>Uo(Ms,this,ehe).call(this))}destroy(){super.destroy()}}function qce(t){if(!k1(t.target)&&Q(ep,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(Q(gl,this)||this.setupHandlePosition(e))}}function Zce(t){pe(t.target,"manualRowResizer")&&(this.setupHandlePosition(Q(to,this)),this.setupGuidePosition(),Ot(gl,this,!0),Q(Bh,this)===null&&(Ot(Bh,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Q(Bh,this))),Ot(Wh,this,Q(Wh,this)+1),Ot(eE,this,t.pageY),Ot(ks,this,Q(ku,this)))}function Qce(t){Q(gl,this)&&(Ot(Vh,this,Q(ku,this)+(t.pageY-Q(eE,this))),M(Q(Ri,this),e=>{Ot(ks,this,this.setManualSize(e,Q(Vh,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Jce(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(n,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};Q(gl,this)&&(this.hideHandleAndGuide(),Ot(gl,this,!1),Q(ks,this)!==Q(ku,this)&&(Q(Ri,this).length>1?(M(Q(Ri,this),i=>{e(i)}),t()):M(Q(Ri,this),i=>{e(i,!0)})),this.setupHandlePosition(Q(to,this)))}function ehe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Q(Wn,this)),this.hot.rootElement.removeChild(Q(Qr,this)),Ot(gl,this,!1),Ot(ep,this,!0),this.hot._registerImmediate(()=>{Ot(ep,this,!1)})}function the(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalRow(e),r=Q(wr,this).getValueAtIndex(i);this.hot.getSettings()[Jm]&&r&&(n=r)}return n}function nhe(){const t=this.hot.getSettings()[Jm],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e!="undefined"?e.forEach((n,i)=>{Q(wr,this).setValueAtIndex(i,n)}):Array.isArray(t)?(t.forEach((n,i)=>{Q(wr,this).setValueAtIndex(i,n)}),Ot(jh,this,t)):t===!0&&Array.isArray(Q(jh,this))&&Q(jh,this).forEach((n,i)=>{Q(wr,this).setValueAtIndex(i,n)})},!0)}var ihe=Np;ihe("flatMap");var rhe=An,bP=on,ohe=wo,she=$S,ahe=function(t,e){(!e||typeof t!="string")&&bP(t);var n=she(t);return ohe(bP(n!==void 0?rhe(n,t):t))},lhe=dt,RP=An,uhe=hi,hS=on,che=wo,hhe=ahe,dhe=DS,EP=qu,fhe=CS,ghe=dhe(function(){for(var t=this.iterator,e=this.mapper,n,i;;){if(i=this.inner)try{if(n=hS(RP(i.next,i.iterator)),!n.done)return n.value;this.inner=null}catch(r){EP(t,"throw",r)}if(n=hS(RP(this.next,t)),this.done=!!n.done)return;try{this.inner=hhe(e(n.value,this.counter++),!1)}catch(r){EP(t,"throw",r)}}});lhe({target:"Iterator",proto:!0,real:!0,forced:fhe},{flatMap:function(e){return hS(this),uhe(e),new ghe(che(this),{mapper:e,inner:null})}});function mhe(t,e,n){phe(t,e),e.set(t,n)}function phe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function La(t,e,n){return(e=whe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function whe(t){var e=vhe(t,"string");return typeof e=="symbol"?e:e+""}function vhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TP(t,e){return t.get(wD(t,e))}function wg(t,e,n){return t.set(wD(t,e),n),n}function wD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ka=new WeakMap;class Che{constructor(e,n,i,r,o,s){La(this,"row",void 0),La(this,"col",void 0),La(this,"rowspan",void 0),La(this,"colspan",void 0),La(this,"removed",!1),La(this,"cellCoordsFactory",void 0),La(this,"cellRangeFactory",void 0),mhe(this,ka,null),this.row=e,this.col=n,this.rowspan=i,this.colspan=r,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:i,rowspan:r,colspan:o}=e;return tt`The merged cell declared with {row: ${n}, col: ${i},\x20
      rowspan: ${r}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:i}=e;return tt`The merged cell declared at [${n}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:i}=e;return tt`The merged cell declared at [${n}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:i}=e;return tt`The merged cell declared at [${n}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:i,rowspan:r,colspan:o}=e;return n<0||i<0||r<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:i}=e;return i===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:i}=e;return i===0||n===0}static isOutOfBounds(e,n,i){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const n=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),wg(ka,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const i=e[0]||e[1],r=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,r),l=Math.max(n,r),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=i),i>0)n<=c&&n>u&&(this[o]+=i);else if(i<0){if(a<=u&&l>=c)return this.removed=!0,wg(ka,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(i)-h;this[s]-=d+i,this[o]-=h}else if(u<=a&&c>=l)this[o]+=i;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return wg(ka,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return TP(ka,this)||wg(ka,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),TP(ka,this)}}var no=Che;function yhe(t,e){She(t,e),e.add(t)}function She(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vg(t,e,n){return(e=bhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bhe(t){var e=Rhe(t,"string");return typeof e=="symbol"?e:e+""}function Rhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _s=new WeakSet;class tp{constructor(e){yhe(this,_s),vg(this,"plugin",void 0),vg(this,"mergedCells",[]),vg(this,"mergedCellsMatrix",new Map),vg(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:i}=e;return tt`The merged cell declared at [${n}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(n))!==null&&i!==void 0?i:!1}getByRange(e){const{row:n,col:i}=e.getTopStartCorner(),{row:r,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=r&&h>=i&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(r=>{const{row:o,col:s,colspan:a,rowspan:l}=r;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(r=>{const{row:o,col:s,colspan:a,rowspan:l}=r,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){qe(tp.IS_OVERLAPPING_WARNING(r)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:r}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=i;l<=o;l++)for(let u=r;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,r=e.col,o=e.rowspan,s=e.colspan,a=new no(i,r,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(i,r),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Fa(_s,this,MP).call(this,a),a):(u&&qe(tp.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const i=this.get(e,n),r=i?this.mergedCells.indexOf(i):-1;return i&&r!==-1?(this.mergedCells.splice(r,1),Fa(_s,this,Ehe).call(this,i),i):!1}clear(){M(this.mergedCells,e=>{let{row:n,col:i,rowspan:r,colspan:o}=e;ce(n,n+r,s=>{ce(i,i+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const i=this.get(e,n);if(!i)return!1;const{row:r,col:o,rowspan:s,colspan:a}=i,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Ue(u,r,r+s-1),d=Ue(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const i=this.get(e,n);if(!i||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(r,o)}getStartMostColumnIndex(e,n){const i=Fa(_s,this,Cg).call(this,e,"col",-1);let r=n;for(let o=0;o<i.length;o++)if(i[o]<=n){r=i[o];break}return r}getEndMostColumnIndex(e,n){const i=Fa(_s,this,Cg).call(this,e,"col",1);let r=n;for(let o=0;o<i.length;o++)if(i[o]>=n){r=i[o];break}return r}getTopMostRowIndex(e,n){const i=Fa(_s,this,Cg).call(this,e,"row",-1);let r=n;for(let o=0;o<i.length;o++)if(i[o]<=n){r=i[o];break}return r}getBottomMostRowIndex(e,n){const i=Fa(_s,this,Cg).call(this,e,"row",1);let r=n;for(let o=0;o<i.length;o++)if(i[o]>=n){r=i[o];break}return r}shiftCollections(e,n,i){const r=[0,0];switch(e){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i;break}const o=[];this.mergedCells.forEach(s=>{s.shift(r,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Fa(_s,this,MP).call(this,s)})}}function Cg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,r=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=r.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=r.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),i.has(l)||i.set(l,new Set),i.get(l).add(c)}return Array.from(new Set(Array.from(i.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function MP(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function Ehe(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}var The=tp;function AC(t,e,n){return(e=Mhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mhe(t){var e=_he(t,"string");return typeof e=="symbol"?e:e+""}function _he(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ihe{constructor(e){AC(this,"plugin",void 0),AC(this,"mergedCellsCollection",void 0),AC(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let i=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?i="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?i="up":n[1]===e[1]&&n[2]===e[2]?i="right":i="left",i}snapDragArea(e,n,i,r){const o=n.slice(0),s=this.getAutofillSize(e,n,i),[a,l,u,c]=e,d=["up","down"].indexOf(i)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,p=s-f,S=this.getFarthestCollection(e,n,i,r);if(S){if(i==="down"){const y=S.row+S.rowspan-a-p;o[2]+y>=this.plugin.hot.countRows()?o[2]-=p:o[2]+=p?y:0}else if(i==="right"){const y=S.col+S.colspan-l-p;o[3]+y>=this.plugin.hot.countCols()?o[3]-=p:o[3]+=p?y:0}else if(i==="up"){const y=u-p-S.row+1;o[0]+y<0?o[0]+=p:o[0]-=p?y:0}else if(i==="left"){const y=c-p-S.col+1;o[1]+y<0?o[1]+=p:o[1]-=p?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:r,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),nn(this.currentFillData,e)}getAutofillSize(e,n,i){const[r,o,s,a]=e,[l,u,c,h]=n;switch(i){case"up":return r-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,i){const[r,o,s,a]=e,[l,u,c,h]=n;switch(i){case"up":return[l,u,r-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[r,a+f,c,h]}default:return null}}getFarthestCollection(e,n,i,r){const[o,s,a,l]=e,u=["up","down"].indexOf(i)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,i),f=u?a-o+1:l-s+1,p=Math.floor(d/f)*f,S=d-p;let y=null,R=null,T=null;switch(i){case"up":y="includesVertically",T=c-S+1;break;case"left":y="includesHorizontally",T=c-S+1;break;case"down":y="includesVertically",T=h+S-1;break;case"right":y="includesHorizontally",T=h+S-1;break}return M(r,V=>{V[y](T)&&V.isFarther(R,i)&&(R=V)}),R}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=(u,c)=>{switch(r){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<i.length;u+=1){if(a=i[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===i.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},i={min:null,max:null};return M(e,r=>{const o=r[0],s=this.plugin.hot.propToCol(r[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:n.min,column:i.min},to:{row:n.max,column:i.max}}}dragAreaOverlapsCollections(e,n,i){const r=this.getDragArea(e,n,i),[o,s,a,l]=r,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:i==="up"||i==="down"?!f.every(p=>{let{colspan:S}=p;return S===h.getWidth()}):!f.every(p=>{let{rowspan:S}=p;return S===h.getHeight()})}}var Phe=Ihe;function NC(t,e,n){return(e=Ohe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ohe(t){var e=xhe(t,"string");return typeof e=="symbol"?e:e+""}function xhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hhe{constructor(e){NC(this,"plugin",void 0),NC(this,"hot",void 0),NC(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,i,r){const o=Math.min(i[0],i[2]),s=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),l=Math.max(i[1],i[3]);if(r===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${r}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const i=[];if(!n||!e)return!1;for(let r=0;r<e.rowspan;r+=1)for(let o=0;o<e.colspan;o+=1)i.push(this.hot._createCellCoords(e.row+r,e.col+o));for(let r=0;r<i.length;r+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(i[r]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}var Ahe=Hhe;function Nhe(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(hR)}return this.getTranslatedPhrase(cR)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedLast();return e?no.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Uh(t,e,n){return(e=Dhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dhe(t){var e=$he(t,"string");return typeof e=="symbol"?e:e+""}function $he(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _P{constructor(e){Uh(this,"data",void 0),Uh(this,"next",null),Uh(this,"prev",null),this.data=e}}class Lhe{constructor(){Uh(this,"first",null),Uh(this,"last",null)}push(e){const n=new _P(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.last;this.last=n,n.prev=i,i.next=n}return n}unshift(e){const n=new _P(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.first;this.first=n,n.next=i,i.prev=n}}inorder(e){let n=this.first;for(;n;){const i=e(n);if(n===this.last||i===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,i,r;for(;n;){if(n.data===e)return i=n.next,r=n.prev,i&&(i.prev=r),r&&(r.next=i),n===this.first&&(this.first=i),n===this.last&&(this.last=r),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,r){!r||(e(r,r.next),r.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,i;for(;e;)i=e.next,e.next=n,n.prev=e,n=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=n,this.last=i}}var yg=Lhe;function khe(t,e){vD(t,e),e.add(t)}function Va(t,e,n){vD(t,e),e.set(t,n)}function vD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Je(t,e){return t.get(np(t,e))}function mi(t,e,n){return t.set(np(t,e),n),n}function np(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zr=new WeakMap,Yr=new WeakMap,Gr=new WeakMap,Kr=new WeakMap,dS=new WeakMap,Sg=new WeakMap,bg=new WeakMap,DC=new WeakSet;class Fhe{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:i,columnIndexMapper:r}=e;khe(this,DC),Va(this,zr,new yg),Va(this,Yr,new yg),Va(this,Gr,null),Va(this,Kr,null),Va(this,dS,null),Va(this,Sg,null),Va(this,bg,null),mi(dS,this,n),mi(Sg,this,i),mi(bg,this,r)}getCurrentVerticalNode(){return Je(Kr,this).data}getFirstVerticalNode(){return Je(Yr,this).first.data}getNextVerticalNode(){return Je(Kr,this).next.data}getPrevVerticalNode(){return Je(Kr,this).prev.data}getCurrentHorizontalNode(){return Je(Gr,this).data}getFirstHorizontalNode(){return Je(zr,this).first.data}getNextHorizontalNode(){return Je(Gr,this).next.data}getPrevHorizontalNode(){return Je(Gr,this).prev.data}setPrevNodeAsActive(){mi(Kr,this,Je(Kr,this).prev),mi(Gr,this,Je(Gr,this).prev)}setNextNodeAsActive(){mi(Kr,this,Je(Kr,this).next),mi(Gr,this,Je(Gr,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),i=e.getBottomEndCorner(),r=new WeakSet;mi(zr,this,new yg);for(let s=n.row;s<=i.row;s++)if(!Je(Sg,this).isHidden(s))for(let a=n.col;a<=i.col;a++){if(Je(bg,this).isHidden(a))continue;const l=np(DC,this,IP).call(this,e,Je(zr,this),r,s,a);l&&mi(Gr,this,l)}Je(zr,this).first&&(Je(zr,this).first.prev=Je(zr,this).last,Je(zr,this).last.next=Je(zr,this).first);const o=new WeakSet;mi(Yr,this,new yg);for(let s=n.col;s<=i.col;s++)if(!Je(bg,this).isHidden(s))for(let a=n.row;a<=i.row;a++){if(Je(Sg,this).isHidden(a))continue;const l=np(DC,this,IP).call(this,e,Je(Yr,this),o,a,s);l&&mi(Kr,this,l)}Je(Yr,this).first&&(Je(Yr,this).first.prev=Je(Yr,this).last,Je(Yr,this).last.next=Je(Yr,this).first)}setActiveNode(e,n){return Je(zr,this).inorder(i=>{const{rowStart:r,rowEnd:o,colStart:s,colEnd:a}=i.data;if(e>=r&&e<=o&&n>=s&&n<=a)return mi(Gr,this,i),!1}),Je(Yr,this).inorder(i=>{const{rowStart:r,rowEnd:o,colStart:s,colEnd:a}=i.data;if(e>=r&&e<=o&&n>=s&&n<=a)return mi(Kr,this,i),!1}),this}}function IP(t,e,n,i,r){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=Je(dS,this).call(this,i,r);if(l&&n.has(l))return null;const u={colStart:r,colEnd:r,rowStart:i,rowEnd:i};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return i===a.row&&r===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function Vhe(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:i}=e;function r(){}function o(s,a,l){const u=t.mergedCellsCollection.get(a,l);if(!He(u)){s.removeAttribute("rowspan"),s.removeAttribute("colspan"),s.style.display="";return}const{row:c,col:h,colspan:d,rowspan:f}=u,[p,S]=t.translateMergedCellToRenderable(c,f,h,d),y=t.getSetting("virtualized"),R=n.getRenderableFromVisualIndex(a),T=i.getRenderableFromVisualIndex(l),V=p-R+1,B=S-T+1;let W=n.getNearestNotHiddenIndex(c,1),$=i.getNearestNotHiddenIndex(h,1);if(y){const ie=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(ie)||(W=Math.max(W,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(ie)||($=Math.max($,e.getFirstRenderedVisibleColumn()))}const L=Math.min(f,V),z=Math.min(d,B);W===a&&$===l?(s.setAttribute("rowspan",L),s.setAttribute("colspan",z)):(s.removeAttribute("rowspan"),s.removeAttribute("colspan"),s.style.display="none")}return{before:r,after:o}}function Whe(t,e){CD(t,e),e.add(t)}function Rg(t,e,n){CD(t,e),e.set(t,n)}function CD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $C(t,e,n){return(e=Bhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bhe(t){var e=jhe(t,"string");return typeof e=="symbol"?e:e+""}function jhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dd(t,e,n){return t.set(et(t,e),n),n}function ht(t,e){return t.get(et(t,e))}function et(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ee.getSingleton().register("beforeMergeCells");ee.getSingleton().register("afterMergeCells");ee.getSingleton().register("beforeUnmergeCells");ee.getSingleton().register("afterUnmergeCells");const fS="mergeCells",Uhe=150,PP=fS;var Ui=new WeakMap,zi=new WeakMap,lo=new WeakMap,OP=new WeakMap,it=new WeakSet;class zhe extends Xe{constructor(){super(...arguments),Whe(this,it),$C(this,"mergedCellsCollection",null),$C(this,"autofillCalculations",null),$C(this,"selectionCalculations",null),Rg(this,Ui,null),Rg(this,zi,{row:0,col:0}),Rg(this,lo,new Fhe({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Rg(this,OP,Vhe(this))}static get PLUGIN_KEY(){return fS}static get PLUGIN_PRIORITY(){return Uhe}static get DEFAULT_SETTINGS(){return{[VA]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[fS]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new The(this),this.autofillCalculations=new Phe(this),this.selectionCalculations=new Ahe(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,Yhe).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,Khe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,Xhe).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,qhe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,Zhe).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,HP).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,HP).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,Jhe).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,ede).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,tde).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,xP).call(e,...i)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,xP).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,Ghe).call(e,...i)}),this.addHook("afterRenderer",function(){return ht(OP,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,Qhe).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,nde).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,ide).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,rde).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,ode).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,sde).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,ade).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,lde).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,ude).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,cde).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,hde).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,dde).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,fde).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,gde).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return et(it,e,mde).call(e,...i)}),this.addHook("beforeUndoStackChange",(n,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!G1())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:r,rowspan:o}=i;for(let s=r+1;s<r+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(i=>{const r=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(r);s&&(s.style.background=bm(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{i.style.background=bm(i,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?no.containsNegativeValues(e)?(qe(no.NEGATIVE_VALUES_WARNING(e)),!1):no.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(qe(no.IS_OUT_OF_BOUNDS_WARNING(e)),!1):no.isSingleCell(e)?(qe(no.IS_SINGLE_CELL(e)),!1):no.containsZeroSpan(e)?(qe(no.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(r=>this.validateSetting(r)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),i=[];n.forEach(r=>{const{row:o,col:s,rowspan:a,colspan:l}=r,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&i.push([d,f,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:r.row,col:r.col,rowspan:o.row-r.row+1,colspan:o.col-r.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),ce(0,s.rowspan-1,c=>{ce(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(i?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),M(i,r=>{this.mergedCellsCollection.remove(r.row,r.col),ce(0,r.rowspan-1,o=>{ce(0,r.colspan-1,s=>{this.hot.removeCellMeta(r.row+o,r.col+s,"hidden"),this.hot.removeCellMeta(r.row+o,r.col+s,"copyable")})}),this.hot.removeCellMeta(r.row,r.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,i,r){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(i,r);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,i,r){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(i,r);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeLast();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:PP})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(PP)}modifyViewportRowStart(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(r,o);if(He(s)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(r,o);if(He(s)){const a=s.row+s.rowspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,r);if(He(s)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,r);if(He(s)){const a=s.col+s.colspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,i,r){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),r===0?l=s.getNearestNotHiddenIndex(i,1):l=s.getNearestNotHiddenIndex(i+r-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=i>=0?s.getRenderableFromVisualIndex(l):i;return[u,c]}}function Yhe(){this.generateFromSettings(),this.hot.render()}function Ghe(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),i=n.getTopStartCorner(),r=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(i.row===e[o].row&&i.col===e[o].col&&r.row===e[o].row+e[o].rowspan-1&&r.col===e[o].col+e[o].colspan-1)return!1}return t}function Khe(t){ht(zi,this).row=t.row,ht(zi,this).col=t.col}function Xhe(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:i,rowIndexMapper:r}=this.hot;ht(Ui,this)&&(r.getRenderableFromVisualIndex(ht(Ui,this).row)!==null&&(n.row=ht(Ui,this).row),i.getRenderableFromVisualIndex(ht(Ui,this).col)!==null&&(n.col=ht(Ui,this).col),dd(Ui,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=i.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=r.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function qhe(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:i}=e,{columnIndexMapper:r,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+t.col;s(i.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=r.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,i.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+t.col;s(i.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=r.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+t.row;s(a,i.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,i.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+t.row;s(a,i.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,l)-1,1))}}function Zhe(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){dd(Ui,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);dd(Ui,this,e.clone()),n&&e.assign(n)}function xP(t,e,n,i){if(t<0||e<0)return;const r=this.mergedCellsCollection.get(t,e);if(!r)return;const{row:o,col:s,colspan:a,rowspan:l}=r,u=o,c=s,h=o+l-1,d=s+a-1;if(i==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),p=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),S=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Ue(p,u,h),Ue(S,c,d),Ue(this.hot.getLastRenderedVisibleRow(),u,h),Ue(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function Qhe(t){t.items.push({name:"---------"},Nhe(this))}function HP(){dd(Ui,this,null)}function Jhe(){if(ht(Ui,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),i=ht(Ui,this).clone().normalize();ht(lo,this).setActiveNode(i.row,i.col),ht(zi,this).row>0||ht(zi,this).col>0?ht(lo,this).setPrevNodeAsActive():(n==="E-W"&&ht(zi,this).col<0||e==="S-N"&&ht(zi,this).row<0)&&ht(lo,this).setNextNodeAsActive()}function ede(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:r}=this.hot;let o=null,s=null;if(ht(zi,this).col<0){const{rowEnd:a,colEnd:l}=ht(lo,this).getPrevHorizontalNode();s=i.getNearestNotHiddenIndex(l,-1),o=r.getNearestNotHiddenIndex(a,-1)}else if(ht(zi,this).col>0){const{rowStart:a,colStart:l}=ht(lo,this).getNextHorizontalNode();s=i.getNearestNotHiddenIndex(l,1),o=r.getNearestNotHiddenIndex(a,1)}else if(ht(zi,this).row<0){const{rowEnd:a,colEnd:l}=ht(lo,this).getPrevVerticalNode();s=i.getNearestNotHiddenIndex(l,-1),o=r.getNearestNotHiddenIndex(a,-1)}else if(ht(zi,this).row>0){const{rowStart:a,colStart:l}=ht(lo,this).getNextVerticalNode();s=i.getNearestNotHiddenIndex(l,1),o=r.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}ht(lo,this).setActiveNode(t,e),dd(zi,this,{row:0,col:0})}function tde(){this.hot.getSelectedRangeLast().isHeader()||ht(lo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function nde(t,e,n){const i=this.mergedCellsCollection.get(t,e);i&&(i.row!==t||i.col!==e?n.copyable=!1:(n.rowspan=i.rowspan,n.colspan=i.colspan))}function ide(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function rde(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function ode(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const i=this.hot._createCellCoords(e[0],e[1]),r=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(i,i,r),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function sde(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function ade(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function lde(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function ude(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function cde(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function hde(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(n);M(i,r=>{n.getBottomEndCorner().row===r.getLastRow()&&n.getBottomEndCorner().col===r.getLastColumn()&&(t[2]=r.row,t[3]=r.col)})}}function dde(t,e,n,i){if(!!n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,i)}function fde(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function gde(t,e,n,i){if(!(i instanceof MouseEvent))return;const r=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(r);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&r.isEqual(this.hot._createCellRange(s,s,a))}function mde(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let i,r;if(n==="master")i=this.hot.getFirstRenderedVisibleColumn(),r=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return t;const s=this.hot._createCellCoords(e,i),a=this.hot._createCellCoords(e,r),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:p}=f;return Math.max(d,p)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,p=0;n==="top"||n==="top_inline_start_corner"?p=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):p=f-h,t=Math.max(t!=null?t:0,et(it,this,pde).call(this,e,p))}),t}function pde(t,e){const{view:n,rowIndexMapper:i}=this.hot,r=n.getStylesHandler(),o=n.getDefaultRowHeight();let s=0;for(let l=t;l<t+e;l++)if(!i.isHidden(l)){var a;s+=(a=this.hot.getRowHeight(l))!==null&&a!==void 0?a:o,l===0&&!r.isClassicTheme()&&(s+=1)}return s}function wde(t,e){return function(n,i){const[,...r]=n,[,...o]=i;return function s(a){const l=t[a],u=e[a],c=r[a],h=o[a],d=u.multiColumnSorting,p=(d.compareFunctionFactory?d.compareFunctionFactory:XA(u.type))(l,u,d)(c,h);if(p===ho){const S=a+1;if(typeof e[S]!="undefined")return s(S)}return p}(0)}}const yD="sort";function vde(t,e,n){const i=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&i.push(`${yD}-${t.getIndexOfColumnInSortQueue(e)+1}`),i}function Cde(t){const e=t.className.split(" "),n=new RegExp(`^${yD}-[0-9]{1,2}$`);return e.filter(i=>n.test(i))}function yde(t,e,n){return(e=Sde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sde(t){var e=bde(t,"string");return typeof e=="symbol"?e:e+""}function bde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ip="multiColumnSorting",Rde=170,AP=ip;KA(ip,wde);class Ede extends rN{constructor(){super(...arguments),yde(this,"pluginKey",ip)}static get PLUGIN_KEY(){return ip}static get PLUGIN_PRIORITY(){return Rde}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,km)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:na,position:"before",group:AP})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(AP)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];super.updateHeaderClasses(e,...i),ge(e,Cde(e)),this.enabled!==!1&&U(e,vde(...i))}onAfterOnCellMouseDown(e,n){V0(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,km))):this.sort(this.getColumnNextConfig(n.col)))}}function NP(t,e,n){return(e=Tde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tde(t){var e=Mde(t,"string");return typeof e=="symbol"?e:e+""}function Mde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _de="multipleSelectionHandles",Ide=160;class Pde extends Xe{constructor(){super(...arguments),NP(this,"dragged",[]),NP(this,"lastSetCell",null)}static get PLUGIN_KEY(){return _de}static get PLUGIN_PRIORITY(){return Ide}isEnabled(){return qo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function i(r){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(r);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",r=>{let o;if(pe(r.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},r.preventDefault(),!1;if(pe(r.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",r=>{if(pe(r.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,r.preventDefault(),!1;if(pe(r.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",r=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(r.touches[0].clientX,r.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),r.preventDefault())})}getCurrentRangeCoords(e,n,i,r,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(r){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(r){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function gS(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:i=!1,crossHiddenColumns:r=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:i,isCollapsed:o,crossHiddenColumns:r,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function SD(){return{label:"",isPlaceholder:!0}}function Ode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;M(t,r=>{const o=[];let s=0;n.push(o),M(r,a=>{const l=gS();if(He(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Gt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Gt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(SD());return!u})});const i=Math.max(...We(n,r=>r.length));return M(n,r=>{if(r.length<i){const o=We(new Array(i-r.length),()=>gS());r.splice(r.length,0,...o)}}),n}function LC(t,e,n){xde(t,e),e.set(t,n)}function xde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sr(t,e){return t.get(bD(t,e))}function lh(t,e,n){return t.set(bD(t,e),n),n}function bD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const DP=["label","collapsible"];var No=new WeakMap,Wa=new WeakMap,kC=new WeakMap;class Hde{constructor(){LC(this,No,[]),LC(this,Wa,0),LC(this,kC,1/0)}setColumnsLimit(e){lh(kC,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];lh(No,this,Ode(e,sr(kC,this))),lh(Wa,this,sr(No,this).length)}getData(){return sr(No,this)}mergeWith(e){M(e,n=>{let a=n,{row:i,col:r}=a,o=$n(a,["row","col"]);const s=this.getHeaderSettings(i,r);s!==null&&nn(s,o,DP)})}map(e){M(sr(No,this),n=>{M(n,i=>{const r=e(Me({},i));He(r)&&nn(i,r,DP)})})}getHeaderSettings(e,n){var i;if(e>=sr(Wa,this)||e<0)return null;const r=sr(No,this)[e];return Array.isArray(r)===!1||n>=r.length?null:(i=r[n])!==null&&i!==void 0?i:null}getHeadersSettings(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=[];if(e>=sr(Wa,this)||e<0)return r;const o=sr(No,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,r.push(l),l.colspan>1&&(a+=l.colspan-1),s===i)break;if(s>i)throw new Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return sr(Wa,this)}getColumnsCount(){return sr(Wa,this)>0?sr(No,this)[0].length:0}clear(){lh(No,this,[]),lh(Wa,this,0)}}function FC(t,e,n){return(e=Ade(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ade(t){var e=Nde(t,"string");return typeof e=="symbol"?e:e+""}function Nde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const RD="DF-pre-order";function ED(t,e){let n=t.call(e,this);for(let i=0;i<this.childs.length;i++){if(n===!1)return!1;n=ED.call(this.childs[i],t,e)}return n}const Dde="DF-post-order";function TD(t,e){for(let n=0;n<this.childs.length;n++)if(TD.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const MD="BF";function $de(t,e){const n=[this];function i(){if(n.length===0)return;const r=n.shift();n.push(...r.childs),t.call(e,r)!==!1&&i()}i()}const Lde=MD,$P=new Map([[RD,ED],[Dde,TD],[MD,$de]]);class rp{constructor(e){FC(this,"data",{}),FC(this,"parent",null),FC(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new rp(Me({},e.data));for(let i=0;i<e.childs.length;i++)n.addChild(this.cloneTree(e.childs[i]));return n}replaceTreeWith(e){this.data=Me({},e.data),this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Lde;if(!$P.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);$P.get(n).call(this,e,this)}walkUp(e){const n=this,i=r=>{e.call(n,r)!==!1&&r.parent!==null&&i(r.parent)};i(this)}}function VC(t,e,n){kde(t,e),e.set(t,n)}function kde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vn(t,e){return t.get(_D(t,e))}function Fde(t,e,n){return t.set(_D(t,e),n),n}function _D(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var au=new WeakMap,Ba=new WeakMap,lu=new WeakMap;class Vde{constructor(e){VC(this,au,new Map),VC(this,Ba,new Map),VC(this,lu,null),Fde(lu,this,e)}getRoots(){return Array.from(Vn(au,this).values())}getRootByColumn(e){let n;return Vn(Ba,this).has(e)&&(n=Vn(au,this).get(Vn(Ba,this).get(e))),n}getNode(e,n){const i=this.getRootByColumn(n);if(!i)return;const r=n-Vn(Ba,this).get(n);let o=0,s;return i.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(r>=o&&r<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;Vn(Ba,this).clear(),M(Vn(au,this),n=>{let[,{data:{colspan:i}}]=n;for(let r=e;r<e+i;r++)Vn(Ba,this).set(r,e);e+=i})}buildTree(){this.clear();const e=Vn(lu,this).getColumnsCount();let n=0;for(;n<e;){const i=Vn(lu,this).getHeaderSettings(0,n),r=new rp;Vn(au,this).set(n,r),this.buildLeaves(r,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Vn(lu,this).getHeadersSettings(i,n,r);i+=1,M(o,s=>{const a=Cn(Me({},s),{headerLevel:i-1,columnIndex:n});let l;i===1?(e.data=a,l=e):(l=new rp(a),e.addChild(l)),i<Vn(lu,this).getLayersCount()&&this.buildLeaves(l,n,i,s.origColspan),n+=s.origColspan})}clear(){Vn(au,this).clear(),Vn(Ba,this).clear()}}function ID(t,e){t.walkDown(n=>{let{data:i,childs:r}=n;if(!i.isHidden&&(e(i.columnIndex),r.length===0))for(let o=1;o<i.colspan;o++)e(i.columnIndex+o)})}function op(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function sp(t){return op(t,"origColspan")===t.data.origColspan}function tE(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(sp(t))return tE(n[0]);e.isCollapsed=!1;const r=n.slice(1),o=new Set;let s=0;if(r.length>0)M(r,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null,s+=a.data.colspan,ID(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):sp(a)&&(l.isCollapsed=op(a,"isCollapsed"))}),{rollbackModification:()=>nE(t),affectedColumns:Array.from(o),colspanCompensation:s}}function nE(t){var e;const{data:n,childs:i}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(sp(t))return nE(i[0]);n.isCollapsed=!0;const o=i.slice(1),s=new Set;if(o.length>0)M(o,l=>{ID(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=op(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):sp(l)&&(u.isCollapsed=op(l,"isCollapsed"))}),{rollbackModification:()=>tE(t),affectedColumns:Array.from(s),colspanCompensation:a}}function Wde(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(tt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:o}}=r;if(o)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:o}=r;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function Bde(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(tt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:o}}=r;if(o)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:o}=r;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const LP=new Map([["collapse",nE],["expand",tE],["hide-column",Wde],["show-column",Bde]]);function jde(t,e,n){if(!LP.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return LP.get(t)(e,n)}function Eg(t){const e=[];return M(t,n=>{n.walkDown(i=>{const r=i.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=r,u=zde(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(SD());else{const f=Ude(r);f.isRoot=!0,u.push(f),c=!0}})}),e}function Ude(t){const i=gS(t),{crossHiddenColumns:e}=i;return $n(i,["crossHiddenColumns"])}function zde(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function WC(t,e,n){Yde(t,e),e.set(t,n)}function Yde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uh(t,e,n){return t.set(PD(t,e),n),n}function _t(t,e){return t.get(PD(t,e))}function PD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xr=new WeakMap,ni=new WeakMap,ja=new WeakMap;class Gde{constructor(){WC(this,Xr,new Hde),WC(this,ni,new Vde(_t(Xr,this))),WC(this,ja,[[]])}setState(e){_t(Xr,this).setData(e);let n=!1;try{_t(ni,this).buildTree()}catch(i){_t(ni,this).clear(),_t(Xr,this).clear(),n=!0}return uh(ja,this,Eg(_t(ni,this).getRoots())),n}setColumnsLimit(e){_t(Xr,this).setColumnsLimit(e)}mergeStateWith(e){const n=We(e,i=>{let s=i,{row:r}=s,o=$n(s,["row"]);return Me({row:r<0?this.rowCoordsToLevel(r):r},o)});_t(Xr,this).mergeWith(n),_t(ni,this).buildTree(),uh(ja,this,Eg(_t(ni,this).getRoots()))}mapState(e){_t(Xr,this).map(e),_t(ni,this).buildTree(),uh(ja,this,Eg(_t(ni,this).getRoots()))}mapNodes(e){return di(_t(ni,this).getRoots(),(n,i)=>(i.walkDown(r=>{const o=e(r.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,i){n<0&&(n=this.rowCoordsToLevel(n));const r=_t(ni,this).getNode(n,i);let o;return r&&(o=jde(e,r,i),uh(ja,this,Eg(_t(ni,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var i,r;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(r=_t(ja,this)[e])===null||r===void 0?void 0:r[n])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,n){const i=this.getHeaderTreeNode(e,n);return i?Me({},i.data):null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=_t(ni,this).getNode(e,n);return i||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=n-e+1;let r=!1,o=null;for(let s=e;s<=n;s++){const a=_t(ni,this).getRootByColumn(s);if(!a)break;r=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=i&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},RD)}return r&&o===null?-1:this.levelToRowCoords(o!=null?o:0)}findLeftMostColumnIndex(e,n){var i;const{isRoot:r}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0};if(r)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var i;const{isRoot:r,origColspan:o}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(r)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return _t(Xr,this).getLayersCount()}getColumnsCount(){return _t(Xr,this).getColumnsCount()}clear(){uh(ja,this,[]),_t(Xr,this).clear(),_t(ni,this).clear()}}function ch(t,e,n){return(e=Kde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kde(t){var e=Xde(t,"string");return typeof e=="symbol"?e:e+""}function Xde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qde{constructor(e,n){ch(this,"hot",void 0),ch(this,"nestedHeaderSettingsGetter",void 0),ch(this,"layersCount",0),ch(this,"container",void 0),ch(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),i=n.length;this.widthsMap.clear();for(let r=0;r<i;r++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:i}=this.hot,r=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=i.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=i.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let p=f.label;s&&(p+='<button class="changeType"></button>'),nc(d,p),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}r.appendChild(o),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}}var Zde=qde;function Qde(t,e){OD(t,e),e.add(t)}function kP(t,e,n){return(e=Jde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jde(t){var e=efe(t,"string");return typeof e=="symbol"?e:e+""}function efe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hh(t,e,n){OD(t,e),e.set(t,n)}function OD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function es(t,e,n){return t.set(It(t,e),n),n}function Fe(t,e){return t.get(It(t,e))}function It(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const FP="nestedHeaders",tfe=280;var ot=new WeakMap,Is=new WeakMap,zh=new WeakMap,rw=new WeakMap,ap=new WeakMap,$t=new WeakSet;class nfe extends Xe{constructor(){super(...arguments),Qde(this,$t),hh(this,ot,new Gde),hh(this,Is,null),hh(this,zh,null),hh(this,rw,!1),hh(this,ap,null),kP(this,"ghostTable",new Zde(this.hot,(e,n)=>this.getHeaderSettings(e,n))),kP(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return FP}static get PLUGIN_PRIORITY(){return tfe}isEnabled(){return!!this.hot.getSettings()[FP]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&qe(tt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>It($t,this,vfe).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return It($t,e,Cfe).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return It($t,e,sfe).call(e,...r)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return It($t,e,afe).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return It($t,e,lfe).call(e,...r)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return It($t,e,ufe).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return It($t,e,cfe).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return It($t,e,hfe).call(e,...r)}),this.addHook("afterSelection",()=>It($t,this,Tg).call(this)),this.addHook("afterSelectionFocusSet",()=>It($t,this,Tg).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return It($t,e,ife).call(e,...r)}),this.addHook("afterGetColumnHeaderRenderers",i=>It($t,this,ffe).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return It($t,e,mfe).call(e,...r)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return It($t,e,pfe).call(e,...r)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return It($t,e,rfe).call(e,...r)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return It($t,e,ofe).call(e,...r)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return It($t,e,dfe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return It($t,e,gfe).call(e,...r)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return It($t,e,wfe).call(e,...r)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>It($t,this,Tg).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>It($t,this,Tg).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Fe(ot,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Fe(ot,this).setState(e)),this.detectedOverlappedHeaders&&qe(tt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,i)=>{const r=n===!0?"hide-column":"show-column";Fe(ot,this).triggerColumnModification(r,i)}),!Fe(Is,this)&&this.enabled&&es(Is,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(i=>{let{op:r,index:o,newValue:s}=i;if(r==="replace"){const a=s===!0?"hide-column":"show-column";Fe(ot,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Fe(ot,this).clear(),Fe(Is,this).unsubscribe(),es(Is,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Fe(ot,this)}getLayersCount(){return Fe(ot,this).getLayersCount()}getHeaderSettings(e,n){return Fe(ot,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=i.childNodes[s];if(!a)break;const l=r.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),ge(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),ge(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),ge(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(r);u===null&&(u=r),o.removeAttribute("colspan"),ge(o,"hiddenHeader"),ge(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=Fe(ot,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(d||h)U(o,"hiddenHeader");else if(c>1){var p,S,y;const{wtOverlays:R}=l._wt,T=(p=R.topInlineStartCornerOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o),V=(S=R.inlineStartOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(o);((y=R.topOverlay)===null||y===void 0?void 0:y.clone.wtTable.THEAD.contains(o))&&u<i&&U(o,"hiddenHeaderText");const W=T||V?Math.min(c,i-r):c;W>1&&o.setAttribute("colspan",W)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const R=o.querySelector("div.relative");R&&f&&f.length>0&&(ge(R,this.hot.getColumnMeta(u).headerClassName),U(R,f))}}}getColumnHeaderValue(e,n){var i;const{isHidden:r,isPlaceholder:o}=(i=Fe(ot,this).getHeaderSettings(n,e))!==null&&i!==void 0?i:{};return o||r?"":this.hot.getColHeader(e,n)}destroy(){es(ot,this,null),Fe(Is,this)!==null&&(Fe(Is,this).unsubscribe(),es(Is,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Fe(ot,this).getHeaderTreeNodeData(e.row,e.col)}}function Tg(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const r=Fe(ot,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=r,o.visualCellRange.from.col=r,o.visualCellRange.to.col=r,o.commit()}}function ife(t,e){var n;const i=this.hot.getSelectedRangeLast();if(!i)return t;const{highlight:r}=i,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?r.row:(n=Fe(ap,this))===null||n===void 0?void 0:n.row,l=s?t:r.col,u=a<0&&l>=0;if(es(ap,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=Fe(ot,this).findLeftMostColumnIndex(a,l),p=Fe(ot,this).findRightMostColumnIndex(a,l),S=p-f+1;if(f<c&&p>h)return f;if(s){let y=null;return f>=c&&p>h?S>d?(e.value="start",y=f):(e.value="end",y=p):f<c&&p<=h&&(S>d?(e.value="end",y=p):(e.value="start",y=f)),y}return f<=c?f:p}function rfe(t,e,n){const i=Fe(ot,this).getHeaderTreeNodeData(e,t);if(!i)return t;const{columnCursor:r,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=Fe(ot,this).getHeaderSettings(e,t);if(o===xb){if(!a)return i.columnIndex}else if(o===IH&&(l>s-r||!a))return null;return t}function ofe(t,e,n){let{columnHeadersCount:i}=n;if(i!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var r;const p=c+f,S=d-a;if(S===0)continue;((r=Fe(ot,this).getHeaderTreeNodeData(f,d))===null||r===void 0?void 0:r.isRoot)===!1&&(t[p][S]="")}}}function sfe(t,e,n,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function afe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;es(zh,this,e.clone()),es(rw,this,!0);const{selection:i}=this.hot,r=i.isSelected()?i.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!i.inInSelection(e);t.shiftKey&&r?e.col<r.from.col?o.push(r.getTopEndCorner().col,s,e.row):e.col>r.from.col?o.push(r.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(pb(t)||ul(t)&&l||Y3(t))&&o.push(s,s+a-1,e.row),i.selectColumns(...o)}function lfe(t,e,n,i){if(!this.hot.view.isMouseDown()||i.column)return;const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;const{columnIndex:o,origColspan:s}=r,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;i.column=!0,i.cell=!0;const h=[],d=Ue(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function ufe(){es(rw,this,!1)}function cfe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Fe(rw,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:r,origColspan:o}=Fe(ot,this).getHeaderTreeNodeData(Fe(zh,this).row,Fe(zh,this).col);if(e.setHighlight(Fe(zh,this)),o>e.getWidth()||r<n||r+o-1>i){const s=Fe(ot,this).findTopMostEntireHeaderLevel(Ue(n,r,r+o-1),Ue(i,r,r+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function hfe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const r=Fe(ot,this).findLeftMostColumnIndex(n.row,n.col),o=Fe(ot,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=r&&e.col<=o?r-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=r&&e.col<=o?o+1:r,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function dfe(t,e,n){const i=t.row,r=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});es(ap,this,n.clone()),e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function ffe(t){if(Fe(ot,this).getLayersCount()>0){t.length=0;for(let e=0;e<Fe(ot,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function gfe(t){const e=Fe(ot,this).getLayersCount();let n=t.startColumn,i=!!e;for(let r=0;r<e;r++){const o=Fe(ot,this).findLeftMostColumnIndex(r,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(i=!1),Yn(s)&&s<t.startColumn){n=s;break}}t.startColumn=i?Fe(ot,this).getHeaderTreeNodeData(0,n).columnIndex:n}function mfe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function pfe(t,e,n){var i;const{label:r}=(i=Fe(ot,this).getHeaderTreeNodeData(n,e))!==null&&i!==void 0?i:{label:""};return r}function wfe(t,e){if(t<0)return this.hot.getCell(t,Fe(ot,this).findLeftMostColumnIndex(t,e),!0)}function vfe(){this.updatePlugin()}function Cfe(t,e){e||this.updatePlugin()}function dh(t,e,n){return(e=yfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yfe(t){var e=Sfe(t,"string");return typeof e=="symbol"?e:e+""}function Sfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bfe{constructor(e,n){dh(this,"hot",void 0),dh(this,"data",null),dh(this,"plugin",void 0),dh(this,"parentReference",new WeakMap),dh(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},ce(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,i){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&M(e.__children,r=>{this.cacheNode(r,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,i,r){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),i!=null&&s===i?{result:a,end:!0}:r!=null&&a===r?{result:s,end:!0}:(s+=1,a.__children&&M(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,i,r),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ae(this.data[0],(n,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(M(i.__children,r=>{n+=1,r.__children&&(n+=this.countChildren(r))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var i;return((i=e.__children)===null||i===void 0?void 0:i[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let i=n;this.hot.runHooks("beforeAddChild",e,i);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),i||(i=this.mockNode()),o.__children.push(i),this.rewriteCache();const s=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,n,i){let r=i,o;if(r||(r=this.mockNode()),this.hot.runHooks("beforeAddChild",e,r,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,r),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);r=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,r,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),r=this.getRowParent(i),o=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(r,o+1,null);break;case"above":this.addChildAtIndex(r,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const r=[];Array.isArray(e)?(ce(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);r.push(this.getDataObject(f))}),ce(0,r.length-2,d=>{this.detachFromParent(r[d],!1)}),i=r[r.length-1]):i=e;const o=this.getRowIndex(i),s=this.countChildren(i),a=this.getRowIndexWithinParent(i),l=this.getRowParent(i),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,i),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),p=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",p+1,s+1,this.plugin.pluginName),u.__children.push(i)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,i,this.getRowIndex(i)),n&&this.hot.render()}filterData(e,n,i){const r=[];M(i,o=>{r.push(this.getDataObject(o))}),M(r,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,i){const r=this.getDataObject(e-1);let o=null,s=e;r&&r.__children&&r.__children.length===0?(o=r,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?i?o.__children.splice(s,n,...i):o.__children.splice(s,n):i?this.data.splice(s,n,...i):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,i=null;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,i,r){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||i||r?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}var Rfe=bfe;function VP(t,e,n){return(e=Efe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Efe(t){var e=Tfe(t,"string");return typeof e=="symbol"?e:e+""}function Tfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mfe{constructor(e,n){VP(this,"hot",void 0),VP(this,"plugin",void 0),this.hot=n,this.plugin=e}}var iE=Mfe;class zo extends iE{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const i=this.hot.toPhysicalRow(e),r=this.dataManager.getRowLevel(i),o=this.dataManager.getDataObject(i),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(M(l,c=>{c&&s.removeChild(c)}),U(n,zo.CSS_CLASSES.indicatorContainer),r){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",ce(0,r-1,()=>{const d=c.createElement("SPAN");U(d,zo.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&ve(c,[Js()]),U(n,zo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(U(c,`${zo.CSS_CLASSES.button} ${zo.CSS_CLASSES.expandButton}`),u&&ve(n,[Yi(!1)])):(U(c,`${zo.CSS_CLASSES.button} ${zo.CSS_CLASSES.collapseButton}`),u&&ve(n,[Yi(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const i=this.hot.view.getStylesHandler();let r=11;i.isClassicTheme()||(r=i.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,r+10*n+25),this.hot.render()}}var xD=zo;class _fe extends iE{constructor(e,n){var i;super(e,n),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,r)},shiftStash:function(r,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),M(i.lastCollapsedRows,(a,l)=>{a>=r&&a<o&&(i.lastCollapsedRows[l]=a+s)})},applyStash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,r),i.lastCollapsedRows=void 0},trimStash:(r,o)=>{ce(r,r+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&M(o.__children,l=>{r.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(r,!0,!1),i&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];M(e,o=>{r.push(...this.collapseChildren(o,!1,!1))}),i&&this.trimRows(r),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return M(e,o=>{r.push(o),n&&this.collapseChildRows(o,r)}),i&&this.trimRows(r),r}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);M(r.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}i&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return M(e,o=>{r.push(o),n&&this.expandChildRows(o,r)}),i&&this.untrimRows(r),r}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);M(r.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}i&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&M(o.__children,l=>{const u=this.dataManager.getRowIndex(l);r.push(u)}),a=this.expandRows(r,!0,!1),i&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];M(e,o=>{r.push(...this.expandChildren(o,!1,!1))}),i&&this.untrimRows(r),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];M(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];M(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{M(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{M(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&M(n.__children,r=>{const o=this.dataManager.getRowIndex(r);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return i=!1,!1}),i}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const i=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const i=this.translateTrimmedRow(n.row);pe(e.target,xD.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),Ir(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}var Ife=_fe;function Pfe(t,e,n){Ofe(t,e),e.set(t,n)}function Ofe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xfe(t,e,n){return(e=Hfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hfe(t){var e=Afe(t,"string");return typeof e=="symbol"?e:e+""}function Afe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nfe(t,e){return t.get(Dfe(t,e))}function Dfe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var WP=new WeakMap;class $fe extends iE{constructor(){super(...arguments),xfe(this,"dataManager",this.plugin.dataManager),Pfe(this,WP,{row_above:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(OR)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),r=this.dataManager.getDataObject(i);this.dataManager.addChild(r)},disabled:()=>{const i=this.hot.getSelectedLast();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(xR)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const i=this.hot.getSelectedLast(),r=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(r)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return ce(0,e.items.length-1,i=>{if(i===0)return M(n,(r,o)=>{e.items.splice(i+o,0,r)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return ce(0,e.items.length-1,n=>{const i=Nfe(WP,this)[e.items[n].key];i!=null&&(e.items[n].callback=i)}),e}}var Lfe=$fe;function Mg(t,e,n){return(e=kfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kfe(t){var e=Ffe(t,"string");return typeof e=="symbol"?e:e+""}function Ffe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vfe{constructor(e){Mg(this,"plugin",void 0),Mg(this,"hot",void 0),Mg(this,"dataManager",void 0),Mg(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,i,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:i,movePossible:r}))return!1;this.movedToCollapsed=!1;const s=i===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let l=!0;const u=e.map(p=>{if(!l)return!1;const S=this.dataManager.translateTrimmedRow(p);return l=this.shouldAllowMoving(S,a),S}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,i,r,r&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:i,dropIndex:r,movePossible:o}=e;let s=!1;return Tt(r)&&(qe(tt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,i,r,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let i=this.dataManager.getRowParent(e?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}shiftCollapsibleParentsLocations(e,n,i){i||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,i){const r=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,r)})})}moveCellsMeta(e,n){const i=[],r=Math.max(...e)<n;e.forEach(o=>{i.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(r?i.length:0),0,...i)}selectCells(e,n){const i=e.length;let r=0,o=0;if(this.movedToCollapsed){let s=null;e[i-1]<n?s=this.dataManager.translateTrimmedRow(n-i):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);r=this.dataManager.untranslateTrimmedRow(l),o=r}else e[i-1]<n?(o=n-1,r=o-i+1):(r=n,o=r+i-1);this.hot.selectCells([[r,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}}function Wfe(t,e){HD(t,e),e.add(t)}function BP(t,e,n){HD(t,e),e.set(t,n)}function HD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BC(t,e,n){return(e=Bfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bfe(t){var e=jfe(t,"string");return typeof e=="symbol"?e:e+""}function jfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lm(t,e){return t.get(ln(t,e))}function lp(t,e,n){return t.set(ln(t,e),n),n}function ln(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const up="nestedRows",Ufe=300,jP=up,zfe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var ow=new WeakMap,uu=new WeakMap,mn=new WeakSet;class Yfe extends Xe{constructor(){super(...arguments),Wfe(this,mn),BC(this,"dataManager",null),BC(this,"headersUI",null),BC(this,"collapsedRowsMap",null),BP(this,ow,!1),BP(this,uu,!1)}static get PLUGIN_KEY(){return up}static get PLUGIN_PRIORITY(){return Ufe}isEnabled(){return!!this.hot.getSettings()[up]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Od),this.dataManager=new Rfe(this,this.hot),this.collapsingUI=new Ife(this,this.hot),this.headersUI=new xD(this,this.hot),this.contextMenuUI=new Lfe(this,this.hot),this.rowMoveController=new Vfe(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ln(mn,e,sge).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ln(mn,e,age).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ln(mn,e,Xfe).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ln(mn,e,qfe).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ln(mn,e,Zfe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ln(mn,e,Kfe).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ln(mn,e,ege).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ln(mn,e,Jfe).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ln(mn,e,tge).call(e,...i)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ln(mn,e,nge).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ln(mn,e,ige).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ln(mn,e,rge).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ln(mn,e,Qfe).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ln(mn,e,oge).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ln(mn,e,Gfe).call(e,...i)}),this.addHook("beforeLoadData",n=>ln(mn,this,UP).call(this,n)),this.addHook("beforeUpdateData",n=>ln(mn,this,UP).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:jP,relativeToGroup:na,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jP)}disableCoreAPIModifiers(){lp(uu,this,!0)}enableCoreAPIModifiers(){lp(uu,this,!1)}onModifyRowData(e){if(!lm(uu,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!lm(uu,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,i){return lm(uu,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,i),!1)}destroy(){super.destroy()}}function Gfe(t,e,n,i){return this.rowMoveController.onBeforeRowMove(t,e,n,i)}function Kfe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Xfe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),lp(ow,this,!0),this.dataManager.getData().slice()}function qfe(t){return this.contextMenuUI.appendOptions(t)}function Zfe(t,e){this.headersUI.appendLevelIndicators(t,e)}function Qfe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Jfe(t,e,n,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{lp(ow,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function ege(t,e,n){const i=Array.from(n.reduce((r,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return r.add(o),Array.isArray(s)&&s.forEach(a=>r.add(this.dataManager.getRowIndex(a))),r}return r.add(o)},new Set));n.length=0,n.push(...i)}function tge(){this.collapsingUI.collapsedRowsStash.stash()}function nge(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function ige(){this.collapsingUI.collapsedRowsStash.stash()}function rge(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function oge(){this.dataManager.rewriteCache()}function sge(){this.headersUI.updateRowHeaderWidth()}function age(t,e){lm(ow,this)&&(e.skipRender=!0)}function UP(t){if(!k5(t)){wb(zfe),this.hot.getSettings()[up]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function jC(t,e,n){return(e=lge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lge(t){var e=uge(t,"string");return typeof e=="symbol"?e:e+""}function uge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cge{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;jC(this,"rootWindow",void 0),jC(this,"prefix",void 0),jC(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const i=typeof e=="undefined"?n:e,r=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return r===null?void 0:JSON.parse(r)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){M(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}var hge=cge;function dge(t,e,n){return(e=fge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fge(t){var e=gge(t,"string");return typeof e=="symbol"?e:e+""}function gge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ee.getSingleton().register("persistentStateSave");ee.getSingleton().register("persistentStateLoad");ee.getSingleton().register("persistentStateReset");const zP="persistentState",mge=0;class pge extends Xe{constructor(){super(...arguments),dge(this,"storage",void 0)}static get PLUGIN_KEY(){return zP}static get PLUGIN_PRIORITY(){return mge}isEnabled(){return!!this.hot.getSettings()[zP]}enablePlugin(){this.enabled||(this.storage||(this.storage=new hge(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e=="undefined"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function wge(t,e){vge(t,e),e.add(t)}function vge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UC(t,e,n){return(e=Cge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cge(t){var e=yge(t,"string");return typeof e=="symbol"?e:e+""}function yge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YP(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zC="search",Sge=190,bge="htSearchResult",Rge=function(t,e,n,i,r){t.getCellMeta(e,n).isSearchResult=r},Ege=function(t,e,n){return Tt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Tt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var YC=new WeakSet;class Tge extends Xe{constructor(){super(...arguments),wge(this,YC),UC(this,"callback",Rge),UC(this,"queryMethod",Ege),UC(this,"searchResultClass",bge)}static get PLUGIN_KEY(){return zC}static get PLUGIN_PRIORITY(){return Sge}isEnabled(){return this.hot.getSettings()[zC]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[zC];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return YP(YC,e,GP).call(e,...r)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return YP(YC,e,GP).call(e,...r)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const r=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return ce(0,r-1,l=>{ce(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,p=(h.search.queryMethod||i)(e,c,h);if(p){const S={row:l,col:u,data:c};s.push(S)}d&&d(a,l,u,c,p)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){He(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function GP(t,e,n,i,r,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function _g(t,e,n){return(e=Mge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mge(t){var e=_ge(t,"string");return typeof e=="symbol"?e:e+""}function _ge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AD{constructor(e){_g(this,"viewportWidth",void 0),_g(this,"overwriteColumnWidthFn",void 0),_g(this,"baseWidths",new Map),_g(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class Ige extends AD{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const i=this.viewportWidth/e,r=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*i),p=this.overwriteColumnWidthFn(f,d);f===p&&f>=Wu?(r.push([d,p]),a+=p):f!==p&&(r.push([d,p]),o.push(d),s-=p)}),s<=Wu){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;r.forEach((h,d)=>{let[f,p]=h,S=p;o.includes(f)||(S=Math.round(p*l)),this.stretchedWidths.set(f,S),u=f,d<r.length-1&&(c+=S)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function KP(t,e,n){Pge(t,e),e.set(t,n)}function Pge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GC(t,e){return t.get(ND(t,e))}function Ig(t,e,n){return t.set(ND(t,e),n),n}function ND(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Pg=new WeakMap,fh=new WeakMap;class Oge extends AD{constructor(){super(...arguments),KP(this,Pg,0),KP(this,fh,-1)}prepare(e){super.prepare(e),Ig(Pg,this,0),Ig(fh,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),Ig(fh,this,e),Ig(Pg,this,n)}calculate(){if(GC(fh,this)===-1)return;const e=Array.from(this.baseWidths).reduce((i,r)=>{let[,o]=r;return i+o},0),n=Math.max(this.viewportWidth-e+GC(Pg,this),0);this.stretchedWidths.set(GC(fh,this),n)}}function xge(t,e){DD(t,e),e.add(t)}function Og(t,e,n){DD(t,e),e.set(t,n)}function DD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lt(t,e){return t.get(Iu(t,e))}function KC(t,e,n){return t.set(Iu(t,e),n),n}function Iu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Hge="stretchColumns";var Pn=new WeakMap,cu=new WeakMap,XC=new WeakMap,xg=new WeakMap,gh=new WeakSet;class Age{constructor(e){xge(this,gh),Og(this,Pn,void 0),Og(this,cu,void 0),Og(this,XC,new Map([["all",new Ige(Iu(gh,this,XP).bind(this))],["last",new Oge(Iu(gh,this,XP).bind(this))]])),Og(this,xg,"none"),KC(Pn,this,e),KC(cu,this,Lt(Pn,this).columnIndexMapper.createAndRegisterIndexMap(Hge,"physicalIndexToValue"))}useStrategy(e){KC(xg,this,Lt(XC,this).has(e)?e:"none")}refreshStretching(){if(Lt(xg,this)==="none"){Lt(cu,this).clear();return}Lt(Pn,this).batchExecution(()=>{Lt(cu,this).clear();const e=Lt(XC,this).get(Lt(xg,this));let i=Lt(Pn,this).view.getViewportWidth();Iu(gh,this,Nge).call(this)&&(i-=wn(Lt(Pn,this).rootDocument)),e.prepare({viewportWidth:i});for(let r=0;r<Lt(Pn,this).countCols();r++)Lt(Pn,this).columnIndexMapper.isHidden(Lt(Pn,this).toPhysicalColumn(r))||e.setColumnBaseWidth(r,Iu(gh,this,Dge).call(this,r));e.calculate(),e.getWidths().forEach(r=>{let[o,s]=r;Lt(cu,this).setValueAtIndex(Lt(Pn,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return Lt(cu,this).getValueAtIndex(Lt(Pn,this).toPhysicalColumn(e))}}function Nge(){const{view:t}=Lt(Pn,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=Lt(Pn,this).countRows(),i=t.getStylesHandler().getDefaultRowHeight();let r=0,o=!1;for(let a=0;a<n;a++){var s;if(r+=((s=Lt(Pn,this).getRowHeight(a))!==null&&s!==void 0?s:i)+(a===0?1:0),r>e){o=!0;break}}return o}function Dge(t){var e;return(e=Lt(Pn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:Wu}function XP(t,e){return Lt(Pn,this).runHooks("beforeStretchingColumnWidth",t,e)}function $ge(t,e){$D(t,e),e.add(t)}function qC(t,e,n){$D(t,e),e.set(t,n)}function $D(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZC(t,e,n){return t.set(cp(t,e),n),n}function Vo(t,e){return t.get(cp(t,e))}function cp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Lge="stretchColumns",kge=155;var yu=new WeakMap,Hg=new WeakMap,mh=new WeakMap,QC=new WeakSet;class Fge extends Xe{constructor(){super(...arguments),$ge(this,QC),qC(this,yu,new Age(this.hot)),qC(this,Hg,null),qC(this,mh,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;!((n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow())||e.forEach(i=>{let{contentRect:r}=i;Vo(Hg,this)!==null&&Vo(Hg,this)!==r.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),ZC(Hg,this,r.width)})})}))}static get PLUGIN_KEY(){return Lge}static get PLUGIN_PRIORITY(){return kge}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Vo(yu,this).useStrategy(this.hot.getSettings().stretchH),Vo(mh,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return cp(QC,e,Wge).call(e,...i)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return cp(QC,e,Vge).call(e,...i)},10),super.enablePlugin())}updatePlugin(){Vo(yu,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Vo(mh,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Vo(yu,this).getStretchedWidth(e)}destroy(){Vo(mh,this).disconnect(),ZC(mh,this,null),ZC(yu,this,null),super.destroy()}}function Vge(t,e,n){if(n===this.pluginName)return;const i=this.getColumnWidth(e);return typeof i=="number"?i:t}function Wge(t){t&&Vo(yu,this).refreshStretching()}function Bge(t,e){jge(t,e),e.add(t)}function jge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ag(t,e,n){return(e=Uge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uge(t){var e=zge(t,"string");return typeof e=="symbol"?e:e+""}function zge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Yge="touchScroll",Gge=200;var Ng=new WeakSet;class Kge extends Xe{constructor(){super(...arguments),Bge(this,Ng),Ag(this,"scrollbars",[]),Ag(this,"clones",[]),Ag(this,"lockedCollection",!1),Ag(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Yge}static get PLUGIN_PRIORITY(){return Gge}static get SETTING_KEYS(){return!0}isEnabled(){return Y1()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>JC(Ng,this,Xge).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>JC(Ng,this,qge).call(this)),this.addHook("afterMomentumScroll",()=>JC(Ng,this,Zge).call(this))}}function Xge(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),i&&this.scrollbars.push(i),r&&r.clone&&this.scrollbars.push(r),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&r.clone&&this.clones.push(r.clone.wtTable.holder.parentNode)}function qge(){this.freezeOverlays=!0,M(this.clones,t=>{U(t,"hide-tween")})}function Zge(){this.freezeOverlays=!1,M(this.clones,t=>{ge(t,"hide-tween"),U(t,"show-tween")}),this.hot._registerTimeout(()=>{M(this.clones,t=>{ge(t,"show-tween")})},400),M(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Qge(t,e){Jge(t,e),e.add(t)}function Jge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eme(t,e,n){return(e=tme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tme(t){var e=nme(t,"string");return typeof e=="symbol"?e:e+""}function nme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ime(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const um="trimRows",rme=330;var qP=new WeakSet;class ome extends Xe{constructor(){super(...arguments),Qge(this,qP),eme(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return um}static get PLUGIN_PRIORITY(){return rme}isEnabled(){return!!this.hot.getSettings()[um]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Od),this.trimmedRowsMap.addLocalHook("init",()=>ime(qP,this,sme).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[um];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),M(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{M(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,r,i,i&&r.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;i&&s&&(M(e,l=>{o[l]=!1}),r=di(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,r,i&&s)!==!1&&(i&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,r,i&&s,i&&r.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<n)}destroy(){super.destroy()}}function sme(){const t=this.hot.getSettings()[um];Array.isArray(t)&&this.hot.batchExecution(()=>{M(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function ame(t,e,n){return(e=lme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lme(t){var e=ume(t,"string");return typeof e=="symbol"?e:e+""}function ume(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qi{constructor(e){ame(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Dg(t,e,n){return(e=cme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cme(t){var e=hme(t,"string");return typeof e=="symbol"?e:e+""}function hme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rE extends Qi{constructor(e){let{stateBefore:n,range:i,type:r,alignment:o}=e;super("cell_alignment"),Dg(this,"stateBefore",void 0),Dg(this,"range",void 0),Dg(this,"type",void 0),Dg(this,"alignment",void 0),this.stateBefore=n,this.range=i,this.type=r,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(i,r,o,s)=>{n.done(()=>new rE({stateBefore:i,range:r,type:o,alignment:s}))})}undo(e,n){M(this.range,i=>{i.forAll((r,o)=>{r>=0&&o>=0&&e.setCellMeta(r,o,"className",this.stateBefore[r][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){Os(this.range,this.type,this.alignment,(i,r)=>e.getCellMeta(i,r),(i,r,o,s)=>e.setCellMeta(i,r,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function ZP(t,e,n){return(e=dme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dme(t){var e=fme(t,"string");return typeof e=="symbol"?e:e+""}function fme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oE extends Qi{constructor(e){let{columns:n,finalIndex:i}=e;super("col_move"),ZP(this,"columns",void 0),ZP(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(i,r)=>{i!==!1&&n.done(()=>new oE({columns:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),Q0(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),i.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),i.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function QP(t,e,n){return(e=gme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gme(t){var e=mme(t,"string");return typeof e=="symbol"?e:e+""}function mme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sE extends Qi{constructor(e){let{currentSortState:n,newSortState:i}=e;super("col_sort"),QP(this,"previousSortState",void 0),QP(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(i,r,o)=>{!o||n.done(()=>new sE({currentSortState:i,newSortState:r}))})}undo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting"),o=r.isEnabled()?r:i;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting");(r.isEnabled()?r:i).sort(this.nextSortState),n()}}function JP(t,e,n){return(e=pme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pme(t){var e=wme(t,"string");return typeof e=="symbol"?e:e+""}function wme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aE extends Qi{constructor(e){let{index:n,amount:i}=e;super("insert_col"),JP(this,"index",void 0),JP(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(i,r,o)=>{n.done(()=>new aE({index:i,amount:r}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function eO(t,e,n){return(e=vme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vme(t){var e=Cme(t,"string");return typeof e=="symbol"?e:e+""}function Cme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lE extends Qi{constructor(e){let{index:n,amount:i}=e;super("insert_row"),eO(this,"index",void 0),eO(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(i,r,o)=>{n.done(()=>new lE({index:i,amount:r}),o)})}undo(e,n){const i=e.countRows(),r=e.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function $g(t,e,n){return(e=yme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yme(t){var e=Sme(t,"string");return typeof e=="symbol"?e:e+""}function Sme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uE extends Qi{constructor(e){let{changes:n,selected:i,countCols:r,countRows:o}=e;super("change"),$g(this,"changes",void 0),$g(this,"selected",void 0),$g(this,"countCols",void 0),$g(this,"countRows",void 0),this.changes=n,this.selected=i,this.countCols=r,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(i,r){const o=i&&i.length;if(!o||!i.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=i.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new uE({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,r)})}undo(e,n){const i=Xn(this.changes);for(let s=0,a=i.length;s<a;s++)i[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(i,null,null,"UndoRedo.undo");const r=e.countRows()-this.countRows;r>0&&e.alter("remove_row",null,r,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const i=Xn(this.changes);for(let r=0,o=i.length;r<o;r++)i[r].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(i,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function tO(t,e,n){return(e=bme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bme(t){var e=Rme(t,"string");return typeof e=="symbol"?e:e+""}function Rme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cE extends Qi{constructor(e){let{conditionsStack:n,previousConditionsStack:i}=e;super("filter"),tO(this,"conditionsStack",void 0),tO(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=i}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(i,r)=>{n.done(()=>new cE({conditionsStack:i,previousConditionsStack:r}))})}undo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.importConditions(this.previousConditionsStack),i.filter()}redo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.importConditions(this.conditionsStack),i.filter()}}function Eme(t,e,n){return(e=Tme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tme(t){var e=Mme(t,"string");return typeof e=="symbol"?e:e+""}function Mme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hE extends Qi{constructor(e){let{data:n,cellRange:i}=e;super("merge_cells"),Eme(this,"cellRange",void 0),this.cellRange=i,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(i,r)=>{if(r)return;const o=i.getTopStartCorner(),s=i.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new hE({data:a,cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0);const r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange)}}var _me=dt,Ime=Zu,Pme=XO;_me({target:"Object",stat:!0},{fromEntries:function(e){var n={};return Ime(e,function(i,r){Pme(n,i,r)},{AS_ENTRIES:!0}),n}});function LD(t,e,n,i,r){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return ce(i,r,l=>{ce(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Do(t,e,n){return(e=Ome(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ome(t){var e=xme(t,"string");return typeof e=="symbol"?e:e+""}function xme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dE extends Qi{constructor(e){let{index:n,indexes:i,data:r,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Do(this,"index",void 0),Do(this,"indexes",void 0),Do(this,"data",void 0),Do(this,"amount",void 0),Do(this,"headers",void 0),Do(this,"columnPositions",void 0),Do(this,"rowPositions",void 0),Do(this,"fixedColumnsStart",void 0),Do(this,"removedCellMetas",void 0),this.index=n,this.indexes=i,this.data=r,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(i,r,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+i)%e.countCols(),c=u+r-1,h=[],d=[],f=[];ce(l.length-1,y=>{const R=[],T=l[y];ce(u,c,V=>{R.push(T[e.toPhysicalColumn(V)])}),h.push(R)}),ce(r-1,y=>{f.push(e.toPhysicalColumn(u+y))}),Array.isArray(e.getSettings().colHeaders)&&ce(r-1,y=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+y)]||null)});const p=e.columnIndexMapper.getIndexesSequence(),S=e.rowIndexMapper.getIndexesSequence();return new dE({index:u,indexes:f,data:h,amount:r,headers:d,columnPositions:p,rowPositions:S,fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:LD(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const i=e.getSettings();i.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(r[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(We(this.data[c],o));const l=We(this.headers,o),u=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),M(e.getSourceDataArray(),(c,h)=>{M(r,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),e.setSourceDataAtCell(u,void 0,void 0,"UndoRedo.undo"),typeof this.headers!="undefined"&&M(l,(c,h)=>{e.getSettings().colHeaders[r[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function hu(t,e,n){return(e=Hme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hme(t){var e=Ame(t,"string");return typeof e=="symbol"?e:e+""}function Ame(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fE extends Qi{constructor(e){let{index:n,data:i,fixedRowsBottom:r,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),hu(this,"index",void 0),hu(this,"data",void 0),hu(this,"fixedRowsBottom",void 0),hu(this,"fixedRowsTop",void 0),hu(this,"rowIndexesSequence",void 0),hu(this,"removedCellMetas",void 0),this.index=n,this.data=i,this.fixedRowsBottom=r,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(i,r,o,s)=>{const a=()=>{const l=e.toPhysicalRow(i),u=l+r-1,c=Xn(e.getSourceData(l,0,l+r-1,e.countSourceCols()-1));return new fE({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:LD(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const i=e.getSettings(),r=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);r.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")}}function nO(t,e,n){return(e=Nme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nme(t){var e=Dme(t,"string");return typeof e=="symbol"?e:e+""}function Dme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gE extends Qi{constructor(e){let{rows:n,finalIndex:i}=e;super("row_move"),nO(this,"rows",void 0),nO(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(i,r)=>{i!==!1&&n.done(()=>new gE({rows:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),Q0(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),i.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),i.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function $me(t,e,n){return(e=Lme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lme(t){var e=kme(t,"string");return typeof e=="symbol"?e:e+""}function kme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mE extends Qi{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),$me(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(i,r)=>{r||n.done(()=>new mE({cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange,!0)}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0),e.render()}}function Fme(t,e){[rE,oE,sE,aE,lE,uE,cE,hE,dE,fE,gE,mE].forEach(n=>n.startRegisteringEvents(t,e))}function Vme(t,e){Wme(t,e),e.add(t)}function Wme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ey(t,e,n){return(e=Bme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bme(t){var e=jme(t,"string");return typeof e=="symbol"?e:e+""}function jme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ty(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const iO="undoRedo",Ume="undoRedo",zme=1e3;ee.getSingleton().register("beforeUndo");ee.getSingleton().register("afterUndo");ee.getSingleton().register("beforeRedo");ee.getSingleton().register("afterRedo");const rO=new Set;var Lg=new WeakSet;class Yme extends Xe{static get PLUGIN_KEY(){return Ume}static get PLUGIN_PRIORITY(){return zme}static get SETTING_KEYS(){return!0}constructor(e){super(e),Vme(this,Lg),ey(this,"doneActions",[]),ey(this,"undoneActions",[]),ey(this,"ignoreNewActions",!1),Fme(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ty(Lg,e,Gme).call(e,...i)}),this.registerShortcuts(),ty(Lg,this,Kme).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),ty(Lg,this,Xme).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),r={runOnlyIf:o=>!o.altKey,group:iO};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(iO)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const r=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",r,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const i=Xn(n);if(this.hot.runHooks("beforeUndo",i)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",i)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const i=Xn(n);if(this.hot.runHooks("beforeRedo",i)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",i)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function Gme(t,e){e==="loadData"&&this.clear()}function Kme(){const t=e=>{rO.has(e)||(qe(tt`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),rO.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function Xme(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function qme(){ze(xh),ze(Pte),ze(Hh),ze(cne),ze(vne),ze(rN),ze(gie),ze(ere),ze(Jp),ze(coe),ze($oe),ze(Uoe),ze(nw),ze(Sse),ze(vle),ze(Qle),ze(Tue),ze(Lue),ze(Xue),ze(uce),ze(Cce),ze(Vce),ze(Xce),ze(zhe),ze(Ede),ze(Pde),ze(nfe),ze(Yfe),ze(pge),ze(Tge),ze(Fge),ze(Kge),ze(ome),ze(Yme)}function Zme(){QQ(),See(),Oee(),qee(),qme()}Zme();const Qme=mS({data(){return{data:[["","Ford","Volvo","Toyota","Honda"],["2016",10,11,12,13],["2017",20,11,14,13],["2018",30,15,12,13]]}},components:{HotTable:p0}}),Jme={class:"ht-theme-main-dark-auto"};function epe(t,e,n,i,r,o){const s=ZD("hot-table");return oO(),sO("div",Jme,[qD(s,{data:t.data,rowHeaders:!0,colHeaders:!0},null,8,["data"])])}var fpe=XD(Qme,[["render",epe]]);export{fpe as default};
//# sourceMappingURL=index.294f3899.js.map

import{_ as Xe}from"./plugin-vue_export-helper-DlAUqK2U.js";import{h as Ze,f as Ke,c as Je,a as Ge,o as Qe}from"../index-C51a6HNj.js";class Z{constructor(t,e=""){typeof t=="string"?(this.el=document.createElement(t),this.el.className=e):this.el=t,this.data={}}data(t,e){return e!==void 0?(this.data[t]=e,this):this.data[t]}on(t,e){const[s,...i]=t.split(".");let n=s;return n==="mousewheel"&&/Firefox/i.test(window.navigator.userAgent)&&(n="DOMMouseScroll"),this.el.addEventListener(n,r=>{e(r);for(let o=0;o<i.length;o+=1){const c=i[o];if(c==="left"&&r.button!==0||c==="right"&&r.button!==2)return;c==="stop"&&r.stopPropagation()}}),this}offset(t){if(t!==void 0)return Object.keys(t).forEach(r=>{this.css(r,`${t[r]}px`)}),this;const{offsetTop:e,offsetLeft:s,offsetHeight:i,offsetWidth:n}=this.el;return{top:e,left:s,height:i,width:n}}scroll(t){const{el:e}=this;return t!==void 0&&(t.left!==void 0&&(e.scrollLeft=t.left),t.top!==void 0&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}box(){return this.el.getBoundingClientRect()}parent(){return new Z(this.el.parentNode)}children(...t){return arguments.length===0?this.el.childNodes:(t.forEach(e=>this.child(e)),this)}removeChild(t){this.el.removeChild(t)}child(t){let e=t;return typeof t=="string"?e=document.createTextNode(t):t instanceof Z&&(e=t.el),this.el.appendChild(e),this}contains(t){return this.el.contains(t)}className(t){return t!==void 0?(this.el.className=t,this):this.el.className}addClass(t){return this.el.classList.add(t),this}hasClass(t){return this.el.classList.contains(t)}removeClass(t){return this.el.classList.remove(t),this}toggle(t="active"){return this.toggleClass(t)}toggleClass(t){return this.el.classList.toggle(t)}active(t=!0,e="active"){return t?this.addClass(e):this.removeClass(e),this}checked(t=!0){return this.active(t,"checked"),this}disabled(t=!0){return t?this.addClass("disabled"):this.removeClass("disabled"),this}attr(t,e){if(e!==void 0)this.el.setAttribute(t,e);else{if(typeof t=="string")return this.el.getAttribute(t);Object.keys(t).forEach(s=>{this.el.setAttribute(s,t[s])})}return this}removeAttr(t){return this.el.removeAttribute(t),this}html(t){return t!==void 0?(this.el.innerHTML=t,this):this.el.innerHTML}val(t){return t!==void 0?(this.el.value=t,this):this.el.value}focus(){this.el.focus()}cssRemoveKeys(...t){return t.forEach(e=>this.el.style.removeProperty(e)),this}css(t,e){return e===void 0&&typeof t!="string"?(Object.keys(t).forEach(s=>{this.el.style[s]=t[s]}),this):e!==void 0?(this.el.style[t]=e,this):this.el.style[t]}computedStyle(){return window.getComputedStyle(this.el,null)}show(){return this.css("display","block"),this}hide(){return this.css("display","none"),this}}const u=(l,t="")=>new Z(l,t),q=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function Te(l){let t="",e=l;for(;e>=q.length;)e/=q.length,e-=1,t+=q[parseInt(e,10)%q.length];const s=l%q.length;return t+=q[s],t}function ts(l){let t=0;for(let e=0;e<l.length-1;e+=1){const s=l.charCodeAt(e)-65,i=l.length-1-e;t+=q.length**i+q.length*s}return t+=l.charCodeAt(l.length-1)-65,t}function L(l){let t="",e="";for(let s=0;s<l.length;s+=1)l.charAt(s)>="0"&&l.charAt(s)<="9"?e+=l.charAt(s):t+=l.charAt(s);return[ts(t),parseInt(e,10)-1]}function _(l,t){return`${Te(l)}${t+1}`}function st(l,t,e,s=()=>!0){if(t===0&&e===0)return l;const[i,n]=L(l);return s(i,n)?_(i+t,n+e):l}class ${constructor(t,e,s,i,n=0,r=0){this.sri=t,this.sci=e,this.eri=s,this.eci=i,this.w=n,this.h=r}set(t,e,s,i){this.sri=t,this.sci=e,this.eri=s,this.eci=i}multiple(){return this.eri-this.sri>0||this.eci-this.sci>0}includes(...t){let[e,s]=[0,0];t.length===1?[s,e]=L(t[0]):t.length===2&&([e,s]=t);const{sri:i,sci:n,eri:r,eci:o}=this;return i<=e&&e<=r&&n<=s&&s<=o}each(t,e=()=>!0){const{sri:s,sci:i,eri:n,eci:r}=this;for(let o=s;o<=n;o+=1)if(e(o))for(let c=i;c<=r;c+=1)t(o,c)}contains(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}within(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}disjoint(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}intersects(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}union(t){const{sri:e,sci:s,eri:i,eci:n}=this;return new $(t.sri<e?t.sri:e,t.sci<s?t.sci:s,t.eri>i?t.eri:i,t.eci>n?t.eci:n)}difference(t){const e=[],s=(f,g,p,w)=>{e.push(new $(f,g,p,w))},{sri:i,sci:n,eri:r,eci:o}=this,c=t.sri-i,h=t.sci-n,d=r-t.eri,a=o-t.eci;return c>0?(s(i,n,t.sri-1,o),d>0?(s(t.eri+1,n,r,o),h>0&&s(t.sri,n,t.eri,t.sci-1),a>0&&s(t.sri,t.eci+1,t.eri,o)):(h>0&&s(t.sri,n,r,t.sci-1),a>0&&s(t.sri,t.eci+1,r,o))):d>0&&(s(t.eri+1,n,r,o),h>0&&s(i,n,t.eri,t.sci-1),a>0&&s(i,t.eci+1,t.eri,o)),h>0?(s(i,n,r,t.sci-1),a>0?(s(i,t.eri+1,r,o),c>0&&s(i,t.sci,t.sri-1,t.eci),d>0&&s(t.sri+1,t.sci,r,t.eci)):(c>0&&s(i,t.sci,t.sri-1,o),d>0&&s(t.sri+1,t.sci,r,o))):a>0&&(s(r,t.eci+1,r,o),c>0&&s(i,n,t.sri-1,t.eci),d>0&&s(t.eri+1,n,r,t.eci)),e}size(){return[this.eri-this.sri+1,this.eci-this.sci+1]}toString(){const{sri:t,sci:e,eri:s,eci:i}=this;let n=_(e,t);return this.multiple()&&(n=`${n}:${_(i,s)}`),n}clone(){const{sri:t,sci:e,eri:s,eci:i,w:n,h:r}=this;return new $(t,e,s,i,n,r)}equals(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}static valueOf(t){const e=t.split(":"),[s,i]=L(e[0]);let[n,r]=[i,s];return e.length>1&&([r,n]=L(e[1])),new $(i,s,n,r)}}let es=class{constructor(){this.range=new $(0,0,0,0),this.ri=0,this.ci=0}multiple(){return this.range.multiple()}setIndexes(t,e){this.ri=t,this.ci=e}size(){return this.range.size()}};class ss{constructor(){this.x=0,this.y=0,this.ri=0,this.ci=0}}class is{constructor(){this.undoItems=[],this.redoItems=[]}add(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}canUndo(){return this.undoItems.length>0}canRedo(){return this.redoItems.length>0}undo(t,e){const{undoItems:s,redoItems:i}=this;this.canUndo()&&(i.push(JSON.stringify(t)),e(JSON.parse(s.pop())))}redo(t,e){const{undoItems:s,redoItems:i}=this;this.canRedo()&&(s.push(JSON.stringify(t)),e(JSON.parse(i.pop())))}}class ls{constructor(){this.range=null,this.state="clear"}copy(t){return this.range=t,this.state="copy",this}cut(t){return this.range=t,this.state="cut",this}isCopy(){return this.state==="copy"}isCut(){return this.state==="cut"}isClear(){return this.state==="clear"}clear(){this.range=null,this.state="clear"}}class Gt{constructor(t,e,s){this.ci=t,this.operator=e,this.value=s}set(t,e){this.operator=t,this.value=e}includes(t){const{operator:e,value:s}=this;return e==="all"?!0:e==="in"?s.includes(t):!1}vlength(){const{operator:t,value:e}=this;return t==="in"?e.length:0}getData(){const{ci:t,operator:e,value:s}=this;return{ci:t,operator:e,value:s}}}class Qt{constructor(t,e){this.ci=t,this.order=e}asc(){return this.order==="asc"}desc(){return this.order==="desc"}}class ns{constructor(){this.ref=null,this.filters=[],this.sort=null}setData({ref:t,filters:e,sort:s}){t!=null&&(this.ref=t,this.filters=e.map(i=>new Gt(i.ci,i.operator,i.value)),s&&(this.sort=new Qt(s.ci,s.order)))}getData(){if(this.active()){const{ref:t,filters:e,sort:s}=this;return{ref:t,filters:e.map(i=>i.getData()),sort:s}}return{}}addFilter(t,e,s){const i=this.getFilter(t);i==null?this.filters.push(new Gt(t,e,s)):i.set(e,s)}setSort(t,e){this.sort=e?new Qt(t,e):null}includes(t,e){return this.active()?this.hrange().includes(t,e):!1}getSort(t){const{sort:e}=this;return e&&e.ci===t?e:null}getFilter(t){const{filters:e}=this;for(let s=0;s<e.length;s+=1)if(e[s].ci===t)return e[s];return null}filteredRows(t){const e=new Set,s=new Set;if(this.active()){const{sri:i,eri:n}=this.range(),{filters:r}=this;for(let o=i+1;o<=n;o+=1)for(let c=0;c<r.length;c+=1){const h=r[c],d=t(o,h.ci),a=d?d.text:"";if(h.includes(a))s.add(o);else{e.add(o);break}}}return{rset:e,fset:s}}items(t,e){const s={};if(this.active()){const{sri:i,eri:n}=this.range();for(let r=i+1;r<=n;r+=1){const o=e(r,t);if(o!==null&&!/^\s*$/.test(o.text)){const c=o.text,h=(s[c]||0)+1;s[c]=h}else s[""]=(s[""]||0)+1}}return s}range(){return $.valueOf(this.ref)}hrange(){const t=this.range();return t.eri=t.sri,t}clear(){this.ref=null,this.filters=[],this.sort=null}active(){return this.ref!==null}}class Vt{constructor(t=[]){this._=t}forEach(t){this._.forEach(t)}deleteWithin(t){this._=this._.filter(e=>!e.within(t))}getFirstIncludes(t,e){for(let s=0;s<this._.length;s+=1){const i=this._[s];if(i.includes(t,e))return i}return null}filterIntersects(t){return new Vt(this._.filter(e=>e.intersects(t)))}intersects(t){for(let e=0;e<this._.length;e+=1)if(this._[e].intersects(t))return!0;return!1}union(t){let e=t;return this._.forEach(s=>{s.intersects(e)&&(e=s.union(e))}),e}add(t){this.deleteWithin(t),this._.push(t)}shift(t,e,s,i){this._.forEach(n=>{const{sri:r,sci:o,eri:c,eci:h}=n,d=n;t==="row"?r>=e?(d.sri+=s,d.eri+=s):r<e&&e<=c&&(d.eri+=s,i(r,o,s,0)):t==="column"&&(o>=e?(d.sci+=s,d.eci+=s):o<e&&e<=h&&(d.eci+=s,i(r,o,0,s)))})}move(t,e,s){this._.forEach(i=>{const n=i;n.within(t)&&(n.eri+=e,n.sri+=e,n.sci+=s,n.eci+=s)})}setData(t){return this._=t.map(e=>$.valueOf(e)),this}getData(){return this._.map(t=>t.toString())}}function rs(l){return JSON.parse(JSON.stringify(l))}const De=(l={},...t)=>(t.forEach(e=>{Object.keys(e).forEach(s=>{const i=e[s];typeof i=="string"||typeof i=="number"||typeof i=="boolean"?l[s]=i:typeof i!="function"&&!Array.isArray(i)&&i instanceof Object?(l[s]=l[s]||{},De(l[s],i)):l[s]=i})}),l);function Rt(l,t){const e=Object.keys(l);if(e.length!==Object.keys(t).length)return!1;for(let s=0;s<e.length;s+=1){const i=e[s],n=l[i],r=t[i];if(r===void 0)return!1;if(typeof n=="string"||typeof n=="number"||typeof n=="boolean"){if(n!==r)return!1}else if(Array.isArray(n)){if(n.length!==r.length)return!1;for(let o=0;o<n.length;o+=1)if(!Rt(n[o],r[o]))return!1}else if(typeof n!="function"&&!Array.isArray(n)&&n instanceof Object&&!Rt(n,r))return!1}return!0}const os=(l,t=e=>e)=>{let e=0,s=0;return Object.keys(l).forEach(i=>{e+=t(l[i],i),s+=1}),[e,s]};function cs(l,t){const e=l[`${t}`];return delete l[`${t}`],e}function hs(l,t,e,s,i,n){let r=e,o=s,c=l;for(;c<t&&!(r>i);c+=1)o=n(c),r+=o;return[c,r-o,o]}function as(l,t,e){let s=0;for(let i=l;i<t;i+=1)s+=e(i);return s}function ds(l,t,e){for(let s=l;s<t;s+=1)e(s)}function fs(l,t){if(l.length===t.length){for(let e=0;e<l.length;e+=1)if(l[e]!==t[e])return!1}else return!1;return!0}function Dt(l){const t=`${l}`;let e=0,s=!1;for(let i=0;i<t.length;i+=1)s===!0&&(e+=1),t.charAt(i)==="."&&(s=!0);return e}function U(l,t,e){if(Number.isNaN(t)||Number.isNaN(e))return t+l+e;const s=Dt(t),i=Dt(e),n=Number(t),r=Number(e);let o=0;if(l==="-")o=n-r;else if(l==="+")o=n+r;else if(l==="*")o=n*r;else if(l==="/")return o=n/r,Dt(o)>5?o.toFixed(2):o;return o.toFixed(Math.max(s,i))}const O={cloneDeep:rs,merge:(...l)=>De({},...l),equals:Rt,arrayEquals:fs,sum:os,rangeEach:ds,rangeSum:as,rangeReduceIf:hs,deleteProperty:cs,numberCalc:U};class us{constructor({len:t,height:e}){this._={},this.len=t,this.height=e}getHeight(t){if(this.isHide(t))return 0;const e=this.get(t);return e&&e.height?e.height:this.height}setHeight(t,e){const s=this.getOrNew(t);s.height=e}unhide(t){let e=t;for(;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}isHide(t){const e=this.get(t);return e&&e.hide}setHide(t,e){const s=this.getOrNew(t);e===!0?s.hide=!0:delete s.hide}setStyle(t,e){const s=this.getOrNew(t);s.style=e}sumHeight(t,e,s){return O.rangeSum(t,e,i=>s&&s.has(i)?0:this.getHeight(i))}totalHeight(){return this.sumHeight(0,this.len)}get(t){return this._[t]}getOrNew(t){return this._[t]=this._[t]||{cells:{}},this._[t]}getCell(t,e){const s=this.get(t);return s!==void 0&&s.cells!==void 0&&s.cells[e]!==void 0?s.cells[e]:null}getCellMerge(t,e){const s=this.getCell(t,e);return s&&s.merge?s.merge:[0,0]}getCellOrNew(t,e){const s=this.getOrNew(t);return s.cells[e]=s.cells[e]||{},s.cells[e]}setCell(t,e,s,i="all"){const n=this.getOrNew(t);i==="all"?n.cells[e]=s:i==="text"?(n.cells[e]=n.cells[e]||{},n.cells[e].text=s.text):i==="format"&&(n.cells[e]=n.cells[e]||{},n.cells[e].style=s.style,s.merge&&(n.cells[e].merge=s.merge))}setCellText(t,e,s){const i=this.getCellOrNew(t,e);i.editable!==!1&&(i.text=s)}copyPaste(t,e,s,i=!1,n=()=>{}){const{sri:r,sci:o,eri:c,eci:h}=t,d=e.sri,a=e.sci,f=e.eri,g=e.eci,[p,w]=t.size(),[b,x]=e.size();let k=!0,v=0;(f<r||g<o)&&(k=!1,f<r?v=b:v=x);for(let y=r;y<=c;y+=1)if(this._[y]){for(let S=o;S<=h;S+=1)if(this._[y].cells&&this._[y].cells[S])for(let M=d;M<=f;M+=p)for(let R=a;R<=g;R+=w){const I=M+(y-r),ht=R+(S-o),V=O.cloneDeep(this._[y].cells[S]);if(i&&V&&V.text&&V.text.length>0){const{text:at}=V;let dt=R-a+(M-d)+2;if(k||(dt-=v+1),at[0]==="=")V.text=at.replace(/[a-zA-Z]{1,3}\d+/g,j=>{let[ft,Jt]=[0,0];return r===d?ft=dt-1:Jt=dt-1,/^\d+$/.test(j)?j:st(j,ft,Jt)});else if(p<=1&&w>1&&(d>c||f<r)||w<=1&&p>1&&(a>h||g<o)||p<=1&&w<=1){const j=/[\\.\d]+$/.exec(at);if(j!==null){const ft=Number(j[0])+dt-1;V.text=at.substring(0,j.index)+ft}}}this.setCell(I,ht,V,s),n(I,ht,V)}}}cutPaste(t,e){const s={};this.each(i=>{this.eachCells(i,n=>{let r=parseInt(i,10),o=parseInt(n,10);t.includes(i,n)&&(r=e.sri+(r-t.sri),o=e.sci+(o-t.sci)),s[r]=s[r]||{cells:{}},s[r].cells[o]=this._[i].cells[n]})}),this._=s}paste(t,e){if(t.length<=0)return;const{sri:s,sci:i}=e;t.forEach((n,r)=>{const o=s+r;n.forEach((c,h)=>{const d=i+h;this.setCellText(o,d,c)})})}insert(t,e=1){const s={};this.each((i,n)=>{let r=parseInt(i,10);r>=t&&(r+=e,this.eachCells(i,(o,c)=>{c.text&&c.text[0]==="="&&(c.text=c.text.replace(/[a-zA-Z]{1,3}\d+/g,h=>st(h,0,e,(d,a)=>a>=t)))})),s[r]=n}),this._=s,this.len+=e}delete(t,e){const s=e-t+1,i={};this.each((n,r)=>{const o=parseInt(n,10);o<t?i[o]=r:n>e&&(i[o-s]=r,this.eachCells(n,(c,h)=>{h.text&&h.text[0]==="="&&(h.text=h.text.replace(/[a-zA-Z]{1,3}\d+/g,d=>st(d,0,-s,(a,f)=>f>e)))}))}),this._=i,this.len-=s}insertColumn(t,e=1){this.each((s,i)=>{const n={};this.eachCells(s,(r,o)=>{let c=parseInt(r,10);c>=t&&(c+=e,o.text&&o.text[0]==="="&&(o.text=o.text.replace(/[a-zA-Z]{1,3}\d+/g,h=>st(h,e,0,d=>d>=t)))),n[c]=o}),i.cells=n})}deleteColumn(t,e){const s=e-t+1;this.each((i,n)=>{const r={};this.eachCells(i,(o,c)=>{const h=parseInt(o,10);h<t?r[h]=c:h>e&&(r[h-s]=c,c.text&&c.text[0]==="="&&(c.text=c.text.replace(/[a-zA-Z]{1,3}\d+/g,d=>st(d,-s,0,a=>a>e))))}),n.cells=r})}deleteCells(t,e="all"){t.each((s,i)=>{this.deleteCell(s,i,e)})}deleteCell(t,e,s="all"){const i=this.get(t);if(i!==null){const n=this.getCell(t,e);n!==null&&n.editable!==!1&&(s==="all"?delete i.cells[e]:s==="text"?(n.text&&delete n.text,n.value&&delete n.value):s==="format"?(n.style!==void 0&&delete n.style,n.merge&&delete n.merge):s==="merge"&&n.merge&&delete n.merge)}}maxCell(){const t=Object.keys(this._),e=t[t.length-1],s=this._[e];if(s){const{cells:i}=s,n=Object.keys(i),r=n[n.length-1];return[parseInt(e,10),parseInt(r,10)]}return[0,0]}each(t){Object.entries(this._).forEach(([e,s])=>{t(e,s)})}eachCells(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach(([s,i])=>{e(s,i)})}setData(t){t.len&&(this.len=t.len,delete t.len),this._=t}getData(){const{len:t}=this;return Object.assign({len:t},this._)}}class gs{constructor({len:t,width:e,indexWidth:s,minWidth:i}){this._={},this.len=t,this.width=e,this.indexWidth=s,this.minWidth=i}setData(t){t.len&&(this.len=t.len,delete t.len),this._=t}getData(){const{len:t}=this;return Object.assign({len:t},this._)}getWidth(t){if(this.isHide(t))return 0;const e=this._[t];return e&&e.width?e.width:this.width}getOrNew(t){return this._[t]=this._[t]||{},this._[t]}setWidth(t,e){const s=this.getOrNew(t);s.width=e}unhide(t){let e=t;for(;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}isHide(t){const e=this._[t];return e&&e.hide}setHide(t,e){const s=this.getOrNew(t);e===!0?s.hide=!0:delete s.hide}setStyle(t,e){const s=this.getOrNew(t);s.style=e}sumWidth(t,e){return O.rangeSum(t,e,s=>this.getWidth(s))}totalWidth(){return this.sumWidth(0,this.len)}}const ps={toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRow:"Insert row",insertColumn:"Insert column",deleteSheet:"Delete",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}};let Ft=["en"];const Oe={en:ps};function te(l,t){if(t)for(const e of Ft){if(!t[e])break;let s=t[e];const i=l.match(/(?:\\.|[^.])+/g);for(let n=0;n<i.length;n+=1){const r=i[n],o=s[r];if(!o)break;if(n===i.length-1)return o;s=o}}}function T(l){let t=te(l,Oe);return!t&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(t=te(l,window.x_spreadsheet.$messages)),t||""}function E(l){return()=>T(l)}function ze(l,t,e=!1){e?Ft=[l]:Ft.unshift(l),t&&(Oe[l]=t)}const ee={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function F(l,t,...e){let s="";return l||(s=T(`validation.${t}`,...e)),[l,s]}class Ae{constructor(t,e,s,i){this.required=e,this.value=s,this.type=t,this.operator=i,this.message=""}parseValue(t){const{type:e}=this;return e==="date"?new Date(t):e==="number"?Number(t):t}equals(t){let e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(Array.isArray(this.value)?e=O.arrayEquals(this.value,t.value):e=this.value===t.value),e}values(){return this.value.split(",")}validate(t){const{required:e,operator:s,value:i,type:n}=this;if(e&&/^\s*$/.test(t))return F(!1,"required");if(/^\s*$/.test(t))return[!0];if(ee[n]&&!ee[n].test(t))return F(!1,"notMatch");if(n==="list")return F(this.values().includes(t),"notIn");if(s){const r=this.parseValue(t);if(s==="be"){const[o,c]=i;return F(r>=this.parseValue(o)&&r<=this.parseValue(c),"between",o,c)}if(s==="nbe"){const[o,c]=i;return F(r<this.parseValue(o)||r>this.parseValue(c),"notBetween",o,c)}if(s==="eq")return F(r===this.parseValue(i),"equal",i);if(s==="neq")return F(r!==this.parseValue(i),"notEqual",i);if(s==="lt")return F(r<this.parseValue(i),"lessThan",i);if(s==="lte")return F(r<=this.parseValue(i),"lessThanEqual",i);if(s==="gt")return F(r>this.parseValue(i),"greaterThan",i);if(s==="gte")return F(r>=this.parseValue(i),"greaterThanEqual",i)}return[!0]}}class yt{constructor(t,e,s){this.refs=e,this.mode=t,this.validator=s}includes(t,e){const{refs:s}=this;for(let i=0;i<s.length;i+=1)if($.valueOf(s[i]).includes(t,e))return!0;return!1}addRef(t){this.remove($.valueOf(t)),this.refs.push(t)}remove(t){const e=[];this.refs.forEach(s=>{const i=$.valueOf(s);i.intersects(t)?i.difference(t).forEach(r=>e.push(r.toString())):e.push(s)}),this.refs=e}getData(){const{refs:t,mode:e,validator:s}=this,{type:i,required:n,operator:r,value:o}=s;return{refs:t,mode:e,type:i,required:n,operator:r,value:o}}static valueOf({refs:t,mode:e,type:s,required:i,operator:n,value:r}){return new yt(e,t,new Ae(s,i,r,n))}}class ms{constructor(){this._=[],this.errors=new Map}getError(t,e){return this.errors.get(`${t}_${e}`)}validate(t,e,s){const i=this.get(t,e),n=`${t}_${e}`,{errors:r}=this;if(i!==null){const[o,c]=i.validator.validate(s);o?r.delete(n):r.set(n,c)}else r.delete(n);return!0}add(t,e,{type:s,required:i,value:n,operator:r}){const o=new Ae(s,i,n,r),c=this.getByValidator(o);c!==null?c.addRef(e):this._.push(new yt(t,[e],o))}getByValidator(t){for(let e=0;e<this._.length;e+=1){const s=this._[e];if(s.validator.equals(t))return s}return null}get(t,e){for(let s=0;s<this._.length;s+=1){const i=this._[s];if(i.includes(t,e))return i}return null}remove(t){this.each(e=>{e.remove(t)})}each(t){this._.forEach(e=>t(e))}getData(){return this._.filter(t=>t.refs.length>0).map(t=>t.getData())}setData(t){this._=t.map(e=>yt.valueOf(e))}}const ws={mode:"edit",view:{height:()=>document.documentElement.clientHeight,width:()=>document.documentElement.clientWidth},showGrid:!0,showToolbar:!0,showContextmenu:!0,showBottomBar:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}},bs=41,xs=41,se=(l,t)=>Object.prototype.hasOwnProperty.call(l,t);function ie(l,t,e=()=>{}){const{merges:s}=this,i=t.clone(),[n,r]=l.size(),[o,c]=t.size();return n>o&&(i.eri=t.sri+n-1),r>c&&(i.eci=t.sci+r-1),s.intersects(i)?(e(T("error.pasteForMergedCell")),!1):!0}function le(l,t,e,s=!1){const{rows:i,merges:n}=this;(e==="all"||e==="format")&&(i.deleteCells(t,e),n.deleteWithin(t)),i.copyPaste(l,t,e,s,(r,o,c)=>{if(c&&c.merge){const[h,d]=c.merge;if(h<=0&&d<=0)return;n.add(new $(r,o,r+h,o+d))}})}function vs(l,t){const{clipboard:e,rows:s,merges:i}=this;s.cutPaste(l,t),i.move(l,t.sri-l.sri,t.sci-l.sci),e.clear()}function K(l,t,e){const{styles:s,rows:i}=this,n=i.getCellOrNew(l,t);let r={};n.style!==void 0&&(r=O.cloneDeep(s[n.style])),r=O.merge(r,{border:e}),n.style=this.addStyle(r)}function ys({mode:l,style:t,color:e}){const{styles:s,selector:i,rows:n}=this,{sri:r,sci:o,eri:c,eci:h}=i.range,d=!this.isSignleSelected();if(!(!d&&(l==="inside"||l==="horizontal"||l==="vertical"))){if(l==="outside"&&!d)K.call(this,r,o,{top:[t,e],bottom:[t,e],left:[t,e],right:[t,e]});else if(l==="none")i.range.each((a,f)=>{const g=n.getCell(a,f);if(g&&g.style!==void 0){const p=O.cloneDeep(s[g.style]);delete p.border,g.style=this.addStyle(p)}});else if(l==="all"||l==="inside"||l==="outside"||l==="horizontal"||l==="vertical"){const a=[];for(let f=r;f<=c;f+=1)for(let g=o;g<=h;g+=1){const p=[];for(let S=0;S<a.length;S+=1){const[M,R,I,ht]=a[S];if(f===M+I+1&&p.push(S),M<=f&&f<=M+I&&g===R){g+=ht+1;break}}if(p.forEach(S=>a.splice(S,1)),g>h)break;const w=n.getCell(f,g);let[b,x]=[0,0];w&&w.merge&&([b,x]=w.merge,a.push([f,g,b,x]));const k=b>0&&f+b===c,v=x>0&&g+x===h;let y={};l==="all"?y={bottom:[t,e],top:[t,e],left:[t,e],right:[t,e]}:l==="inside"?(!v&&g<h&&(y.right=[t,e]),!k&&f<c&&(y.bottom=[t,e])):l==="horizontal"?!k&&f<c&&(y.bottom=[t,e]):l==="vertical"?!v&&g<h&&(y.right=[t,e]):l==="outside"&&d&&(r===f&&(y.top=[t,e]),(k||c===f)&&(y.bottom=[t,e]),o===g&&(y.left=[t,e]),(v||h===g)&&(y.right=[t,e])),Object.keys(y).length>0&&K.call(this,f,g,y),g+=x}}else if(l==="top"||l==="bottom")for(let a=o;a<=h;a+=1)l==="top"&&(K.call(this,r,a,{top:[t,e]}),a+=n.getCellMerge(r,a)[1]),l==="bottom"&&(K.call(this,c,a,{bottom:[t,e]}),a+=n.getCellMerge(c,a)[1]);else if(l==="left"||l==="right")for(let a=r;a<=c;a+=1)l==="left"&&(K.call(this,a,o,{left:[t,e]}),a+=n.getCellMerge(a,o)[0]),l==="right"&&(K.call(this,a,h,{right:[t,e]}),a+=n.getCellMerge(a,h)[0])}}function ks(l,t){const{rows:e}=this,s=this.freezeTotalHeight();let i=e.height;s+e.height<l&&(i-=t);const n=this.exceptRowSet;let r=0,o=i,{height:c}=e;for(;r<e.len&&!(o>l);r+=1)n.has(r)||(c=e.getHeight(r),o+=c);return o-=c,o<=0?{ri:-1,top:0,height:c}:{ri:r-1,top:o,height:c}}function Cs(l,t){const{cols:e}=this,s=this.freezeTotalWidth();let i=e.indexWidth;s+e.indexWidth<l&&(i-=t);const[n,r,o]=O.rangeReduceIf(0,e.len,i,e.indexWidth,l,c=>e.getWidth(c));return r<=0?{ci:-1,left:0,width:e.indexWidth}:{ci:n-1,left:r,width:o}}class Es{constructor(t,e){this.settings=O.merge(ws,e||{}),this.name=t||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new Vt,this.rows=new us(this.settings.row),this.cols=new gs(this.settings.col),this.validations=new ms,this.hyperlinks={},this.comments={},this.selector=new es,this.scroll=new ss,this.history=new is,this.clipboard=new ls,this.autoFilter=new ns,this.change=()=>{},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map}addValidation(t,e,s){this.changeData(()=>{this.validations.add(t,e,s)})}removeValidation(){const{range:t}=this.selector;this.changeData(()=>{this.validations.remove(t)})}getSelectedValidator(){const{ri:t,ci:e}=this.selector,s=this.validations.get(t,e);return s?s.validator:null}getSelectedValidation(){const{ri:t,ci:e,range:s}=this.selector,i=this.validations.get(t,e),n={ref:s.toString()};return i!==null&&(n.mode=i.mode,n.validator=i.validator),n}canUndo(){return this.history.canUndo()}canRedo(){return this.history.canRedo()}undo(){this.history.undo(this.getData(),t=>{this.setData(t)})}redo(){this.history.redo(this.getData(),t=>{this.setData(t)})}copy(){this.clipboard.copy(this.selector.range)}copyToSystemClipboard(){if(navigator.clipboard===void 0)return;let t="";const e=this.rows.getData();for(let s=this.selector.range.sri;s<=this.selector.range.eri;s+=1){if(se(e,s)){for(let i=this.selector.range.sci;i<=this.selector.range.eci;i+=1)if(i>this.selector.range.sci&&(t+="	"),se(e[s].cells,i)){const n=String(e[s].cells[i].text);n.indexOf(`
`)===-1&&n.indexOf("	")===-1&&n.indexOf('"')===-1?t+=n:t+=`"${n}"`}}else for(let i=this.selector.range.sci;i<=this.selector.range.eci;i+=1)t+="	";t+=`
`}navigator.clipboard.writeText(t).then(()=>{},s=>{console.log("text copy to the system clipboard error  ",t,s)})}cut(){this.clipboard.cut(this.selector.range)}paste(t="all",e=()=>{}){const{clipboard:s,selector:i}=this;return s.isClear()||!ie.call(this,s.range,i.range,e)?!1:(this.changeData(()=>{s.isCopy()?le.call(this,s.range,i.range,t):s.isCut()&&vs.call(this,s.range,i.range)}),!0)}pasteFromText(t){const e=t.split(`\r
`).map(n=>n.replace(/"/g,"").split("	"));e.length>0&&(e.length-=1);const{rows:s,selector:i}=this;this.changeData(()=>{s.paste(e,i.range)})}autofill(t,e,s=()=>{}){const i=this.selector.range;return ie.call(this,i,t,s)?(this.changeData(()=>{le.call(this,i,t,e,!0)}),!0):!1}clearClipboard(){this.clipboard.clear()}calSelectedRangeByEnd(t,e){const{selector:s,rows:i,cols:n,merges:r}=this;let{sri:o,sci:c,eri:h,eci:d}=s.range;const a=s.ri,f=s.ci;let[g,p]=[t,e];return t<0&&(g=i.len-1),e<0&&(p=n.len-1),g>a?[o,h]=[a,g]:[o,h]=[g,a],p>f?[c,d]=[f,p]:[c,d]=[p,f],s.range=r.union(new $(o,c,h,d)),s.range=r.union(s.range),s.range}calSelectedRangeByStart(t,e){const{selector:s,rows:i,cols:n,merges:r}=this;let o=r.getFirstIncludes(t,e);return o===null&&(o=new $(t,e,t,e),t===-1&&(o.sri=0,o.eri=i.len-1),e===-1&&(o.sci=0,o.eci=n.len-1)),s.range=o,o}setSelectedCellAttr(t,e){this.changeData(()=>{const{selector:s,styles:i,rows:n}=this;if(t==="merge")e?this.merge():this.unmerge();else if(t==="border")ys.call(this,e);else if(t==="formula"){const{ri:r,ci:o,range:c}=s;if(s.multiple()){const[h,d]=s.size(),{sri:a,sci:f,eri:g,eci:p}=c;if(h>1)for(let w=f;w<=p;w+=1){const b=n.getCellOrNew(g+1,w);b.text=`=${e}(${_(w,a)}:${_(w,g)})`}else if(d>1){const w=n.getCellOrNew(r,p+1);w.text=`=${e}(${_(f,r)}:${_(p,r)})`}}else{const h=n.getCellOrNew(r,o);h.text=`=${e}()`}}else s.range.each((r,o)=>{const c=n.getCellOrNew(r,o);let h={};if(c.style!==void 0&&(h=O.cloneDeep(i[c.style])),t==="format")h.format=e,c.style=this.addStyle(h);else if(t==="font-bold"||t==="font-italic"||t==="font-name"||t==="font-size"){const d={};d[t.split("-")[1]]=e,h.font=Object.assign(h.font||{},d),c.style=this.addStyle(h)}else t==="strike"||t==="textwrap"||t==="underline"||t==="align"||t==="valign"||t==="color"||t==="bgcolor"?(h[t]=e,c.style=this.addStyle(h)):c[t]=e})})}setSelectedCellText(t,e="input"){const{autoFilter:s,selector:i,rows:n}=this,{ri:r,ci:o}=i;let c=r;this.unsortedRowMap.has(r)&&(c=this.unsortedRowMap.get(r));const h=n.getCell(c,o),d=h?h.text:"";if(this.setCellText(c,o,t,e),s.active()){const a=s.getFilter(o);if(a){const f=a.value.findIndex(g=>g===d);f>=0&&a.value.splice(f,1,t)}}}getSelectedCell(){const{ri:t,ci:e}=this.selector;let s=t;return this.unsortedRowMap.has(t)&&(s=this.unsortedRowMap.get(t)),this.rows.getCell(s,e)}xyInSelectedRect(t,e){const{left:s,top:i,width:n,height:r}=this.getSelectedRect(),o=t-this.cols.indexWidth,c=e-this.rows.height;return o>s&&o<s+n&&c>i&&c<i+r}getSelectedRect(){return this.getRect(this.selector.range)}getClipboardRect(){const{clipboard:t}=this;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}getRect(t){const{scroll:e,rows:s,cols:i,exceptRowSet:n}=this,{sri:r,sci:o,eri:c,eci:h}=t;if(r<0&&o<0)return{left:0,l:0,top:0,t:0,scroll:e};const d=i.sumWidth(0,o),a=s.sumHeight(0,r,n),f=s.sumHeight(r,c+1,n),g=i.sumWidth(o,h+1);let p=d-e.x,w=a-e.y;const b=this.freezeTotalHeight(),x=this.freezeTotalWidth();return x>0&&x>d&&(p=d),b>0&&b>a&&(w=a),{l:d,t:a,left:p,top:w,height:f,width:g,scroll:e}}getCellRectByXY(t,e){const{scroll:s,merges:i,rows:n,cols:r}=this;let{ri:o,top:c,height:h}=ks.call(this,e,s.y),{ci:d,left:a,width:f}=Cs.call(this,t,s.x);if(d===-1&&(f=r.totalWidth()),o===-1&&(h=n.totalHeight()),o>=0||d>=0){const g=i.getFirstIncludes(o,d);g&&(o=g.sri,d=g.sci,{left:a,top:c,width:f,height:h}=this.cellRect(o,d))}return{ri:o,ci:d,left:a,top:c,width:f,height:h}}isSignleSelected(){const{sri:t,sci:e,eri:s,eci:i}=this.selector.range,n=this.getCell(t,e);if(n&&n.merge){const[r,o]=n.merge;if(t+r===s&&e+o===i)return!0}return!this.selector.multiple()}canUnmerge(){const{sri:t,sci:e,eri:s,eci:i}=this.selector.range,n=this.getCell(t,e);if(n&&n.merge){const[r,o]=n.merge;if(t+r===s&&e+o===i)return!0}return!1}merge(){const{selector:t,rows:e}=this;if(this.isSignleSelected())return;const[s,i]=t.size();if(s>1||i>1){const{sri:n,sci:r}=t.range;this.changeData(()=>{const o=e.getCellOrNew(n,r);o.merge=[s-1,i-1],this.merges.add(t.range),this.rows.deleteCells(t.range),this.rows.setCell(n,r,o)})}}unmerge(){const{selector:t}=this;if(!this.isSignleSelected())return;const{sri:e,sci:s}=t.range;this.changeData(()=>{this.rows.deleteCell(e,s,"merge"),this.merges.deleteWithin(t.range)})}canAutofilter(){return!this.autoFilter.active()}autofilter(){const{autoFilter:t,selector:e}=this;this.changeData(()=>{t.active()?(t.clear(),this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map):t.ref=e.range.toString()})}setAutoFilter(t,e,s,i){const{autoFilter:n}=this;n.addFilter(t,s,i),n.setSort(t,e),this.resetAutoFilter()}resetAutoFilter(){const{autoFilter:t,rows:e}=this;if(!t.active())return;const{sort:s}=t,{rset:i,fset:n}=t.filteredRows((c,h)=>e.getCell(c,h)),r=Array.from(n),o=Array.from(n);s&&r.sort((c,h)=>s.order==="asc"?c-h:s.order==="desc"?h-c:0),this.exceptRowSet=i,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,r.forEach((c,h)=>{this.sortedRowMap.set(o[h],c),this.unsortedRowMap.set(c,o[h])})}deleteCell(t="all"){const{selector:e}=this;this.changeData(()=>{this.rows.deleteCells(e.range,t),(t==="all"||t==="format")&&this.merges.deleteWithin(e.range)})}insert(t,e=1){this.changeData(()=>{const{sri:s,sci:i}=this.selector.range,{rows:n,merges:r,cols:o}=this;let c=s;t==="row"?n.insert(s,e):t==="column"&&(n.insertColumn(i,e),c=i,o.len+=1),r.shift(t,c,e,(h,d,a,f)=>{const g=n.getCell(h,d);g.merge[0]+=a,g.merge[1]+=f})})}delete(t){this.changeData(()=>{const{rows:e,merges:s,selector:i,cols:n}=this,{range:r}=i,{sri:o,sci:c,eri:h,eci:d}=i.range,[a,f]=i.range.size();let g=o,p=a;t==="row"?e.delete(o,h):t==="column"&&(e.deleteColumn(c,d),g=r.sci,p=f,n.len-=1),s.shift(t,g,-p,(w,b,x,k)=>{const v=e.getCell(w,b);v.merge[0]+=x,v.merge[1]+=k,v.merge[0]===0&&v.merge[1]===0&&delete v.merge})})}scrollx(t,e){const{scroll:s,freeze:i,cols:n}=this,[,r]=i,[o,c,h]=O.rangeReduceIf(r,n.len,0,0,t,a=>n.getWidth(a));let d=c;t>0&&(d+=h),s.x!==d&&(s.ci=t>0?o:0,s.x=d,e())}scrolly(t,e){const{scroll:s,freeze:i,rows:n}=this,[r]=i,[o,c,h]=O.rangeReduceIf(r,n.len,0,0,t,a=>n.getHeight(a));let d=c;t>0&&(d+=h),s.y!==d&&(s.ri=t>0?o:0,s.y=d,e())}cellRect(t,e){const{rows:s,cols:i}=this,n=i.sumWidth(0,e),r=s.sumHeight(0,t),o=s.getCell(t,e);let c=i.getWidth(e),h=s.getHeight(t);if(o!==null&&o.merge){const[d,a]=o.merge;if(d>0)for(let f=1;f<=d;f+=1)h+=s.getHeight(t+f);if(a>0)for(let f=1;f<=a;f+=1)c+=i.getWidth(e+f)}return{left:n,top:r,width:c,height:h,cell:o}}getCell(t,e){return this.rows.getCell(t,e)}getCellTextOrDefault(t,e){const s=this.getCell(t,e);return s&&s.text?s.text:""}getCellStyle(t,e){const s=this.getCell(t,e);return s&&s.style!==void 0?this.styles[s.style]:null}getCellStyleOrDefault(t,e){const{styles:s,rows:i}=this,n=i.getCell(t,e),r=n&&n.style!==void 0?s[n.style]:{};return O.merge(this.defaultStyle(),r)}getSelectedCellStyle(){const{ri:t,ci:e}=this.selector;return this.getCellStyleOrDefault(t,e)}setCellText(t,e,s,i){const{rows:n,history:r,validations:o}=this;i==="finished"?(n.setCellText(t,e,""),r.add(this.getData()),n.setCellText(t,e,s)):(n.setCellText(t,e,s),this.change(this.getData())),o.validate(t,e,s)}freezeIsActive(){const[t,e]=this.freeze;return t>0||e>0}setFreeze(t,e){this.changeData(()=>{this.freeze=[t,e]})}freezeTotalWidth(){return this.cols.sumWidth(0,this.freeze[1])}freezeTotalHeight(){return this.rows.sumHeight(0,this.freeze[0])}setRowHeight(t,e){this.changeData(()=>{this.rows.setHeight(t,e)})}setColWidth(t,e){this.changeData(()=>{this.cols.setWidth(t,e)})}viewHeight(){const{view:t,showToolbar:e,showBottomBar:s}=this.settings;let i=t.height();return s&&(i-=xs),e&&(i-=bs),i}viewWidth(){return this.settings.view.width()}freezeViewRange(){const[t,e]=this.freeze;return new $(0,0,t-1,e-1,this.freezeTotalWidth(),this.freezeTotalHeight())}contentRange(){const{rows:t,cols:e}=this,[s,i]=t.maxCell(),n=t.sumHeight(0,s+1),r=e.sumWidth(0,i+1);return new $(0,0,s,i,r,n)}exceptRowTotalHeight(t,e){const{exceptRowSet:s,rows:i}=this,n=Array.from(s);let r=0;return n.forEach(o=>{if(o<t||o>e){const c=i.getHeight(o);r+=c}}),r}viewRange(){const{scroll:t,rows:e,cols:s,freeze:i,exceptRowSet:n}=this;let{ri:r,ci:o}=t;r<=0&&([r]=i),o<=0&&([,o]=i);let[c,h]=[0,0],[d,a]=[e.len,s.len];for(let f=r;f<e.len&&(n.has(f)||(h+=e.getHeight(f),d=f),!(h>this.viewHeight()));f+=1);for(let f=o;f<s.len&&(c+=s.getWidth(f),a=f,!(c>this.viewWidth()));f+=1);return new $(r,o,d,a,c,h)}eachMergesInView(t,e){this.merges.filterIntersects(t).forEach(s=>e(s))}hideRowsOrCols(){const{rows:t,cols:e,selector:s}=this,[i,n]=s.size(),{sri:r,sci:o,eri:c,eci:h}=s.range;if(i===t.len)for(let d=o;d<=h;d+=1)e.setHide(d,!0);else if(n===e.len)for(let d=r;d<=c;d+=1)t.setHide(d,!0)}unhideRowsOrCols(t,e){this[`${t}s`].unhide(e)}rowEach(t,e,s){let i=0;const{rows:n}=this,r=this.exceptRowSet,o=[...r];let c=0;for(let h=0;h<o.length;h+=1)o[h]<t&&(c+=1);for(let h=t+c;h<=e+c;h+=1)if(r.has(h))c+=1;else{const d=n.getHeight(h);if(d>0&&(s(h,i,d),i+=d,i>this.viewHeight()))break}}colEach(t,e,s){let i=0;const{cols:n}=this;for(let r=t;r<=e;r+=1){const o=n.getWidth(r);if(o>0&&(s(r,i,o),i+=o,i>this.viewWidth()))break}}defaultStyle(){return this.settings.style}addStyle(t){const{styles:e}=this;for(let s=0;s<e.length;s+=1){const i=e[s];if(O.equals(i,t))return s}return e.push(t),e.length-1}changeData(t){this.history.add(this.getData()),t(),this.change(this.getData())}setData(t){return Object.keys(t).forEach(e=>{if(e==="merges"||e==="rows"||e==="cols"||e==="validations")this[e].setData(t[e]);else if(e==="freeze"){const[s,i]=L(t[e]);this.freeze=[i,s]}else e==="autofilter"?this.autoFilter.setData(t[e]):t[e]!==void 0&&(this[e]=t[e])}),this}getData(){const{name:t,freeze:e,styles:s,merges:i,rows:n,cols:r,validations:o,autoFilter:c}=this;return{name:t,freeze:_(e[1],e[0]),styles:s,merges:i.getData(),rows:n.getData(),cols:r.getData(),validations:o.getData(),autofilter:c.getData()}}}function A(l,t,e){l.addEventListener(t,e)}function kt(l,t,e){l.removeEventListener(t,e)}function et(l){l.xclickoutside&&(kt(window.document.body,"click",l.xclickoutside),delete l.xclickoutside)}function rt(l,t){l.xclickoutside=e=>{e.detail===2||l.contains(e.target)||(t?t(l):(l.hide(),et(l)))},A(window.document.body,"click",l.xclickoutside)}function Ie(l,t,e){A(l,"mousemove",t);const s=l;s.xEvtUp=i=>{kt(l,"mousemove",t),kt(l,"mouseup",l.xEvtUp),e(i)},A(l,"mouseup",l.xEvtUp)}function ne(l,t,e,s){let i="";Math.abs(l)>Math.abs(t)?(i=l>0?"right":"left",s(i,l,e)):(i=t>0?"down":"up",s(i,t,e))}function Ss(l,{move:t,end:e}){let s=0,i=0;A(l,"touchstart",n=>{const{pageX:r,pageY:o}=n.touches[0];s=r,i=o}),A(l,"touchmove",n=>{if(!t)return;const{pageX:r,pageY:o}=n.changedTouches[0],c=r-s,h=o-i;(Math.abs(c)>10||Math.abs(h)>10)&&(ne(c,h,n,t),s=r,i=o),n.preventDefault()}),A(l,"touchend",n=>{if(!e)return;const{pageX:r,pageY:o}=n.changedTouches[0],c=r-s,h=o-i;ne(c,h,n,e)})}function $s(){const l=new Map;function t(r,o){const c=()=>{const d=l.get(r);return Array.isArray(d)&&d.push(o)||!1},h=()=>l.set(r,[].concat(o));return l.has(r)&&c()||h()}function e(r,o){const c=()=>{const h=l.get(r);for(const d of h)d.call(null,...o)};return l.has(r)&&c()}function s(r,o){const c=()=>{const h=l.get(r),d=h.indexOf(o);return d>=0&&h.splice(d,1)&&l.get(r).length===0&&l.delete(r)};return l.has(r)&&c()}function i(r,o){const c=(...h)=>{o.call(null,...h),s(r,c)};return t(r,c)}function n(){l.clear()}return{get current(){return l},on:t,once:i,fire:e,removeListener:s,removeAllListeners:n}}const m="x-spreadsheet";class re{constructor(t=!1,e){this.moving=!1,this.vertical=t,this.el=u("div",`${m}-resizer ${t?"vertical":"horizontal"}`).children(this.unhideHoverEl=u("div",`${m}-resizer-hover`).on("dblclick.stop",s=>this.mousedblclickHandler(s)).css("position","absolute").hide(),this.hoverEl=u("div",`${m}-resizer-hover`).on("mousedown.stop",s=>this.mousedownHandler(s)),this.lineEl=u("div",`${m}-resizer-line`).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=e,this.unhideFn=()=>{}}showUnhide(t){this.unhideIndex=t,this.unhideHoverEl.show()}hideUnhide(){this.unhideHoverEl.hide()}show(t,e){const{moving:s,vertical:i,hoverEl:n,lineEl:r,el:o,unhideHoverEl:c}=this;if(s)return;this.cRect=t;const{left:h,top:d,width:a,height:f}=t;o.offset({left:i?h+a-5:h,top:i?d:d+f-5}).show(),n.offset({width:i?5:a,height:i?f:5}),r.offset({width:i?0:e.width,height:i?e.height:0}),c.offset({left:i?5-a:h,top:i?d:5-f,width:i?5:a,height:i?f:5})}hide(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}mousedblclickHandler(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}mousedownHandler(t){let e=t;const{el:s,lineEl:i,cRect:n,vertical:r,minDistance:o}=this;let c=r?n.width:n.height;i.show(),Ie(window,h=>{this.moving=!0,e!==null&&h.buttons===1&&(r?(c+=h.movementX,c>o&&s.css("left",`${n.left+c}px`)):(c+=h.movementY,c>o&&s.css("top",`${n.top+c}px`)),e=h)},()=>{e=null,i.hide(),this.moving=!1,this.hide(),this.finishedFn&&(c<o&&(c=o),this.finishedFn(n,c))})}}class oe{constructor(t){this.vertical=t,this.moveFn=null,this.el=u("div",`${m}-scrollbar ${t?"vertical":"horizontal"}`).child(this.contentEl=u("div","")).on("mousemove.stop",()=>{}).on("scroll.stop",e=>{const{scrollTop:s,scrollLeft:i}=e.target;this.moveFn&&this.moveFn(this.vertical?s:i,e)})}move(t){return this.el.scroll(t),this}scroll(){return this.el.scroll()}set(t,e){const s=t-1;if(e>s){const i=this.vertical?"height":"width";this.el.css(i,`${s-15}px`).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(i,`${e}px`)}else this.el.hide();return this}}const ut=2*2-1;let Mt=10;class gt{constructor(t=!1){this.useHideInput=t,this.inputChange=()=>{},this.cornerEl=u("div",`${m}-selector-corner`),this.areaEl=u("div",`${m}-selector-area`).child(this.cornerEl).hide(),this.clipboardEl=u("div",`${m}-selector-clipboard`).hide(),this.autofillEl=u("div",`${m}-selector-autofill`).hide(),this.el=u("div",`${m}-selector`).css("z-index",`${Mt}`).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),t&&(this.hideInput=u("input","").on("compositionend",e=>{this.inputChange(e.target.value)}),this.el.child(this.hideInputDiv=u("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=u("div","hide-input").child(this.hideInput))),Mt+=1}setOffset(t){return this.el.offset(t).show(),this}hide(){return this.el.hide(),this}setAreaOffset(t){const{left:e,top:s,width:i,height:n}=t,r={width:i-ut+.8,height:n-ut+.8,left:e-.8,top:s-.8};this.areaEl.offset(r).show(),this.useHideInput&&(this.hideInputDiv.offset(r),this.hideInput.val("").focus())}setClipboardOffset(t){const{left:e,top:s,width:i,height:n}=t;this.clipboardEl.offset({left:e,top:s,width:i-5,height:n-5})}showAutofill(t){const{left:e,top:s,width:i,height:n}=t;this.autofillEl.offset({width:i-ut,height:n-ut,left:e,top:s}).show()}hideAutofill(){this.autofillEl.hide()}showClipboard(){this.clipboardEl.show()}hideClipboard(){this.clipboardEl.hide()}}function Bt(l){const{data:t}=this,{left:e,top:s,width:i,height:n,scroll:r,l:o,t:c}=l,h=t.freezeTotalWidth(),d=t.freezeTotalHeight();let a=e-h;h>o&&(a-=r.x);let f=s-d;return d>c&&(f-=r.y),{left:a,top:f,width:i,height:n}}function qt(l){const{data:t}=this,{left:e,width:s,height:i,l:n,t:r,scroll:o}=l,c=t.freezeTotalWidth();let h=e-c;return c>n&&(h-=o.x),{left:h,top:r,width:s,height:i}}function Lt(l){const{data:t}=this,{top:e,width:s,height:i,l:n,t:r,scroll:o}=l,c=t.freezeTotalHeight();let h=e-c;return c>r&&(h-=o.y),{left:n,top:h,width:s,height:i}}function Ht(l){const{br:t}=this;t.setAreaOffset(Bt.call(this,l))}function Ts(l){const{tl:t}=this;t.setAreaOffset(l)}function Re(l){const{t}=this;t.setAreaOffset(qt.call(this,l))}function Fe(l){const{l:t}=this;t.setAreaOffset(Lt.call(this,l))}function Me(l){const{l:t}=this;t.setClipboardOffset(Lt.call(this,l))}function Wt(l){const{br:t}=this;t.setClipboardOffset(Bt.call(this,l))}function Ds(l){const{tl:t}=this;t.setClipboardOffset(l)}function He(l){const{t}=this;t.setClipboardOffset(qt.call(this,l))}function ce(l){Ht.call(this,l),Ts.call(this,l),Re.call(this,l),Fe.call(this,l)}function he(l){Wt.call(this,l),Ds.call(this,l),He.call(this,l),Me.call(this,l)}class Os{constructor(t){this.inputChange=()=>{},this.data=t,this.br=new gt(!0),this.t=new gt,this.l=new gt,this.tl=new gt,this.br.inputChange=e=>{this.inputChange(e)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=u("div",`${m}-selectors`).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,Mt+=1}resetData(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}hide(){this.el.hide()}resetOffset(){const{data:t,tl:e,t:s,l:i,br:n}=this,r=t.freezeTotalHeight(),o=t.freezeTotalWidth();r>0||o>0?(e.setOffset({width:o,height:r}),s.setOffset({left:o,height:r}),i.setOffset({top:r,width:o}),n.setOffset({left:o,top:r})):(e.hide(),s.hide(),i.hide(),n.setOffset({left:0,top:0}))}resetAreaOffset(){const t=this.data.getSelectedRect(),e=this.data.getClipboardRect();ce.call(this,t),he.call(this,e),this.resetOffset()}resetBRTAreaOffset(){const t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Ht.call(this,t),Re.call(this,t),Wt.call(this,e),He.call(this,e),this.resetOffset()}resetBRLAreaOffset(){const t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Ht.call(this,t),Fe.call(this,t),Wt.call(this,e),Me.call(this,e),this.resetOffset()}set(t,e,s=!0){const{data:i}=this,n=i.calSelectedRangeByStart(t,e),{sri:r,sci:o}=n;if(s){let[c,h]=[t,e];t<0&&(c=0),e<0&&(h=0),i.selector.setIndexes(c,h),this.indexes=[c,h]}this.moveIndexes=[r,o],this.range=n,this.resetAreaOffset(),this.el.show()}setEnd(t,e,s=!0){const{data:i,lastri:n,lastci:r}=this;if(s){if(t===n&&e===r)return;this.lastri=t,this.lastci=e}this.range=i.calSelectedRangeByEnd(t,e),ce.call(this,this.data.getSelectedRect())}reset(){const{eri:t,eci:e}=this.data.selector.range;this.setEnd(t,e)}showAutofill(t,e){if(t===-1&&e===-1)return;const{sri:s,sci:i,eri:n,eci:r}=this.range,[o,c]=[t,e],h=s-t,d=i-e,a=n-t,f=r-e;if(d>0)this.arange=new $(s,c,n,i-1);else if(h>0)this.arange=new $(o,i,s-1,r);else if(f<0)this.arange=new $(s,r+1,n,c);else if(a<0)this.arange=new $(n+1,i,o,r);else{this.arange=null;return}if(this.arange!==null){const g=this.data.getRect(this.arange);g.width+=2,g.height+=2;const{br:p,l:w,t:b,tl:x}=this;p.showAutofill(Bt.call(this,g)),w.showAutofill(Lt.call(this,g)),b.showAutofill(qt.call(this,g)),x.showAutofill(g)}}hideAutofill(){["br","l","t","tl"].forEach(t=>{this[t].hideAutofill()})}showClipboard(){const t=this.data.getClipboardRect();he.call(this,t),["br","l","t","tl"].forEach(e=>{this[e].showClipboard()})}hideClipboard(){["br","l","t","tl"].forEach(t=>{this[t].hideClipboard()})}}function zs(l){l.preventDefault(),l.stopPropagation();const{filterItems:t}=this;t.length<=0||(this.itemIndex>=0&&t[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=t.length-1),t[this.itemIndex].toggle())}function As(l){l.stopPropagation();const{filterItems:t}=this;t.length<=0||(this.itemIndex>=0&&t[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>t.length-1&&(this.itemIndex=0),t[this.itemIndex].toggle())}function ae(l){l.preventDefault();const{filterItems:t}=this;t.length<=0||(l.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),t[this.itemIndex].el.click(),this.hide())}function Is(l){const{keyCode:t}=l;switch(l.ctrlKey&&l.stopPropagation(),t){case 37:l.stopPropagation();break;case 38:zs.call(this,l);break;case 39:l.stopPropagation();break;case 40:As.call(this,l);break;case 13:ae.call(this,l);break;case 9:ae.call(this,l);break;default:l.stopPropagation();break}}class We{constructor(t,e,s="200px"){this.filterItems=[],this.items=t,this.el=u("div",`${m}-suggest`).css("width",s).hide(),this.itemClick=e,this.itemIndex=-1}setOffset(t){this.el.cssRemoveKeys("top","bottom").offset(t)}hide(){const{el:t}=this;this.filterItems=[],this.itemIndex=-1,t.hide(),et(this.el.parent())}setItems(t){this.items=t}search(t){let{items:e}=this;if(/^\s*$/.test(t)||(e=e.filter(i=>(i.key||i).startsWith(t.toUpperCase()))),e=e.map(i=>{let{title:n}=i;n?typeof n=="function"&&(n=n()):n=i;const r=u("div",`${m}-item`).child(n).on("click.stop",()=>{this.itemClick(i),this.hide()});return i.label&&r.child(u("div","label").html(i.label)),r}),this.filterItems=e,e.length<=0)return;const{el:s}=this;s.html("").children(...e).show(),rt(s.parent(),()=>{this.hide()})}bindInputEvents(t){t.on("keydown",e=>Is.call(this,e))}}class D extends Z{constructor(t){super("div",`${m}-icon`),this.iconNameEl=u("div",`${m}-icon-img ${t}`),this.child(this.iconNameEl)}setName(t){this.iconNameEl.className(`${m}-icon-img ${t}`)}}function de(l,t){l.setMonth(l.getMonth()+t)}function Rs(l,t){const e=new Date(l);return e.setDate(t-l.getDay()+1),e}function Fs(l,t,e){const s=new Date(l,t,1,23,59,59),i=[[],[],[],[],[],[]];for(let n=0;n<6;n+=1)for(let r=0;r<7;r+=1){const o=n*7+r,c=Rs(s,o),h=c.getMonth()!==t,d=c.getMonth()===e.getMonth()&&c.getDate()===e.getDate();i[n][r]={d:c,disabled:h,active:d}}return i}class Ms{constructor(t){this.value=t,this.cvalue=new Date(t),this.headerLeftEl=u("div","calendar-header-left"),this.bodyEl=u("tbody",""),this.buildAll(),this.el=u("div","x-spreadsheet-calendar").children(u("div","calendar-header").children(this.headerLeftEl,u("div","calendar-header-right").children(u("a","calendar-prev").on("click.stop",()=>this.prev()).child(new D("chevron-left")),u("a","calendar-next").on("click.stop",()=>this.next()).child(new D("chevron-right")))),u("table","calendar-body").children(u("thead","").child(u("tr","").children(...T("calendar.weeks").map(e=>u("th","cell").child(e)))),this.bodyEl)),this.selectChange=()=>{}}setValue(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}prev(){const{value:t}=this;de(t,-1),this.buildAll()}next(){const{value:t}=this;de(t,1),this.buildAll()}buildAll(){this.buildHeaderLeft(),this.buildBody()}buildHeaderLeft(){const{value:t}=this;this.headerLeftEl.html(`${T("calendar.months")[t.getMonth()]} ${t.getFullYear()}`)}buildBody(){const{value:t,cvalue:e,bodyEl:s}=this,n=Fs(t.getFullYear(),t.getMonth(),e).map(r=>{const o=r.map(c=>{let h="cell";return c.disabled&&(h+=" disabled"),c.active&&(h+=" active"),u("td","").child(u("div",h).on("click.stop",()=>{this.selectChange(c.d)}).child(c.d.getDate().toString()))});return u("tr","").children(...o)});s.html("").children(...n)}}class Hs{constructor(){this.calendar=new Ms(new Date),this.el=u("div",`${m}-datepicker`).child(this.calendar.el).hide()}setValue(t){const{calendar:e}=this;return typeof t=="string"?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}change(t){this.calendar.selectChange=e=>{t(e),this.hide()}}show(){this.el.show()}hide(){this.el.hide()}}function Ct(){const{inputText:l}=this;if(!/^\s*$/.test(l)){const{textlineEl:t,textEl:e,areaOffset:s}=this,i=l.split(`
`),n=Math.max(...i.map(a=>a.length)),o=t.offset().width/l.length,c=(n+1)*o+5,h=this.viewFn().width-s.left-o;let d=i.length;if(c>s.width){let a=c;c>h&&(a=h,d+=parseInt(c/h,10),d+=c%h>0?1:0),e.css("width",`${a}px`)}d*=this.rowHeight,d>s.height&&e.css("height",`${d}px`)}}function Ws({target:l},t){const{value:e,selectionEnd:s}=l,i=`${e.slice(0,s)}${t}${e.slice(s)}`;l.value=i,l.setSelectionRange(s+1,s+1),this.inputText=i,this.textlineEl.html(i),Ct.call(this)}function Ns(l){const{keyCode:t,altKey:e}=l;t!==13&&t!==9&&l.stopPropagation(),t===13&&e&&(Ws.call(this,l,`
`),l.stopPropagation()),t===13&&!e&&l.preventDefault()}function _s(l){const t=l.target.value,{suggest:e,textlineEl:s,validator:i}=this,{cell:n}=this;if(n!==null)if("editable"in n&&n.editable===!0||n.editable===void 0){if(this.inputText=t,i)i.type==="list"?e.search(t):e.hide();else{const r=t.lastIndexOf("=");r!==-1?e.search(t.substring(r+1)):e.hide()}s.html(t),Ct.call(this),this.change("input",t)}else l.target.value=n.text;else{if(this.inputText=t,i)i.type==="list"?e.search(t):e.hide();else{const r=t.lastIndexOf("=");r!==-1?e.search(t.substring(r+1)):e.hide()}s.html(t),Ct.call(this),this.change("input",t)}}function Ps(l){const{el:t}=this.textEl;setTimeout(()=>{t.focus(),t.setSelectionRange(l,l)},0)}function Ne(l,t){const{textEl:e,textlineEl:s}=this;e.el.blur(),e.val(l),s.html(l),Ps.call(this,t)}function Vs(l){const{inputText:t,validator:e}=this;let s=0;if(e&&e.type==="list")this.inputText=l,s=this.inputText.length;else{const i=t.lastIndexOf("="),n=t.substring(0,i+1);let r=t.substring(i+1);r.indexOf(")")!==-1?r=r.substring(r.indexOf(")")):r="",this.inputText=`${n+l.key}(`,s=this.inputText.length,this.inputText+=`)${r}`}Ne.call(this,this.inputText,s)}function Bs(){this.suggest.setItems(this.formulas)}function qs(l){let t=l.getMonth()+1,e=l.getDate();return t<10&&(t=`0${t}`),e<10&&(e=`0${e}`),`${l.getFullYear()}-${t}-${e}`}class Ls{constructor(t,e,s){this.viewFn=e,this.rowHeight=s,this.formulas=t,this.suggest=new We(t,i=>{Vs.call(this,i)}),this.datepicker=new Hs,this.datepicker.change(i=>{this.setText(qs(i)),this.clear()}),this.areaEl=u("div",`${m}-editor-area`).children(this.textEl=u("textarea","").on("input",i=>_s.call(this,i)).on("paste.stop",()=>{}).on("keydown",i=>Ns.call(this,i)),this.textlineEl=u("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",()=>{}).on("mousedown.stop",()=>{}),this.el=u("div",`${m}-editor`).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=()=>{}}setFreezeLengths(t,e){this.freeze.w=t,this.freeze.h=e}clear(){this.inputText!==""&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),Bs.call(this),this.datepicker.hide()}setOffset(t,e="top"){const{textEl:s,areaEl:i,suggest:n,freeze:r,el:o}=this;if(t){this.areaOffset=t;const{left:c,top:h,width:d,height:a,l:f,t:g}=t,p={left:0,top:0};r.w>f&&r.h>g||(r.w<f&&r.h<g?(p.left=r.w,p.top=r.h):r.w>f?p.top=r.h:r.h>g&&(p.left=r.w)),o.offset(p),i.offset({left:c-p.left-.8,top:h-p.top-.8}),s.offset({width:d-9+.8,height:a-3+.8});const w={left:0};w[e]=a,n.setOffset(w),n.hide()}}setCell(t,e){const{el:s,datepicker:i,suggest:n}=this;s.show(),this.cell=t;const r=t&&t.text||"";if(this.setText(r),this.validator=e,e){const{type:o}=e;o==="date"&&(i.show(),/^\s*$/.test(r)||i.setValue(r)),o==="list"&&(n.setItems(e.values()),n.search(""))}}setText(t){this.inputText=t,Ne.call(this,t,t.length),Ct.call(this)}}class Y extends Z{constructor(t,e=""){super("div",`${m}-button ${e}`),this.child(T(`button.${t}`))}}function Et(){return window.devicePixelRatio||1}function jt(){return Et()-.5}function C(l){return parseInt(l*Et(),10)}function J(l){const t=C(l);return t>0?t-.5:.5}class js{constructor(t,e,s,i,n=0){this.x=t,this.y=e,this.width=s,this.height=i,this.padding=n,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}setBorders({top:t,bottom:e,left:s,right:i}){t&&(this.borderTop=t),i&&(this.borderRight=i),e&&(this.borderBottom=e),s&&(this.borderLeft=s)}innerWidth(){return this.width-this.padding*2-2}innerHeight(){return this.height-this.padding*2-2}textx(t){const{width:e,padding:s}=this;let{x:i}=this;return t==="left"?i+=s:t==="center"?i+=e/2:t==="right"&&(i+=e-s),i}texty(t,e){const{height:s,padding:i}=this;let{y:n}=this;return t==="top"?n+=i:t==="middle"?n+=s/2-e/2:t==="bottom"&&(n+=s-i-e),n}topxys(){const{x:t,y:e,width:s}=this;return[[t,e],[t+s,e]]}rightxys(){const{x:t,y:e,width:s,height:i}=this;return[[t+s,e],[t+s,e+i]]}bottomxys(){const{x:t,y:e,width:s,height:i}=this;return[[t,e+i],[t+s,e+i]]}leftxys(){const{x:t,y:e,height:s}=this;return[[t,e],[t,e+s]]}}function fe(l,t,e,s,i,n,r){const o={x:0,y:0};l==="underline"?i==="bottom"?o.y=0:i==="top"?o.y=-(n+2):o.y=-n/2:l==="strike"&&(i==="bottom"?o.y=n/2:i==="top"&&(o.y=-(n/2+2))),s==="center"?o.x=r/2:s==="right"&&(o.x=r),this.line([t-o.x,e-o.y],[t-o.x+r,e-o.y])}class _e{constructor(t,e,s){this.el=t,this.ctx=t.getContext("2d"),this.resize(e,s),this.ctx.scale(Et(),Et())}resize(t,e){this.el.style.width=`${t}px`,this.el.style.height=`${e}px`,this.el.width=C(t),this.el.height=C(e)}clear(){const{width:t,height:e}=this.el;return this.ctx.clearRect(0,0,t,e),this}attr(t){return Object.assign(this.ctx,t),this}save(){return this.ctx.save(),this.ctx.beginPath(),this}restore(){return this.ctx.restore(),this}beginPath(){return this.ctx.beginPath(),this}translate(t,e){return this.ctx.translate(C(t),C(e)),this}scale(t,e){return this.ctx.scale(t,e),this}clearRect(t,e,s,i){return this.ctx.clearRect(t,e,s,i),this}fillRect(t,e,s,i){return this.ctx.fillRect(C(t)-.5,C(e)-.5,C(s),C(i)),this}fillText(t,e,s){return this.ctx.fillText(t,C(e),C(s)),this}text(t,e,s={},i=!0){const{ctx:n}=this,{align:r,valign:o,font:c,color:h,strike:d,underline:a}=s,f=e.textx(r);n.save(),n.beginPath(),this.attr({textAlign:r,textBaseline:o,font:`${c.italic?"italic":""} ${c.bold?"bold":""} ${C(c.size)}px ${c.name}`,fillStyle:h,strokeStyle:h});const g=`${t}`.split(`
`),p=e.innerWidth(),w=[];g.forEach(k=>{const v=n.measureText(k).width;if(i&&v>C(p)){let y={w:0,len:0,start:0};for(let S=0;S<k.length;S+=1)y.w>=C(p)&&(w.push(k.substr(y.start,y.len)),y={w:0,len:0,start:S}),y.len+=1,y.w+=n.measureText(k[S]).width+1;y.len>0&&w.push(k.substr(y.start,y.len))}else w.push(k)});const b=(w.length-1)*(c.size+2);let x=e.texty(o,b);return w.forEach(k=>{const v=n.measureText(k).width;this.fillText(k,f,x),d&&fe.call(this,"strike",f,x,r,o,c.size,v),a&&fe.call(this,"underline",f,x,r,o,c.size,v),x+=c.size+2}),n.restore(),this}border(t,e){const{ctx:s}=this;return s.lineWidth=jt,s.strokeStyle=e,t==="medium"?s.lineWidth=C(2)-.5:t==="thick"?s.lineWidth=C(3):t==="dashed"?s.setLineDash([C(3),C(2)]):t==="dotted"?s.setLineDash([C(1),C(1)]):t==="double"&&s.setLineDash([C(2),0]),this}line(...t){const{ctx:e}=this;if(t.length>1){e.beginPath();const[s,i]=t[0];e.moveTo(J(s),J(i));for(let n=1;n<t.length;n+=1){const[r,o]=t[n];e.lineTo(J(r),J(o))}e.stroke()}return this}strokeBorders(t){const{ctx:e}=this;e.save();const{borderTop:s,borderRight:i,borderBottom:n,borderLeft:r}=t;s&&(this.border(...s),this.line(...t.topxys())),i&&(this.border(...i),this.line(...t.rightxys())),n&&(this.border(...n),this.line(...t.bottomxys())),r&&(this.border(...r),this.line(...t.leftxys())),e.restore()}dropdown(t){const{ctx:e}=this,{x:s,y:i,width:n,height:r}=t,o=s+n-15,c=i+r-15;e.save(),e.beginPath(),e.moveTo(C(o),C(c)),e.lineTo(C(o+8),C(c)),e.lineTo(C(o+4),C(c+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}error(t){const{ctx:e}=this,{x:s,y:i,width:n}=t,r=s+n-1;e.save(),e.beginPath(),e.moveTo(C(r-8),C(i-1)),e.lineTo(C(r),C(i-1)),e.lineTo(C(r),C(i+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}frozen(t){const{ctx:e}=this,{x:s,y:i,width:n}=t,r=s+n-1;e.save(),e.beginPath(),e.moveTo(C(r-8),C(i-1)),e.lineTo(C(r),C(i-1)),e.lineTo(C(r),C(i+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}rect(t,e){const{ctx:s}=this,{x:i,y:n,width:r,height:o,bgcolor:c}=t;s.save(),s.beginPath(),s.fillStyle=c||"#fff",s.rect(J(i+1),J(n+1),C(r-2),C(o-2)),s.clip(),s.fill(),e(),s.restore()}}const ue=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],Nt=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function Us(l){for(let t=0;t<Nt.length;t+=1){const e=Nt[t];if(e.pt===l)return e.px}return l}const Ys=l=>{const t=[],e=[];let s=[],i=0,n="",r=1,o="";for(let c=0;c<l.length;c+=1){const h=l.charAt(c);if(h!==" "){if(h>="a"&&h<="z")s.push(h.toUpperCase());else if(h>="0"&&h<="9"||h>="A"&&h<="Z"||h===".")s.push(h);else if(h==='"'){for(c+=1;l.charAt(c)!=='"';)s.push(l.charAt(c)),c+=1;e.push(`"${s.join("")}`),s=[]}else if(h==="-"&&/[+\-*/,(]/.test(o))s.push(h);else{if(h!=="("&&s.length>0&&e.push(s.join("")),h===")"){let d=t.pop();if(i===2)try{const[a,f]=L(e.pop()),[g,p]=L(e.pop());let w=0;for(let b=g;b<=a;b+=1)for(let x=p;x<=f;x+=1)e.push(_(b,x)),w+=1;e.push([d,w])}catch{}else if(i===1||i===3)i===3&&e.push(n),e.push([d,r]),r=1;else for(;d!=="("&&(e.push(d),!(t.length<=0));)d=t.pop();i=0}else if(h==="="||h===">"||h==="<"){const d=l.charAt(c+1);n=h,(d==="="||d==="-")&&(n+=d,c+=1),i=3}else if(h===":")i=2;else if(h===",")i===3&&e.push(n),i=1,r+=1;else if(h==="("&&s.length>0)t.push(s.join(""));else{if(t.length>0&&(h==="+"||h==="-")){let d=t[t.length-1];if(d!=="("&&e.push(t.pop()),d==="*"||d==="/")for(;t.length>0&&(d=t[t.length-1],d!=="(");)e.push(t.pop())}else if(t.length>0){const d=t[t.length-1];(d==="*"||d==="/")&&e.push(t.pop())}t.push(h)}s=[]}o=h}}for(s.length>0&&e.push(s.join(""));t.length>0;)e.push(t.pop());return e},Xs=(l,t)=>{const[e]=l;let s=l;if(e==='"')return l.substring(1);let i=1;if(e==="-"&&(s=l.substring(1),i=-1),s[0]>="0"&&s[0]<="9")return i*Number(s);const[n,r]=L(s);return i*t(n,r)},Zs=(l,t,e,s)=>{const i=[];for(let n=0;n<l.length;n+=1){const r=l[n],o=r[0];if(r==="+"){const c=i.pop();i.push(U("+",i.pop(),c))}else if(r==="-")if(i.length===1){const c=i.pop();i.push(U("*",c,-1))}else{const c=i.pop();i.push(U("-",i.pop(),c))}else if(r==="*")i.push(U("*",i.pop(),i.pop()));else if(r==="/"){const c=i.pop();i.push(U("/",i.pop(),c))}else if(o==="="||o===">"||o==="<"){let c=i.pop();Number.isNaN(c)||(c=Number(c));let h=i.pop();Number.isNaN(h)||(h=Number(h));let d=!1;o==="="?d=h===c:r===">"?d=h>c:r===">="?d=h>=c:r==="<"?d=h<c:r==="<="&&(d=h<=c),i.push(d)}else if(Array.isArray(r)){const[c,h]=r,d=[];for(let a=0;a<h;a+=1)d.push(i.pop());i.push(t[c].render(d.reverse()))}else{if(s.includes(r))return 0;(o>="a"&&o<="z"||o>="A"&&o<="Z")&&s.push(r),i.push(Xs(r,e)),s.pop()}}return i[0]},Pe=(l,t,e,s=[])=>{if(l[0]==="="){const i=Ys(l.substring(1));return i.length<=0?l:Zs(i,t,(n,r)=>Pe(e(n,r),t,e,s),s)}return l},Ks={render:Pe},Ut=[{key:"SUM",title:E("formula.sum"),render:l=>l.reduce((t,e)=>U("+",t,e),0)},{key:"AVERAGE",title:E("formula.average"),render:l=>l.reduce((t,e)=>Number(t)+Number(e),0)/l.length},{key:"MAX",title:E("formula.max"),render:l=>Math.max(...l.map(t=>Number(t)))},{key:"MIN",title:E("formula.min"),render:l=>Math.min(...l.map(t=>Number(t)))},{key:"IF",title:E("formula._if"),render:([l,t,e])=>l?t:e},{key:"AND",title:E("formula.and"),render:l=>l.every(t=>t)},{key:"OR",title:E("formula.or"),render:l=>l.some(t=>t)},{key:"CONCAT",title:E("formula.concat"),render:l=>l.join("")}],Js=Ut,Ve={};Ut.forEach(l=>{Ve[l.key]=l});const G=l=>l,pt=l=>{if(/^(-?\d*.?\d*)$/.test(l)){const t=Number(l).toFixed(2).toString(),[e,...s]=t.split("\\.");return[e.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),...s]}return l},it=[{key:"normal",title:E("format.normal"),type:"string",render:G},{key:"text",title:E("format.text"),type:"string",render:G},{key:"number",title:E("format.number"),type:"number",label:"1,000.12",render:pt},{key:"percent",title:E("format.percent"),type:"number",label:"10.12%",render:l=>`${l}%`},{key:"rmb",title:E("format.rmb"),type:"number",label:"￥10.00",render:l=>`￥${pt(l)}`},{key:"usd",title:E("format.usd"),type:"number",label:"$10.00",render:l=>`$${pt(l)}`},{key:"eur",title:E("format.eur"),type:"number",label:"€10.00",render:l=>`€${pt(l)}`},{key:"date",title:E("format.date"),type:"date",label:"26/09/2008",render:G},{key:"time",title:E("format.time"),type:"date",label:"15:59:00",render:G},{key:"datetime",title:E("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:G},{key:"duration",title:E("format.duration"),type:"date",label:"24:01:00",render:G}],Be={};it.forEach(l=>{Be[l.key]=l});const Gs=5,Qs={fillStyle:"#f4f5f8"},ti={fillStyle:"#fff",lineWidth:jt,strokeStyle:"#e6e6e6"};function ei(){return{textAlign:"center",textBaseline:"middle",font:`500 ${C(12)}px Source Sans Pro`,fillStyle:"#585757",lineWidth:jt(),strokeStyle:"#e6e6e6"}}function qe(l,t,e,s=0){const{left:i,top:n,width:r,height:o}=l.cellRect(t,e);return new js(i,n+s,r,o,Gs)}function St(l,t,e,s,i=0){const{sortedRowMap:n,rows:r,cols:o}=t;if(r.isHide(e)||o.isHide(s))return;let c=e;n.has(e)&&(c=n.get(e));const h=t.getCell(c,s);if(h===null)return;let d=!1;"editable"in h&&h.editable===!1&&(d=!0);const a=t.getCellStyleOrDefault(c,s),f=qe(t,e,s,i);f.bgcolor=a.bgcolor,a.border!==void 0&&(f.setBorders(a.border),l.strokeBorders(f)),l.rect(f,()=>{let g="";t.settings.evalPaused?g=h.text||"":g=Ks.render(h.text||"",Ve,(b,x)=>t.getCellTextOrDefault(x,b)),a.format&&(g=Be[a.format].render(g));const p=Object.assign({},a.font);p.size=Us(p.size),l.text(g,f,{align:a.align,valign:a.valign,font:p,color:a.color,strike:a.strike,underline:a.underline},a.textwrap),t.validations.getError(e,s)&&l.error(f),d&&l.frozen(f)})}function si(l){const{data:t,draw:e}=this;if(l){const{autoFilter:s}=t;if(!s.active())return;const i=s.hrange();l.intersects(i)&&i.each((n,r)=>{const o=qe(t,n,r);e.dropdown(o)})}}function mt(l,t,e,s,i){const{draw:n,data:r}=this;n.save(),n.translate(t,e).translate(s,i);const{exceptRowSet:o}=r,c=a=>{const f=o.has(a);if(f){const g=r.rows.getHeight(a);n.translate(0,-g)}return!f},h=r.exceptRowTotalHeight(l.sri,l.eri);n.save(),n.translate(0,-h),l.each((a,f)=>{St(n,r,a,f)},a=>c(a)),n.restore();const d=new Set;n.save(),n.translate(0,-h),r.eachMergesInView(l,({sri:a,sci:f,eri:g})=>{if(!o.has(a))St(n,r,a,f);else if(!d.has(a)){d.add(a);const p=r.rows.sumHeight(a,g+1);n.translate(0,-p)}}),n.restore(),si.call(this,l),n.restore()}function ge(l,t,e,s){const{draw:i}=this;i.save(),i.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(l,t,e,s),i.restore()}function wt(l,t,e,s,i,n){const{draw:r,data:o}=this,c=t.h,h=t.w,d=n+s,a=i+e;r.save(),r.attr(Qs),(l==="all"||l==="left")&&r.fillRect(0,d,e,c),(l==="all"||l==="top")&&r.fillRect(a,0,h,s);const{sri:f,sci:g,eri:p,eci:w}=o.selector.range;r.attr(ei()),(l==="all"||l==="left")&&(o.rowEach(t.sri,t.eri,(b,x,k)=>{const v=d+x,y=b;r.line([0,v],[e,v]),f<=y&&y<p+1&&ge.call(this,0,v,e,k),r.fillText(y+1,e/2,v+k/2),b>0&&o.rows.isHide(b-1)&&(r.save(),r.attr({strokeStyle:"#c6c6c6"}),r.line([5,v+5],[e-5,v+5]),r.restore())}),r.line([0,c+d],[e,c+d]),r.line([e,d],[e,c+d])),(l==="all"||l==="top")&&(o.colEach(t.sci,t.eci,(b,x,k)=>{const v=a+x,y=b;r.line([v,0],[v,s]),g<=y&&y<w+1&&ge.call(this,v,0,k,s),r.fillText(Te(y),v+k/2,s/2),b>0&&o.cols.isHide(b-1)&&(r.save(),r.attr({strokeStyle:"#c6c6c6"}),r.line([v+5,5],[v+5,s-5]),r.restore())}),r.line([h+a,0],[h+a,s]),r.line([0,s],[h+a,s])),r.restore()}function ii(l,t){const{draw:e}=this;e.save(),e.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,l,t),e.restore()}function bt({sri:l,sci:t,eri:e,eci:s,w:i,h:n},r,o,c,h){const{draw:d,data:a}=this,{settings:f}=a;if(d.save(),d.attr(ti).translate(r+c,o+h),!f.showGrid){d.restore();return}a.rowEach(l,e,(g,p,w)=>{g!==l&&d.line([0,p],[i,p]),g===e&&d.line([0,p+w],[i,p+w])}),a.colEach(t,s,(g,p,w)=>{g!==t&&d.line([p,0],[p,n]),g===s&&d.line([p+w,0],[p+w,n])}),d.restore()}function li(l,t,e,s){const{draw:i,data:n}=this,r=n.viewWidth()-l,o=n.viewHeight()-t;i.save().translate(l,t).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),i.line([0,s],[r,s]),i.line([e,0],[e,o]),i.restore()}class ni{constructor(t,e){this.el=t,this.draw=new _e(t,e.viewWidth(),e.viewHeight()),this.data=e}resetData(t){this.data=t,this.render()}render(){const{data:t}=this,{rows:e,cols:s}=t,i=s.indexWidth,n=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();const r=t.viewRange(),o=t.freezeTotalWidth(),c=t.freezeTotalHeight(),{x:h,y:d}=t.scroll;bt.call(this,r,i,n,o,c),mt.call(this,r,i,n,-h,-d),wt.call(this,"all",r,i,n,o,c),ii.call(this,i,n);const[a,f]=t.freeze;if(a>0||f>0){if(a>0){const p=r.clone();p.sri=0,p.eri=a-1,p.h=c,bt.call(this,p,i,n,o,0),mt.call(this,p,i,n,-h,0),wt.call(this,"top",p,i,n,o,0)}if(f>0){const p=r.clone();p.sci=0,p.eci=f-1,p.w=o,bt.call(this,p,i,n,0,c),wt.call(this,"left",p,i,n,0,c),mt.call(this,p,i,n,0,-d)}const g=t.freezeViewRange();bt.call(this,g,i,n,0,0),wt.call(this,"all",g,i,n,0,0),mt.call(this,g,i,n,0,0),li.call(this,i,n,o,c)}}clear(){this.draw.clear()}}const xt=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],_t=["landscape","portrait"];function $t(l){return parseInt(96*l,10)}function pe(l){l==="cancel"?this.el.hide():this.toPrint()}function ri(l){const{paper:t}=this,{value:e}=l.target,s=xt[e];t.w=$t(s[1]),t.h=$t(s[2]),this.preview()}function oi(l){const{paper:t}=this,{value:e}=l.target,s=_t[e];t.orientation=s,this.preview()}let ci=class{constructor(t){this.paper={w:$t(xt[0][1]),h:$t(xt[0][2]),padding:50,orientation:_t[0],get width(){return this.orientation==="landscape"?this.h:this.w},get height(){return this.orientation==="landscape"?this.w:this.h}},this.data=t,this.el=u("div",`${m}-print`).children(u("div",`${m}-print-bar`).children(u("div","-title").child("Print settings"),u("div","-right").children(u("div",`${m}-buttons`).children(new Y("cancel").on("click",pe.bind(this,"cancel")),new Y("next","primary").on("click",pe.bind(this,"next"))))),u("div",`${m}-print-content`).children(this.contentEl=u("div","-content"),u("div","-sider").child(u("form","").children(u("fieldset","").children(u("label","").child(`${T("print.size")}`),u("select","").children(...xt.map((e,s)=>u("option","").attr("value",s).child(`${e[0]} ( ${e[1]}''x${e[2]}'' )`))).on("change",ri.bind(this))),u("fieldset","").children(u("label","").child(`${T("print.orientation")}`),u("select","").children(..._t.map((e,s)=>u("option","").attr("value",s).child(`${T("print.orientations")[s]}`))).on("change",oi.bind(this))))))).hide()}resetData(t){this.data=t}preview(){const{data:t,paper:e}=this,{width:s,height:i,padding:n}=e,r=s-n*2,o=i-n*2,c=t.contentRange(),h=parseInt(c.h/o,10)+1,d=r/c.w;let a=n;const f=n;d>1&&(a+=(r-c.w)/2);let g=0,p=0;this.contentEl.html(""),this.canvases=[];const w={sri:0,sci:0,eri:0,eci:0};for(let b=0;b<h;b+=1){let x=0,k=0;const v=u("div",`${m}-canvas-card`),y=u("canvas",`${m}-canvas`);this.canvases.push(y.el);const S=new _e(y.el,s,i);for(S.save(),S.translate(a,f),d<1&&S.scale(d,d);g<=c.eri;g+=1){const R=t.rows.getHeight(g);if(x+=R,x<o)for(let I=0;I<=c.eci;I+=1)St(S,t,g,I,p),w.eci=I;else{k=-(x-R);break}}w.eri=g,S.restore(),S.save(),S.translate(a,f),d<1&&S.scale(d,d);const M=p;t.eachMergesInView(w,({sri:R,sci:I})=>{St(S,t,R,I,M)}),S.restore(),w.sri=w.eri,w.sci=w.eci,p+=k,this.contentEl.child(u("div",`${m}-canvas-card-wraper`).child(v.child(y)))}this.el.show()}toPrint(){this.el.hide();const{paper:t}=this,e=u("iframe","").hide(),{el:s}=e;window.document.body.appendChild(s);const{contentWindow:i}=s,n=i.document,r=document.createElement("style");r.innerHTML=`
      @page { size: ${t.width}px ${t.height}px; };
      canvas {
        page-break-before: auto;        
        page-break-after: always;
        image-rendering: pixelated;
      };
    `,n.head.appendChild(r),this.canvases.forEach(o=>{const c=o.cloneNode(!1);c.getContext("2d").drawImage(o,0,0),n.body.appendChild(c)}),i.print()}};const hi=[{key:"copy",title:E("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:E("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:E("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:E("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:E("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:E("contextmenu.insertRow")},{key:"insert-column",title:E("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:E("contextmenu.deleteRow")},{key:"delete-column",title:E("contextmenu.deleteColumn")},{key:"delete-cell-text",title:E("contextmenu.deleteCellText")},{key:"hide",title:E("contextmenu.hide")},{key:"divider"},{key:"validation",title:E("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:E("contextmenu.cellprintable")},{key:"cell-non-printable",title:E("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:E("contextmenu.celleditable")},{key:"cell-non-editable",title:E("contextmenu.cellnoneditable")}];function ai(l){return l.key==="divider"?u("div",`${m}-item divider`):u("div",`${m}-item`).on("click",()=>{this.itemClick(l.key),this.hide()}).children(l.title(),u("div","label").child(l.label||""))}function di(){return hi.map(l=>ai.call(this,l))}let fi=class{constructor(t,e=!1){this.menuItems=di.call(this),this.el=u("div",`${m}-contextmenu`).children(...this.menuItems).hide(),this.viewFn=t,this.itemClick=()=>{},this.isHide=e,this.setMode("range")}setMode(t){const e=this.menuItems[12];t==="row-col"?e.show():e.hide()}hide(){const{el:t}=this;t.hide(),et(t)}setPosition(t,e){if(this.isHide)return;const{el:s}=this,{width:i}=s.show().offset(),n=this.viewFn(),r=n.height/2;let o=t;n.width-t<=i&&(o-=i),s.css("left",`${o}px`),e>r?s.css("bottom",`${n.height-e}px`).css("max-height",`${e}px`).css("top","auto"):s.css("top",`${e}px`).css("max-height",`${n.height-e}px`).css("bottom","auto"),rt(s)}};function ui(l,t){if(t.classList.contains("active"))return;const{left:e,top:s,width:i,height:n}=t.getBoundingClientRect(),r=u("div",`${m}-tooltip`).html(l).show();document.body.appendChild(r.el);const o=r.box();r.css("left",`${e+i/2-o.width/2}px`).css("top",`${s+n+2}px`),A(t,"mouseleave",()=>{document.body.contains(r.el)&&document.body.removeChild(r.el)}),A(t,"click",()=>{document.body.contains(r.el)&&document.body.removeChild(r.el)})}class Yt{constructor(t,e,s){this.tip=T(`toolbar.${t.replace(/-[a-z]/g,i=>i[1].toUpperCase())}`),e&&(this.tip+=` (${e})`),this.tag=t,this.shortcut=e,this.value=s,this.el=this.element(),this.change=()=>{}}element(){const{tip:t}=this;return u("div",`${m}-toolbar-btn`).on("mouseenter",e=>{ui(t,e.target)}).attr("data-tooltip",t)}setState(){}}class W extends Yt{dropdown(){}getValue(t){return t}element(){const{tag:t}=this;return this.dd=this.dropdown(),this.dd.change=e=>this.change(t,this.getValue(e)),super.element().child(this.dd)}setState(t){t&&(this.value=t,this.dd.setTitle(t))}}class N extends Z{constructor(t,e,s,i,...n){super("div",`${m}-dropdown ${i}`),this.title=t,this.change=()=>{},this.headerClick=()=>{},typeof t=="string"?this.title=u("div",`${m}-dropdown-title`).child(t):s&&this.title.addClass("arrow-left"),this.contentEl=u("div",`${m}-dropdown-content`).css("width",e).hide(),this.setContentChildren(...n),this.headerEl=u("div",`${m}-dropdown-header`),this.headerEl.on("click",()=>{this.contentEl.css("display")!=="block"?this.show():this.hide()}).children(this.title,s?u("div",`${m}-icon arrow-right`).child(u("div",`${m}-icon-img arrow-down`)):""),this.children(this.headerEl,this.contentEl)}setContentChildren(...t){this.contentEl.html(""),t.length>0&&this.contentEl.children(...t)}setTitle(t){this.title.html(t),this.hide()}show(){const{contentEl:t}=this;t.show(),this.parent().active(),rt(this.parent(),()=>{this.hide()})}hide(){this.parent().active(!1),this.contentEl.hide(),et(this.parent())}}function gi(l){return u("div",`${m}-item`).child(new D(l))}class Le extends N{constructor(t,e){const s=new D(`align-${e}`),i=t.map(n=>gi(`align-${n}`).on("click",()=>{this.setTitle(n),this.change(n)}));super(s,"auto",!0,"bottom-left",...i)}setTitle(t){this.title.setName(`align-${t}`),this.hide()}}class pi extends W{constructor(t){super("align","",t)}dropdown(){const{value:t}=this;return new Le(["left","center","right"],t)}}class mi extends W{constructor(t){super("valign","",t)}dropdown(){const{value:t}=this;return new Le(["top","middle","bottom"],t)}}class P extends Yt{element(){const{tag:t}=this;return super.element().child(new D(t)).on("click",()=>this.click())}click(){this.change(this.tag,this.toggle())}setState(t){this.el.active(t)}toggle(){return this.el.toggle()}active(){return this.el.hasClass("active")}}class wi extends P{constructor(){super("autofilter")}setState(){}}class bi extends P{constructor(){super("font-bold","Ctrl+B")}}class xi extends P{constructor(){super("font-italic","Ctrl+I")}}class vi extends P{constructor(){super("strike","Ctrl+U")}}class yi extends P{constructor(){super("underline","Ctrl+U")}}const ki=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],Ci=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],Ei=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function Ot(l){return u("td","").child(u("div",`${m}-color-palette-cell`).on("click.stop",()=>this.change(l)).css("background-color",l))}class Si{constructor(){this.el=u("div",`${m}-color-palette`),this.change=()=>{};const t=u("table","").children(u("tbody","").children(u("tr",`${m}-theme-color-placeholders`).children(...ki.map(e=>Ot.call(this,e))),...Ci.map(e=>u("tr",`${m}-theme-colors`).children(...e.map(s=>Ot.call(this,s)))),u("tr",`${m}-standard-colors`).children(...Ei.map(e=>Ot.call(this,e)))));this.el.child(t)}}class Xt extends N{constructor(t,e){const s=new D(t).css("height","16px").css("border-bottom",`3px solid ${e}`),i=new Si;i.change=n=>{this.setTitle(n),this.change(n)},super(s,"auto",!1,"bottom-left",i.el)}setTitle(t){this.title.css("border-color",t),this.hide()}}const $i=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']];class Ti extends N{constructor(t){const e=new D("line-type");let s=0;const i=$i.map((n,r)=>u("div",`${m}-item state ${t===n[0]?"checked":""}`).on("click",()=>{i[s].toggle("checked"),i[r].toggle("checked"),s=r,this.hide(),this.change(n)}).child(u("div",`${m}-line-type`).html(n[1])));super(e,"auto",!1,"bottom-left",...i)}}function me(...l){return u("table","").child(u("tbody","").children(...l))}function we(l){return u("td","").child(u("div",`${m}-border-palette-cell`).child(new D(`border-${l}`)).on("click",()=>{this.mode=l;const{mode:t,style:e,color:s}=this;this.change({mode:t,style:e,color:s})}))}class Di{constructor(){this.color="#000",this.style="thin",this.mode="all",this.change=()=>{},this.ddColor=new Xt("line-color",this.color),this.ddColor.change=e=>{this.color=e},this.ddType=new Ti(this.style),this.ddType.change=([e])=>{this.style=e},this.el=u("div",`${m}-border-palette`);const t=me(u("tr","").children(u("td",`${m}-border-palette-left`).child(me(u("tr","").children(...["all","inside","horizontal","vertical","outside"].map(e=>we.call(this,e))),u("tr","").children(...["left","top","right","bottom","none"].map(e=>we.call(this,e))))),u("td",`${m}-border-palette-right`).children(u("div",`${m}-toolbar-btn`).child(this.ddColor.el),u("div",`${m}-toolbar-btn`).child(this.ddType.el))));this.el.child(t)}}class Oi extends N{constructor(){const t=new D("border-all"),e=new Di;e.change=s=>{this.change(s),this.hide()},super(t,"auto",!1,"bottom-left",e.el)}}class zi extends W{constructor(){super("border")}dropdown(){return new Oi}}class Tt extends Yt{element(){return super.element().child(new D(this.tag)).on("click",()=>this.change(this.tag))}setState(t){this.el.disabled(t)}}class Ai extends Tt{constructor(){super("clearformat")}}class Ii extends P{constructor(){super("paintformat")}setState(){}}class Ri extends W{constructor(t){super("color",void 0,t)}dropdown(){const{tag:t,value:e}=this;return new Xt(t,e)}}class Fi extends W{constructor(t){super("bgcolor",void 0,t)}dropdown(){const{tag:t,value:e}=this;return new Xt(t,e)}}class Mi extends N{constructor(){const t=Nt.map(e=>u("div",`${m}-item`).on("click",()=>{this.setTitle(`${e.pt}`),this.change(e)}).child(`${e.pt}`));super("10","60px",!0,"bottom-left",...t)}}let Hi=class extends W{constructor(){super("font-size")}getValue(t){return t.pt}dropdown(){return new Mi}};class Wi extends N{constructor(){const t=ue.map(e=>u("div",`${m}-item`).on("click",()=>{this.setTitle(e.title),this.change(e)}).child(e.title));super(ue[0].title,"160px",!0,"bottom-left",...t)}}class Ni extends W{constructor(){super("font-name")}getValue(t){return t.key}dropdown(){return new Wi}}class _i extends N{constructor(){let t=it.slice(0);t.splice(2,0,{key:"divider"}),t.splice(8,0,{key:"divider"}),t=t.map(e=>{const s=u("div",`${m}-item`);return e.key==="divider"?s.addClass("divider"):(s.child(e.title()).on("click",()=>{this.setTitle(e.title()),this.change(e)}),e.label&&s.child(u("div","label").html(e.label))),s}),super("Normal","220px",!0,"bottom-left",...t)}setTitle(t){for(let e=0;e<it.length;e+=1)it[e].key===t&&this.title.html(it[e].title());this.hide()}}let Pi=class extends W{constructor(){super("format")}getValue(t){return t.key}dropdown(){return new _i}};class Vi extends N{constructor(){const t=Ut.map(e=>u("div",`${m}-item`).on("click",()=>{this.hide(),this.change(e)}).child(e.key));super(new D("formula"),"180px",!0,"bottom-left",...t)}}class Bi extends W{constructor(){super("formula")}getValue(t){return t.key}dropdown(){return new Vi}}class qi extends P{constructor(){super("freeze")}}class Li extends P{constructor(){super("merge")}setState(t,e){this.el.active(t).disabled(e)}}class ji extends Tt{constructor(){super("redo","Ctrl+Y")}}class Ui extends Tt{constructor(){super("undo","Ctrl+Z")}}class Yi extends Tt{constructor(){super("print","Ctrl+P")}}class Xi extends P{constructor(){super("textwrap")}}let Zi=class extends N{constructor(){const t=new D("ellipsis"),e=u("div",`${m}-toolbar-more`);super(t,"auto",!1,"bottom-right",e),this.moreBtns=e,this.contentEl.css("max-width","420px")}};class Ki extends W{constructor(){super("more"),this.el.hide()}dropdown(){return new Zi}show(){this.el.show()}hide(){this.el.hide()}}function Q(){return u("div",`${m}-toolbar-divider`)}function Ji(){this.btns2=[],this.items.forEach(l=>{if(Array.isArray(l))l.forEach(({el:t})=>{const e=t.box(),{marginLeft:s,marginRight:i}=t.computedStyle();this.btns2.push([t,e.width+parseInt(s,10)+parseInt(i,10)])});else{const t=l.box(),{marginLeft:e,marginRight:s}=l.computedStyle();this.btns2.push([l,t.width+parseInt(e,10)+parseInt(s,10)])}})}function be(){const{el:l,btns:t,moreEl:e,btns2:s}=this,{moreBtns:i,contentEl:n}=e.dd;l.css("width",`${this.widthFn()-60}px`);const r=l.box();let o=160,c=12;const h=[],d=[];s.forEach(([a,f],g)=>{o+=f,g===s.length-1||o<r.width?h.push(a):(c+=f,d.push(a))}),t.html("").children(...h),i.html("").children(...d),n.css("width",`${c}px`),d.length>0?e.show():e.hide()}class Gi{constructor(t,e,s=!1){this.data=t,this.change=()=>{},this.widthFn=e,this.isHide=s;const i=t.defaultStyle();this.items=[[this.undoEl=new Ui,this.redoEl=new ji,new Yi,this.paintformatEl=new Ii,this.clearformatEl=new Ai],Q(),[this.formatEl=new Pi],Q(),[this.fontEl=new Ni,this.fontSizeEl=new Hi],Q(),[this.boldEl=new bi,this.italicEl=new xi,this.underlineEl=new yi,this.strikeEl=new vi,this.textColorEl=new Ri(i.color)],Q(),[this.fillColorEl=new Fi(i.bgcolor),this.borderEl=new zi,this.mergeEl=new Li],Q(),[this.alignEl=new pi(i.align),this.valignEl=new mi(i.valign),this.textwrapEl=new Xi],Q(),[this.freezeEl=new qi,this.autofilterEl=new wi,this.formulaEl=new Bi,this.moreEl=new Ki]],this.el=u("div",`${m}-toolbar`),this.btns=u("div",`${m}-toolbar-btns`),this.items.forEach(n=>{Array.isArray(n)?n.forEach(r=>{this.btns.child(r.el),r.change=(...o)=>{this.change(...o)}}):this.btns.child(n.el)}),this.el.child(this.btns),s?this.el.hide():(this.reset(),setTimeout(()=>{Ji.call(this),be.call(this)},0),A(window,"resize",()=>{be.call(this)}))}paintformatActive(){return this.paintformatEl.active()}paintformatToggle(){this.paintformatEl.toggle()}trigger(t){this[`${t}El`].click()}resetData(t){this.data=t,this.reset()}reset(){if(this.isHide)return;const{data:t}=this,e=t.getSelectedCellStyle();this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutofilter());const{font:s,format:i}=e;this.formatEl.setState(i),this.fontEl.setState(s.name),this.fontSizeEl.setState(s.size),this.boldEl.setState(s.bold),this.italicEl.setState(s.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive())}}class Qi{constructor(t,e,s="600px"){this.title=t,this.el=u("div",`${m}-modal`).css("width",s).children(u("div",`${m}-modal-header`).children(new D("close").on("click.stop",()=>this.hide()),this.title),u("div",`${m}-modal-content`).children(...e)).hide()}show(){this.dimmer=u("div",`${m}-dimmer active`),document.body.appendChild(this.dimmer.el);const{width:t,height:e}=this.el.show().box(),{clientHeight:s,clientWidth:i}=document.documentElement;this.el.offset({left:(i-t)/2,top:(s-e)/3}),window.xkeydownEsc=n=>{n.keyCode===27&&this.hide()},A(window,"keydown",window.xkeydownEsc)}hide(){this.el.hide(),document.body.removeChild(this.dimmer.el),kt(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}class tt{constructor(t,e){this.vchange=()=>{},this.el=u("div",`${m}-form-input`),this.input=u("input","").css("width",t).on("input",s=>this.vchange(s)).attr("placeholder",e),this.el.child(this.input)}focus(){setTimeout(()=>{this.input.el.focus()},10)}hint(t){this.input.attr("placeholder",t)}val(t){return this.input.val(t)}}class zt{constructor(t,e,s,i=r=>r,n=()=>{}){this.key=t,this.getTitle=i,this.vchange=()=>{},this.el=u("div",`${m}-form-select`),this.suggest=new We(e.map(r=>({key:r,title:this.getTitle(r)})),r=>{this.itemClick(r.key),n(r.key),this.vchange(r.key)},s,this.el),this.el.children(this.itemEl=u("div","input-text").html(this.getTitle(t)),this.suggest.el).on("click",()=>this.show())}show(){this.suggest.search("")}itemClick(t){this.key=t,this.itemEl.html(this.getTitle(t))}val(t){return t!==void 0?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}const tl={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/};class B{constructor(t,e,s,i){this.label="",this.rule=e,s&&(this.label=u("label","label").css("width",`${i}px`).html(s)),this.tip=u("div","tip").child("tip").hide(),this.input=t,this.input.vchange=()=>this.validate(),this.el=u("div",`${m}-form-field`).children(this.label,t.el,this.tip)}isShow(){return this.el.css("display")!=="none"}show(){this.el.show()}hide(){return this.el.hide(),this}val(t){return this.input.val(t)}hint(t){this.input.hint(t)}validate(){const{input:t,rule:e,tip:s,el:i}=this,n=t.val();return e.required&&/^\s*$/.test(n)?(s.html(T("validation.required")),i.addClass("error"),!1):(e.type||e.pattern)&&!(e.pattern||tl[e.type]).test(n)?(s.html(T("validation.notMatch")),i.addClass("error"),!1):(i.removeClass("error"),!0)}}const xe=100;class el extends Qi{constructor(){const t=new B(new zt("cell",["cell"],"100%",h=>T(`dataValidation.modeType.${h}`)),{required:!0},`${T("dataValidation.range")}:`,xe),e=new B(new tt("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),s=new B(new zt("list",["list","number","date","phone","email"],"100%",h=>T(`dataValidation.type.${h}`),h=>this.criteriaSelected(h)),{required:!0},`${T("dataValidation.criteria")}:`,xe),i=new B(new zt("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",h=>T(`dataValidation.operator.${h}`),h=>this.criteriaOperatorSelected(h)),{required:!0}).hide(),n=new B(new tt("70px","10"),{required:!0}).hide(),r=new B(new tt("70px","100"),{required:!0,type:"number"}).hide(),o=new B(new tt("120px","a,b,c"),{required:!0}),c=new B(new tt("70px","10"),{required:!0,type:"number"}).hide();super(T("contextmenu.validation"),[u("div",`${m}-form-fields`).children(t.el,e.el),u("div",`${m}-form-fields`).children(s.el,i.el,n.el,r.el,c.el,o.el),u("div",`${m}-buttons`).children(new Y("cancel").on("click",()=>this.btnClick("cancel")),new Y("remove").on("click",()=>this.btnClick("remove")),new Y("save","primary").on("click",()=>this.btnClick("save")))]),this.mf=t,this.rf=e,this.cf=s,this.of=i,this.minvf=n,this.maxvf=r,this.vf=c,this.svf=o,this.change=()=>{}}showVf(t){const e=t==="date"?"2018-11-12":"10",{vf:s}=this;s.input.hint(e),s.show()}criteriaSelected(t){const{of:e,minvf:s,maxvf:i,vf:n,svf:r}=this;t==="date"||t==="number"?(e.show(),s.rule.type=t,i.rule.type=t,t==="date"?(s.hint("2018-11-12"),i.hint("2019-11-12")):(s.hint("10"),i.hint("100")),s.show(),i.show(),n.hide(),r.hide()):(t==="list"?r.show():r.hide(),n.hide(),e.hide(),s.hide(),i.hide())}criteriaOperatorSelected(t){if(!t)return;const{minvf:e,maxvf:s,vf:i}=this;if(t==="be"||t==="nbe")e.show(),s.show(),i.hide();else{const n=this.cf.val();i.rule.type=n,n==="date"?i.hint("2018-11-12"):i.hint("10"),i.show(),e.hide(),s.hide()}}btnClick(t){if(t==="cancel")this.hide();else if(t==="remove")this.change("remove"),this.hide();else if(t==="save"){const e=["mf","rf","cf","of","svf","vf","minvf","maxvf"];for(let c=0;c<e.length;c+=1){const h=this[e[c]];if(h.isShow()&&!h.validate())return}const s=this.mf.val(),i=this.rf.val(),n=this.cf.val(),r=this.of.val();let o=this.svf.val();(n==="number"||n==="date")&&(r==="be"||r==="nbe"?o=[this.minvf.val(),this.maxvf.val()]:o=this.vf.val()),this.change("save",s,i,{type:n,operator:r,required:!1,value:o}),this.hide()}}setValue(t){if(t){const{mf:e,rf:s,cf:i,of:n,svf:r,vf:o,minvf:c,maxvf:h}=this,{mode:d,ref:a,validator:f}=t,{type:g,operator:p,value:w}=f||{type:"list"};e.val(d||"cell"),s.val(a),i.val(g),n.val(p),Array.isArray(w)?(c.val(w[0]),h.val(w[1])):(r.val(w||""),o.val(w||"")),this.criteriaSelected(g),this.criteriaOperatorSelected(p)}this.show()}}function je(l){return u("div",`${m}-item ${l}`)}function ve(l){return je("state").child(T(`sort.${l}`)).on("click.stop",()=>this.itemClick(l))}function sl(l){const{filterbEl:t,filterValues:e}=this;t.html(""),Object.keys(l).forEach((i,n)=>{const r=l[i],o=e.includes(i)?"checked":"";t.child(u("div",`${m}-item state ${o}`).on("click.stop",()=>this.filterClick(n,i)).children(i===""?T("filter.empty"):i,u("div","label").html(`(${r})`)))})}function ye(){const{filterhEl:l,filterValues:t,values:e}=this;l.html(`${t.length} / ${e.length}`),l.checked(t.length===e.length)}class il{constructor(){this.filterbEl=u("div",`${m}-body`),this.filterhEl=u("div",`${m}-header state`).on("click.stop",()=>this.filterClick(0,"all")),this.el=u("div",`${m}-sort-filter`).children(this.sortAscEl=ve.call(this,"asc"),this.sortDescEl=ve.call(this,"desc"),je("divider"),u("div",`${m}-filter`).children(this.filterhEl,this.filterbEl),u("div",`${m}-buttons`).children(new Y("cancel").on("click",()=>this.btnClick("cancel")),new Y("ok","primary").on("click",()=>this.btnClick("ok")))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}btnClick(t){if(t==="ok"){const{ci:e,sort:s,filterValues:i}=this;this.ok&&this.ok(e,s,"in",i)}this.hide()}itemClick(t){this.sort=t;const{sortAscEl:e,sortDescEl:s}=this;e.checked(t==="asc"),s.checked(t==="desc")}filterClick(t,e){const{filterbEl:s,filterValues:i,values:n}=this,r=s.children();e==="all"?r.length===i.length?(this.filterValues=[],r.forEach(o=>u(o).checked(!1))):(this.filterValues=Array.from(n),r.forEach(o=>u(o).checked(!0))):u(r[t]).toggle("checked")?i.push(e):i.splice(i.findIndex(c=>c===e),1),ye.call(this)}set(t,e,s,i){this.ci=t;const{sortAscEl:n,sortDescEl:r}=this;i!==null?(this.sort=i.order,n.checked(i.asc()),r.checked(i.desc())):(this.sortDesc=null,n.checked(!1),r.checked(!1)),this.values=Object.keys(e),this.filterValues=s?Array.from(s.value):Object.keys(e),sl.call(this,e,s),ye.call(this)}setOffset(t){this.el.offset(t).show();let e=1;rt(this.el,()=>{e<=0&&this.hide(),e-=1})}show(){this.el.show()}hide(){this.el.hide(),et(this.el)}}function Ue(l,t){const e=u("div",`${m}-toast`),s=u("div",`${m}-dimmer active`),i=()=>{document.body.removeChild(e.el),document.body.removeChild(s.el)};e.children(u("div",`${m}-toast-header`).children(new D("close").on("click.stop",()=>i()),l),u("div",`${m}-toast-content`).html(t)),document.body.appendChild(e.el),document.body.appendChild(s.el);const{width:n,height:r}=e.box(),{clientHeight:o,clientWidth:c}=document.documentElement;e.offset({left:(c-n)/2,top:(o-r)/3})}function At(l,t){let e;return(...s)=>{const i=this,n=s;e||(e=setTimeout(()=>{e=null,l.apply(i,n)},t))}}function ll(){const{data:l,verticalScrollbar:t,horizontalScrollbar:e}=this,{l:s,t:i,left:n,top:r,width:o,height:c}=l.getSelectedRect(),h=this.getTableOffset();if(Math.abs(n)+o>h.width)e.move({left:s+o-h.width});else{const d=l.freezeTotalWidth();n<d&&e.move({left:s-1-d})}if(Math.abs(r)+c>h.height)t.move({top:i+c-h.height-1});else{const d=l.freezeTotalHeight();r<d&&t.move({top:i-1-d})}}function X(l,t,e,s=!0,i=!1){if(t===-1&&e===-1)return;const{table:n,selector:r,toolbar:o,data:c,contextMenu:h}=this;h.setMode(t===-1||e===-1?"row-col":"range");const d=c.getCell(t,e);l?(r.setEnd(t,e,i),this.trigger("cells-selected",d,r.range)):(r.set(t,e,s),this.trigger("cell-selected",d,t,e)),o.reset(),n.render()}function H(l,t){const{selector:e,data:s}=this,{rows:i,cols:n}=s;let[r,o]=e.indexes;const{eri:c,eci:h}=e.range;l&&([r,o]=e.moveIndexes),t==="left"?o>0&&(o-=1):t==="right"?(h!==o&&(o=h),o<n.len-1&&(o+=1)):t==="up"?r>0&&(r-=1):t==="down"?(c!==r&&(r=c),r<i.len-1&&(r+=1)):t==="row-first"?o=0:t==="row-last"?o=n.len-1:t==="col-first"?r=0:t==="col-last"&&(r=i.len-1),l&&(e.moveIndexes=[r,o]),X.call(this,l,r,o),ll.call(this)}function nl(l){if(l.buttons!==0||l.target.className===`${m}-resizer-hover`)return;const{offsetX:t,offsetY:e}=l,{rowResizer:s,colResizer:i,tableEl:n,data:r}=this,{rows:o,cols:c}=r;if(t>c.indexWidth&&e>o.height){s.hide(),i.hide();return}const h=n.box(),d=r.getCellRectByXY(l.offsetX,l.offsetY);d.ri>=0&&d.ci===-1?(d.width=c.indexWidth,s.show(d,{width:h.width}),o.isHide(d.ri-1)?s.showUnhide(d.ri):s.hideUnhide()):s.hide(),d.ri===-1&&d.ci>=0?(d.height=o.height,i.show(d,{height:h.height}),c.isHide(d.ci-1)?i.showUnhide(d.ci):i.hideUnhide()):i.hide()}function rl(l){const{verticalScrollbar:t,horizontalScrollbar:e,data:s}=this,{top:i}=t.scroll(),{left:n}=e.scroll(),{rows:r,cols:o}=s,{deltaY:c,deltaX:h}=l,d=(b,x)=>{let k=b,v=0;do v=x(k),k+=1;while(v<=0);return v},a=b=>{if(b>0){const x=s.scroll.ri+1;if(x<r.len){const k=d(x,v=>r.getHeight(v));t.move({top:i+k-1})}}else{const x=s.scroll.ri-1;if(x>=0){const k=d(x,v=>r.getHeight(v));t.move({top:x===0?0:i-k})}}},f=b=>{if(b>0){const x=s.scroll.ci+1;if(x<o.len){const k=d(x,v=>o.getWidth(v));e.move({left:n+k-1})}}else{const x=s.scroll.ci-1;if(x>=0){const k=d(x,v=>o.getWidth(v));e.move({left:x===0?0:n-k})}}},g=Math.abs(c),p=Math.abs(h),w=Math.max(g,p);/Firefox/i.test(window.navigator.userAgent)&&At(a(l.detail),50),w===p&&At(f(h),50),w===g&&At(a(c),50)}function ol(l,t){const{verticalScrollbar:e,horizontalScrollbar:s}=this,{top:i}=e.scroll(),{left:n}=s.scroll();l==="left"||l==="right"?s.move({left:n-t}):(l==="up"||l==="down")&&e.move({top:i-t})}function Zt(){const{data:l,verticalScrollbar:t}=this,{height:e}=this.getTableOffset(),s=l.exceptRowTotalHeight(0,-1);t.set(e,l.rows.totalHeight()-s)}function Kt(){const{data:l,horizontalScrollbar:t}=this,{width:e}=this.getTableOffset();l&&t.set(e,l.cols.totalWidth())}function cl(){const{selector:l,data:t,editor:e}=this,[s,i]=t.freeze;if(s>0||i>0){const n=t.freezeTotalWidth(),r=t.freezeTotalHeight();e.setFreezeLengths(n,r)}l.resetAreaOffset()}function z(){const{tableEl:l,overlayerEl:t,overlayerCEl:e,table:s,toolbar:i,selector:n,el:r}=this,o=this.getTableOffset(),c=this.getRect();l.attr(c),t.offset(c),e.offset(o),r.css("width",`${c.width}px`),Zt.call(this),Kt.call(this),cl.call(this),s.render(),i.reset(),n.reset()}function ot(){const{data:l,selector:t}=this;l.clearClipboard(),t.hideClipboard()}function Pt(){const{data:l,selector:t}=this;l.copy(),l.copyToSystemClipboard(),t.showClipboard()}function ke(){const{data:l,selector:t}=this;l.cut(),t.showClipboard()}function lt(l,t){const{data:e}=this;if(e.settings.mode!=="read"){if(e.paste(l,s=>Ue("Tip",s)))z.call(this);else if(t){const s=t.clipboardData.getData("text/plain");this.data.pasteFromText(s),z.call(this)}}}function hl(){this.data.hideRowsOrCols(),z.call(this)}function Ce(l,t){this.data.unhideRowsOrCols(l,t),z.call(this)}function al(){const{data:l}=this;l.autofilter(),z.call(this)}function dl(){const{toolbar:l}=this;l.paintformatActive()&&(lt.call(this,"format"),ot.call(this),l.paintformatToggle())}function Ee(l){const{selector:t,data:e,table:s,sortFilter:i}=this,{offsetX:n,offsetY:r}=l,o=l.target.className===`${m}-selector-corner`,c=e.getCellRectByXY(n,r),{left:h,top:d,width:a,height:f}=c;let{ri:g,ci:p}=c;const{autoFilter:w}=e;if(w.includes(g,p)&&h+a-20<n&&d+f-20<r){const b=w.items(p,(x,k)=>e.rows.getCell(x,k));i.hide(),i.set(p,b,w.getFilter(p),w.getSort(p)),i.setOffset({left:h,top:d+f+2});return}l.shiftKey||(o?t.showAutofill(g,p):X.call(this,!1,g,p),Ie(window,b=>{({ri:g,ci:p}=e.getCellRectByXY(b.offsetX,b.offsetY)),o?t.showAutofill(g,p):b.buttons===1&&!b.shiftKey&&X.call(this,!0,g,p,!0,!0)},()=>{o&&t.arange&&e.settings.mode!=="read"&&e.autofill(t.arange,"all",b=>Ue("Tip",b))&&s.render(),t.hideAutofill(),dl.call(this)})),!o&&l.buttons===1&&l.shiftKey&&X.call(this,!0,g,p)}function ct(){const{editor:l,data:t}=this,e=t.getSelectedRect(),s=this.getTableOffset();let i="top";e.top>s.height/2&&(i="bottom"),l.setOffset(e,i)}function nt(){const{editor:l,data:t}=this;t.settings.mode!=="read"&&(ct.call(this),l.setCell(t.getSelectedCell(),t.getSelectedValidator()),ot.call(this))}function fl(l){const{data:t,table:e,selector:s}=this;t.scrolly(l,()=>{s.resetBRLAreaOffset(),ct.call(this),e.render()})}function ul(l){const{data:t,table:e,selector:s}=this;t.scrollx(l,()=>{s.resetBRTAreaOffset(),ct.call(this),e.render()})}function gl(l,t){const{ri:e}=l,{table:s,selector:i,data:n}=this;n.rows.setHeight(e,t),s.render(),i.resetAreaOffset(),Zt.call(this),ct.call(this)}function pl(l,t){const{ci:e}=l,{table:s,selector:i,data:n}=this;n.cols.setWidth(e,t),s.render(),i.resetAreaOffset(),Kt.call(this),ct.call(this)}function It(l,t="finished"){const{data:e,table:s}=this;if(e.settings.mode==="read")return;e.setSelectedCellText(l,t);const{ri:i,ci:n}=e.selector;t==="finished"?s.render():this.trigger("cell-edited",l,i,n)}function vt(l){const{data:t}=this;t.settings.mode!=="read"&&(l==="insert-row"?t.insert("row"):l==="delete-row"?t.delete("row"):l==="insert-column"?t.insert("column"):l==="delete-column"?t.delete("column"):l==="delete-cell"?t.deleteCell():l==="delete-cell-format"?t.deleteCell("format"):l==="delete-cell-text"?t.deleteCell("text"):l==="cell-printable"?t.setSelectedCellAttr("printable",!0):l==="cell-non-printable"?t.setSelectedCellAttr("printable",!1):l==="cell-editable"?t.setSelectedCellAttr("editable",!0):l==="cell-non-editable"&&t.setSelectedCellAttr("editable",!1),ot.call(this),z.call(this))}function ml(l,t){const{data:e}=this;if(l==="undo")this.undo();else if(l==="redo")this.redo();else if(l==="print")this.print.preview();else if(l==="paintformat")t===!0?Pt.call(this):ot.call(this);else if(l==="clearformat")vt.call(this,"delete-cell-format");else if(l!=="link"){if(l!=="chart")if(l==="autofilter")al.call(this);else if(l==="freeze")if(t){const{ri:s,ci:i}=e.selector;this.freeze(s,i)}else this.freeze(0,0);else e.setSelectedCellAttr(l,t),l==="formula"&&!e.selector.multiple()&&nt.call(this),z.call(this)}}function wl(l,t,e,s){this.data.setAutoFilter(l,t,e,s),z.call(this)}function bl(){const{selector:l,overlayerEl:t,rowResizer:e,colResizer:s,verticalScrollbar:i,horizontalScrollbar:n,editor:r,contextMenu:o,toolbar:c,modalValidation:h,sortFilter:d}=this;t.on("mousemove",a=>{nl.call(this,a)}).on("mousedown",a=>{r.clear(),o.hide(),a.buttons===2?(this.data.xyInSelectedRect(a.offsetX,a.offsetY)||Ee.call(this,a),o.setPosition(a.offsetX,a.offsetY),a.stopPropagation()):a.detail===2?nt.call(this):Ee.call(this,a)}).on("mousewheel.stop",a=>{rl.call(this,a)}).on("mouseout",a=>{const{offsetX:f,offsetY:g}=a;g<=0&&s.hide(),f<=0&&e.hide()}),l.inputChange=a=>{It.call(this,a,"input"),nt.call(this)},Ss(t.el,{move:(a,f)=>{ol.call(this,a,f)}}),c.change=(a,f)=>ml.call(this,a,f),d.ok=(a,f,g,p)=>wl.call(this,a,f,g,p),e.finishedFn=(a,f)=>{gl.call(this,a,f)},s.finishedFn=(a,f)=>{pl.call(this,a,f)},e.unhideFn=a=>{Ce.call(this,"row",a)},s.unhideFn=a=>{Ce.call(this,"col",a)},i.moveFn=(a,f)=>{fl.call(this,a,f)},n.moveFn=(a,f)=>{ul.call(this,a,f)},r.change=(a,f)=>{It.call(this,f,a)},h.change=(a,...f)=>{a==="save"?this.data.addValidation(...f):this.data.removeValidation()},o.itemClick=a=>{a==="validation"?h.setValue(this.data.getSelectedValidation()):a==="copy"?Pt.call(this):a==="cut"?ke.call(this):a==="paste"?lt.call(this,"all"):a==="paste-value"?lt.call(this,"text"):a==="paste-format"?lt.call(this,"format"):a==="hide"?hl.call(this):vt.call(this,a)},A(window,"resize",()=>{this.reload()}),A(window,"click",a=>{this.focusing=t.contains(a.target)}),A(window,"paste",a=>{this.focusing&&(lt.call(this,"all",a),a.preventDefault())}),A(window,"keydown",a=>{if(!this.focusing)return;const f=a.keyCode||a.which,{key:g,ctrlKey:p,shiftKey:w,metaKey:b}=a;if(p||b)switch(f){case 90:this.undo(),a.preventDefault();break;case 89:this.redo(),a.preventDefault();break;case 67:Pt.call(this),a.preventDefault();break;case 88:ke.call(this),a.preventDefault();break;case 85:c.trigger("underline"),a.preventDefault();break;case 86:break;case 37:H.call(this,w,"row-first"),a.preventDefault();break;case 38:H.call(this,w,"col-first"),a.preventDefault();break;case 39:H.call(this,w,"row-last"),a.preventDefault();break;case 40:H.call(this,w,"col-last"),a.preventDefault();break;case 32:X.call(this,!1,-1,this.data.selector.ci,!1),a.preventDefault();break;case 66:c.trigger("bold");break;case 73:c.trigger("italic");break}else{switch(f){case 32:w&&X.call(this,!1,this.data.selector.ri,-1,!1);break;case 27:o.hide(),ot.call(this);break;case 37:H.call(this,w,"left"),a.preventDefault();break;case 38:H.call(this,w,"up"),a.preventDefault();break;case 39:H.call(this,w,"right"),a.preventDefault();break;case 40:H.call(this,w,"down"),a.preventDefault();break;case 9:r.clear(),H.call(this,!1,w?"left":"right"),a.preventDefault();break;case 13:r.clear(),H.call(this,!1,w?"up":"down"),a.preventDefault();break;case 8:vt.call(this,"delete-cell-text"),a.preventDefault();break}g==="Delete"?(vt.call(this,"delete-cell-text"),a.preventDefault()):f>=65&&f<=90||f>=48&&f<=57||f>=96&&f<=105||a.key==="="?(It.call(this,a.key,"input"),nt.call(this)):f===113&&nt.call(this)}})}class xl{constructor(t,e){this.eventMap=$s();const{view:s,showToolbar:i,showContextmenu:n}=e.settings;this.el=u("div",`${m}-sheet`),this.toolbar=new Gi(e,s.width,!i),this.print=new ci(e),t.children(this.toolbar.el,this.el,this.print.el),this.data=e,this.tableEl=u("canvas",`${m}-table`),this.rowResizer=new re(!1,e.rows.height),this.colResizer=new re(!0,e.cols.minWidth),this.verticalScrollbar=new oe(!0),this.horizontalScrollbar=new oe(!1),this.editor=new Ls(Js,()=>this.getTableOffset(),e.rows.height),this.modalValidation=new el,this.contextMenu=new fi(()=>this.getRect(),!n),this.selector=new Os(e),this.overlayerCEl=u("div",`${m}-overlayer-content`).children(this.editor.el,this.selector.el),this.overlayerEl=u("div",`${m}-overlayer`).child(this.overlayerCEl),this.sortFilter=new il,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el),this.table=new ni(this.tableEl.el,e),bl.call(this),z.call(this),X.call(this,!1,0,0)}on(t,e){return this.eventMap.on(t,e),this}trigger(t,...e){const{eventMap:s}=this;s.fire(t,e)}resetData(t){this.editor.clear(),this.data=t,Zt.call(this),Kt.call(this),this.toolbar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t)}loadData(t){return this.data.setData(t),z.call(this),this}freeze(t,e){const{data:s}=this;return s.setFreeze(t,e),z.call(this),this}undo(){this.data.undo(),z.call(this)}redo(){this.data.redo(),z.call(this)}reload(){return z.call(this),this}getRect(){const{data:t}=this;return{width:t.viewWidth(),height:t.viewHeight()}}getTableOffset(){const{rows:t,cols:e}=this.data,{width:s,height:i}=this.getRect();return{width:s-e.indexWidth,height:i-t.height,left:e.indexWidth,top:t.height}}}class vl extends N{constructor(t){const e=new D("ellipsis");super(e,"auto",!1,"top-left"),this.contentClick=t}reset(t){const e=t.map((s,i)=>u("div",`${m}-item`).css("width","150px").css("font-weight","normal").on("click",()=>{this.contentClick(i),this.hide()}).child(s));this.setContentChildren(...e)}setTitle(){}}const yl=[{key:"delete",title:E("contextmenu.deleteSheet")}];function kl(l){return u("div",`${m}-item`).child(l.title()).on("click",()=>{this.itemClick(l.key),this.hide()})}function Cl(){return yl.map(l=>kl.call(this,l))}class El{constructor(){this.el=u("div",`${m}-contextmenu`).css("width","160px").children(...Cl.call(this)).hide(),this.itemClick=()=>{}}hide(){const{el:t}=this;t.hide(),et(t)}setOffset(t){const{el:e}=this;e.offset(t),e.show(),rt(e)}}class Sl{constructor(t=()=>{},e=()=>{},s=()=>{},i=()=>{}){this.swapFunc=e,this.updateFunc=i,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new vl(n=>{this.clickSwap2(this.items[n])}),this.contextMenu=new El,this.contextMenu.itemClick=s,this.el=u("div",`${m}-bottombar`).children(this.contextMenu.el,this.menuEl=u("ul",`${m}-menu`).child(u("li","").children(new D("add").on("click",()=>{t()}),u("span","").child(this.moreEl))))}addItem(t,e){this.dataNames.push(t);const s=u("li",e?"active":"").child(t);s.on("click",()=>{this.clickSwap2(s)}).on("contextmenu",i=>{const{offsetLeft:n,offsetHeight:r}=i.target;this.contextMenu.setOffset({left:n,bottom:r+1}),this.deleteEl=s}).on("dblclick",()=>{const i=s.html(),n=new tt("auto","");n.val(i),n.input.on("blur",({target:r})=>{const{value:o}=r,c=this.dataNames.findIndex(h=>h===i);this.renameItem(c,o)}),s.html("").child(n.el),n.focus()}),e&&this.clickSwap(s),this.items.push(s),this.menuEl.child(s),this.moreEl.reset(this.dataNames)}renameItem(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}clear(){this.items.forEach(t=>{this.menuEl.removeChild(t.el)}),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}deleteItem(){const{activeEl:t,deleteEl:e}=this;if(this.items.length>1){const s=this.items.findIndex(i=>i===e);if(this.items.splice(s,1),this.dataNames.splice(s,1),this.menuEl.removeChild(e.el),this.moreEl.reset(this.dataNames),t===e){const[i]=this.items;return this.activeEl=i,this.activeEl.toggle(),[s,0]}return[s,-1]}return[-1]}clickSwap2(t){const e=this.items.findIndex(s=>s===t);this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}clickSwap(t){this.activeEl!==null&&this.activeEl.toggle(),this.activeEl=t}}class Ye{constructor(t,e={}){let s=t;this.options={showBottomBar:!0,...e},this.sheetIndex=1,this.datas=[],typeof t=="string"&&(s=document.querySelector(t)),this.bottombar=this.options.showBottomBar?new Sl(()=>{const n=this.addSheet();this.sheet.resetData(n)},n=>{const r=this.datas[n];this.sheet.resetData(r)},()=>{this.deleteSheet()},(n,r)=>{this.datas[n].name=r}):null,this.data=this.addSheet();const i=u("div",`${m}`).on("contextmenu",n=>n.preventDefault());s.appendChild(i.el),this.sheet=new xl(i,this.data),this.bottombar!==null&&i.child(this.bottombar.el)}addSheet(t,e=!0){const s=t||`sheet${this.sheetIndex}`,i=new Es(s,this.options);return i.change=(...n)=>{this.sheet.trigger("change",...n)},this.datas.push(i),this.bottombar!==null&&this.bottombar.addItem(s,e),this.sheetIndex+=1,i}deleteSheet(){if(this.bottombar===null)return;const[t,e]=this.bottombar.deleteItem();t>=0&&(this.datas.splice(t,1),e>=0&&this.sheet.resetData(this.datas[e]))}loadData(t){const e=Array.isArray(t)?t:[t];if(this.bottombar!==null&&this.bottombar.clear(),this.datas=[],e.length>0)for(let s=0;s<e.length;s+=1){const i=e[s],n=this.addSheet(i.name,s===0);n.setData(i),s===0&&this.sheet.resetData(n)}return this}getData(){return this.datas.map(t=>t.getData())}cellText(t,e,s,i=0){return this.datas[i].setCellText(t,e,s,"finished"),this}cell(t,e,s=0){return this.datas[s].getCell(t,e)}cellStyle(t,e,s=0){return this.datas[s].getCellStyle(t,e)}reRender(){return this.sheet.table.render(),this}on(t,e){return this.sheet.on(t,e),this}validate(){const{validations:t}=this.data;return t.errors.size<=0}change(t){return this.sheet.on("change",t),this}static locale(t,e){ze(t,e)}}const $l=(l,t={})=>new Ye(l,t);window&&(window.x_spreadsheet=$l,window.x_spreadsheet.locale=(l,t)=>ze(l,t));var Se={},$e;function Tl(){return $e||($e=1,function(l){var t={};function e(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return l[s].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=l,e.c=t,e.d=function(s,i,n){e.o(s,i)||Object.defineProperty(s,i,{enumerable:!0,get:n})},e.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},e.t=function(s,i){if(1&i&&(s=e(s)),8&i||4&i&&typeof s=="object"&&s&&s.__esModule)return s;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:s}),2&i&&typeof s!="string")for(var r in s)e.d(n,r,(function(o){return s[o]}).bind(null,r));return n},e.n=function(s){var i=s&&s.__esModule?function(){return s.default}:function(){return s};return e.d(i,"a",i),i},e.o=function(s,i){return Object.prototype.hasOwnProperty.call(s,i)},e.p="",e(e.s=3)}({3:function(l,t,e){e.r(t);const s={toolbar:{undo:"撤销",redo:"恢复",print:"打印",paintformat:"格式刷",clearformat:"清除格式",format:"数据格式",fontName:"字体",fontSize:"字号",fontBold:"加粗",fontItalic:"倾斜",underline:"下划线",strike:"删除线",color:"字体颜色",bgcolor:"填充颜色",border:"边框",merge:"合并单元格",align:"水平对齐",valign:"垂直对齐",textwrap:"自动换行",freeze:"冻结",autofilter:"自动筛选",formula:"函数",more:"更多"},contextmenu:{copy:"复制",cut:"剪切",paste:"粘贴",pasteValue:"粘贴数据",pasteFormat:"粘贴格式",hide:"隐藏",insertRow:"插入行",insertColumn:"插入列",deleteSheet:"删除",deleteRow:"删除行",deleteColumn:"删除列",deleteCell:"删除",deleteCellText:"删除数据",validation:"数据验证",cellprintable:"可打印",cellnonprintable:"不可打印",celleditable:"可编辑",cellnoneditable:"不可编辑"},print:{size:"纸张大小",orientation:"方向",orientations:["横向","纵向"]},format:{normal:"正常",text:"文本",number:"数值",percent:"百分比",rmb:"人民币",usd:"美元",eur:"欧元",date:"短日期",time:"时间",datetime:"长日期",duration:"持续时间"},formula:{sum:"求和",average:"求平均值",max:"求最大值",min:"求最小值",concat:"字符拼接",_if:"条件判断",and:"和",or:"或"},validation:{required:"此值必填",notMatch:"此值不匹配验证规则",between:"此值应在 {} 和 {} 之间",notBetween:"此值不应在 {} 和 {} 之间",notIn:"此值不在列表中",equal:"此值应该等于 {}",notEqual:"此值不应该等于 {}",lessThan:"此值应该小于 {}",lessThanEqual:"此值应该小于等于 {}",greaterThan:"此值应该大于 {}",greaterThanEqual:"此值应该大于等于 {}"},error:{pasteForMergedCell:"无法对合并的单元格执行此操作"},calendar:{weeks:["日","一","二","三","四","五","六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},button:{next:"下一步",cancel:"取消",remove:"删除",save:"保存",ok:"确认"},sort:{desc:"降序",asc:"升序"},filter:{empty:"空白"},dataValidation:{mode:"模式",range:"单元区间",criteria:"条件",modeType:{cell:"单元格",column:"列模式",row:"行模式"},type:{list:"列表",number:"数字",date:"日期",phone:"手机号",email:"电子邮件"},operator:{be:"在区间",nbe:"不在区间",lt:"小于",lte:"小于等于",gt:"大于",gte:"大于等于",eq:"等于",neq:"不等于"}}};window&&window.x_spreadsheet&&(window.x_spreadsheet.$messages=window.x_spreadsheet.$messages||{},window.x_spreadsheet.$messages["zh-cn"]=s),t.default=s}})),Se}Tl();const Dl={class:"excel"},Ol={__name:"x-data-spreadsheet",setup(l){const t=Ze(null);let e=null,s=-1,i=-1;Ke(()=>{e=new Ye(t.value,{showToolbar:!1,showBottomBar:!1,view:{height:()=>375,width:()=>400},row:{len:10,height:30},col:{len:3,width:100}}),e.loadData({rows:{0:{cells:{0:{text:"Mon"},1:{text:"100"},2:{text:"80"}}},1:{cells:{0:{text:"Tue"},1:{text:"200"},2:{text:"160"}}},2:{cells:{0:{text:"Wed"},1:{text:"300"},2:{text:"240"}}},3:{cells:{0:{text:"Thu"},1:{text:"400"},2:{text:"320"}}},4:{cells:{0:{text:"Fri"},1:{text:"500"},2:{text:"400"}}},5:{cells:{0:{text:"Sat"},1:{text:"600"},2:{text:"480"}}},6:{cells:{0:{text:"Sun"},1:{text:"700"},2:{text:"560"}}}}}),e.on("cell-selected",(r,o,c)=>{s=c,i=o,console.log(`选中: 行 ${o}, 列 ${c}`)}),e.on("cell-edited",(r,o,c)=>{let h=e.getData()[0].rows.len;o==h-1&&n("row",s,i,1)})});function n(r,o,c,h=1){let{datas:d}=e;d[0].changeData(()=>{const{rows:f,merges:g,cols:p}=d[0];let w=c;f.insert(c+1,h),g.shift(r,w,h,(b,x,k,v)=>{const y=f.getCell(b,x);y.merge[0]+=k,y.merge[1]+=v})});const a=e.getData();e.sheet.loadData(a)}return(r,o)=>(Qe(),Je("div",Dl,[Ge("div",{ref_key:"spreadsheetContainer",ref:t,style:{width:"400px",height:"375px"}},null,512)]))}},Nl=Xe(Ol,[["__scopeId","data-v-f0f72994"]]);export{Nl as default};
